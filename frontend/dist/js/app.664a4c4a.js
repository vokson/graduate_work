(function(){var __webpack_modules__={1211:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{AT:function(){return Counter},BB:function(){return Document},C2:function(){return MailChannel},GX:function(){return ApprovalFlow},JJ:function(){return FlowItemStep},Lt:function(){return ServerSetting},Rb:function(){return MailMessage},W6:function(){return evaluate_pattern},Yg:function(){return UserGroup},Zl:function(){return PdfDocument},Zw:function(){return Flow},gt:function(){return Folder},jy:function(){return UserFolderSetting},l2:function(){return DocumentApproval},m5:function(){return BaseFile},n5:function(){return User},qp:function(){return FlowItem},tr:function(){return MailBox}});var C_NOSKOV_030_DEV_web_services_skotch3_src_frontend_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2482),uuid__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(5934);const evaluate_pattern=(pattern,attributes,escape_regex_symbols=!0)=>{const arr=[...pattern.matchAll(new RegExp("{%([^{}%]*)%}","g"))];let result=pattern;return arr.forEach((e=>{const part_to_be_replaced=e[0];let expression=e[1];Object.keys(attributes).forEach((t=>{const s=attributes[t];expression=expression.replace("$$"+t+"$$","String.raw`"+s+"`")}));let evaluated_expression="";try{evaluated_expression=eval(expression)}catch(e){console.log(`Error during evaluation of pattern "${pattern}".`),console.log(e)}if(escape_regex_symbols){const escapeRegExp=t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");evaluated_expression=escapeRegExp(evaluated_expression)}while(-1!==result.indexOf(part_to_be_replaced))result=result.replace(part_to_be_replaced,evaluated_expression)})),result};class User{constructor(t,s,a,r,o,n,i,_,l,d,p,c,u){this._username=t,this._email=s,this._first_name=a,this._last_name=r,this._patronomic=o,this._position=n,this._department=i,this._is_active=_,this._access_group_regex=l,this._role=d,this._role_inside_group=p,this._role_outside_group=c,this._on_behalf=u}reset(){this._username="",this._email="",this._first_name="",this._last_name="",this._patronomic="",this._position="",this._department="",this._is_active="",this._access_group_regex="^$",this._role="",this._role_inside_group="",this._role_outside_group="",this._on_behalf=null}get to_dict(){return{username:this._username,email:this._email,first_name:this._first_name,last_name:this._last_name,patronomic:this._patronomic,position:this._position,department:this._department,is_active:this._is_active,access_group_regex:this._access_group_regex,role:this._role,role_inside_group:this._role_inside_group,role_outside_group:this._role_outside_group,on_behalf:this._on_behalf}}get username(){return this._username}set username(t){this._username=t}get email(){return this._email}set email(t){this._email=t}get first_name(){return this._first_name}set first_name(t){this._first_name=t}get last_name(){return this._last_name}set last_name(t){this._last_name=t}get patronomic(){return this._patronomic}set patronomic(t){this._patronomic=t}get position(){return this._position}set position(t){this._position=t}get department(){return this._department}set department(t){this._department=t}get is_active(){return this._is_active}set is_active(t){this._is_active=t}get access_group_regex(){return this._access_group_regex}set access_group_regex(t){this._access_group_regex=t}get role(){return this._role}set role(t){this._role=t}get role_inside_group(){return this._role_inside_group}set role_inside_group(t){this._role_inside_group=t}get role_outside_group(){return this._role_outside_group}set role_outside_group(t){this._role_outside_group=t}get on_behalf(){return this._on_behalf}set on_behalf(t){this._on_behalf=t}}class UserGroup{constructor(t,s,a,r){this._id=t,this._name=s,this._slug=a,this._is_private=r,this._users=[]}get to_dict(){return{id:this._id,name:this._name,slug:this._slug,is_private:this._is_private,users:this._users}}get id(){return this._id}get name(){return this._name}get slug(){return this._slug}get is_private(){return this._is_private}get users(){return this._users}add_user(t){this._users.push(t)}has_username(t){return this._users.map((t=>t.username)).includes(t)}}class Document{constructor(t,s,a,r,o,n=new Date,i=new Date){(0,C_NOSKOV_030_DEV_web_services_skotch3_src_frontend_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_0__.Z)(this,"_decode_attribute",((t,s)=>{if(t.toLowerCase().includes("date")){if(""===s||0===s)return"";const t=new Date(1e3*s);return isNaN(t.getTime())?s:[t.getDate(),t.getMonth()+1,t.getFullYear()].map((t=>t<10?`0${t}`:`${t}`)).join(".")}return s})),this._id=t,this._folder_id=s,this._usergroup_id=a,this._union=o,this._raw_attributes={},this._attributes={},this._description="",this._description_pattern="",this._files={},this._errors=[],this._is_saved=!0,this._is_deleted=!1,this._is_created_first_time=r,this._is_blocked=!0,this._created_at=n,this._updated_at=i,this._approvals=[],this._errors_container_id=(0,uuid__WEBPACK_IMPORTED_MODULE_1__.Z)(),this._started_checks_count=0,this._finished_checks_count=0,this._is_once_validated=!1,this._clones=[]}get id(){return this._id}get folder_id(){return this._folder_id}get usergroup_id(){return this._usergroup_id}get union(){return this._union}set union(t){this._union=t}get raw_attributes(){return this._raw_attributes}get attributes(){return this._attributes}get errors(){return this._errors}set_attribute(t,s){this._raw_attributes[t]=s,this._attributes[t]=this._decode_attribute(t,s),this._is_once_validated=!1}get_raw_attribute(t){return Object.prototype.hasOwnProperty.call(this._raw_attributes,t)?this._raw_attributes[t]:null}get_attribute(t){return Object.prototype.hasOwnProperty.call(this._attributes,t)?this._attributes[t]:null}add_file(t,s){this._files[t]=s,this._is_once_validated=!1}remove_file(t){delete this._files[t],this._is_once_validated=!1}get_file(t){return Object.prototype.hasOwnProperty.call(this._files,t)?this._files[t]:null}get files(){return Object.values(this._files)}add_approval(t){this._approvals.push(t)}get approvals(){return this._approvals}add_error(t,s){t!==this._errors_container_id||this._errors.includes(s)||this._errors.push(s)}reset_errors(){this._errors=[],this._errors_container_id=(0,uuid__WEBPACK_IMPORTED_MODULE_1__.Z)(),this._started_checks_count=0,this._finished_checks_count=0,this._is_validation_in_progress=!1}get errors_container_id(){return this._errors_container_id}get is_saved(){return this._is_saved}save(){this._is_saved=!0,this._is_created_first_time=!1}modify(){this._is_saved=!1}get is_deleted(){return this._is_deleted}delete(){this._is_deleted=!0}recover(){this._is_deleted=!1}get is_created_first_time(){return this._is_created_first_time}get raw_description(){return this._description}set description(t){void 0!==t&&(this._description=t)}get description(){return evaluate_pattern(this._description_pattern,this._attributes,!1)}get description_pattern(){return this._description_pattern}set description_pattern(t){void 0!==t&&(this._description_pattern=t)}get is_blocked(){return this._is_blocked}set is_blocked(t){void 0!==t&&(this._is_blocked=t)}get created_at(){return this._created_at}get updated_at(){return this._updated_at}start_validation(t=1){this._started_checks_count+=t,this._is_once_validated=!0}stop_validation(){this._finished_checks_count++}get is_validation_in_progress(){return this._started_checks_count>this._finished_checks_count}get is_once_validated(){return this._is_once_validated}add_clone(t){this._clones.push(t)}get clones(){return this._clones}}class Folder{constructor(t){this._id=t,this._name=null,this._storage_path="",this._master_usergroup_slug="",this._access_group="",this._version="",this._search_schema=null,this._form_schema=null,this._max_file_size=null,this._validation_constraints=null,this._user_search_schema=null,this._filename_pattern=null,this._description_pattern="",this._is_empty_search_allowed=null,this._is_list_container_required=!0,this._is_doc_container_required=!0,this._doc_container_parsers=[],this._is_necessary_validate=!1,this._default_sort_attribute=null,this._default_sort_order=!0,this._default_mode="view",this._group_by=null,this._strict_validation=[],this._action_buttons=[],this._search_action_buttons=[],this._approval_rules=null,String.prototype.replaceBadSymbols=function(t="_"){return this.replace(/\\|\||\/|:|\*|\?|<|>|\+|%|!|@/g,t)},String.prototype.padStartBeforeSeparator=function(t,s,a="."){const r=this.indexOf(a),o=-1===r?t:t+this.length-r;return this.padStart(o,s)},String.prototype.padStartBeforeNonDigitSymbol=function(t,s){const a=this.match(/[^0-9]/),r=null===a?t:t+this.length-a["index"];return this.padStart(r,s)}}get to_dict(){return{id:this.id,name:this.name,storage_path:this.storage_path,master_usergroup_slug:this.master_usergroup_slug,access_group:this.access_group,settings:this.settings}}get id(){return this._id}get version(){return this._version}set version(t){this._version=t}get name(){return this._name}set name(t){this._name=t}get search_schema(){return this._search_schema}set search_schema(t){this._search_schema=t}get form_schema(){return this._form_schema}set form_schema(t){this._form_schema=t}get user_search_schema(){return null===this._user_search_schema?this.search_schema:this._user_search_schema}set user_search_schema(t){this._user_search_schema=t}get validation_constraints(){return this._validation_constraints}set validation_constraints(t){this._validation_constraints=void 0===t?[]:t}get is_necessary_validate(){return this._is_necessary_validate}set is_necessary_validate(t){this._is_necessary_validate=t}get max_file_size(){return this._max_file_size}set max_file_size(t){this._max_file_size=t}get storage_path(){return this._storage_path}set storage_path(t){this._storage_path=t}get is_empty_search_allowed(){return this._is_empty_search_allowed}set is_empty_search_allowed(t){this._is_empty_search_allowed=void 0!==t&&t}get is_list_container_required(){return this._is_list_container_required}set is_list_container_required(t){void 0!==t&&(this._is_list_container_required=t)}get is_doc_container_required(){return this._is_doc_container_required}set is_doc_container_required(t){void 0!==t&&(this._is_doc_container_required=t)}get default_sort_attribute(){return this._default_sort_attribute}set default_sort_attribute(t){void 0!==t&&(this._default_sort_attribute=t)}get default_sort_order(){return this._default_sort_order}set default_sort_order(t){void 0!==t&&(this._default_sort_order=t)}get default_mode(){return this._default_mode}set default_mode(t){void 0!==t&&(this._default_mode=t)}get group_by(){return this._group_by}set group_by(t){void 0!==t&&(this._group_by=t)}get master_usergroup_slug(){return this._master_usergroup_slug}set master_usergroup_slug(t){void 0!==t&&(this._master_usergroup_slug=t)}get access_group(){return this._access_group}set access_group(t){void 0!==t&&(this._access_group=t)}get doc_container_parsers(){return this._doc_container_parsers}set doc_container_parsers(t){void 0!==t&&(this._doc_container_parsers=t)}get_filename_pattern(t){return evaluate_pattern(this._filename_pattern,t)}set_filename_pattern(t){this._filename_pattern=t}get description_pattern(){return this._description_pattern}set description_pattern(t){void 0!==t&&(this._description_pattern=t)}strict_validation_for_permission(t){return-1!==this._strict_validation.indexOf(t)}get strict_validation(){return this._strict_validation}set strict_validation(t){void 0!==t&&(this._strict_validation=t)}get action_buttons(){return this._action_buttons}set action_buttons(t){void 0!==t&&(this._action_buttons=t)}get search_action_buttons(){return this._search_action_buttons}set search_action_buttons(t){void 0!==t&&(this._search_action_buttons=t)}get approval_rules(){return this._approval_rules}set approval_rules(t){void 0!==t&&(this._approval_rules=t)}get settings(){let t={version:this._version,validation_schema:this._validation_schema,validation_constraints:this._validation_constraints,search_schema:this._search_schema,form_schema:this._form_schema,max_file_size:this._max_file_size,filename_pattern:this._filename_pattern,description_pattern:this._description_pattern,is_empty_search_allowed:this._is_empty_search_allowed,is_list_container_required:this._is_list_container_required,is_doc_container_required:this._is_doc_container_required,doc_container_parsers:this._doc_container_parsers,sort_by:{name:this._default_sort_attribute,asc:this._default_sort_order},mode:this._default_mode,strict_validation:this._strict_validation,action_buttons:this._action_buttons,search_action_buttons:this._search_action_buttons};return null!==this.group_by&&(t["group_by"]=this.group_by),null!==this.approval_rules&&(t["approval_rules"]=this.approval_rules),t}}class BaseFile{constructor(t,s,a){this._id=t,this._name=s,this._uploaded_size=0,this._total_size=a}get id(){return this._id}get name(){return this._name}rename(t){this._name=t}get size(){return this._total_size}set_total_size(t){this._total_size=t}_formatBytes(t,s){if(0==t)return"0 Bytes";var a=1024,r=s||2,o=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],n=Math.floor(Math.log(t)/Math.log(a));return parseFloat((t/Math.pow(a,n)).toFixed(r))+" "+o[n]}formatted_size(t){return this._formatBytes(this._total_size,t)}get progress(){return Math.floor(this._uploaded_size/this._total_size*100)}get uploaded(){return this._uploaded_size>=this._total_size}set_size_complete(){this._uploaded_size=this._total_size}set_size(t){t<0?this._uploaded_size=0:t>this._total_size?this._uploaded_size=this._total_size:t>this._uploaded_size&&(this._uploaded_size=t)}}class UserFolderSetting{constructor(t,s,a,r,o=null,n=null){this._id=t,this._folder_id=s,this._usergroup_slug=a,this._username=r,this._role=o,this._search_schema=n}get to_dict(){return{id:this._id,folder_id:this._folder_id,usergroup_slug:this._usergroup_slug,username:this._username,role:this._role,search_schema:this._search_schema}}get id(){return this._id}set id(t){this._user_folder_settings_id=t}get role(){return this._role}set role(t){this._role=t}get search_schema(){return this._search_schema}set search_schema(t){}get username(){return this._username}get folder_id(){return this._folder_id}get usergroup_slug(){return this._usergroup_slug}}class PdfDocument{constructor(t,s,a,r,o,n,i,_=!0){this._id=t,this._order=s,this._page_count=a,this._page_from=r,this._page_to=o,this._angle=n,this._file=i,this._uploaded=_}get id(){return this._id}get order(){return this._order}set order(t){void 0!==t&&(this._order=t)}get page_count(){return this._page_count}set page_count(t){void 0!==t&&(this._page_count=t)}get page_to(){return this._page_to}set page_to(t){void 0!==t&&(this._page_to=t)}get page_from(){return this._page_from}set page_from(t){void 0!==t&&(this._page_from=t)}get angle(){return this._angle}set angle(t){void 0!==t&&(this._angle=t)}get uploaded(){return this._uploaded}set uploaded(t){void 0!==t&&(this._uploaded=t)}get file(){return this._file}get to_be_editted(){return 1!=this.page_from||this.page_to!=this.page_count||0!=this.angle}}class Flow{constructor(t,s,a,r,o,n,i,_,l,d){this._id=t,this._name=s,this._username=a,this._trigger=r,this._is_multiple=o,this._is_active=n,this._message_if_fail=i,this._process=_,this._created_at=l,this._updated_at=d}get to_dict(){return{id:this.id,name:this.name,username:this.username,trigger:this.trigger,is_multiple:this.is_multiple,is_active:this.is_active,message_if_fail:this.message_if_fail,process:this.process,created_at:this.created_at,updated_at:this.updated_at}}get id(){return this._id}get name(){return this._name}get username(){return this._username}get trigger(){return this._trigger}get is_multiple(){return this._is_multiple}get is_active(){return this._is_active}get message_if_fail(){return this._message_if_fail}get process(){return this._process}get created_at(){return this._created_at}get updated_at(){return this._updated_at}}class FlowItem{constructor(t,s,a,r,o,n,i,_,l,d,p){this._id=t,this._name=s,this._username=a,this._trigger=r,this._success=o,this._is_active=n,this._message_if_fail=i,this._input=_,this._process=l,this._started_at=d,this._finished_at=p}get id(){return this._id}get name(){return this._name}get username(){return this._username}get trigger(){return this._trigger}get success(){return this._success}get is_active(){return this._is_active}get message_if_fail(){return this._message_if_fail}get raw_input(){return this._input}get input(){return JSON.stringify(this._input)}get raw_process(){return this._process}get process(){return JSON.stringify(this._process)}get started_at(){return this._started_at}get finished_at(){return this._finished_at}}class FlowItemStep{constructor(t,s,a,r,o,n,i,_,l,d,p){this._id=t,this._name=s,this._description=a,this._flowitem_id=r,this._success=o,this._result_key=n,this._action=i,this._input=_,this._output=l,this._started_at=d,this._finished_at=p}get id(){return this._id}get name(){return this._name}get description(){return this._description}get flowitem_id(){return this._flowitem_id}get success(){return this._success}get result_key(){return this._result_key}get action(){return this._action}get input(){return this._input}get output(){return this._output}get started_at(){return this._started_at}get finished_at(){return this._finished_at}}class DocumentApproval{constructor(t,s,a,r,o,n,i,_,l,d,p){this._id=t,this._state=s,this._from_username=a,this._from_first_name=r,this._from_last_name=o,this._to_username=n,this._to_first_name=i,this._to_last_name=_,this._delegated_from=l,this._created_at=d,this._updated_at=p,this._files={},this._document=null,this._active_approvals_count_of_document=null}get id(){return this._id}get state(){return this._state}get from_username(){return this._from_username}get from_first_name(){return this._from_first_name}get from_last_name(){return this._from_last_name}get to_username(){return this._to_username}get to_first_name(){return this._to_first_name}get to_last_name(){return this._to_last_name}get delegated_from(){return this._delegated_from}get created_at(){return this._created_at}get updated_at(){return this._updated_at}add_file(t,s){this._files[t]=s}remove_file(t){delete this._files[t]}get_file(t){return Object.prototype.hasOwnProperty.call(this._files,t)?this._files[t]:null}get files(){return Object.values(this._files)}get document(){return this._document}set document(t){this._document=t}get active_approvals_count_of_document(){return this._active_approvals_count_of_document}set active_approvals_count_of_document(t){this._active_approvals_count_of_document=t}}class ApprovalFlow{constructor(t,s,a,r,o,n){this._id=t,this._is_active=s,this._success=a,this._steps=r,this._created_at=o,this._updated_at=n,this._is_saved=!0}get id(){return this._id}get is_active(){return this._is_active}get is_saved(){return this._is_saved}get success(){return this._success}get steps(){return this._steps}get created_at(){return this._created_at}get updated_at(){return this._updated_at}validate_index(t){return!(t<0&&t>=this._steps.length)||(console.log("Неверный индекс массива",t),!1)}flush_empty_steps(){this._steps=this._steps.filter((t=>0!=t.length)),this._is_saved=!1}add_step(){this._steps.push([]),this._is_saved=!1}delete_step(t){this.validate_index(t)&&this._steps.splice(t,1),this._is_saved=!1}add_username_to_step(t,s){this.validate_index(t)&&this._steps[t].push(s),this._is_saved=!1}delete_username_from_step(t,s){this._steps[t]=this._steps[t].filter((t=>t!=s)),this._is_saved=!1}save(){this._is_saved=!0}}class ServerSetting{constructor(t,s,a){this._id=t,this._name=s,this._value=a,this._has_modified=!1}get id(){return this._id}get name(){return this._name}get value(){return this._value}set value(t){t&&(this._value=t),this._has_modified=!0}get has_modified(){return this._has_modified}}class MailBox{constructor(t,s,a,r,o,n,i,_,l,d,p,c){this._id=t,this._out_protocol=s,this._out_encryption=a,this._out_port=r,this._out_server=o,this._in_protocol=n,this._in_encryption=i,this._in_port=_,this._in_server=l,this._username=d,this._password=p,this._name=c,this._mail_channels=[]}get to_dict(){return{id:this.id,name:this.name,username:this.username,password:this.password,description:this.description,out_protocol:this.out_protocol,out_encryption:this.out_encryption,out_port:this.out_port,out_server:this.out_server,in_protocol:this.in_protocol,in_encryption:this.in_encryption,in_port:this.in_port,in_server:this.in_server}}get id(){return this._id}get out_protocol(){return this._out_protocol}get out_encryption(){return this._out_encryption}get out_port(){return this._out_port}get out_server(){return this._out_server}get in_protocol(){return this._in_protocol}get in_encryption(){return this._in_encryption}get in_port(){return this._in_port}get in_server(){return this._in_server}get username(){return this._username}get password(){return this._password}get name(){return this._name}get mail_channels(){return this._mail_channels}add_mail_channel(t){this._mail_channels.push(t)}}class MailChannel{constructor(t,s,a,r,o,n){this._id=t,this._name=s,this._folder=a,this._storage_path=r,this._settings=o,this._is_active=n}get to_dict(){return{id:this.id,name:this.name,folder:this.folder,storage_path:this.storage_path,settings:this.settings,is_active:this.is_active}}get id(){return this._id}get name(){return this._name}get folder(){return this._folder}get storage_path(){return this._storage_path}get settings(){return this._settings}get is_active(){return this._is_active}}class MailMessage{constructor(t,s,a,r,o,n,i,_,l,d,p){this._id=t,this._subject=s,this._address_from=a,this._address_to=r,this._address_cc=o,this._address_bcc=n,this._received_at=i,this._mailbox=_,this._mailchannel=l,this._has_text=d,this._has_html=p,this._attachments={}}get id(){return this._id}get subject(){return this._subject}get address_to(){return this._address_to}get address_from(){return this._address_from}get address_cc(){return this._address_cc}get address_bcc(){return this._address_bcc}get received_at(){return this._received_at}get mailbox(){return this._mailbox}get mailchannel(){return this._mailchannel}get has_text(){return this._has_text}get has_html(){return this._has_html}add_attachment(t,s){this._attachments[t]=s}get attachments(){return Object.values(this._attachments)}}class Counter{constructor(t,s,a,r,o){this._id=t,this._name=s,this._description=a,this._value=r,this._increment=o}get to_dict(){return{id:this.id,name:this.name,description:this.description,value:this.value,increment:this.increment}}get id(){return this._id}get name(){return this._name}get description(){return this._description}get value(){return this._value}get increment(){return this._increment}}},2985:function(t,s,a){"use strict";var r=a(9963),o=a(6252);function render(t,s,a,r,n,i){const _=(0,o.up)("base-page");return(0,o.wg)(),(0,o.j4)(_)}const n={class:"container"};function BasePagevue_type_template_id_ab6bb786_render(t,s,a,i,_,l){const d=(0,o.up)("navigation-component"),p=(0,o.up)("router-view");return(0,o.wg)(),(0,o.iD)("div",n,[(0,o.Wm)(d,{version:i.version,links:i.navigation_links,show_usergroup:i.show_usergroup,can_change_usergroup:i.can_change_usergroup},null,8,["version","links","show_usergroup","can_change_usergroup"]),(0,o.Wm)(p,null,{default:(0,o.w5)((({Component:t,route:s})=>[(0,o.Wm)(r.uT,{name:s.meta.transitionName},{default:(0,o.w5)((()=>[((0,o.wg)(),(0,o.j4)((0,o.LL)(t),{key:s.path}))])),_:2},1032,["name"])])),_:1})])}var i=a(2262),_=a(2201),l=a(3577);const d={class:"nav"},p={key:0,class:"nav__usergroup"},c={key:1,class:"nav__approvalinfo"},u=(0,o.Uk)(" Согласования: "),m={class:"nav__cartinfo"},g=(0,o._)("div",{class:"nav__cartimg",title:"Перейти в корзину"},null,-1),h=(0,o._)("div",{class:"nav__empty"},null,-1),f={class:"nav__welcome"},v={key:0},w=(0,o.Uk)("Добро пожаловать, "),y=(0,o.Uk)(" . "),b={class:"nav__version"};function NavigationComponentvue_type_template_id_24c82cc2_render(t,s,a,r,n,i){const _=(0,o.up)("router-link"),R=(0,o.up)("form-select-input");return(0,o.wg)(),(0,o.iD)("div",d,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.links,(t=>((0,o.wg)(),(0,o.iD)("div",{key:t.route_name,class:"nav__links"},[(0,o.Wm)(_,{class:"nav__item",to:{name:t.route_name}},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(t.title),1)])),_:2},1032,["to"])])))),128)),a.show_usergroup?((0,o.wg)(),(0,o.iD)("div",p,[(0,o.Wm)(R,{class:"nav__usergroupselect",parameters:{options:r.groups,is_disabled:!a.can_change_usergroup},value:r.group_id.toString(),onUpdate:s[0]||(s[0]=t=>r.handle_change_current(t))},null,8,["parameters","value"])])):(0,o.kq)("",!0),null!==r.approval_actions_count&&null!==r.approval_orders_count?((0,o.wg)(),(0,o.iD)("div",c,[(0,o.Wm)(_,{class:"nav__approvaltext",to:{name:"ApprovalsPage"}},{default:(0,o.w5)((()=>[u])),_:1}),(0,o._)("span",{class:(0,l.C_)(["nav__approvalcount",{nav__approvalcount_warning:0===r.approval_actions_count&&r.approval_orders_count>0,nav__approvalcount_alarm:r.approval_actions_count>0}])},(0,l.zw)(r.approval_actions_count)+"/"+(0,l.zw)(r.approval_orders_count),3)])):(0,o.kq)("",!0),(0,o._)("div",m,[(0,o.Wm)(_,{to:{name:"CartPage"}},{default:(0,o.w5)((()=>[g])),_:1}),(0,o._)("span",{class:(0,l.C_)(["nav__cartcount",{nav__cartcount_increased:r.cart_obj_count_increased_flag,nav__cartcount_decreased:r.cart_obj_count_decreased_flag}])},(0,l.zw)(r.cart_obj_count),3),(0,o._)("div",{class:"nav__cleancartimg",title:"Очистить корзину",onClick:s[1]||(s[1]=t=>r.handle_empty_cart())})]),h,(0,o._)("div",f,[r.user?((0,o.wg)(),(0,o.iD)("span",v,[w,(0,o.Wm)(_,{to:{name:"ProfilePage"}},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(r.user.last_name)+" "+(0,l.zw)(r.user.first_name),1)])),_:1}),y])):(0,o.kq)("",!0)]),(0,o._)("div",b,"v."+(0,l.zw)(a.version),1),(0,o._)("div",{class:"nav__behalfuserimg",title:"Вернуться в свой профиль",onClick:s[2]||(s[2]=t=>r.handle_delete_on_behalf_user())})])}class Command{}class Notify extends Command{constructor(t,s){super(),this.level=t,this.text=s}}class NotifyApiError extends Command{constructor(t){super(),this.code=t}}class LoginWithCredentials extends Command{constructor(t,s){super(),this.username=t,this.password=s}}class LoginWithToken extends Command{}class Logout extends Command{}class GetInfo extends Command{}class GetUsers extends Command{}class SetUser extends Command{constructor(t,s,a,r,o,n){super(),this.username=t,this.is_active=s,this.access_group_regex=a,this.role=r,this.role_inside_group=o,this.role_outside_group=n}}class DeleteUser extends Command{constructor(t){super(),this.username=t}}class GetUserReplacements extends Command{}class AddUserReplacement extends Command{constructor(t){super(),this.username=t}}class DeleteUserReplacement extends Command{constructor(t){super(),this.username=t}}class GetUserReplacementsOfUser extends Command{constructor(t){super(),this.username=t}}class AddUserReplacementToUser extends Command{constructor(t,s){super(),this.username_to_be_replaced=t,this.replaced_with_username=s}}class DeleteUserReplacementFromUser extends Command{constructor(t,s){super(),this.username_to_be_replaced=t,this.replaced_with_username=s}}class GetOnBehalfUsers extends Command{}class SetOnBehalfUser extends Command{constructor(t){super(),this.username=t}}class DeleteOnBehalfUser extends Command{constructor(t){super(),this.username=t}}class GetFolders extends Command{}class AddFolder extends Command{constructor(t,s,a,r,o){super(),this.name=t,this.storage_path=s,this.master_usergroup_slug=a,this.access_group=r,this.settings=o}}class DeleteFolder extends Command{constructor(t){super(),this.id=t}}class UpdateFolder extends Command{constructor(t,s,a,r,o,n){super(),this.id=t,this.name=s,this.storage_path=a,this.master_usergroup_slug=r,this.access_group=o,this.settings=n}}class GetManyDocuments extends Command{constructor(t,s,a,r,o,n,i,_){super(),this.folder_id=t,this.usergroup_id=s,this.query=a,this.offset=r,this.limit=o,this.sort_by=n,this.sort_asc=i,this.sort_rule=_}}class GetDocument extends Command{constructor(t,s,a){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a}}class GetWaitingDocumentApprovals extends Command{}class UploadFileToFolder extends Command{constructor(t,s,a,r){super(),this.folder_id=t,this.usergroup_id=s,this.file_id=a,this.file=r}}class DownloadFileFromFolder extends Command{constructor(t,s,a,r,o,n){super(),this.folder_id=t,this.usergroup_id=s,this.file_id=a,this.name=r,this.size=o,this.inline=n}}class DownloadManyDocumentsFilesAsArchive extends Command{constructor(t,s,a,r){super(),this.folder_id=t,this.usergroup_id=s,this.document_ids=a,this.size=r}}class DownloadDocumentFilesAsArchive extends Command{constructor(t,s,a,r){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a,this.size=r}}class GetFileInfo extends Command{constructor(t){super(),this.file_id=t}}class DeleteFileFromFolder extends Command{constructor(t,s,a){super(),this.folder_id=t,this.usergroup_id=s,this.file_id=a}}class UpdateFileFromFolder extends Command{constructor(t,s,a,r){super(),this.folder_id=t,this.usergroup_id=s,this.file_id=a,this.name=r}}class GetRoles extends Command{}class AddRole extends Command{constructor(t){super(),this.name=t}}class DeleteRole extends Command{constructor(t){super(),this.name=t}}class GetUserFolderSettings extends Command{}class AddUserFolderSettings extends Command{constructor(t,s,a,r,o){super(),this.folder_id=t,this.usergroup_slug=s,this.username=a,this.role=r,this.search_schema=o}}class UpdateUserFolderSettings extends Command{constructor(t,s,a,r,o,n){super(),this.id=t,this.folder_id=s,this.usergroup_slug=a,this.username=r,this.role=o,this.search_schema=n}}class DeleteUserFolderSettings extends Command{constructor(t){super(),this.id=t}}class AddPermission extends Command{constructor(t,s){super(),this.role=t,this.perm=s}}class DeletePermission extends Command{constructor(t,s){super(),this.role=t,this.perm=s}}class GetUserPermissions extends Command{}class GetUserPermissionsForFolder extends Command{constructor(t,s){super(),this.folder_id=t,this.usergroup_id=s}}class GetUserSearchSchema extends Command{constructor(t,s){super(),this.folder_id=t,this.usergroup_id=s}}class SetUserSearchSchema extends Command{constructor(t,s,a){super(),this.folder_id=t,this.usergroup_id=s,this.search_schema=a}}class DeleteUserSearchSchema extends Command{constructor(t,s){super(),this.folder_id=t,this.usergroup_id=s}}class SetDocumentAttribute extends Command{constructor(t,s,a,r,o,n){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a,this.name=r,this.value=o,this.to_be_decoded=n}}class SaveDocumentsInFolder extends Command{constructor(t,s){super(),this.folder_id=t,this.usergroup_id=s}}class SaveManyDocuments extends Command{constructor(t,s,a){super(),this.folder_id=t,this.usergroup_id=s,this.docs=a}}class MarkDocumentAsDeleted extends Command{constructor(t,s){super(),this.folder_id=t,this.document_id=s}}class MarkDocumentAsNotDeleted extends Command{constructor(t,s){super(),this.folder_id=t,this.document_id=s}}class DeleteManyDocuments extends Command{constructor(t,s,a){super(),this.folder_id=t,this.usergroup_id=s,this.document_ids=a}}class AttachFileToDocument extends Command{constructor(t,s,a,r){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a,this.file_id=r}}class DetachFileFromDocument extends Command{constructor(t,s,a,r){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a,this.file_id=r}}class FlushFileContainer extends Command{constructor(t,s){super(),this.folder_id=t,this.usergroup_id=s}}class AddDocument extends Command{constructor(t,s,a,r,o,n,i,_,l){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a,this.union_id=r,this.attributes=o,this.files=n,this.mark_as_modified=i,this.is_created_first_time=_,this.is_blocked=l}}class AddDocumentModel extends Command{constructor(t,s,a,r){super(),this.folder_id=t,this.usergroup_id=s,this.doc=a,this.mark_as_modified=r}}class DuplicateDocumentToUsergroup extends Command{constructor(t,s,a,r){super(),this.folder_id=t,this.source_usergroup_id=s,this.target_usergroup_id=a,this.document_id=r}}class DuplicateManyDocumentsToUsergroup extends Command{constructor(t,s,a,r){super(),this.folder_id=t,this.source_usergroup_id=s,this.target_usergroup_id=a,this.document_ids=r}}class ValidateDocument extends Command{constructor(t,s,a){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a}}class ValidateDocumentAgainstConstraint extends Command{constructor(t,s,a,r,o){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a,this.parameters=r,this.error_message=o}}class ValidateDocumentAgainstAttributeRegexValidationConstraint extends ValidateDocumentAgainstConstraint{}class ValidateDocumentAgainstAttributeTogetherRegexValidationConstraint extends ValidateDocumentAgainstConstraint{}class ValidateDocumentAgainstUniqueTogetherConstraint extends ValidateDocumentAgainstConstraint{}class ValidateDocumentAgainstAttributeHasPreviousValueConstraint extends ValidateDocumentAgainstConstraint{}class ValidateDocumentAgainstHasFileConstraint extends ValidateDocumentAgainstConstraint{}class ValidateDocumentAgainstHasApprovalConstraint extends ValidateDocumentAgainstConstraint{}class ValidateDocumentAgainstSingleUnionConstraint extends ValidateDocumentAgainstConstraint{}class ValidateDocumentAgainstFilenamePatternConstraint extends ValidateDocumentAgainstConstraint{}class AttachFilesToDocumentUsingPattern extends Command{constructor(t,s,a){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a}}class AllocateFilesToDocumentsUsingPattern extends Command{constructor(t,s){super(),this.folder_id=t,this.usergroup_id=s}}class GetSpareFiles extends Command{constructor(t,s){super(),this.folder_id=t,this.usergroup_id=s}}class UpdateUploadProgress extends Command{constructor(t){super(),this.file_ids=t}}class DownloadExcelFile extends Command{constructor(t,s){super(),this.filename=t,this.aoa=s}}class DownloadJsonFile extends Command{constructor(t,s){super(),this.filename=t,this.data=s}}class GetPdfMergeFiles extends Command{}class UploadPdfMergeFile extends Command{constructor(t,s,a){super(),this.id=t,this.order=s,this.file=a}}class PushDocumentButton extends Command{constructor(t,s,a,r){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a,this.action=r}}class PerformActionOnDocuments extends Command{constructor(t,s,a=null,r=null,o=[]){super(),this.handler=t,this.username=s,this.folder_id=a,this.usergroup_id=r,this.document_ids=o}}class UpdatePdfMergeFile extends Command{constructor(t,s,a,r,o){super(),this.id=t,this.order=s,this.page_from=a,this.page_to=r,this.angle=o}}class DeletePdfMergeFile extends Command{constructor(t){super(),this.id=t}}class DeleteAllPdfMergeFiles extends Command{}class DownloadPdfMergeResult extends Command{constructor(t,s){super(),this.keep_bookmarks=t,this.add_filenames_as_bookmarks=s}}class DownloadPdfMixResult extends Command{}class GetShareFiles extends Command{}class UploadShareFile extends Command{constructor(t,s){super(),this.id=t,this.file=s}}class DeleteShareFile extends Command{constructor(t){super(),this.id=t}}class DownloadShareFile extends Command{constructor(t,s,a,r){super(),this.id=t,this.name=s,this.size=a,this.inline=r}}class GetUserGroups extends Command{}class AddUserGroup extends Command{constructor(t,s,a){super(),this.name=t,this.slug=s,this.is_private=a}}class UpdateUserGroup extends Command{constructor(t,s,a,r){super(),this.id=t,this.name=s,this.slug=a,this.is_private=r}}class DeleteUserGroup extends Command{constructor(t){super(),this.id=t}}class AddUserToUserGroup extends Command{constructor(t,s){super(),this.id=t,this.username=s}}class DeleteUserFromUserGroup extends Command{constructor(t,s){super(),this.id=t,this.username=s}}class SetCurrentUserGroup extends Command{constructor(t){super(),this.usergroup=t}}class GetFlows extends Command{constructor(t){super(),this.query=t}}class AddFlow extends Command{constructor(t,s,a,r,o,n){super(),this.name=t,this.trigger=s,this.is_active=a,this.is_multiple=r,this.message_if_fail=o,this.process=n}}class UpdateFlow extends Command{constructor(t,s,a,r,o,n,i){super(),this.id=t,this.name=s,this.trigger=a,this.is_active=r,this.is_multiple=o,this.message_if_fail=n,this.process=i}}class DeleteFlow extends Command{constructor(t){super(),this.id=t}}class GetFlowItem extends Command{constructor(t){super(),this.id=t}}class GetManyFlowItems extends Command{constructor(t){super(),this.query=t}}class RestartFlowItem extends Command{constructor(t){super(),this.id=t}}class GetFlowItemSteps extends Command{constructor(t){super(),this.flowitem_id=t}}class DropSelfTestingQuestions extends Command{}class AddSelfTestingQuestion extends Command{constructor(t,s,a){super(),this.id=t,this.question=s,this.answers=a}}class GetManyDocumentsApprovals extends Command{constructor(t,s,a,r,o){super(),this.query=t,this.offset=s,this.limit=a,this.sort_by=r,this.sort_asc=o}}class GetDocumentApprovals extends Command{constructor(t,s,a){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a}}class AddDocumentApproval extends Command{constructor(t,s,a,r){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a,this.username=r}}class UpdateDocumentApproval extends Command{constructor(t,s,a,r,o,n){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a,this.approval_id=r,this.state=o,this.comments=n}}class DeleteDocumentApproval extends Command{constructor(t,s,a,r){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a,this.approval_id=r}}class DelegateDocumentApproval extends Command{constructor(t,s,a,r,o,n){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a,this.approval_id=r,this.username=o,this.with_return=n}}class GetDocumentApprovalSpareFiles extends Command{constructor(t,s,a){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a}}class UploadDocumentApprovalFile extends Command{constructor(t,s,a,r,o){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a,this.file_id=r,this.file=o}}class DeleteDocumentApprovalFile extends Command{constructor(t,s,a,r){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a,this.file_id=r}}class EmptyCart extends Command{}class GetCart extends Command{}class AddDocumentToCart extends Command{constructor(t,s,a){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a}}class AddManyDocumentsToCart extends Command{constructor(t,s,a){super(),this.folder_id=t,this.usergroup_id=s,this.document_ids=a}}class RemoveDocumentFromCart extends Command{constructor(t,s,a){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a}}class CreateDocumentApprovalFlow extends Command{constructor(t){super(),this.document_id=t}}class AddDocumentApprovalFlowStep extends Command{constructor(t){super(),this.document_id=t}}class DeleteDocumentApprovalFlowStep extends Command{constructor(t,s){super(),this.document_id=t,this.index=s}}class AttachUserToDocumentApprovalFlowStep extends Command{constructor(t,s,a){super(),this.document_id=t,this.index=s,this.username=a}}class DeleteUserFromDocumentApprovalFlowStep extends AttachUserToDocumentApprovalFlowStep{}class AbstractDocumentApprovalFlowCommand extends Command{constructor(t,s,a){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a}}class GetDocumentApprovalFlow extends AbstractDocumentApprovalFlowCommand{}class StartDocumentApprovalFlow extends AbstractDocumentApprovalFlowCommand{}class StopDocumentApprovalFlow extends AbstractDocumentApprovalFlowCommand{}class SetDocumentApprovalFlow extends AbstractDocumentApprovalFlowCommand{}class GetServerSettings extends Command{}class UpdateServerSetting extends Command{constructor(t,s){super(),this.id=t,this.value=s}}class GetMailBoxes extends Command{}class AddMailBox extends Command{constructor(t,s,a,r,o,n,i,_,l,d,p){super(),this.out_protocol=t,this.out_encryption=s,this.out_port=a,this.out_server=r,this.in_protocol=o,this.in_encryption=n,this.in_port=i,this.in_server=_,this.username=l,this.password=d,this.name=p}}class UpdateMailBox extends Command{constructor(t,s,a,r,o,n,i,_,l,d,p,c){super(),this.id=t,this.out_protocol=s,this.out_encryption=a,this.out_port=r,this.out_server=o,this.in_protocol=n,this.in_encryption=i,this.in_port=_,this.in_server=l,this.username=d,this.password=p,this.name=c}}class DeleteMailBox extends Command{constructor(t){super(),this.id=t}}class GetMailChannels extends Command{}class AddMailChannel extends Command{constructor(t,s,a,r,o){super(),this.name=t,this.folder=s,this.storage_path=a,this.settings=r,this.is_active=o}}class UpdateMailChannel extends Command{constructor(t,s,a,r,o,n){super(),this.id=t,this.name=s,this.folder=a,this.storage_path=r,this.settings=o,this.is_active=n}}class DeleteMailChannel extends Command{constructor(t){super(),this.id=t}}class AddMailChannelToMailBox extends Command{constructor(t,s){super(),this.mailbox_id=t,this.mailchannel_id=s}}class DeleteMailChannelFromMailBox extends Command{constructor(t,s){super(),this.mailbox_id=t,this.mailchannel_id=s}}class FetchMailChannel extends Command{constructor(t){super(),this.id=t}}class GetMailMessages extends Command{constructor(t){super(),this.query=t}}class DeleteMailMessage extends Command{constructor(t){super(),this.id=t}}class AbstractDownloadMailMessage extends Command{constructor(t,s){super(),this.id=t,this.format=s}}class DownloadMailMessageInTextFormat extends AbstractDownloadMailMessage{constructor(t){super(t,"text")}}class DownloadMailMessageInHtmlFormat extends AbstractDownloadMailMessage{constructor(t){super(t,"html")}}class DownloadMailMessageInRawFormat extends AbstractDownloadMailMessage{constructor(t){super(t,"raw")}}class DownloadMailMessageAttachment extends Command{constructor(t,s,a,r,o){super(),this.message_id=t,this.id=s,this.name=a,this.size=r,this.inline=o}}class GetDocumentAttributesContext extends Command{constructor(t,s,a,r,o){super(),this.ctx_id=t,this.ctx_name=s,this.folder_id=a,this.document_id=r,this.is_raw_attribute=o}}class GetDocumentPreviousAttributeContext extends Command{constructor(t,s,a,r,o,n,i,_){super(),this.ctx_id=t,this.ctx_name=s,this.folder_id=a,this.usergroup_id=r,this.document_id=o,this.attribute_name=n,this.is_raw_attribute=i,this.count=_}}class GetUserEmailContext extends Command{constructor(t,s){super(),this.ctx_id=t,this.ctx_name=s}}class GetCounters extends Command{}class AddCounter extends Command{constructor(t,s,a,r){super(),this.name=t,this.description=s,this.value=a,this.increment=r}}class UpdateCounter extends Command{constructor(t,s,a,r,o){super(),this.id=t,this.name=s,this.description=a,this.value=r,this.increment=o}}class DeleteCounter extends Command{constructor(t){super(),this.id=t}}a(1703);class Event{}class ApiError extends Event{constructor(t){super(),this.code=t}}class AccessPagePermissionCheckFail extends Event{}class UserLoginSuccess extends Event{}class UserLogoutSuccess extends Event{}class UsersUpdateSuccess extends Event{}class UsersDeleteSuccess extends Event{}class UserReplacementAddSuccess extends Event{}class UserReplacementDeleteSuccess extends Event{}class OnBehalfUserChangeSuccess extends Event{}class OnBehalfUserDeleteSuccess extends Event{}class FoldersAddSuccess extends Event{}class FoldersUpdateSuccess extends Event{}class FoldersDeleteSuccess extends Event{}class UploadFileError extends Event{constructor(t){super(),this.filename=t}}class UploadEmptyFileError extends UploadFileError{}class UploadFileTooBigError extends UploadFileError{}class UploadFileWrongExtensionError extends UploadFileError{}class UploadFileWrongFilenameError extends UploadFileError{}class UploadFileSuccess extends Event{}class SaveManyDocumentsSuccess extends Event{}class DeleteManyDocumentsSuccess extends Event{}class DocumentAttributesChanged extends Event{constructor(t,s,a){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a}}class DuplicateDocumentToUsergroupSuccess extends Event{}class DuplicateManyDocumentsToUsergroupSuccess extends Event{}class DocumentFilesAreUploading extends Event{}class FileUpdatedSuccess extends Event{}class FileDeletedSuccess extends Event{}class FileAttachedToDocument extends Event{constructor(t,s,a,r){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a,this.file_id=r}}class FileDetachedFromDocument extends Event{constructor(t,s,a,r){super(),this.folder_id=t,this.usergroup_id=s,this.document_id=a,this.file_id=r}}class DocumentButtonPushed extends Event{}class FilesAllocated extends Event{}class AddRoleSuccess extends Event{}class DeleteRoleSuccess extends Event{}class AddUserFolderSettingsSuccess extends Event{}class UpdateUserFolderSettingsSuccess extends Event{}class DeleteUserFolderSettingsSuccess extends Event{}class SetUserSearchSchemaSuccess extends Event{}class AddPermissionSuccess extends Event{}class DeletePermissionSuccess extends Event{}class DocumentLinkCopied extends Event{}class FileLinkCopied extends Event{}class AddUserGroupSuccess extends Event{}class UpdateUserGroupSuccess extends Event{}class DeleteUserGroupSuccess extends Event{}class DocumentAddedToCartSuccess extends Event{}class DocumentRemovedFromCartSuccess extends Event{}class ManyDocumentsAddedToCartSuccess extends Event{}class AddFlowSuccess extends Event{}class UpdateFlowSuccess extends Event{}class DeleteFlowSuccess extends Event{}class RestartFlowItemSuccess extends Event{}class SelfTestingRepliedSuccess extends Event{}class SelfTestingRepliedFail extends Event{}class DocumentApprovalAddedSuccess extends Event{}class DocumentApprovalUpdatedSuccess extends Event{}class DocumentApprovalDeletedSuccess extends Event{}class DocumentApprovalDelegatedSuccess extends Event{}class EmptyApprovalFlowSaved extends Event{}class ApprovalFlowStarted extends Event{}class ApprovalFlowStopped extends Event{}class ApprovalFlowUploadError extends Event{}class ServerSettingUpdatedSuccess extends Event{}class MailBoxAddedSuccess extends Event{}class MailBoxUpdatedSuccess extends Event{}class MailBoxDeletedSuccess extends Event{}class MailChannelAddedSuccess extends Event{}class MailChannelUpdatedSuccess extends Event{}class MailChannelDeletedSuccess extends Event{}class MailChannelFetchedSuccess extends Event{}class MailMessageDeletedSuccess extends Event{}class CounterAddedSuccess extends Event{}class CounterUpdatedSuccess extends Event{}class CounterDeletedSuccess extends Event{}var R=a(2482),F=a(1581),D=a.n(F),x=a(3351),k=a.n(x);class NotImplementedError extends Error{}class DataClass{constructor(t){this._data=void 0,void 0!==t&&this._validate_using_schema(t,this.schema)}get data(){if(void 0===this._data)throw new NotImplementedError("DataClass.data has not been assigned");return this._data}get schema(){throw new NotImplementedError("Json schema is not defined")}_validate_using_schema(t,s){this.ajv=new(D())({allErrors:!0,allowUnionTypes:!0}),k()(this.ajv);const a=this.ajv.compile(s);if(a(t),null!==a.errors)throw a.errors.forEach((t=>console.log(t))),new NotImplementedError("Object "+t.constructor.name+" does not correspond to json schema");this._data=t}}const q={type:"object",properties:{approval_actions_count:{type:"integer"},approval_orders_count:{type:"integer"}},required:["approval_actions_count","approval_orders_count"],additionalProperties:!1},S={type:"object",properties:{auth_token:{type:"string"},first_name:{type:"string"},last_name:{type:"string"},patronomic:{type:"string"},position:{type:"string"},department:{type:"string"},username:{type:"string"},email:{type:["null","string"]},role:{type:"string"},role_inside_group:{type:"string"},role_outside_group:{type:"string"},is_active:{type:"boolean"},access_group_regex:{type:"string"},on_behalf:{type:["null","string"]}},required:["first_name","last_name","patronomic","position","department","username","email","role","role_inside_group","role_outside_group","is_active","access_group_regex","on_behalf"],additionalProperties:!1},E={type:"array",items:S},A={type:"object",properties:{name:{enum:["attribute_regex_validation"]},error_message:{type:"string"},parameters:{type:"object",properties:{field:{type:"string"},pattern:{type:"string"},case_insensitive:{type:"boolean"}},required:["field","pattern"],additionalProperties:!1}},required:["name","error_message","parameters"],additionalProperties:!1},C={type:"object",properties:{name:{enum:["attribute_together_regex_validation"]},error_message:{type:"string"},parameters:{type:"object",properties:{subject_field:{type:"string"},subject_pattern:{type:"string"},object_field:{type:"string"},object_pattern:{type:"string"},case_insensitive:{type:"boolean"}},required:["subject_field","subject_pattern","object_field","object_pattern"],additionalProperties:!1}},required:["name","error_message","parameters"],additionalProperties:!1},U={type:"object",properties:{name:{enum:["unique_together"]},error_message:{type:"string"},parameters:{type:"object",properties:{fields:{type:"array",items:{type:"string"}}},required:["fields"],additionalProperties:!1}},required:["name","error_message","parameters"],additionalProperties:!1},P={type:"object",properties:{name:{enum:["attribute_has_previous_value"]},error_message:{type:"string"},parameters:{type:"object",properties:{fields:{type:"array",items:{type:"string"}},field_to_be_checked:{type:"string"},allowed_values:{type:"array",items:{type:"string"}}},required:["fields","field_to_be_checked","allowed_values"],additionalProperties:!1}},required:["name","error_message","parameters"],additionalProperties:!1},j={type:"object",properties:{name:{enum:["has_file"]},error_message:{type:"string"},parameters:{type:"object",properties:{pattern:{type:"string"},case_insensitive:{type:"boolean"},min_count:{type:"integer"},max_count:{type:"integer"}},required:["pattern"],additionalProperties:!1}},required:["name","error_message","parameters"],additionalProperties:!1},M={type:"object",properties:{name:{enum:["has_approval"]},error_message:{type:"string"},parameters:{type:"object",properties:{usernames:{type:"array",items:{type:"string"}}},required:["usernames"],additionalProperties:!1}},required:["name","error_message","parameters"],additionalProperties:!1},T={type:"object",properties:{name:{enum:["single_union"]},error_message:{type:"string"},parameters:{type:"object",properties:{fields:{type:"array",items:{type:"string"}}},required:["fields"],additionalProperties:!1}},required:["name","error_message","parameters"],additionalProperties:!1},N={type:"object",properties:{name:{enum:["filename_match_pattern"]},error_message:{type:"string"},parameters:{type:"object",properties:{min_count:{type:"integer"}},additionalProperties:!1}},required:["name","error_message","parameters"],additionalProperties:!1},I={type:"object",properties:{name:{type:"string"},type:{const:"DOCUMENT_ATTRIBUTES"},parameters:{type:"object",properties:{is_raw_attribute:{type:"boolean"}},required:["is_raw_attribute"],additionalProperties:!1}},required:["name","type","parameters"],additionalProperties:!1},B={type:"object",properties:{name:{type:"string"},type:{const:"PREVIOUS_DOCUMENTS_ATTRIBUTE"},parameters:{type:"object",properties:{attribute_name:{type:"string"},is_raw_attribute:{type:"boolean"},count:{type:"integer"}},required:["attribute_name","is_raw_attribute","count"],additionalProperties:!1}},required:["name","type","parameters"],additionalProperties:!1},O={type:"object",properties:{name:{type:"string"},type:{const:"USERS_EMAILS"}},required:["name","type"],additionalProperties:!1},z={const:"FormDateInput"},W={type:"object",properties:{is_disabled:{type:"boolean"},default:{type:"integer",minimum:0}},additionalProperties:!1},G={oneOf:[{type:"object",properties:{type:z,parameters:W,value:{type:"integer",minimum:0}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:z,parameters:W,bind:{type:"string"}},required:["type","bind"],additionalProperties:!1}]},Z={const:"FormEmailToAddressField"},H={oneOf:[{type:"object",properties:{type:Z,value:{type:"object",properties:{TO:{type:"string"},CC:{type:"string"},BCC:{type:"string"}},required:["TO","CC","BCC"],additionalProperties:!1}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:Z,bind:{type:"string"}},required:["type","bind"],additionalProperties:!1}]},$={const:"FormEmailToAddressInput"},L={type:"object",properties:{ADDRESS:{type:"string"},KNOWN_EMAILS:{type:"string"}},additionalProperties:!1},V={type:"object",properties:{default:{type:"object",properties:{TO:{type:"string"},CC:{type:"string"},BCC:{type:"string"}},required:["TO","CC","BCC"],additionalProperties:!1}},additionalProperties:!1},J={oneOf:[{type:"object",properties:{type:$,parameters:V,value:{type:"object",properties:{TO:{type:"string"},CC:{type:"string"},BCC:{type:"string"}},required:["TO","CC","BCC"],additionalProperties:!1},bind_context:L},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:$,parameters:V,bind:{type:"string"},bind_context:L},required:["type","bind"],additionalProperties:!1}]},Y={const:"FormHtmlField"},K={type:"object",properties:{height:{type:"integer"}},additionalProperties:!1},X={oneOf:[{type:"object",properties:{type:Y,parameters:K,value:{type:"string"}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:Y,parameters:K,bind:{type:"string"}},required:["type","bind"],additionalProperties:!1}]},Q={const:"FormHtmlInput"},ee={type:"object",properties:{height:{type:"integer"},default:{type:"string"}},additionalProperties:!1},te={oneOf:[{type:"object",properties:{type:Q,parameters:ee,value:{type:"string"}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:Q,parameters:ee,bind:{type:"string"}},required:["type","bind"],additionalProperties:!1}]},se={const:"FormTextField"},ae={type:"object",properties:{align:{type:"string"},font_weight:{type:"string"}},additionalProperties:!1},re={oneOf:[{type:"object",properties:{type:se,parameters:ae,value:{type:"string"}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:se,parameters:ae,bind:{type:"string"}},required:["type","bind"],additionalProperties:!1}]},oe={const:"FormTextInput"},ne={type:"object",properties:{placeholder:{type:"string"},secure:{type:"boolean"},is_disabled:{type:"boolean"},color:{type:"string"},default:{type:"string"}},additionalProperties:!1},ie={oneOf:[{type:"object",properties:{type:oe,parameters:ne,value:{type:"string"}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:oe,parameters:ne,bind:{type:"string"}},required:["type","bind"],additionalProperties:!1}]},_e={type:"object",properties:{ATTRIBUTES:{type:"string"}},additionalProperties:!1},le={oneOf:[{type:"object",properties:{type:{const:"FormHiddenInput"},parameters:{type:"object",properties:{default:{},pattern:{type:"string"}},required:["default"],additionalProperties:!1},bind:{type:"string"},bind_context:_e},required:["type","bind"],additionalProperties:!1}]},de={const:"FormSelectInput"},pe={type:"object",properties:{size:{type:"integer",minimum:1},is_disabled:{type:"boolean"},default:{type:"string"},options:{type:"array",items:{type:"object",properties:{name:{type:"string"},value:{type:"string"}},required:["name","value"],additionalProperties:!1}}},required:["options"],additionalProperties:!1},ce={oneOf:[{type:"object",properties:{type:de,parameters:pe,value:{type:"string"}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:de,parameters:pe,bind:{type:"string"}},required:["type","bind"],additionalProperties:!1}]},ue={const:"FormFilteredSelectInput"},me={type:"object",properties:{size:{type:"integer",minimum:1},is_disabled:{type:"boolean"},placeholder:{type:"string"},default:{type:"string"},options:{type:"array",items:{type:"object",properties:{name:{type:"string"},value:{type:"string"}},required:["name","value"],additionalProperties:!1}}},required:["options"],additionalProperties:!1},ge={oneOf:[{type:"object",properties:{type:ue,parameters:me,value:{type:"string"}},required:["type","value"],additionalProperties:!1},{type:"object",properties:{type:ue,parameters:me,bind:{type:"string"}},required:["type","bind"],additionalProperties:!1}]},he={type:"array",items:{oneOf:[G,H,J,X,te,re,ie,le,ce,ge]}},fe={type:"object",properties:{version:{type:"string"},validation_constraints:{type:"array",items:{oneOf:[A,C,U,P,j,M,T,N]}},search_schema:{type:"array",items:{type:"object",properties:{name:{type:"string"},description:{type:"string"},size:{enum:["w50","w100","w150","w200","w250","w300","w350","w400"]},grow:{type:"boolean"},align:{enum:["left","center","right"]},default:{type:["string","integer"]},is_disabled:{type:"boolean"},sort_rule:{enum:["DEFAULT","INTEGER","STRING","CHANGE_ORDER_NUMBER"]},fields:{type:"array",items:{type:"object",properties:{placeholder:{type:"string"},rule:{enum:["exact","iexact","contains","icontains","gt","gte","lt","lte"]},re:{type:"string"},converter:{type:"string"}},required:["placeholder","rule"],additionalProperties:!1}}},required:["name","fields","description"],additionalProperties:!1}},form_schema:{type:"object",properties:{context:{type:"array",items:{oneOf:[I,B,O]}},pages:{type:"array",items:{type:"object",properties:{size:{type:"integer"},name:{type:"string"},fields:{type:"object",properties:{read_mode:he,edit_mode:he},additionalProperties:!1}},required:["fields"],additionalProperties:!1}}},required:["pages"],additionalProperties:!1},max_file_size:{type:"integer"},filename_pattern:{type:"string"},description_pattern:{type:"string"},is_empty_search_allowed:{type:"boolean"},sort_by:{type:"object",properties:{name:{type:"string"},asc:{type:"boolean"}},required:["name","asc"],additionalProperties:!1},group_by:{type:"object",properties:{button_active_name:{type:"string"},button_passive_name:{type:"string"},fields:{type:"array",items:{type:"string"}},order_by:{type:"string"},aggregate_function:{enum:["MAX"]},is_active:{type:"boolean"}},required:["button_active_name","button_passive_name","fields","order_by","aggregate_function"],additionalProperties:!1},is_list_container_required:{type:"boolean"},is_doc_container_required:{type:"boolean"},doc_container_parsers:{type:"array",items:{enum:["1868_amm_transmittal","1882_dlenc_transmittal"]}},action_buttons:{type:"array",items:{type:"object",required:["caption","action"],additionalProperties:!1,properties:{caption:{type:"string"},action:{type:"string"},type:{enum:["primary","secondary","success","warning","danger"]},allowed_usernames:{type:"array",items:{type:"string"}},required_approvals:{type:"object",additionalProperties:!1,properties:{all:{type:"array",items:{type:"string"}},anyOf:{type:"array",items:{type:"string"}}}}}}},search_action_buttons:{type:"array",items:{type:"object",required:["caption","handler"],additionalProperties:!1,properties:{caption:{type:"string"},handler:{enum:["1882_dlenc_transmittal"]},allowed_usernames:{type:"array",items:{type:"string"}}}}},approval_rules:{type:"object",additionalProperties:!1,properties:{filename:{type:"object",properties:{pattern:{type:"string"},case_insensitive:{type:"boolean"}},required:["pattern"],additionalProperties:!1},can_approve:{type:"array",items:{type:"string"}},can_reject:{type:"array",items:{type:"string"}},can_delegate_with_return:{type:"array",items:{type:"string"}},can_delegate_without_return:{type:"array",items:{type:"string"}}}},mode:{enum:["view","edit"]},strict_validation:{type:"array",items:{type:"string"}}},required:["validation_constraints","search_schema","max_file_size","filename_pattern","description_pattern"],additionalProperties:!1},ve={type:"object",properties:{id:{type:"number"},name:{type:"string"},storage_path:{type:"string"},master_usergroup_slug:{type:"string"},access_group:{type:"string"},settings:fe},required:["id","name","storage_path","master_usergroup_slug","access_group","settings"],additionalProperties:!1},we={type:"array",items:ve},ye={type:"object",properties:{name:{type:"string",enum:["can_get_folders","can_view_settings","can_view_folder","can_add_folder","can_change_folder","can_delete_folder","can_view_user","can_change_user","can_delete_user","can_view_role","can_view_permission","can_change_permission","can_add_role","can_change_role","can_delete_role","can_view_document","can_add_document","can_change_document","can_delete_document","can_view_file","can_add_file","can_change_file","can_delete_file","can_view_userfoldersetting","can_add_userfoldersetting","can_change_userfoldersetting","can_delete_userfoldersetting","can_view_usergroup","can_add_usergroup","can_change_usergroup","can_delete_usergroup","can_view_service","can_view_flow","can_add_flow","can_change_flow","can_delete_flow","can_view_flowitem","can_add_flowitem","can_change_flowitem","can_delete_flowitem","can_view_flowitemstep","can_view_documentapproval","can_add_documentapproval","can_change_documentapproval","can_delete_documentapproval","can_delegate_documentapproval","can_search_documentapproval","can_empty_cart","can_view_cart","can_add_to_cart","can_remove_from_cart","can_view_userreplacement","can_add_userreplacement","can_delete_userreplacement","can_view_onbehalfuser","can_change_onbehalfuser","can_delete_onbehalfuser","can_view_documentapprovalflow","can_change_documentapprovalflow","can_delete_documentapprovalflow","can_view_serversetting","can_change_serversetting","can_view_mailbox","can_add_mailbox","can_change_mailbox","can_delete_mailbox","can_view_mailchannel","can_add_mailchannel","can_change_mailchannel","can_delete_mailchannel","can_fetch_mailchannel","can_view_mail","can_delete_mail","can_view_counter","can_add_counter","can_change_counter","can_delete_counter","can_fetch_counter","can_view_xmldocument","can_add_xmldocument","can_change_xmldocument","can_delete_xmldocument","can_view_alluserreplacement","can_add_alluserreplacement","can_delete_alluserreplacement","can_view_transmittal"]},is_for_folder:{type:"boolean"}},required:["name","is_for_folder"]},be={type:"array",items:ye},Re={type:"object",properties:{id:{type:"number"},name:{type:"string"},permissions:{type:"array",items:ye}},required:["id","name","permissions"]},Fe={type:"array",items:Re},De={type:["array","null"]},xe={type:"object",properties:{id:{type:"integer"},user:{type:"string"},folder:{type:"integer"},usergroup:{type:"string"},role:{type:["string","null"]},search_schema:De},required:["id","user","folder","usergroup","role","search_schema"],additionalProperties:!1},ke={type:"array",items:xe},qe={type:"object",properties:{id:{type:"string"},name:{type:"string"},size:{type:"number"}},required:["id","name","size"],additionalProperties:!1},Se={type:"array",items:qe},Ee={type:"object",properties:{id:{type:"string"},union:{type:["null","string"]},folder_id:{type:"integer"},usergroup_id:{type:"integer"},user_id:{type:["null","integer"]},data:{type:"object",patternProperties:{"^[a-zA-Z0-9_]+$":{type:["string","number","boolean","object","array"]}}},description:{type:"string"},files:Se,is_blocked:{type:"boolean"},created_at:{type:"string"},updated_at:{type:"string"}},required:["id","union","folder_id","usergroup_id","user_id","data","description","files","is_blocked","created_at","updated_at"],additionalProperties:!1},Ae={type:"array",items:Ee},Ce={type:"object",properties:{id:{type:"integer"},user:S,created_by:S,delegated_from:{type:["null","integer"]},state:{enum:["APPROVED","REJECTED","DELEGATED","NONE"]},created_at:{type:"string"},updated_at:{type:"string"},files:{type:"array",items:qe},document:Ee,active_approvals_count_of_document:{type:"integer"}},required:["id","user","state","created_at","updated_at","files"],additionalProperties:!1},Ue={type:"array",items:Ce},Pe={type:"object",required:["approvals","count"],additionalProperties:!1,properties:{approvals:Ue,count:{type:"integer"}}},je={oneOf:[{type:"null"},{type:"object",properties:{id:{type:"integer"},created_by:S,started_by:S,finished_by:S,is_active:{type:"boolean"},success:{type:"boolean"},steps:{type:"array",items:{type:"array",items:{type:"string"}}},created_at:{type:"string"},updated_at:{type:"string"}},required:["id","created_by","started_by","finished_by","is_active","success","steps","created_at","updated_at"],additionalProperties:!1}]},Me={type:"object",properties:{id:{type:"string"},order:{type:"integer"},page_count:{type:"integer"},page_from:{type:"integer"},page_to:{type:"integer"},angle:{type:"integer"},file:qe},required:["id","order","page_count","page_from","page_to","angle","file"],additionalProperties:!1},Te={type:"array",items:Me},Ne={type:"object",properties:{id:{type:"integer"},name:{type:"string"},slug:{type:"string"},is_private:{type:"boolean"},users:{type:"array",items:S}},required:["id","name","slug","is_private","users"],additionalProperties:!1},Ie={type:"array",items:Ne},Be={type:"object",required:["name","success","result_key"],additionalProperties:!1,properties:{name:{type:"string"},success:{type:"boolean"},result_key:{type:"string"}}},Oe={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"DIVISION_BY_ZERO"},input:{const:{}}}},ze={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"IF"},input:{type:"object",required:["condition"],additionalProperties:!1,properties:{condition:{type:"string"}}}}},We={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"CREATE_VARIABLE"},input:{type:"object"}}},Ge={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"SEND_EMAIL"},input:{type:"object",required:["address_to","subject","combination_pattern","body"],additionalProperties:!1,properties:{address_to:{type:"string"},subject:{type:"string"},combination_pattern:{type:"string"},body:{type:"string"},html_body:{type:"string"}}}}},Ze={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"SEND_EMAIL_USER_CREATED"},input:{type:"object",required:["address_to","username"],additionalProperties:!1,properties:{address_to:{type:"string"},username:{type:"string"}}}}},He={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"SEND_EMAIL_DOCUMENT_CREATED_OR_UPDATED"},input:{type:"object",required:["address_to","subject","combination_pattern","doc_id"],additionalProperties:!1,properties:{address_to:{type:"string"},subject:{type:"string"},combination_pattern:{type:"string"},doc_id:{type:"string"}}}}},$e={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"SEND_EMAIL_DOCUMENT_APPROVAL_CREATED"},input:{type:"object",required:["address_to","approval_id"],additionalProperties:!1,properties:{address_to:{type:"string"},approval_id:{type:["integer","string"]}}}}},Le={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"SEND_EMAIL_DOCUMENT_APPROVAL_UPDATED"},input:{type:"object",required:["address_to","approval_id"],additionalProperties:!1,properties:{address_to:{type:"string"},approval_id:{type:["integer","string"]}}}}},Ve={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"SEND_EMAIL_DOCUMENT_APPROVAL_DELETED"},input:{type:"object",required:["address_to","approval_id"],additionalProperties:!1,properties:{address_to:{type:"string"},approval_id:{type:["integer","string"]}}}}},Je={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"SEND_EMAIL_DOCUMENT_APPROVAL_FLOW_STARTED"},input:{type:"object",required:["address_to","approval_flow_id"],additionalProperties:!1,properties:{address_to:{type:"string"},approval_flow_id:{type:["integer","string"]}}}}},Ye={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"SEND_EMAIL_DOCUMENT_APPROVAL_FLOW_STOPPED"},input:{type:"object",required:["address_to","approval_flow_id"],additionalProperties:!1,properties:{address_to:{type:"string"},approval_flow_id:{type:["integer","string"]}}}}},Ke={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"SEND_EMAIL_DOCUMENT_APPROVAL_FLOW_EXECUTED"},input:{type:"object",required:["address_to","approval_flow_id"],additionalProperties:!1,properties:{address_to:{type:"string"},approval_flow_id:{type:["integer","string"]}}}}},Xe={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"SEND_EMAIL_DOCUMENT_CREATED_FROM_MAIL_MESSAGE"},input:{type:"object",required:["address_to","success","doc_id"],additionalProperties:!1,properties:{address_to:{type:"string"},success:{type:["boolean","string"]},doc_id:{type:"string"}}}}},Qe={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"DISPATCH_EMAILS"},input:{const:{}}}},et={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"GET_USER_BY_ID"},input:{type:"object",required:["user_id"],additionalProperties:!1,properties:{user_id:{type:["integer","string"]}}}}},tt={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"GET_USER_BY_USERNAME"},input:{type:"object",required:["username"],additionalProperties:!1,properties:{username:{type:"string"}}}}},st={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"GET_USERGROUP_BY_ID"},input:{type:"object",required:["usergroup_id"],additionalProperties:!1,properties:{usergroup_id:{type:["integer","string"]}}}}},at={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"GET_FOLDER_BY_ID"},input:{type:"object",required:["folder_id"],additionalProperties:!1,properties:{folder_id:{type:["integer","string"]}}}}},rt={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"GET_DOCUMENT_BY_ID"},input:{type:"object",required:["doc_id"],additionalProperties:!1,properties:{doc_id:{type:"string"}}}}},ot={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"GET_DOCUMENT_BY_APPROVAL_ID"},input:{type:"object",required:["approval_id"],additionalProperties:!1,properties:{approval_id:{type:["integer","string"]}}}}},nt={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"UPDATE_DOCUMENT_ATTRIBUTES"},input:{type:"object",required:["doc_id","attributes"],additionalProperties:!1,properties:{doc_id:{type:"string"},attributes:{type:"string"}}}}},it={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"UPDATE_DOCUMENT_FILES"},input:{type:"object",required:["doc_id","file_ids"],additionalProperties:!1,properties:{doc_id:{type:"string"},file_ids:{oneOf:[{type:"string"},{type:"array",items:{type:"string"}}]}}}}},_t={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"GET_MAILBOX_BY_ID"},input:{type:"object",required:["mailbox_id"],additionalProperties:!1,properties:{mailbox_id:{type:["integer","string"]}}}}},lt={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"GET_MAILCHANNEL_BY_ID"},input:{type:"object",required:["mailchannel_id"],additionalProperties:!1,properties:{mailchannel_id:{type:["integer","string"]}}}}},dt={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"FETCH_MAIL_MESSAGES"},input:{type:"object",required:["mailbox_id","mailchannel_id"],additionalProperties:!1,properties:{mailchannel_id:{type:["integer","string"]},mailbox_id:{type:["integer","string"]}}}}},pt={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"SEND_MAIL_MESSAGE"},input:{type:"object",required:["mailbox_id","address_to","address_cc","address_bcc","subject","text_body","html_body","files","save_storage_path","save_filename"],additionalProperties:!1,properties:{mailbox_id:{type:["integer","string"]},address_to:{type:"string"},address_cc:{type:"string"},address_bcc:{type:"string"},subject:{type:"string"},text_body:{type:"string"},html_body:{type:"string"},files:{oneOf:[{type:"string"},{type:"object",required:["id","name","storage_path"],properties:{id:{type:"string"},name:{type:"string"},storage_path:{type:"string"}},additionalProperties:!1}]},save_storage_path:{type:"string"},save_filename:{type:"string"}}}}},ct={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"FETCH_MAIL_CHANNEL"},input:{type:"object",required:["mailchannel_id"],additionalProperties:!1,properties:{mailchannel_id:{type:["integer","string"]}}}}},ut={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"FETCH_ALL_MAIL_CHANNELS"},input:{const:{}}}},mt={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"CREATE_DOCUMENT_FROM_MAIL_MESSAGE"},input:{type:"object",required:["mail_id"],additionalProperties:!1,properties:{mail_id:{type:["integer","string"]}}}}},gt={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"EXTRACT_HTML_PORTION"},input:{type:"object",required:["html","tag","attributes"],additionalProperties:!1,properties:{html:{type:"string"},tag:{type:"string"},attributes:{oneOf:[{type:"string"},{type:"object"}]}}}}},ht={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"FETCH_COUNTER_BY_NAME"},input:{type:"object",required:["counter_name"],additionalProperties:!1,properties:{counter_name:{type:"string"},key:{type:"string"}}}}},ft={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"CONFIRM_COUNTER_BY_NAME"},input:{type:"object",required:["counter_name","key","value"],additionalProperties:!1,properties:{counter_name:{type:"string"},key:{type:"string"},value:{type:["string","integer"]}}}}},vt={$schema:"http://json-schema.org/draft-07/schema#",type:"object",required:["name","input"],additionalProperties:!1,properties:{name:{const:"COPY_DOCUMENT_TO_USERGROUP"},input:{type:"object",required:["user_id","folder_id","source_usergroup_id","target_usergroup_id","doc_id"],additionalProperties:!1,properties:{user_id:{type:["integer","string"]},folder_id:{type:["integer","string"]},source_usergroup_id:{type:["integer","string"]},target_usergroup_id:{type:["integer","string"]},doc_id:{type:["integer","string"]}}}}},wt={type:"object",properties:{version:{type:"integer",minimum:1,maximum:1},start_condition:{type:"string"},steps:{type:"array",items:{type:"object",required:["name","description","action"],properties:{name:{type:"string",not:{enum:["input"]}},variable_name:{type:"string",not:{enum:["input"]}},description:{type:"string"},to_be_finished_before:{type:"array",items:Be},at_least_one_to_be_finished_before:{type:"array",items:Be},action:{oneOf:[Oe,ze,We,Ge,Ze,He,$e,Le,Ve,Je,Ye,Ke,Xe,Qe,et,tt,st,at,rt,ot,nt,it,_t,lt,dt,pt,ct,ut,mt,gt,ht,ft,vt]}}}}},required:["version","steps"],additionalProperties:!1},yt={oneOf:[wt]},bt={type:"object",properties:{id:{type:"integer"},name:{type:"string"},user:{type:"string"},trigger:{type:"string"},is_multiple:{type:"boolean"},is_active:{type:"boolean"},process:yt,message_if_fail:{type:"boolean"},created_at:{type:"string"},updated_at:{type:"string"}},required:["id","name","user","trigger","is_multiple","is_active","process","message_if_fail","created_at","updated_at"],additionalProperties:!1},Rt={type:"array",items:bt},Ft={type:"object",properties:{id:{type:"integer"},flow:bt,success:{type:"boolean"},is_active:{type:"boolean"},input:{type:"object"},process:{type:"object"},message_if_fail:{type:"boolean"},started_at:{type:"string"},finished_at:{type:["null","string"]}},required:["id","flow","success","is_active","input","process","message_if_fail","started_at","finished_at"],additionalProperties:!1},Dt={type:"array",items:Ft},xt={type:"object",properties:{id:{type:"integer"},name:{type:"string"},description:{type:"string"},flowitem_id:{type:"integer"},success:{type:"boolean"},result_key:{type:"string"},action:{type:"string"},input:{type:"object"},output:{type:["string","object"]},started_at:{type:"string"},finished_at:{type:["null","string"]}},required:["id","name","description","flowitem_id","success","result_key","action","input","output","started_at","finished_at"],additionalProperties:!1},kt={type:"array",items:xt},qt={type:"object",properties:{id:{type:"integer"},name:{type:"string"},value:{type:"string"}},required:["id","name","value"]},St={type:"array",items:qt},Et={type:"object",properties:{name:{enum:["CHECK_MANDATORY"]}},required:["name"],additionalProperties:!1},At={type:"object",properties:{name:{enum:["DATETIME_TO_TIMESTAMP"]},parameters:{type:"object",properties:{format:{type:"string"}},required:["format"],additionalProperties:!1}},required:["name","parameters"],additionalProperties:!1},Ct={type:"object",properties:{name:{enum:["SET_IF_NONE"]},parameters:{type:"object",properties:{value:{type:["integer","string"]}},required:["value"],additionalProperties:!1}},required:["name","parameters"],additionalProperties:!1},Ut={type:"object",properties:{name:{enum:["SIMPLE"]},parameters:{type:"object",properties:{subject:{type:"object",properties:{regex:{type:"array",items:{type:"string"}},flags:{type:"string"},row_count:{type:"integer",minimum:1}},required:["regex"],additionalProperties:!1},body:{type:"object",properties:{regex:{type:"array",items:{type:"string"}},flags:{type:"string"},row_count:{type:"integer",minimum:1}},required:["regex"],additionalProperties:!1},post_processors:{type:"array",items:{type:"object",properties:{attribute:{type:"string"},processor:{oneOf:[At,Ct,Et]}},required:["attribute","processor"],additionalProperties:!1}}},required:["subject","body"],additionalProperties:!1}},required:["name","parameters"],additionalProperties:!1},Pt={type:"object",properties:{version:{type:"string"},store_to:{type:"array",items:{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"}},required:["folder_id","usergroup_id"],additionalProperties:!1}},parser:{oneOf:[Ut]},save:{type:"object",properties:{raw:{type:"boolean"},text:{type:"boolean"},html:{type:"boolean"},attachments:{type:"boolean"},filename:{type:"string"}},required:["raw","text","html","attachments"],additionalProperties:!1}},required:["store_to","parser","save"],additionalProperties:!1},jt={type:"object",properties:{id:{type:"integer"},name:{type:"string"},folder:{type:"string"},storage_path:{type:"string"},settings:Pt,is_active:{type:"boolean"}},required:["id","name","folder","storage_path","settings","is_active"],additionalProperties:!1},Mt={type:"array",items:jt},Tt={type:"object",properties:{id:{type:"integer"},out_protocol:{enum:["SMTP"]},out_encryption:{enum:["NONE","SSL/TLS","STARTTLS"]},out_port:{type:"integer",minimum:0,maximum:1e3},out_server:{type:"string"},in_protocol:{enum:["POP3","IMAP"]},in_encryption:{enum:["NONE","SSL/TLS","STARTTLS"]},in_port:{type:"integer",minimum:0,maximum:1e3},in_server:{type:"string"},username:{type:"string"},password:{type:"string"},name:{type:"string"},mailchannels:{type:"array",items:jt}},required:["id","out_protocol","out_encryption","out_port","out_server","in_protocol","in_encryption","in_port","in_server","username","password","name","mailchannels"],additionalProperties:!1},Nt={type:"array",items:Tt},It={type:"object",properties:{id:{type:"integer"},subject:{type:["null","string"]},message_id:{type:"string"},address_from:{type:"string"},address_to:{type:"string"},address_cc:{type:["null","string"]},address_bcc:{type:["null","string"]},received_at:{type:"string"},mailbox:{type:"integer"},mailchannel:{type:"integer"},has_text:{type:"boolean"},has_html:{type:"boolean"},attachments:Se},required:["id","subject","message_id","address_from","address_to","address_cc","address_bcc","received_at","mailbox","mailchannel","has_text","has_html","attachments"],additionalProperties:!1},Bt={type:"array",items:It},Ot={type:"object",properties:{id:{type:"integer"},name:{type:"string"},description:{type:"string"},value:{type:"integer"},increment:{type:"integer"}},required:["id","name","description","value","increment"],additionalProperties:!1},zt={type:"array",items:Ot};class api_NotImplementedError extends Error{}class Request extends DataClass{get schema(){return{type:"object",properties:{},additionalProperties:!1}}}class Response extends DataClass{}class NegativeResponse extends Response{get schema(){return{type:"object",properties:{code:{type:"string"}},additionalProperties:!1}}}class EmptyPositiveResponse extends Response{get schema(){return{type:"object",properties:{},additionalProperties:!1}}}class PositiveFileResponse extends Response{get schema(){return{type:"object",properties:{file:{type:"object"},name:{type:"string"},size:{type:"number"}},additionalProperties:!1}}}class LoginCredentialsRequest extends Request{get schema(){return{type:"object",properties:{username:{type:"string"},password:{type:"string"}},additionalProperties:!1}}}class LoginCredentialsResponse extends Response{get schema(){return S}}class LoginTokenRequest extends Request{}class LoginTokenResponse extends Response{get schema(){return S}}class GetInfoRequest extends Request{}class GetInfoResponse extends Response{get schema(){return q}}class GetUsersRequest extends Request{}class GetUsersResponse extends Response{get schema(){return E}}class SetUserRequest extends Request{get schema(){return{type:"object",properties:{username:{type:"string"},is_active:{type:"boolean"},access_group_regex:{type:"string"},role:{type:"string"},role_inside_group:{type:"string"},role_outside_group:{type:"string"}},additionalProperties:!1}}}class SetUserResponse extends Response{get schema(){return S}}class DeleteUserRequest extends Request{get schema(){return{type:"object",properties:{username:{type:"string"}},additionalProperties:!1}}}class DeleteUserResponse extends EmptyPositiveResponse{}class GetUserReplacementsRequest extends Request{}class GetUserReplacementsResponse extends Response{get schema(){return E}}class AddUserReplacementRequest extends Request{get schema(){return{type:"object",properties:{username:{type:"string"}},additionalProperties:!1}}}class AddUserReplacementResponse extends Response{get schema(){return S}}class DeleteUserReplacementRequest extends Request{get schema(){return{type:"object",properties:{username:{type:"string"}},additionalProperties:!1}}}class DeleteUserReplacementResponse extends EmptyPositiveResponse{}class GetUserReplacementsOfUserRequest extends Request{get schema(){return{type:"object",properties:{username:{type:"string"}},additionalProperties:!1}}}class GetUserReplacementsOfUserResponse extends Response{get schema(){return E}}class AddUserReplacementToUserRequest extends Request{get schema(){return{type:"object",properties:{username_to_be_replaced:{type:"string"},replaced_with_username:{type:"string"}},additionalProperties:!1}}}class AddUserReplacementToUserResponse extends Response{get schema(){return S}}class DeleteUserReplacementFromUserRequest extends Request{get schema(){return{type:"object",properties:{username_to_be_replaced:{type:"string"},replaced_with_username:{type:"string"}},additionalProperties:!1}}}class DeleteUserReplacementFromUserResponse extends EmptyPositiveResponse{}class GetOnBehalfUsersRequest extends Request{}class GetOnBehalfUsersResponse extends Response{get schema(){return E}}class SetOnBehalfUserRequest extends Request{get schema(){return{type:"object",properties:{username:{type:"string"}},additionalProperties:!1}}}class SetOnBehalfUserResponse extends Response{get schema(){return S}}class DeleteOnBehalfUserRequest extends Request{get schema(){return{type:"object",properties:{username:{type:"string"}},additionalProperties:!1}}}class DeleteOnBehalfUserResponse extends Response{get schema(){return S}}class GetUserGroupsRequest extends Request{}class GetUserGroupsResponse extends Response{get schema(){return Ie}}class AddUserGroupRequest extends Request{get schema(){return{type:"object",properties:{name:{type:"string"},slug:{type:"string"},is_private:{type:"boolean"}},additionalProperties:!1}}}class AddUserGroupResponse extends Response{get schema(){return Ne}}class SetUserGroupRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"integer"},name:{type:"string"},slug:{type:"string"},is_private:{type:"boolean"}},additionalProperties:!1}}}class SetUserGroupResponse extends Response{get schema(){return Ne}}class DeleteUserGroupRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"integer"}},additionalProperties:!1}}}class DeleteUserGroupResponse extends EmptyPositiveResponse{}class AddUserToUserGroupRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"integer"},username:{type:"string"}},additionalProperties:!1}}}class AddUserToUserGroupResponse extends Response{get schema(){return Ne}}class DeleteUserFromUserGroupRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"integer"},username:{type:"string"}},additionalProperties:!1}}}class DeleteUserFromUserGroupResponse extends Response{get schema(){return Ne}}class GetFoldersRequest extends Request{}class GetFoldersResponse extends Response{get schema(){return we}}class AddFolderRequest extends Request{get schema(){return{type:"object",properties:{name:{type:"string"},storage_path:{type:"string"},master_usergroup_slug:{type:"string"},access_group:{type:"string"},settings:{type:"object"}},additionalProperties:!1}}}class AddFolderResponse extends Response{get schema(){return ve}}class UpdateFolderRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"integer"},name:{type:"string"},storage_path:{type:"string"},master_usergroup_slug:{type:"string"},access_group:{type:"string"},settings:{type:"object"}},additionalProperties:!1}}}class UpdateFolderResponse extends Response{get schema(){return ve}}class DeleteFolderRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"integer"}},additionalProperties:!1}}}class DeleteFolderResponse extends EmptyPositiveResponse{}class UploadFileToFolderRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"string"},folder_id:{type:"integer"},usergroup_id:{type:"integer"},original_file:{type:"object"}},additionalProperties:!1}}}class UploadFileToFolderResponse extends EmptyPositiveResponse{}class DownloadFileFromFolderRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"string"},folder_id:{type:"integer"},usergroup_id:{type:"integer"}},additionalProperties:!0}}}class DownloadFileFromFolderResponse extends PositiveFileResponse{}class DownloadManyDocumentsFilesAsArchiveRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},document_ids:{type:"array",items:{type:"string"}}},additionalProperties:!0}}}class DownloadManyDocumentsFilesAsArchiveResponse extends PositiveFileResponse{}class DownloadDocumentFilesAsArchiveRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},document_id:{type:"string"}},additionalProperties:!0}}}class DownloadDocumentFilesAsArchiveResponse extends PositiveFileResponse{}class DeleteFileFromFolderRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"string"},folder_id:{type:"integer"},usergroup_id:{type:"integer"}},additionalProperties:!1}}}class DeleteFileFromFolderResponse extends EmptyPositiveResponse{}class UpdateFileFromFolderRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"string"},folder_id:{type:"integer"},usergroup_id:{type:"integer"},name:{type:"string"}},additionalProperties:!1}}}class UpdateFileFromFolderResponse extends Response{get schema(){return qe}}class GetFileInfoRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"string"}},additionalProperties:!1}}}class GetFileInfoResponse extends Response{get schema(){return qe}}class GetRolesRequest extends Request{}class GetRolesResponse extends Response{get schema(){return Fe}}class AddRoleRequest extends Request{get schema(){return{type:"object",properties:{name:{type:"string"}},additionalProperties:!1}}}class AddRoleResponse extends Response{get schema(){return Re}}class DeleteRoleRequest extends Request{get schema(){return{type:"object",properties:{name:{type:"string"}},additionalProperties:!1}}}class DeleteRoleResponse extends EmptyPositiveResponse{}class GetUserFolderSettingsRequest extends Request{}class GetUserFolderSettingsResponse extends Response{get schema(){return ke}}class AddUserFolderSettingsRequest extends Request{get schema(){return{type:"object",properties:{username:{type:"string"},folder_id:{type:"number"},usergroup_slug:{type:"string"},role:{type:["null","string"]},search_schema:{type:["null","array"]}},additionalProperties:!1}}}class AddUserFolderSettingsResponse extends Response{get schema(){return xe}}class UpdateUserFolderSettingsRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"number"},username:{type:"string"},folder_id:{type:"number"},usergroup_slug:{type:"string"},role:{type:["null","string"]},search_schema:{type:["null","array"]}},additionalProperties:!1}}}class UpdateUserFolderSettingsResponse extends Response{get schema(){return xe}}class DeleteUserFolderSettingsRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"number"}},additionalProperties:!1}}}class DeleteUserFolderSettingsResponse extends EmptyPositiveResponse{}class GetPermissionsRequest extends Request{}class GetPermissionsResponse extends Response{get schema(){return be}}class AddPermissionRequest extends Request{get schema(){return{type:"object",properties:{role:{type:"string"},permission:{type:"string"}},additionalProperties:!1}}}class AddPermissionResponse extends Response{get schema(){return Re}}class DeletePermissionRequest extends Request{get schema(){return{type:"object",properties:{role:{type:"string"},permission:{type:"string"}},additionalProperties:!1}}}class DeletePermissionResponse extends EmptyPositiveResponse{}class GetUserPermissionsRequest extends Request{}class GetUserPermissionsResponse extends Response{get schema(){return be}}class GetUserPermissionsForFolderRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"}},additionalProperties:!1}}}class GetUserPermissionsForFolderResponse extends Response{get schema(){return be}}class GetUserSearchSchemaRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"}},additionalProperties:!1}}}class GetUserSearchSchemaResponse extends Response{get schema(){return De}}class SetUserSearchSchemaRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},search_schema:De},additionalProperties:!1}}}class SetUserSearchSchemaResponse extends EmptyPositiveResponse{}class DeleteUserSearchSchemaRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"}},additionalProperties:!1}}}class DeleteUserSearchSchemaResponse extends EmptyPositiveResponse{}class GetDocumentRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},document_id:{type:"string"}},additionalProperties:!1}}}class GetDocumentResponse extends Response{get schema(){return Ee}}class GetPreviousDocumentsRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},document_id:{type:"string"},count:{type:"integer"}},additionalProperties:!1}}}class GetPreviousDocumentsResponse extends Response{get schema(){return Ae}}class PushDocumentButtonRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},document_id:{type:"string"},action:{type:"string"}},additionalProperties:!1}}}class PushDocumentButtonResponse extends EmptyPositiveResponse{}class GetManyDocumentsRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},query:{type:"object"}},additionalProperties:!1}}}class GetManyDocumentsResponse extends Response{get schema(){return{type:"object",properties:{documents:Ae,count:{type:"integer"}},additionalProperties:!1}}}class SaveManyDocumentsRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},docs:{type:"array"}},additionalProperties:!1}}}class SaveManyDocumentsResponse extends Response{get schema(){return Ae}}class DeleteManyDocumentsRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},ids:{type:"array"}},additionalProperties:!1}}}class DeleteManyDocumentsResponse extends EmptyPositiveResponse{}class DuplicateDocumentToUsergroupRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},source_usergroup_id:{type:"integer"},target_usergroup_id:{type:"integer"},document_id:{type:"string"}},additionalProperties:!1}}}class DuplicateDocumentToUsergroupResponse extends Response{get schema(){return Ee}}class DuplicateManyDocumentsToUsergroupRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},source_usergroup_id:{type:"integer"},target_usergroup_id:{type:"integer"},document_ids:{type:"array",items:{type:"string"}}},additionalProperties:!1}}}class DuplicateManyDocumentsToUsergroupResponse extends EmptyPositiveResponse{}class GetSpareFilesRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"}},additionalProperties:!1}}}class GetSpareFilesResponse extends Response{get schema(){return Se}}class GetUploadProgressRequest extends Request{}class GetUploadProgressResponse extends Response{get schema(){return{type:"array",items:{type:"object",properties:{file_id:{type:"string"},loaded:{type:"integer"}},additionalProperties:!1}}}}class GetPdfMergeFilesRequest extends Request{}class GetPdfMergeFilesResponse extends Response{get schema(){return Te}}class UploadPdfMergeFileRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"string"},order:{type:"integer"},original_file:{type:"object"}},additionalProperties:!1}}}class UploadPdfMergeFileResponse extends Response{get schema(){return Me}}class UpdatePdfMergeFileRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"string"},order:{type:"integer"},page_from:{type:"integer"},page_to:{type:"integer"},angle:{type:"integer"}},additionalProperties:!1}}}class UpdatePdfMergeFileResponse extends Response{get schema(){return Me}}class DeletePdfMergeFileRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"string"}},additionalProperties:!1}}}class DeletePdfMergeFileResponse extends EmptyPositiveResponse{}class DownloadPdfMergeResultRequest extends Request{get schema(){return{type:"object",properties:{keep_bookmarks:{type:"boolean"},add_filenames_as_bookmarks:{type:"boolean"}},additionalProperties:!0}}}class DownloadPdfMergeResultResponse extends PositiveFileResponse{}class DownloadPdfMixResultRequest extends Request{get schema(){return{type:"object",properties:{},additionalProperties:!0}}}class DownloadPdfMixResultResponse extends PositiveFileResponse{}class GetShareFilesRequest extends Request{}class GetShareFilesResponse extends Response{get schema(){return Se}}class UploadShareFileRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"string"},original_file:{type:"object"}},additionalProperties:!1}}}class UploadShareFileResponse extends EmptyPositiveResponse{}class DownloadShareFileRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"string"}},additionalProperties:!0}}}class DownloadShareFileResponse extends PositiveFileResponse{}class DeleteShareFileRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"string"}},additionalProperties:!1}}}class DeleteShareFileResponse extends EmptyPositiveResponse{}class GetFlowsRequest extends Request{get schema(){return{type:"object",properties:{query:{type:"object"}},additionalProperties:!1}}}class GetFlowsResponse extends Response{get schema(){return Rt}}class AddFlowRequest extends Request{get schema(){return{type:"object",properties:{name:{type:"string"},trigger:{type:"string"},is_active:{type:"boolean"},is_multiple:{type:"boolean"},message_if_fail:{type:"boolean"},process:{type:"object"}},additionalProperties:!1}}}class AddFlowResponse extends Response{get schema(){return bt}}class UpdateFlowRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"integer"},name:{type:"string"},trigger:{type:"string"},is_active:{type:"boolean"},is_multiple:{type:"boolean"},message_if_fail:{type:"boolean"},process:{type:"object"}},additionalProperties:!1}}}class UpdateFlowResponse extends Response{get schema(){return bt}}class DeleteFlowRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"integer"}},additionalProperties:!1}}}class DeleteFlowResponse extends EmptyPositiveResponse{}class GetFlowItemRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"integer"}},additionalProperties:!1}}}class GetFlowItemResponse extends Response{get schema(){return Ft}}class RestartFlowItemRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"integer"}},additionalProperties:!1}}}class RestartFlowItemResponse extends EmptyPositiveResponse{}class GetManyFlowItemsRequest extends Request{get schema(){return{type:"object",properties:{query:{type:"object"}},additionalProperties:!1}}}class GetManyFlowItemsResponse extends Response{get schema(){return Dt}}class GetFlowItemStepsRequest extends Request{get schema(){return{type:"object",properties:{flowitem_id:{type:"integer"}},additionalProperties:!1}}}class GetFlowItemStepsResponse extends Response{get schema(){return kt}}class GetManyDocumentsApprovalsRequest extends Request{get schema(){return{type:"object",properties:{query:{type:"object"}},additionalProperties:!1}}}class GetManyDocumentsApprovalsResponse extends Response{get schema(){return Pe}}class GetDocumentApprovalsRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},document_id:{type:"string"}},additionalProperties:!1}}}class GetDocumentApprovalsResponse extends Response{get schema(){return Ue}}class AddDocumentApprovalRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},document_id:{type:"string"},username:{type:"string"}},additionalProperties:!1}}}class AddDocumentApprovalResponse extends Response{get schema(){return Ce}}class UpdateDocumentApprovalRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},document_id:{type:"string"},approval_id:{type:"integer"},state:{enum:["APPROVED","REJECTED","DELEGATED","NONE"]},files:{type:"array",items:{type:"string"}},comments:{type:"string"}},additionalProperties:!1}}}class UpdateDocumentApprovalResponse extends Response{get schema(){return Ce}}class DeleteDocumentApprovalRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},document_id:{type:"string"},approval_id:{type:"integer"}},additionalProperties:!1}}}class DeleteDocumentApprovalResponse extends EmptyPositiveResponse{}class DelegateDocumentApprovalRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},document_id:{type:"string"},approval_id:{type:"integer"},username:{type:"string"},with_return:{type:"boolean"}},additionalProperties:!1}}}class DelegateDocumentApprovalResponse extends Response{get schema(){return Ue}}class GetDocumentApprovalSpareFilesRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},document_id:{type:"string"}},additionalProperties:!1}}}class GetDocumentApprovalSpareFilesResponse extends Response{get schema(){return Se}}class UploadDocumentApprovalFileRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},document_id:{type:"string"},file_id:{type:"string"},original_file:{type:"object"}},additionalProperties:!1}}}class UploadDocumentApprovalFileResponse extends EmptyPositiveResponse{}class DeleteDocumentApprovalFileRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},document_id:{type:"string"},file_id:{type:"string"}},additionalProperties:!1}}}class DeleteDocumentApprovalFileResponse extends EmptyPositiveResponse{}class GetWaitingDocumentApprovalsRequest extends Request{}class GetWaitingDocumentApprovalsResponse extends Response{get schema(){return Ue}}class EmptyCartRequest extends Request{}class EmptyCartResponse extends EmptyPositiveResponse{}class GetCartDocumentsRequest extends Request{}class GetCartDocumentsResponse extends Response{get schema(){return Ae}}class AddDocumentToCartRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},document_id:{type:"string"}},additionalProperties:!1}}}class AddDocumentToCartResponse extends Response{get schema(){return Ee}}class AddManyDocumentsToCartRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},document_ids:{type:"array"}},additionalProperties:!1}}}class AddManyDocumentsToCartResponse extends Response{get schema(){return Ae}}class RemoveDocumentFromCartRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},document_id:{type:"string"}},additionalProperties:!1}}}class RemoveDocumentFromCartResponse extends EmptyPositiveResponse{}class AbstractDocumentApprovalFlowRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},document_id:{type:"string"}},additionalProperties:!1}}}class AbstractDocumentApprovalFlowResponse extends Response{get schema(){return je}}class GetDocumentApprovalFlowRequest extends AbstractDocumentApprovalFlowRequest{}class GetDocumentApprovalFlowResponse extends AbstractDocumentApprovalFlowResponse{}class SetDocumentApprovalFlowRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},document_id:{type:"string"},steps:{type:"array",items:{type:"array",items:{type:"string"},minItems:1},minItems:1}},additionalProperties:!1}}}class SetDocumentApprovalFlowResponse extends AbstractDocumentApprovalFlowResponse{}class StartDocumentApprovalFlowRequest extends AbstractDocumentApprovalFlowRequest{}class StartDocumentApprovalFlowResponse extends AbstractDocumentApprovalFlowResponse{}class StopDocumentApprovalFlowRequest extends AbstractDocumentApprovalFlowRequest{}class StopDocumentApprovalFlowResponse extends AbstractDocumentApprovalFlowResponse{}class GetServerSettingsRequest extends Request{}class GetServerSettingsResponse extends Response{get schema(){return St}}class UpdateServerSettingRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"integer"},value:{type:"string"}},additionalProperties:!1}}}class UpdateServerSettingResponse extends Response{get schema(){return qt}}class GetMailBoxesRequest extends Request{}class GetMailBoxesResponse extends Response{get schema(){return Nt}}class AddMailBoxRequest extends Request{get schema(){return{type:"object",properties:{out_protocol:{enum:["SMTP"]},out_encryption:{enum:["NONE","SSL/TLS","STARTTLS"]},out_port:{type:"integer",minimum:0,maximum:1e3},out_server:{type:"string"},in_protocol:{enum:["POP3","IMAP"]},in_encryption:{enum:["NONE","SSL/TLS","STARTTLS"]},in_port:{type:"integer",minimum:0,maximum:1e3},in_server:{type:"string"},username:{type:"string"},password:{type:"string"},name:{type:"string"}},additionalProperties:!1}}}class AddMailBoxResponse extends Response{get schema(){return Tt}}class UpdateMailBoxRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"integer"},out_protocol:{enum:["SMTP"]},out_encryption:{enum:["NONE","SSL/TLS","STARTTLS"]},out_port:{type:"integer",minimum:0,maximum:1e3},out_server:{type:"string"},in_protocol:{enum:["POP3","IMAP"]},in_encryption:{enum:["NONE","SSL/TLS","STARTTLS"]},in_port:{type:"integer",minimum:0,maximum:1e3},in_server:{type:"string"},username:{type:"string"},password:{type:"string"},name:{type:"string"}},additionalProperties:!1}}}class UpdateMailBoxResponse extends Response{get schema(){return Tt}}class DeleteMailBoxRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"integer"}},additionalProperties:!1}}}class DeleteMailBoxResponse extends EmptyPositiveResponse{}class GetMailChannelsRequest extends Request{}class GetMailChannelsResponse extends Response{get schema(){return Mt}}class AddMailChannelRequest extends Request{get schema(){return{type:"object",properties:{name:{type:"string"},folder:{type:"string"},storage_path:{type:"string"},settings:{type:"object"},is_active:{type:"boolean"}},additionalProperties:!1}}}class AddMailChannelResponse extends Response{get schema(){return jt}}class UpdateMailChannelRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"integer"},name:{type:"string"},folder:{type:"string"},storage_path:{type:"string"},settings:{type:"object"},is_active:{type:"boolean"}},additionalProperties:!1}}}class UpdateMailChannelResponse extends Response{get schema(){return jt}}class DeleteMailChannelRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"integer"}},additionalProperties:!1}}}class DeleteMailChannelResponse extends EmptyPositiveResponse{}class AddMailChannelToMailBoxRequest extends Request{get schema(){return{type:"object",properties:{mailbox_id:{type:"integer"},mailchannel_id:{type:"integer"}},additionalProperties:!1}}}class AddMailChannelToMailBoxResponse extends Response{get schema(){return Tt}}class DeleteMailChannelFromMailBoxRequest extends AddMailChannelToMailBoxRequest{}class DeleteMailChannelFromMailBoxResponse extends AddMailChannelToMailBoxResponse{}class FetchMailChannelRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"integer"}},additionalProperties:!1}}}class FetchMailChannelResponse extends EmptyPositiveResponse{}class GetMailMessagesRequest extends Request{get schema(){return{type:"object",properties:{query:{type:"object"}},additionalProperties:!1}}}class GetMailMessagesResponse extends Response{get schema(){return Bt}}class DeleteMailMessageRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"integer"}},additionalProperties:!1}}}class DeleteMailMessageResponse extends EmptyPositiveResponse{}class DownloadMailMessageRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"integer"},format:{type:"string"}},additionalProperties:!0}}}class DownloadMailMessageResponse extends PositiveFileResponse{}class DownloadMailMessageAttachmentRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"string"},message_id:{type:"integer"}},additionalProperties:!0}}}class DownloadMailMessageAttachmentResponse extends PositiveFileResponse{}class GetCountersRequest extends Request{}class GetCountersResponse extends Response{get schema(){return zt}}class AddCounterRequest extends Request{get schema(){return{type:"object",properties:{name:{type:"string"},description:{type:"string"},value:{type:"integer"},increment:{type:"integer"}},additionalProperties:!1}}}class AddCounterResponse extends Response{get schema(){return Ot}}class UpdateCounterRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"integer"},name:{type:"string"},description:{type:"string"},value:{type:"integer"},increment:{type:"integer"}},additionalProperties:!1}}}class UpdateCounterResponse extends Response{get schema(){return Ot}}class DeleteCounterRequest extends Request{get schema(){return{type:"object",properties:{id:{type:"integer"}},additionalProperties:!1}}}class DeleteCounterResponse extends EmptyPositiveResponse{}class DownloadTransmittalCoverSheetRequest extends Request{get schema(){return{type:"object",properties:{folder_id:{type:"integer"},usergroup_id:{type:"integer"},document_ids:{type:"array",items:{type:"string"}},template:{type:"string"}},additionalProperties:!0}}}class DownloadTransmittalCoverSheetResponse extends PositiveFileResponse{}class AbstractApi{constructor(){(0,R.Z)(this,"call",(t=>{if(!Object.prototype.hasOwnProperty.call(this.REQUEST_HANDLERS,t.constructor.name))throw new api_NotImplementedError("API request does not have handler for "+t.constructor.name);const s=this.REQUEST_HANDLERS[t.constructor.name];return s(t)})),(0,R.Z)(this,"login_with_credentials",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"login_with_token",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_info",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_users",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"set_user",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_user",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_user_replacements",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"add_user_replacement",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_user_replacement",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_on_behalf_users",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"set_on_behalf_user",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_on_behalf_user",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_user_groups",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"set_user_groups",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"add_user_groups",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_user_groups",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"add_user_to_user_group",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_user_from_user_group",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_folders",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"add_folder",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"update_folder",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_folder",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_document",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_previous_documents",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_many_documents",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_waiting_document_approvals",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"upload_file_to_folder",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"download_file_from_folder",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"download_many_documents_files_as_archive",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"download_document_files_as_archive",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_file_from_folder",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"update_file_from_folder",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_roles",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"add_role",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_role",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_user_folder_settings",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"add_user_folder_settings",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"set_user_folder_settings",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_user_folder_settings",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_permissions",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"add_permission",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_permission",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_permissions_by_roles",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_user_permissions",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_user_permissions_for_folder",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_user_search_schema",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"set_user_search_schema",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_user_search_schema",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_spare_files",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"save_document",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"save_many_documents",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_document",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_many_documents",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"duplicate_document_to_usergroup",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"duplicate_many_documents_to_usergroup",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"push_document_button",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_upload_progress",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_pdf_merge_files",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"upload_pdf_merge_file",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"update_pdf_merge_file",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_pdf_merge_file",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"download_pdf_merge_result",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"download_pdf_mix_result",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_share_files",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"upload_share_file",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"download_share_file",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_share_file",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_flows",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"add_flow",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"update_flow",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_flow",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_flow_item",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"restart_flow_item",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_many_flow_items",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_flow_item_steps",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_many_documents_approvals",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_document_approvals",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"add_document_approval",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"update_document_approval",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_document_approval",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_document_approval_spare_files",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"upload_document_approval_file",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_document_approval_file",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delegate_document_approval_file",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"empty_cart",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_cart_documents",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"add_document_to_cart",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"add_many_documents_to_cart",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"remove_document_from_cart",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_document_approval_flow",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"set_document_approval_flow",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"start_document_approval_flow",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"stop_document_approval_flow",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_server_settings",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"update_server_setting",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_mailboxes",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"add_mailbox",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"update_mailbox",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_mailbox",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_mail_channels",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"add_mail_channel",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"update_mail_channel",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_mail_channel",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"add_mail_channel_to_mailbox",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_mail_channel_from_mailbox",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"fetch_mail_channel",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"get_mail_messages",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_mail_message",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"download_mail_message",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"download_mail_message_attachment",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"add_counter",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"update_counter",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"delete_counter",(()=>{throw new api_NotImplementedError})),(0,R.Z)(this,"download_transmittal_cover_sheet",(()=>{throw new api_NotImplementedError})),this._auth_token=null}set_auth_token(t){this._auth_token=t}}class WrongResponseError extends Error{}class WrongErrorType extends Error{}const notify=(t,s)=>{const a={success:s.notificator.success,warning:s.notificator.warning,info:s.notificator.info,error:s.notificator.error};if(!Object.prototype.hasOwnProperty.call(a,t.level))throw new WrongErrorType('Wrong error type "'+t.level+'"');a[t.level](t.text)},notify_api_error=(t,s)=>{const a={"Auth.Credentials.Fail":["error","Неверные учетные данные"],"Auth.Credentials.Blocked":["error","Учетная запись заблокирована"],"Auth.Token.Fail":["error","Неверные учетные данные"],"Auth.Token.Blocked":["error","Учетная запись заблокирована"],"Auth.Token.NotAllowed":["error","Недостаточно прав доступа"],"User.Error.WrongOnBehalf":["error","Вы не можете работать от данного пользователя"],"Api.Server.Unavailable":["error","Сервер недоступен"],"Api.Server.InternalError":["error","Ошибка сервера"],"Database.Error.Integrity":["error","Ошибка базы данных"],"Database.Error.Validation":["error","Неверные входные данные"],"Database.Error.Protected":["error","Ошибка удаления связанных данных"],"Request.Body.NotJson":["error","Неверный запрос"],"Parameter.Body.Wrong":["error","Неверный запрос"],"Parameter.Path.Wrong":["error","Неверный запрос"],"Parameter.Query.Wrong":["error","Неверный запрос"],"Storage.Error.NotAvailable":["error","Хранилище файлов не доступно"],"Document.Error.Blocked":["error","Документ заблокирован"],"DocumentApproval.Error.AlreadyDone":["error","Согласование уже выполнено"],"DocumentApproval.Error.CanNotBeDeleted":["error","Согласование не может быть удалено. Возможно запущен поток согласований."],"DocumentApproval.Error.CanNotDelegate":["error","Делегирование невозможно"],"DocumentApproval.Error.AlreadyDelegated":["error","Согласование уже делегировано"],"DocumentApproval.Error.HasBeenDelegatedWithReturn":["error","Делегирования с возвратом не завершены"],"DocumentApprovalFile.Error.CanNotBeDeleted":["error","Файл согласования не может быть удален"],"DocumentApprovalFlow.Error.Blocked":["error","Поток согласований заблокирован"],"DocumentApprovalFlow.Error.DoesNotExist":["error","Поток согласований не существует"],"DocumentApprovalFlow.Error.AlreadyStarted":["error","Поток согласований уже запущен"],"DocumentApprovalFlow.Error.AlreadyStopped":["error","Поток согласований уже остановлен"],"File.Blocked.AttachedToDocument":["error","Файл прикреплен к документу"],"File.Uploaded.ZeroSize":["error","Загруженный файл имеет нулевой размер"],"File.Error.TooLarge":["error","Слишком большой файл"],"MailReceiver.Error.Login":["error","Ошибка при подключении к почтовому ящику"],"MailReceiver.Error.List":["error","Ошибка при получении списка сообщений из почтового ящика"],"MailReceiver.Error.Fetch":["error","Ошибка при получении сообщения из почтового ящика"],"MailParser.Error.WrongBytes":["error","Ошибка при парсинге сообщения"],"MailParser.Error.Headers":["error","Ошибка при получении заголовков сообщения"],"MailParser.Error.TextBody":["error","Ошибка при получении тела сообщения в формате text"],"MailParser.Error.HtmlBody":["error","Ошибка при получении тела сообщения в формате html"],"MailParser.Error.Attachment":["error","Ошибка при получении вложения сообщения"],"MailParser.Error.CidImage":["error","Ошибка при извлечении изображения из письма"],"MailParser.Error.ConvertHtmlBody":["error","Ошибка при конвертировании тела сообщения в формате html"],"MailChannel.Error.Settings":["error","Неверные настройки почтового канала"],"MailMessage.Body.NotFound":["error","Тело сообщения в запрошенном формате отсутствует"],"Pdf.Error.Operation":["error","Ошибка операции над PDF файлом"],"Transmittal.Error.CoverSheet":["error","Ошибка создания накладной трансмиттала"]};if(!Object.prototype.hasOwnProperty.call(a,t.code))return console.log('Неизвестный код ответа API "'+t.code+'"'),void s.push_message(new Notify("error","Неизвестная ошибка"));const[r,o]=a[t.code];s.push_message(new Notify(r,o))},get_info=async(t,s)=>{const a=new GetInfoRequest,r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof GetInfoResponse)return s.info_repository.set_approval_actions_count(r.data.approval_actions_count),void s.info_repository.set_approval_orders_count(r.data.approval_orders_count);throw new WrongResponseError}s.push_message(new ApiError(r.data.code))};var Wt=a(1211);class user_handlers_WrongResponseError extends Error{}const convert_user_response_obj_to_model=t=>{const s=new Wt.n5(t.username,t.email,t.first_name,t.last_name,t.patronomic,t.position,t.department,t.is_active,t.access_group_regex,t.role,t.role_inside_group,t.role_outside_group,t.on_behalf);return s},login_with_credentials=async(t,s)=>{s.user_repository.reset_keeping_refs(),s.token_repository.reset();const a=new LoginCredentialsRequest({username:t.username,password:t.password}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof LoginCredentialsResponse)return s.user_repository.set_current(convert_user_response_obj_to_model(r.data)),s.token_repository.set_auth_token(r.data.auth_token),s.api.set_auth_token(r.data.auth_token),s.permission_repository.reset(),void s.push_message(new UserLoginSuccess);throw new user_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},login_with_token=async(t,s)=>{const a=new LoginTokenRequest,r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof LoginTokenResponse)return s.user_repository.set_current(convert_user_response_obj_to_model(r.data)),s.permission_repository.reset(),void s.push_message(new UserLoginSuccess);throw new user_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},logout=(t,s)=>{s.user_repository.reset(),s.token_repository.reset(),s.permission_repository.reset(),s.push_message(new UserLogoutSuccess)},get_users=async(t,s)=>{const a=new GetUsersRequest,r=await s.api.call(a);if(r instanceof NegativeResponse)s.push_message(new ApiError(r.data.code));else{if(!(r instanceof GetUsersResponse))throw new user_handlers_WrongResponseError;r.data.forEach((t=>{const a=convert_user_response_obj_to_model(t);s.user_repository.set(a.username,a)}))}},set_user=async(t,s)=>{const a=new SetUserRequest({username:t.username,is_active:t.is_active,access_group_regex:t.access_group_regex,role:t.role,role_inside_group:t.role_inside_group,role_outside_group:t.role_outside_group}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof SetUserResponse){const t=convert_user_response_obj_to_model(r.data);return s.user_repository.set(t.username,t),void s.push_message(new UsersUpdateSuccess)}throw new user_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},delete_user=async(t,s)=>{const a=new DeleteUserRequest({username:t.username}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof DeleteUserResponse)return s.user_repository.delete(t.username),void s.push_message(new UsersDeleteSuccess);throw new user_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},get_user_replacements=async(t,s)=>{const a=s.user_repository.get_current(),r=new GetUserReplacementsRequest,o=await s.api.call(r);if(o instanceof NegativeResponse)s.push_message(new ApiError(o.data.code));else{if(!(o instanceof GetUserReplacementsResponse))throw new user_handlers_WrongResponseError;o.data.forEach((t=>{const r=convert_user_response_obj_to_model(t);s.user_replacement_repository.set(a.value.username,r.username,r)}))}},add_user_replacement=async(t,s)=>{const a=s.user_repository.get_current(),r=new AddUserReplacementRequest({username:t.username}),o=await s.api.call(r);if(!(o instanceof NegativeResponse)){if(o instanceof AddUserReplacementResponse){const t=convert_user_response_obj_to_model(o.data);return s.user_replacement_repository.set(a.value.username,t.username,t),void s.push_message(new UserReplacementAddSuccess)}throw new user_handlers_WrongResponseError}s.push_message(new ApiError(o.data.code))},delete_user_replacement=async(t,s)=>{const a=s.user_repository.get_current(),r=new DeleteUserReplacementRequest({username:t.username}),o=await s.api.call(r);if(!(o instanceof NegativeResponse)){if(o instanceof DeleteUserReplacementResponse)return s.user_replacement_repository.delete(a.value.username,t.username),void s.push_message(new UserReplacementDeleteSuccess);throw new user_handlers_WrongResponseError}s.push_message(new ApiError(o.data.code))},get_user_replacements_of_user=async(t,s)=>{s.user_replacement_repository.reset_keeping_refs(t.username);const a=new GetUserReplacementsOfUserRequest({username:t.username}),r=await s.api.call(a);if(r instanceof NegativeResponse)s.push_message(new ApiError(r.data.code));else{if(!(r instanceof GetUserReplacementsOfUserResponse))throw new user_handlers_WrongResponseError;r.data.forEach((a=>{const r=convert_user_response_obj_to_model(a);s.user_replacement_repository.set(t.username,r.username,r)}))}},add_user_replacement_to_user=async(t,s)=>{const a=new AddUserReplacementToUserRequest({username_to_be_replaced:t.username_to_be_replaced,replaced_with_username:t.replaced_with_username}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof AddUserReplacementToUserResponse){const a=convert_user_response_obj_to_model(r.data);return s.user_replacement_repository.set(t.username_to_be_replaced,a.username,a),void s.push_message(new UserReplacementAddSuccess)}throw new user_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},delete_user_replacement_from_user=async(t,s)=>{const a=new DeleteUserReplacementFromUserRequest({username_to_be_replaced:t.username_to_be_replaced,replaced_with_username:t.replaced_with_username}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof DeleteUserReplacementFromUserResponse)return s.user_replacement_repository.delete(t.username_to_be_replaced,t.replaced_with_username),void s.push_message(new UserReplacementDeleteSuccess);throw new user_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},get_on_behalf_users=async(t,s)=>{const a=new GetOnBehalfUsersRequest,r=await s.api.call(a);if(r instanceof NegativeResponse)s.push_message(new ApiError(r.data.code));else{if(!(r instanceof GetOnBehalfUsersResponse))throw new user_handlers_WrongResponseError;s.user_repository.set_on_behalf_users(r.data.map((t=>convert_user_response_obj_to_model(t))))}},set_on_behalf_user=async(t,s)=>{const a=new SetOnBehalfUserRequest({username:t.username}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof SetOnBehalfUserResponse)return s.user_repository.set_current(convert_user_response_obj_to_model(r.data)),void s.push_message(new OnBehalfUserChangeSuccess);throw new user_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},delete_on_behalf_user=async(t,s)=>{const a=new DeleteOnBehalfUserRequest({username:t.username}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof DeleteOnBehalfUserResponse)return s.user_repository.set_current(convert_user_response_obj_to_model(r.data)),void s.push_message(new OnBehalfUserDeleteSuccess);throw new user_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},get_user_email_context=async(t,s)=>{const a=s.user_repository.values().map((t=>t.value)).filter((t=>!0===t.is_active));let r={};a.forEach((t=>{t.email&&(r[t.email]=(t.last_name+" "+t.first_name).trim())})),s.context_repository.set(t.ctx_id,t.ctx_name,r)};class usergroup_handlers_WrongResponseError extends Error{}const set_user_group_into_repository=(t,s)=>{const a=new Wt.Yg(s.id,s.name,s.slug,s.is_private);t.usergroup_repository.set(s.id,a),s.users&&s.users.forEach((t=>{const s=new Wt.n5(t.username,t.email,t.first_name,t.last_name,t.patronomic,t.position,t.department,t.is_active,t.role,t.role_inside_group,t.role_outside_group,t.on_behalf);a.add_user(s)}))},get_user_groups=async(t,s)=>{s.usergroup_repository.reset_keeping_refs();const a=new GetUserGroupsRequest({}),r=await s.api.call(a);if(r instanceof NegativeResponse)s.push_message(new ApiError(r.data.code));else{if(!(r instanceof GetUserGroupsResponse))throw new usergroup_handlers_WrongResponseError;r.data.forEach((t=>set_user_group_into_repository(s,t)))}},add_user_group=async(t,s)=>{const a=new AddUserGroupRequest({name:t.name,slug:t.slug,is_private:t.is_private}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof AddUserGroupResponse)return set_user_group_into_repository(s,r.data),void s.push_message(new AddUserGroupSuccess);throw new usergroup_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},update_user_group=async(t,s)=>{const a=new SetUserGroupRequest({id:t.id,name:t.name,slug:t.slug,is_private:t.is_private}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof SetUserGroupResponse)return set_user_group_into_repository(s,r.data),void s.push_message(new UpdateUserGroupSuccess);throw new usergroup_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},delete_user_group=async(t,s)=>{const a=new DeleteUserGroupRequest({id:t.id}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof DeleteUserGroupResponse)return s.usergroup_repository.delete(t.id),void s.push_message(new DeleteUserGroupSuccess);throw new usergroup_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},add_user_to_user_group=async(t,s)=>{const a=new AddUserToUserGroupRequest({id:t.id,username:t.username}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof AddUserToUserGroupResponse)return set_user_group_into_repository(s,r.data),void s.push_message(new UpdateUserGroupSuccess);throw new usergroup_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},delete_user_from_user_group=async(t,s)=>{const a=new DeleteUserFromUserGroupRequest({id:t.id,username:t.username}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof DeleteUserFromUserGroupResponse)return set_user_group_into_repository(s,r.data),void s.push_message(new UpdateUserGroupSuccess);throw new usergroup_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},set_current_user_group=(t,s)=>{null===t.usergroup&&console.log("Запрещенная группа пользователей");const a=s.usergroup_repository.get_current();a.value&&a.value.id===t.usergroup.id||(s.usergroup_repository.set_current(t.usergroup),s.folder_repository.values().forEach((t=>{s.doc_repository.reset(t.value.id)})))};class permission_handlers_WrongResponseError extends Error{}const get_permissions=async(t,s)=>{const a=new GetPermissionsRequest,r=await s.api.call(a);if(r instanceof NegativeResponse)s.push_message(new ApiError(r.data.code));else{if(!(r instanceof GetPermissionsResponse))throw new permission_handlers_WrongResponseError;s.role_permissions_repository.set_variants(r.permissions)}},add_permission=async(t,s)=>{const a=new AddPermissionRequest({role:t.role,permission:t.perm}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof AddPermissionResponse)return s.role_permissions_repository.set(t.role,t.perm,!0),void s.push_message(new AddPermissionSuccess);throw new permission_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},delete_permission=async(t,s)=>{const a=new DeletePermissionRequest({role:t.role,permission:t.perm}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof DeletePermissionResponse)return s.role_permissions_repository.set(t.role,t.perm,!1),void s.push_message(new DeletePermissionSuccess);throw new permission_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},get_user_permissions=async(t,s)=>{s.permission_repository.reset();const a=new GetUserPermissionsRequest,r=await s.api.call(a);if(r instanceof NegativeResponse)s.push_message(new ApiError(r.data.code));else{if(!(r instanceof GetUserPermissionsResponse))throw new permission_handlers_WrongResponseError;r.data.forEach((t=>{s.permission_repository.add(t.name)}))}},get_user_permissions_for_folder=async(t,s)=>{s.permission_repository.reset_for_folder(t.folder_id);const a=new GetUserPermissionsForFolderRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id}),r=await s.api.call(a);if(r instanceof NegativeResponse)s.push_message(new ApiError(r.data.code));else{if(!(r instanceof GetUserPermissionsForFolderResponse))throw new permission_handlers_WrongResponseError;r.data.forEach((a=>{s.permission_repository.add_for_folder(t.folder_id,a.name)}))}};class role_handlers_WrongResponseError extends Error{}const get_roles=async(t,s)=>{const a=new GetRolesRequest,r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof GetRolesResponse)return s.user_folder_settings_repository.set_role_variants(r.data.map((t=>t.name))),s.role_permissions_repository.reset(),void r.data.forEach((t=>{t.permissions.forEach((a=>{s.role_permissions_repository.set(t.name,a.name,!0)}))}));throw new role_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},add_role=async(t,s)=>{const a=new AddRoleRequest({name:t.name}),r=await s.api.call(a);if(r instanceof NegativeResponse)s.push_message(new ApiError(r.data.code));else{if(!(r instanceof AddRoleResponse))throw new role_handlers_WrongResponseError;s.push_message(new AddRoleSuccess)}},delete_role=async(t,s)=>{const a=new DeleteRoleRequest({name:t.name}),r=await s.api.call(a);if(r instanceof NegativeResponse)s.push_message(new ApiError(r.data.code));else{if(!(r instanceof DeleteRoleResponse))throw new role_handlers_WrongResponseError;s.push_message(new DeleteRoleSuccess)}};class folder_handlers_WrongResponseError extends Error{}const convert_folder_response_obj_to_model=t=>{const s=new Wt.gt(t.id);return s.name=t.name,s.storage_path=t.storage_path,s.master_usergroup_slug=t.master_usergroup_slug,s.access_group=t.access_group,s.version=t.settings.version,s.validation_constraints=t.settings.validation_constraints,s.search_schema=t.settings.search_schema,s.form_schema=t.settings.form_schema,s.max_file_size=t.settings.max_file_size,s.set_filename_pattern(t.settings.filename_pattern),s.description_pattern=t.settings.description_pattern,s.is_empty_search_allowed=t.settings.is_empty_search_allowed,s.is_list_container_required=t.settings.is_list_container_required,s.is_doc_container_required=t.settings.is_doc_container_required,s.doc_container_parsers=t.settings.doc_container_parsers,t.settings.sort_by&&(s.default_sort_attribute=t.settings.sort_by.name,s.default_sort_order=t.settings.sort_by.asc),t.settings.sort_rules&&(s.sort_rules=t.settings.sort_rules),t.settings.mode&&(s.default_mode=t.settings.mode),s.group_by=t.settings.group_by,s.strict_validation=t.settings.strict_validation,t.settings.action_buttons&&(s.action_buttons=t.settings.action_buttons),t.settings.search_action_buttons&&(s.search_action_buttons=t.settings.search_action_buttons),t.settings.approval_rules&&(s.approval_rules=t.settings.approval_rules),s},get_folders=async(t,s)=>{const a=new GetFoldersRequest,r=await s.api.call(a);if(r instanceof NegativeResponse)s.push_message(new ApiError(r.data.code));else{if(!(r instanceof GetFoldersResponse))throw new folder_handlers_WrongResponseError;r.data.forEach((t=>s.folder_repository.set(t.id,convert_folder_response_obj_to_model(t))))}},add_folder=async(t,s)=>{const a=new AddFolderRequest({name:t.name,storage_path:t.storage_path,master_usergroup_slug:t.master_usergroup_slug,access_group:t.access_group,settings:t.settings}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof AddFolderResponse){const t=convert_folder_response_obj_to_model(r.data);return s.folder_repository.set(t.id,t),void s.push_message(new FoldersAddSuccess)}throw new folder_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},update_folder=async(t,s)=>{const a=new UpdateFolderRequest({id:t.id,name:t.name,storage_path:t.storage_path,master_usergroup_slug:t.master_usergroup_slug,access_group:t.access_group,settings:t.settings}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof UpdateFolderResponse){const t=convert_folder_response_obj_to_model(r.data);return s.folder_repository.set(t.id,t),void s.push_message(new FoldersUpdateSuccess)}throw new folder_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},delete_folder=async(t,s)=>{const a=new DeleteFolderRequest({id:t.id}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof DeleteFolderResponse)return s.folder_repository.delete(t.id),void s.push_message(new FoldersDeleteSuccess);throw new folder_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},convert_user_folder_settings_to_model=t=>new Wt.jy(t.id,t.folder,t.usergroup,t.user,t.role,t.search_schema),get_user_folder_settings=async(t,s)=>{const a=new GetUserFolderSettingsRequest,r=await s.api.call(a);if(r instanceof NegativeResponse)s.push_message(new ApiError(r.data.code));else{if(!(r instanceof GetUserFolderSettingsResponse))throw new folder_handlers_WrongResponseError;r.data.forEach((t=>{const a=convert_user_folder_settings_to_model(t);s.user_folder_settings_repository.set(a.id,a)}))}},add_user_folder_settings=async(t,s)=>{const a=new AddUserFolderSettingsRequest({folder_id:t.folder_id,usergroup_slug:t.usergroup_slug,username:t.username,role:t.role,search_schema:t.search_schema}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof AddUserFolderSettingsResponse){const t=convert_user_folder_settings_to_model(r.data);return s.user_folder_settings_repository.set(t.id,t),void s.push_message(new AddUserFolderSettingsSuccess)}throw new folder_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},set_user_folder_settings=async(t,s)=>{const a=new UpdateUserFolderSettingsRequest({id:t.id,folder_id:t.folder_id,usergroup_slug:t.usergroup_slug,username:t.username,role:t.role,search_schema:t.search_schema}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof UpdateUserFolderSettingsResponse){const t=convert_user_folder_settings_to_model(r.data);return s.user_folder_settings_repository.set(t.id,t),void s.push_message(new UpdateUserFolderSettingsSuccess)}throw new folder_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},delete_user_folder_settings=async(t,s)=>{const a=new DeleteUserFolderSettingsRequest({id:t.id}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof DeleteUserFolderSettingsResponse)return s.user_folder_settings_repository.delete(t.id),void s.push_message(new DeleteUserFolderSettingsSuccess);throw new folder_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},get_user_search_schema=async(t,s)=>{const a=new GetUserSearchSchemaRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id}),r=await s.api.call(a);if(r instanceof NegativeResponse)s.push_message(new ApiError(r.data.code));else{if(!(r instanceof GetUserSearchSchemaResponse))throw new folder_handlers_WrongResponseError;s.folder_repository.set_user_search_schema(t.folder_id,r.data)}},set_user_search_schema=async(t,s)=>{const a=new SetUserSearchSchemaRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,search_schema:t.search_schema}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof SetUserSearchSchemaResponse)return s.folder_repository.set_user_search_schema(t.folder_id,t.search_schema),void s.push_message(new SetUserSearchSchemaSuccess);throw new folder_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},delete_user_search_schema=async(t,s)=>{const a=new DeleteUserSearchSchemaRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof DeleteUserSearchSchemaResponse)return s.folder_repository.delete_user_search_schema(t.folder_id),void s.push_message(new SetUserSearchSchemaSuccess);throw new folder_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))};a(2801),a(1295);class document_handlers_WrongResponseError extends Error{}const convert_doc_response_obj_to_model=(t,s)=>{const a=t.files.map((t=>{const s=new Wt.m5(t.id,t.name,t.size);return s.set_size(t.size),s})),r=new Wt.BB(t.id,t.folder_id,t.usergroup_id,s,t.union,t.created_at?new Date(t.created_at):t.created_at,t.updated_at?new Date(t.updated_at):t.updated_at);return Object.keys(t.data).forEach((s=>r.set_attribute(s,t.data[s]))),a.forEach((t=>{r.add_file(t.id,t)})),r.is_blocked=t.is_blocked,r.description=t.description,r},get_document=async(t,s)=>{const a=s.folder_repository.get(t.folder_id),r=new GetDocumentRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_id:t.document_id}),o=await s.api.call(r);if(!(o instanceof NegativeResponse)){if(o instanceof GetDocumentResponse){const r=convert_doc_response_obj_to_model(o.data,!1);return r.description_pattern=a.value.description_pattern,void s.push_message(new AddDocumentModel(t.folder_id,t.usergroup_id,r,!1))}throw new document_handlers_WrongResponseError}s.push_message(new ApiError(o.data.code))},get_many_documents=async(t,s)=>{s.doc_repository.reset(t.folder_id);const a=s.folder_repository.get(t.folder_id),r=structuredClone(t.query);t.limit&&(r["_LIMIT"]=t.limit),t.offset&&(r["_OFFSET"]=t.offset),t.sort_by&&(r["_SORT_BY"]=t.sort_by),!1===t.sort_asc&&(r["_SORT_ASC"]="DESC"),t.sort_rule&&"DEFAULT"!==t.sort_rule&&(r["_SORT_RULE"]=t.sort_rule);const o=new GetManyDocumentsRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,query:r}),n=await s.api.call(o);if(!(n instanceof NegativeResponse)){if(n instanceof GetManyDocumentsResponse)return n.data.documents.forEach((r=>{const o=convert_doc_response_obj_to_model(r,!1);o.description_pattern=a.value.description_pattern,s.push_message(new AddDocumentModel(t.folder_id,t.usergroup_id,o,!1))})),void s.doc_repository.set_count(n.data.count);throw new document_handlers_WrongResponseError}s.push_message(new ApiError(n.data.code))},set_document_attribute=(t,s)=>{s.doc_repository.is_blocked(t.folder_id,t.document_id)||(s.doc_repository.set_attribute(t.folder_id,t.document_id,t.name,t.value,t.to_be_decoded),s.doc_repository.mark_as_modified(t.folder_id,t.document_id),s.push_message(new DocumentAttributesChanged(t.folder_id,t.usergroup_id,t.document_id)))},save_documents_in_folder=async(t,s)=>{const a=s.doc_repository.pure_keys(t.folder_id);let r=[],o=[];const handle_function=async a=>{const n=s.doc_repository.is_deleted(t.folder_id,a);if(n){const o=s.doc_repository.is_created_first_time(t.folder_id,a);return o?s.doc_repository.delete(t.folder_id,a):r.push(a),!0}const i=s.doc_repository.is_saved(t.folder_id,a);if(!i){const r=s.doc_repository.get(t.folder_id,a).value,n=r.raw_attributes,i=r.files.map((t=>t.id));o.push({id:a,union:r.union,data:n,description:r.description,files:i})}};if(!a.every((a=>s.doc_repository.uploaded(t.folder_id,a))))return s.push_message(new DocumentFilesAreUploading),!1;a.forEach((a=>{s.doc_repository.is_blocked(t.folder_id,a)||handle_function(a)})),r.length>0&&await s.push_message(new DeleteManyDocuments(t.folder_id,t.usergroup_id,r)),o.length>0&&await s.push_message(new SaveManyDocuments(t.folder_id,t.usergroup_id,o))},save_many_documents=async(t,s)=>{const a=s.folder_repository.get(t.folder_id),r=new SaveManyDocumentsRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,docs:t.docs}),o=await s.api.call(r);if(o instanceof NegativeResponse)return s.push_message(new ApiError(o.data.code)),!1;if(o instanceof SaveManyDocumentsResponse)return o.data.forEach((r=>{const o=convert_doc_response_obj_to_model(r);o.description_pattern=a.value.description_pattern,s.doc_repository.set(t.folder_id,r.id,o),s.doc_repository.mark_as_saved(t.folder_id,r.id)})),s.push_message(new SaveManyDocumentsSuccess),!0;throw new document_handlers_WrongResponseError},mark_document_as_deleted=(t,s)=>{s.doc_repository.is_blocked(t.folder_id,t.document_id)||(s.doc_repository.files(t.folder_id,t.document_id).forEach((a=>{s.file_in_folder_repository.set(t.folder_id,a.id,a)})),s.doc_repository.mark_as_deleted(t.folder_id,t.document_id))},mark_document_as_not_deleted=(t,s)=>{s.doc_repository.is_blocked(t.folder_id,t.document_id)||(s.doc_repository.files(t.folder_id,t.document_id).forEach((a=>{s.file_in_folder_repository.delete(t.folder_id,a.id)})),s.doc_repository.mark_as_not_deleted(t.folder_id,t.document_id))},delete_many_documents=async(t,s)=>{const a=new DeleteManyDocumentsRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,ids:t.document_ids}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof DeleteManyDocumentsResponse)return t.document_ids.forEach((a=>s.doc_repository.delete(t.folder_id,a))),s.push_message(new DeleteManyDocumentsSuccess),!0;throw new document_handlers_WrongResponseError},add_document=(t,s)=>{const a=convert_doc_response_obj_to_model({id:t.document_id,folder_id:t.folder_id,usergroup_id:t.usergroup_id,union:t.union_id,data:t.attributes,files:t.files,is_blocked:t.is_blocked},t.is_created_first_time),r=s.folder_repository.get(t.folder_id);a.description_pattern=r.value.description_pattern;const o=Math.floor(Date.now()/1e3);a.set_attribute("_CREATED_AT_DATE",o),a.set_attribute("_UPDATED_AT_DATE",o),s.push_message(new AddDocumentModel(t.folder_id,t.usergroup_id,a,t.mark_as_modified))},add_document_model=(t,s)=>{s.doc_repository.set(t.folder_id,t.doc.id,t.doc),t.doc.files.forEach((t=>s.file_common_repository.set(t.id,t))),!0===t.mark_as_modified&&s.doc_repository.mark_as_modified(t.folder_id,t.doc.id)},duplicate_document_to_usergroup=async(t,s)=>{const a=new DuplicateDocumentToUsergroupRequest({folder_id:t.folder_id,source_usergroup_id:t.source_usergroup_id,target_usergroup_id:t.target_usergroup_id,document_id:t.document_id}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof DuplicateDocumentToUsergroupResponse){const a=s.doc_repository.get(t.folder_id,t.document_id),o=convert_doc_response_obj_to_model(r.data,!1);return a.value.add_clone(o),s.push_message(new DuplicateDocumentToUsergroupSuccess),!0}throw new document_handlers_WrongResponseError},duplicate_many_documents_to_usergroup=async(t,s)=>{const a=new DuplicateManyDocumentsToUsergroupRequest({folder_id:t.folder_id,source_usergroup_id:t.source_usergroup_id,target_usergroup_id:t.target_usergroup_id,document_ids:t.document_ids}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof DuplicateManyDocumentsToUsergroupResponse)return s.push_message(new DuplicateManyDocumentsToUsergroupSuccess),!0;throw new document_handlers_WrongResponseError},get_document_attributes_context=(t,s)=>{if(!s.doc_repository.is_saved(t.folder_id,t.document_id))return;const a=s.doc_repository.get(t.folder_id,t.document_id),r=t.is_raw?a.value.raw_attributes:a.value.attributes;s.context_repository.set(t.ctx_id,t.ctx_name,r)},get_document_previous_attribute_context=async(t,s)=>{if(!s.doc_repository.is_saved(t.folder_id,t.document_id))return;const a=s.folder_repository.get(t.folder_id),r=a.value.master_usergroup_slug;let o=""===r?null:s.usergroup_repository.get_id_by_slug(r);null===o&&(o=t.usergroup_id);const n=new GetPreviousDocumentsRequest({folder_id:t.folder_id,usergroup_id:o,document_id:t.document_id,count:t.count}),i=await s.api.call(n);if(i instanceof NegativeResponse)s.push_message(new ApiError(i.data.code));else{if(!(i instanceof GetPreviousDocumentsResponse))throw new document_handlers_WrongResponseError;{const a=i.data.map((t=>convert_doc_response_obj_to_model(t,!1))),r=a.map((s=>t.is_raw?s.raw_attributes[t.attribute_name]:s.attributes[t.attribute_name]));s.context_repository.set(t.ctx_id,t.ctx_name,r.filter((t=>void 0!==t)))}}},get_extension_of_file=t=>t.split(".").pop()||"",js_download_file=({data:t,filename:s,mime:a,bom:r,inline:o=!1})=>{const n="application/pdf"===a||"pdf"==get_extension_of_file(s).toLowerCase(),i="text/html"===a||"html"===get_extension_of_file(s).toLowerCase(),_="undefined"!==typeof r?[r,t]:[t];!a&&n&&(a="application/pdf"),!a&&i&&(a="text/html");const l=new Blob(_,{type:a});if("undefined"!==typeof window.navigator.msSaveBlob)window.navigator.msSaveBlob(l,s);else{var d=window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(l):window.webkitURL.createObjectURL(l);const t=document.createElement("a");t.style.display="none",t.href=d;const a=document.createElement("title");a.innerText=s,"undefined"===typeof t.download&&t.setAttribute("target","_blank"),!0===o&&(n||i)?t.addEventListener("click",(function(t){t.preventDefault();let s=window.open(d,"_blank");s.onload=()=>s.document.head.appendChild(a)})):t.setAttribute("download",s),document.body.appendChild(t),t.click(),setTimeout((function(){document.body.removeChild(t),window.URL.revokeObjectURL(d)}),5e3)}};class document_action_handlers_WrongResponseError extends Error{}const push_document_button=async(t,s)=>{const a=new PushDocumentButtonRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_id:t.document_id,action:t.action}),r=await s.api.call(a);if(r instanceof NegativeResponse)s.push_message(new ApiError(r.data.code));else{if(!(r instanceof PushDocumentButtonResponse))throw new document_action_handlers_WrongResponseError;s.push_message(new DocumentButtonPushed)}},handler_1882_dlenc_transmittal=async(t,s,a,r,o)=>{const n=new DownloadTransmittalCoverSheetRequest({folder_id:a,usergroup_id:r,document_ids:o,template:"1882_dlenc"}),i=await t.api.call(n);if(i instanceof NegativeResponse)t.push_message(new ApiError(i.data.code));else{if(!(i instanceof DownloadTransmittalCoverSheetResponse))throw new document_action_handlers_WrongResponseError;js_download_file({data:i.data.file,filename:i.data.name})}},perform_action_on_documents=async(t,s)=>{const a={"1882_dlenc_transmittal":handler_1882_dlenc_transmittal},r=a[t.handler];await r(s,t.username,t.folder_id,t.usergroup_id,t.document_ids)};class document_approval_handlers_WrongResponseError extends Error{}const convert_approval_response_obj_to_model=t=>{const s=t.files.map((t=>{const s=new Wt.m5(t.id,t.name,t.size);return s.set_size(t.size),s})),a=new Wt.l2(t.id,t.state,t.created_by.username,t.created_by.first_name,t.created_by.last_name,t.user.username,t.user.first_name,t.user.last_name,t.delegated_from,new Date(t.created_at),new Date(t.updated_at));return s.forEach((t=>{a.add_file(t.id,t)})),t.document&&(a.document=convert_doc_response_obj_to_model(t.document)),t.active_approvals_count_of_document&&(a.active_approvals_count_of_document=t.active_approvals_count_of_document),a},get_many_documents_approvals=async(t,s)=>{s.search_doc_approval_repository.reset_keeping_refs();const a=structuredClone(t.query);t.limit&&(a["_LIMIT"]=t.limit),t.offset&&(a["_OFFSET"]=t.offset),t.sort_by&&(a["_SORT_BY"]=t.sort_by),!1===t.sort_asc&&(a["_SORT_ASC"]="DESC");const r=new GetManyDocumentsApprovalsRequest({query:a}),o=await s.api.call(r);if(!(o instanceof NegativeResponse)){if(o instanceof GetManyDocumentsApprovalsResponse)return o.data.approvals.forEach((t=>{const a=convert_approval_response_obj_to_model(t);s.search_doc_approval_repository.set(a.id,a)})),void s.search_doc_approval_repository.set_count(o.data.count);throw new document_approval_handlers_WrongResponseError}s.push_message(new ApiError(o.data.code))},get_document_approvals=async(t,s)=>{s.doc_approval_repository.reset_keeping_refs(t.document_id);const a=new GetDocumentApprovalsRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_id:t.document_id}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof GetDocumentApprovalsResponse)return r.data.forEach((a=>{const r=convert_approval_response_obj_to_model(a);s.doc_approval_repository.set(t.document_id,r.id,r)})),!0;throw new document_approval_handlers_WrongResponseError},add_document_approval=async(t,s)=>{const a=new AddDocumentApprovalRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_id:t.document_id,username:t.username}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof AddDocumentApprovalResponse){const a=convert_approval_response_obj_to_model(r.data);return s.doc_approval_repository.set(t.document_id,a.id,a),s.push_message(new DocumentApprovalAddedSuccess),!0}throw new document_approval_handlers_WrongResponseError},update_document_approval=async(t,s)=>{const a=s.doc_approval_file_repository.pure_keys(),r=new UpdateDocumentApprovalRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_id:t.document_id,approval_id:t.approval_id,state:t.state,files:a,comments:t.comments.replace(/<(div|br)>/g,"\n").replace(/<(.|\n)*?>/g,"")}),o=await s.api.call(r);if(o instanceof NegativeResponse)return s.push_message(new ApiError(o.data.code)),!1;if(o instanceof UpdateDocumentApprovalResponse){const a=convert_approval_response_obj_to_model(o.data);return s.doc_approval_repository.set(t.document_id,t.approval_id,a),s.waiting_doc_approval_repository.delete(t.approval_id),s.push_message(new DocumentApprovalUpdatedSuccess),s.push_message(new GetDocumentApprovalSpareFiles(t.folder_id,t.usergroup_id,t.document_id)),!0}throw new document_approval_handlers_WrongResponseError},delete_document_approval=async(t,s)=>{const a=new DeleteDocumentApprovalRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_id:t.document_id,approval_id:t.approval_id}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof DeleteDocumentApprovalResponse)return s.doc_approval_repository.delete(t.document_id,t.approval_id),s.push_message(new DocumentApprovalDeletedSuccess),!0;throw new document_approval_handlers_WrongResponseError},delegate_document_approval=async(t,s)=>{const a=new DelegateDocumentApprovalRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_id:t.document_id,approval_id:t.approval_id,username:t.username,with_return:t.with_return}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof DelegateDocumentApprovalResponse)return r.data.forEach((a=>{const r=convert_approval_response_obj_to_model(a);s.doc_approval_repository.set(t.document_id,r.id,r),s.waiting_doc_approval_repository.set(r.id,r)})),!1===t.with_return&&s.waiting_doc_approval_repository.delete(t.approval_id),s.push_message(new DocumentApprovalDelegatedSuccess),!0;throw new document_approval_handlers_WrongResponseError},get_document_approval_spare_files=async(t,s)=>{s.doc_approval_file_repository.reset();const a=new GetDocumentApprovalSpareFilesRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_id:t.document_id}),r=await s.api.call(a);r instanceof NegativeResponse?s.push_message(new ApiError(r.data.code)):r instanceof GetDocumentApprovalSpareFilesResponse&&r.data.forEach((t=>{const a=new Wt.m5(t.id,t.name,t.size);s.file_common_repository.set(t.id,a),s.file_common_repository.set_size_complete(t.id),s.doc_approval_file_repository.set(t.id,a)}))},upload_document_approval_file=async(t,s)=>{const a=new Wt.m5(t.file_id,t.file.name,t.file.size);s.file_common_repository.set(t.file_id,a),s.doc_approval_file_repository.set(t.file_id,a),s.upload_progress_timer.add(t.file_id);const r=new UploadDocumentApprovalFileRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_id:t.document_id,file_id:t.file_id,original_file:t.file});let o=null;try{o=await s.api.call(r)}catch(n){s.push_message(new UploadFileError(t.file.name)),console.log(n)}if(s.upload_progress_timer.remove(t.file_id),o instanceof NegativeResponse)return s.doc_approval_file_repository.delete(t.file_id),s.file_common_repository.delete(t.file_id),void s.push_message(new ApiError(o.data.code));if(o instanceof UploadDocumentApprovalFileResponse)return s.file_common_repository.set_size_complete(t.file_id),void s.push_message(new UploadFileSuccess);throw s.doc_approval_file_repository.delete(t.file_id),s.file_common_repository.delete(t.file_id),new document_approval_handlers_WrongResponseError},delete_document_approval_file=async(t,s)=>{const a=new DeleteDocumentApprovalFileRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_id:t.document_id,file_id:t.file_id}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof DeleteDocumentApprovalFileResponse)return s.doc_approval_file_repository.delete(t.file_id),s.file_common_repository.delete(t.file_id),void s.push_message(new FileDeletedSuccess);throw new document_approval_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},get_waiting_document_approvals=async(t,s)=>{s.waiting_doc_approval_repository.reset_keeping_refs();const a=new GetWaitingDocumentApprovalsRequest,r=await s.api.call(a);if(r instanceof NegativeResponse)s.push_message(new ApiError(r.data.code));else{if(!(r instanceof GetWaitingDocumentApprovalsResponse))throw new document_approval_handlers_WrongResponseError;r.data.forEach((t=>{const a=convert_approval_response_obj_to_model(t);s.waiting_doc_approval_repository.set(a.id,a)}))}};class document_approval_flow_handlers_WrongResponseError extends Error{}const convert_approval_flow_response_obj_to_model=t=>{const s=new Wt.GX(t.id,t.is_active,t.success,t.steps,new Date(t.created_at),new Date(t.updated_at));return s},create_document_approval_flow=(t,s)=>{const a=new Date;s.doc_approval_flow_repository.set(t.document_id,new Wt.GX(null,!1,!1,[[]],a,a))},add_document_approval_flow_step=(t,s)=>{const a=s.doc_approval_flow_repository.get(t.document_id);a.value.add_step()},delete_document_approval_flow_step=(t,s)=>{const a=s.doc_approval_flow_repository.get(t.document_id);a.value.delete_step(t.index)},attach_user_to_document_approval_flow_step=(t,s)=>{const a=s.doc_approval_flow_repository.get(t.document_id);a.value.add_username_to_step(t.index,t.username)},delete_user_from_document_approval_flow_step=(t,s)=>{const a=s.doc_approval_flow_repository.get(t.document_id);a.value.delete_username_from_step(t.index,t.username)},get_document_approval_flow=async(t,s)=>{const a=new GetDocumentApprovalFlowRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_id:t.document_id}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof GetDocumentApprovalFlowResponse){const a=null===r.data?null:convert_approval_flow_response_obj_to_model(r.data);return s.doc_approval_flow_repository.set(t.document_id,a),!0}throw new document_approval_flow_handlers_WrongResponseError},set_document_approval_flow=async(t,s)=>{const a=s.doc_approval_flow_repository.get(t.document_id);if(a.value.flush_empty_steps(),0===a.value.steps.length)return void s.push_message(new EmptyApprovalFlowSaved);const r=new SetDocumentApprovalFlowRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_id:t.document_id,steps:a.value.steps}),o=await s.api.call(r);if(o instanceof NegativeResponse)return s.push_message(new ApiError(o.data.code)),!1;if(o instanceof SetDocumentApprovalFlowResponse){const a=null===o.data?null:convert_approval_flow_response_obj_to_model(o.data);return s.doc_approval_flow_repository.set(t.document_id,a),!0}throw new document_approval_flow_handlers_WrongResponseError},start_document_approval_flow=async(t,s)=>{const a=new StartDocumentApprovalFlowRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_id:t.document_id}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof StartDocumentApprovalFlowResponse){const a=null===r.data?null:convert_approval_flow_response_obj_to_model(r.data);return s.doc_approval_flow_repository.set(t.document_id,a),s.push_message(new ApprovalFlowStarted),!0}throw new document_approval_flow_handlers_WrongResponseError},stop_document_approval_flow=async(t,s)=>{const a=new StopDocumentApprovalFlowRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_id:t.document_id}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof StopDocumentApprovalFlowResponse){const a=null===r.data?null:convert_approval_flow_response_obj_to_model(r.data);return s.doc_approval_flow_repository.set(t.document_id,a),s.push_message(new ApprovalFlowStopped),!0}throw new document_approval_flow_handlers_WrongResponseError};class cart_handlers_WrongResponseError extends Error{}const empty_cart=async(t,s)=>{const a=new EmptyCartRequest,r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof EmptyCartResponse)return s.cart_repository.reset_keeping_refs_for_docs(),!0;throw new cart_handlers_WrongResponseError},get_cart_documents=async(t,s)=>{const a=new GetCartDocumentsRequest,r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof GetCartDocumentsResponse)return r.data.forEach((t=>{const a=convert_doc_response_obj_to_model(t);s.cart_repository.set_doc(a.id,a)})),!0;throw new cart_handlers_WrongResponseError},add_document_to_cart=async(t,s)=>{const a=new AddDocumentToCartRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_id:t.document_id}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof AddDocumentToCartResponse){const t=convert_doc_response_obj_to_model(r.data);return s.cart_repository.set_doc(t.id,t),s.push_message(new DocumentAddedToCartSuccess),!0}throw new cart_handlers_WrongResponseError},add_many_documents_to_cart=async(t,s)=>{const a=new AddManyDocumentsToCartRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_ids:t.document_ids}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof AddManyDocumentsToCartResponse)return r.data.forEach((t=>{const a=convert_doc_response_obj_to_model(t);s.cart_repository.set_doc(a.id,a)})),s.push_message(new ManyDocumentsAddedToCartSuccess),!0;throw new cart_handlers_WrongResponseError},remove_document_from_cart=async(t,s)=>{const a=new RemoveDocumentFromCartRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_id:t.document_id}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof RemoveDocumentFromCartResponse)return s.cart_repository.delete_doc(t.document_id),s.push_message(new DocumentRemovedFromCartSuccess),!0;throw new cart_handlers_WrongResponseError};class server_settings_handlers_WrongResponseError extends Error{}const convert_server_setting_response_obj_to_model=t=>new Wt.Lt(t.id,t.name,t.value),get_server_settings=async(t,s)=>{const a=new GetServerSettingsRequest({}),r=await s.api.call(a);if(r instanceof NegativeResponse)s.push_message(new ApiError(r.data.code));else{if(!(r instanceof GetServerSettingsResponse))throw new server_settings_handlers_WrongResponseError;r.data.forEach((t=>{const a=convert_server_setting_response_obj_to_model(t);s.server_setting_repository.set(a.id,a)}))}},update_server_setting=async(t,s)=>{const a=new UpdateServerSettingRequest({id:t.id,value:t.value}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof UpdateServerSettingResponse){const t=convert_server_setting_response_obj_to_model(r.data);return s.server_setting_repository.set(t.id,t),void s.push_message(new ServerSettingUpdatedSuccess)}throw new server_settings_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))};var Gt=a(5934);class mail_handlers_WrongResponseError extends Error{}const convert_mailbox_response_obj_to_model=t=>{const s=new Wt.tr(t.id,t.out_protocol,t.out_encryption,t.out_port,t.out_server,t.in_protocol,t.in_encryption,t.in_port,t.in_server,t.username,t.password,t.name);return t.mailchannels&&t.mailchannels.forEach((t=>{const a=convert_mail_channel_response_obj_to_model(t);s.add_mail_channel(a)})),s},get_mailboxes=async(t,s)=>{s.mailbox_repository.reset_keeping_refs();const a=new GetMailBoxesRequest({}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof GetMailBoxesResponse)return r.data.forEach((t=>{const a=convert_mailbox_response_obj_to_model(t);s.mailbox_repository.set(a.id,a)})),!0;throw new mail_handlers_WrongResponseError},add_mailbox=async(t,s)=>{const a=new AddMailBoxRequest({out_protocol:t.out_protocol,out_encryption:t.out_encryption,out_port:t.out_port,out_server:t.out_server,in_protocol:t.in_protocol,in_encryption:t.in_encryption,in_port:t.in_port,in_server:t.in_server,username:t.username,password:t.password,name:t.name}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof AddMailBoxResponse){const t=convert_mailbox_response_obj_to_model(r.data);return s.mailbox_repository.set(t.id,t),s.push_message(new MailBoxAddedSuccess),!0}throw new mail_handlers_WrongResponseError},update_mailbox=async(t,s)=>{const a=new UpdateMailBoxRequest({id:t.id,out_protocol:t.out_protocol,out_encryption:t.out_encryption,out_port:t.out_port,out_server:t.out_server,in_protocol:t.in_protocol,in_encryption:t.in_encryption,in_port:t.in_port,in_server:t.in_server,username:t.username,password:t.password,name:t.name}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof UpdateMailBoxResponse){const t=convert_mailbox_response_obj_to_model(r.data);return s.mailbox_repository.set(t.id,t),s.push_message(new MailBoxUpdatedSuccess),!0}throw new mail_handlers_WrongResponseError},delete_mailbox=async(t,s)=>{const a=new DeleteMailBoxRequest({id:t.id}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof DeleteMailBoxResponse)return s.mailbox_repository.delete(t.id),s.push_message(new MailBoxDeletedSuccess),!0;throw new mail_handlers_WrongResponseError},convert_mail_channel_response_obj_to_model=t=>{const s=new Wt.C2(t.id,t.name,t.folder,t.storage_path,t.settings,t.is_active);return s},get_mail_channels=async(t,s)=>{s.mail_channel_repository.reset_keeping_refs();const a=new GetMailChannelsRequest({}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof GetMailChannelsResponse)return r.data.forEach((t=>{const a=convert_mail_channel_response_obj_to_model(t);s.mail_channel_repository.set(a.id,a)})),!0;throw new mail_handlers_WrongResponseError},add_mail_channel=async(t,s)=>{const a=new AddMailChannelRequest({name:t.name,folder:t.folder,storage_path:t.storage_path,settings:t.settings,is_active:t.is_active}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof AddMailChannelResponse){const t=convert_mail_channel_response_obj_to_model(r.data);return s.mail_channel_repository.set(t.id,t),s.push_message(new MailChannelAddedSuccess),!0}throw new mail_handlers_WrongResponseError},update_mail_channel=async(t,s)=>{const a=new UpdateMailChannelRequest({id:t.id,name:t.name,folder:t.folder,storage_path:t.storage_path,settings:t.settings,is_active:t.is_active}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof UpdateMailChannelResponse){const t=convert_mail_channel_response_obj_to_model(r.data);return s.mail_channel_repository.set(t.id,t),s.push_message(new MailChannelUpdatedSuccess),!0}throw new mail_handlers_WrongResponseError},delete_mail_channel=async(t,s)=>{const a=new DeleteMailChannelRequest({id:t.id}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof DeleteMailChannelResponse)return s.mail_channel_repository.delete(t.id),s.push_message(new MailChannelDeletedSuccess),!0;throw new mail_handlers_WrongResponseError},add_mail_channel_to_mailbox=async(t,s)=>{const a=new AddMailChannelToMailBoxRequest({mailbox_id:t.mailbox_id,mailchannel_id:t.mailchannel_id}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof AddMailChannelToMailBoxResponse){const t=convert_mailbox_response_obj_to_model(r.data);return s.mailbox_repository.set(t.id,t),s.push_message(new MailBoxUpdatedSuccess),!0}throw new mail_handlers_WrongResponseError},delete_mail_channel_from_mailbox=async(t,s)=>{const a=new DeleteMailChannelFromMailBoxRequest({mailbox_id:t.mailbox_id,mailchannel_id:t.mailchannel_id}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof DeleteMailChannelFromMailBoxResponse){const t=convert_mailbox_response_obj_to_model(r.data);return s.mailbox_repository.set(t.id,t),s.push_message(new MailBoxUpdatedSuccess),!0}throw new mail_handlers_WrongResponseError},fetch_mail_channel=async(t,s)=>{const a=new FetchMailChannelRequest({id:t.id}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof FetchMailChannelResponse)return s.push_message(new MailChannelFetchedSuccess),!0;throw new mail_handlers_WrongResponseError},convert_mail_message_response_obj_to_model=t=>{const s=t.attachments.map((t=>{const s=new Wt.m5(t.id,t.name,t.size);return s.set_size(t.size),s})),a=new Wt.Rb(t.id,t.subject,t.address_from,t.address_to,t.address_cc,t.address_bcc,new Date(t.received_at),t.mailbox,t.mailchannel,t.has_text,t.has_html);return s.forEach((t=>{a.add_attachment(t.id,t)})),a},get_mail_messages=async(t,s)=>{s.mail_message_repository.reset_keeping_refs();const a=new GetMailMessagesRequest({query:t.query}),r=await s.api.call(a);if(r instanceof NegativeResponse)s.push_message(new ApiError(r.data.code));else{if(!(r instanceof GetMailMessagesResponse))throw new mail_handlers_WrongResponseError;r.data.forEach((t=>s.mail_message_repository.set(t.id,convert_mail_message_response_obj_to_model(t))))}},delete_mail_message=async(t,s)=>{const a=new DeleteMailMessageRequest({id:t.id}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof DeleteMailMessageResponse)return s.mail_message_repository.delete(t.id),s.push_message(new MailMessageDeletedSuccess),!0;throw new mail_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},download_mail_message=async(t,s)=>{const a=(0,Gt.Z)(),r=new Wt.m5(a,"AAAAA",1e3);s.download_progress.set(a,r);const o=new DownloadMailMessageRequest({set_size_method:t=>s.download_progress.set_size(a,t),id:t.id,format:t.format}),n=await s.api.call(o);if(n instanceof NegativeResponse)s.push_message(new ApiError(n.data.code));else{if(!(n instanceof DownloadMailMessageResponse))throw new mail_handlers_WrongResponseError;js_download_file({data:n.data.file,filename:n.data.name})}},download_mail_message_attachment=async(t,s)=>{const a=(0,Gt.Z)(),r=new Wt.m5(a,t.name,t.size);s.download_progress.set(a,r);const o=new DownloadMailMessageAttachmentRequest({set_size_method:t=>s.download_progress.set_size(a,t),message_id:t.message_id,id:t.id}),n=await s.api.call(o);if(n instanceof NegativeResponse)s.push_message(new ApiError(n.data.code));else{if(!(n instanceof DownloadMailMessageAttachmentResponse))throw new mail_handlers_WrongResponseError;js_download_file({data:n.data.file,filename:n.data.name,inline:t.inline})}};a(8675),a(7380),a(1118);var Zt=a(7869),Ht=a.n(Zt);class file_handlers_WrongResponseError extends Error{}const upload_file_to_folder=async(t,s)=>{const a=new Wt.m5(t.file_id,t.file.name,t.file.size);s.file_in_folder_repository.set(t.folder_id,t.file_id,a),s.file_common_repository.set(t.file_id,a),s.upload_progress_timer.add(t.file_id);const r=new UploadFileToFolderRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,id:t.file_id,original_file:t.file});let o=null;try{o=await s.api.call(r)}catch(n){s.push_message(new UploadFileError(t.file.name)),console.log(n)}if(s.upload_progress_timer.remove(t.file_id),o instanceof NegativeResponse)return s.file_in_folder_repository.delete(t.folder_id,t.file_id),s.file_common_repository.delete(t.file_id),void s.push_message(new ApiError(o.data.code));if(o instanceof UploadFileToFolderResponse)return s.file_common_repository.set_size_complete(t.file_id),void s.push_message(new UploadFileSuccess);throw s.file_in_folder_repository.delete(t.folder_id,t.file_id),s.file_common_repository.delete(t.file_id),new file_handlers_WrongResponseError},download_file_from_folder=async(t,s)=>{const a=(0,Gt.Z)(),r=new Wt.m5(a,t.name,t.size);s.download_progress.set(a,r);const o=new DownloadFileFromFolderRequest({set_size_method:t=>s.download_progress.set_size(a,t),folder_id:t.folder_id,usergroup_id:t.usergroup_id,id:t.file_id}),n=await s.api.call(o);if(n instanceof NegativeResponse)s.push_message(new ApiError(n.data.code));else{if(!(n instanceof DownloadFileFromFolderResponse))throw new file_handlers_WrongResponseError;js_download_file({data:n.data.file,filename:n.data.name,inline:t.inline})}},download_many_documents_files_as_archive=async(t,s)=>{const a=(0,Gt.Z)(),r=new Wt.m5(a,"AAAAA",t.size);s.download_progress.set(a,r);const o=new DownloadManyDocumentsFilesAsArchiveRequest({set_size_method:t=>s.download_progress.set_size(a,t),folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_ids:t.document_ids}),n=await s.api.call(o);if(n instanceof NegativeResponse)s.push_message(new ApiError(n.data.code));else{if(!(n instanceof DownloadManyDocumentsFilesAsArchiveResponse))throw new file_handlers_WrongResponseError;js_download_file({data:n.data.file,filename:n.data.name})}},download_document_files_as_archive=async(t,s)=>{const a=(0,Gt.Z)(),r=new Wt.m5(a,"AAAAA",t.size);s.download_progress.set(a,r);const o=new DownloadDocumentFilesAsArchiveRequest({set_size_method:t=>s.download_progress.set_size(a,t),folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_id:t.document_id}),n=await s.api.call(o);if(n instanceof NegativeResponse)s.push_message(new ApiError(n.data.code));else{if(!(n instanceof DownloadDocumentFilesAsArchiveResponse))throw new file_handlers_WrongResponseError;js_download_file({data:n.data.file,filename:n.data.name})}},get_file_info=async(t,s)=>{const a=new GetFileInfoRequest({id:t.file_id}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof GetFileInfoResponse)return r.data;throw new file_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},delete_file_from_folder=async(t,s)=>{const delete_file_func=()=>{s.file_in_folder_repository.delete(t.folder_id,t.file_id),s.file_common_repository.delete(t.file_id),s.push_message(new FileDeletedSuccess)};if(s.doc_repository.file_in_repository(t.folder_id,t.file_id))return void delete_file_func();const a=new DeleteFileFromFolderRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,id:t.file_id}),r=await s.api.call(a);if(r instanceof NegativeResponse)s.push_message(new ApiError(r.data.code));else{if(!(r instanceof DeleteFileFromFolderResponse))throw new file_handlers_WrongResponseError;delete_file_func()}},update_file_from_folder=async(t,s)=>{const a=new UpdateFileFromFolderRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,id:t.file_id,name:t.name}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof UpdateFileFromFolderResponse){const a=s.file_common_repository.get(t.file_id);return a.value.rename(r.data.name),void s.push_message(new FileUpdatedSuccess)}throw new file_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},flush_file_container=(t,s)=>{s.file_in_folder_repository.pure_keys(t.folder_id).forEach((a=>s.push_message(new DeleteFileFromFolder(t.folder_id,t.usergroup_id,a))))},get_spare_files=async(t,s)=>{s.file_in_folder_repository.reset(t.folder_id);const a=new GetSpareFilesRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id}),r=await s.api.call(a);if(r instanceof NegativeResponse)s.push_message(new ApiError(r.data.code));else{if(!(r instanceof GetSpareFilesResponse))throw new file_handlers_WrongResponseError;r.data.forEach((a=>{const r=new Wt.m5(a.id,a.name,a.size);r.set_size(a.size),s.file_in_folder_repository.set(t.folder_id,a.id,r),s.file_common_repository.set(a.id,r)}))}},update_upload_progress=async(t,s)=>{const a=new GetUploadProgressRequest({}),r=await s.api.call(a);if(r instanceof NegativeResponse)s.push_message(new ApiError(r.data.code));else{if(!(r instanceof GetUploadProgressResponse))throw new file_handlers_WrongResponseError;r.data.forEach((t=>{s.file_common_repository.set_size(t.file_id,t.loaded)}))}},download_excel_file=async t=>{function s2ab(t){for(var s=new ArrayBuffer(t.length),a=new Uint8Array(s),r=0;r<t.length;r++)a[r]=255&t.charCodeAt(r);return s}const s=Ht().utils.aoa_to_sheet(t.aoa),a=Ht().utils.book_new();a.SheetNames.push("Sheet"),a.Sheets["Sheet"]=s;var r=Ht().write(a,{bookType:"xlsx",type:"binary"});js_download_file({data:new Blob([s2ab(r)],{type:"application/octet-stream"}),filename:t.filename})},download_json_file=async t=>{js_download_file({data:new Blob([JSON.stringify(t.data)]),mime:"application/octet-stream",filename:t.filename})},attach_file_to_document=(t,s)=>{const a=s.file_in_folder_repository.get_file(t.folder_id,t.file_id);a?(s.doc_repository.add_file(t.folder_id,t.document_id,a),s.doc_repository.mark_as_modified(t.folder_id,t.document_id),s.file_in_folder_repository.delete(t.folder_id,t.file_id),s.push_message(new FileAttachedToDocument(t.folder_id,t.usergroup_id,t.document_id,t.file_id))):console.log("Error during attaching of file")},detach_file_from_document=(t,s)=>{const a=s.doc_repository.get_file(t.folder_id,t.document_id,t.file_id);a?(s.file_in_folder_repository.set(t.folder_id,t.file_id,a),s.doc_repository.remove_file(t.folder_id,t.document_id,t.file_id),s.doc_repository.mark_as_modified(t.folder_id,t.document_id),s.push_message(new FileDetachedFromDocument(t.folder_id,t.usergroup_id,t.document_id,t.file_id))):console.log("Error during detaching of file")},attach_files_to_document_using_pattern=(t,s)=>{const a=s.doc_repository.attributes(t.folder_id,t.document_id),r=s.folder_repository.get_filename_pattern(t.folder_id,a);if(null===r||""==r)return;const o=new RegExp(r),n=s.file_in_folder_repository.pure_keys(t.folder_id);n.forEach((a=>{const r=s.file_in_folder_repository.get_file(t.folder_id,a);r.uploaded&&null!==r.name.match(o)&&s.push_message(new AttachFileToDocument(t.folder_id,t.usergroup_id,t.document_id,a))}))},allocate_files_to_documents_using_pattern=(t,s)=>{const a=s.doc_repository.pure_keys(t.folder_id);a.forEach((a=>{s.doc_repository.is_blocked(t.folder_id,a)||s.push_message(new AttachFilesToDocumentUsingPattern(t.folder_id,t.usergroup_id,a))})),s.push_message(new FilesAllocated)};class service_handlers_WrongResponseError extends Error{}const get_pdf_merge_files=async(t,s)=>{s.pdf_merge_file_repository.reset();const a=new GetPdfMergeFilesRequest({}),r=await s.api.call(a);r instanceof NegativeResponse?s.push_message(new ApiError(r.data.code)):r instanceof GetPdfMergeFilesResponse&&r.data.forEach((t=>{const a=new Wt.m5(t.file.id,t.file.name,t.file.size);s.file_common_repository.set(t.file.id,a),s.file_common_repository.set_size_complete(t.file.id);const r=new Wt.Zl(t.id,t.order,t.page_count,t.page_from,t.page_to,t.angle,a,!0);s.pdf_merge_file_repository.set(t.id,r)}))},upload_pdf_merge_file=async(t,s)=>{const a=new Wt.m5(t.id,t.file.name,t.file.size);s.file_common_repository.set(t.id,a);const r=new Wt.Zl(t.id,t.order,0,0,0,0,a,!1);s.pdf_merge_file_repository.set(t.id,r),s.upload_progress_timer.add(t.id);const o=new UploadPdfMergeFileRequest({id:t.id,order:t.order,original_file:t.file});let n=null;try{n=await s.api.call(o)}catch(i){s.push_message(new UploadFileError(t.file.name)),console.log(i)}if(s.upload_progress_timer.remove(t.id),n instanceof NegativeResponse)return s.pdf_merge_file_repository.delete(t.id),s.file_common_repository.delete(t.id),void s.push_message(new ApiError(n.data.code));if(n instanceof UploadPdfMergeFileResponse){s.file_common_repository.set_size_complete(t.id);const a=s.pdf_merge_file_repository.get(t.id).value;return a.page_count=n.data.page_count,a.page_from=n.data.page_from,a.page_to=n.data.page_to,a.angle=n.data.angle,a.uploaded=!0,void s.push_message(new UploadFileSuccess)}throw s.pdf_merge_file_repository.delete(t.id),s.file_common_repository.delete(t.id),new service_handlers_WrongResponseError},update_pdf_merge_file=async(t,s)=>{const a=new UpdatePdfMergeFileRequest({id:t.id,order:t.order,page_from:t.page_from,page_to:t.page_to,angle:t.angle}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof UpdatePdfMergeFileResponse){const t=s.pdf_merge_file_repository.get(r.data.id).value;return t.order=r.data.order,t.page_from=r.data.page_from,t.page_to=r.data.page_to,void(t.angle=r.data.angle)}throw new service_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},delete_pdf_merge_file=async(t,s)=>{const a=new DeletePdfMergeFileRequest({id:t.id}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof DeletePdfMergeFileResponse)return s.pdf_merge_file_repository.delete(t.id),s.file_common_repository.delete(t.id),void s.push_message(new FileDeletedSuccess);throw new service_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},delete_all_pdf_merge_files=(t,s)=>{s.pdf_merge_file_repository.pure_keys().forEach((t=>s.push_message(new DeletePdfMergeFile(t))))},download_pdf_merge_result=async(t,s)=>{const a=(0,Gt.Z)(),r=new Wt.m5(a,"AAAAA",1e3);s.download_progress.set(a,r);const o=new DownloadPdfMergeResultRequest({set_size_method:t=>s.download_progress.set_size(a,t),keep_bookmarks:t.keep_bookmarks,add_filenames_as_bookmarks:t.add_filenames_as_bookmarks}),n=await s.api.call(o);if(n instanceof NegativeResponse)s.push_message(new ApiError(n.data.code));else{if(!(n instanceof DownloadPdfMergeResultResponse))throw new service_handlers_WrongResponseError;js_download_file({data:n.data.file,filename:n.data.name})}},download_pdf_mix_result=async(t,s)=>{const a=(0,Gt.Z)(),r=new Wt.m5(a,"AAAAA",1e3);s.download_progress.set(a,r);const o=new DownloadPdfMixResultRequest({set_size_method:t=>s.download_progress.set_size(a,t)}),n=await s.api.call(o);if(n instanceof NegativeResponse)s.push_message(new ApiError(n.data.code));else{if(!(n instanceof DownloadPdfMixResultResponse))throw new service_handlers_WrongResponseError;js_download_file({data:n.data.file,filename:n.data.name})}},get_share_files=async(t,s)=>{s.share_file_repository.reset();const a=new GetShareFilesRequest({}),r=await s.api.call(a);r instanceof NegativeResponse?s.push_message(new ApiError(r.data.code)):r instanceof GetShareFilesResponse&&r.data.forEach((t=>{const a=new Wt.m5(t.id,t.name,t.size);s.file_common_repository.set(t.id,a),s.file_common_repository.set_size_complete(t.id),s.share_file_repository.set(t.id,a)}))},upload_share_file=async(t,s)=>{const a=new Wt.m5(t.id,t.file.name,t.file.size);s.file_common_repository.set(t.id,a),s.share_file_repository.set(t.id,a),s.upload_progress_timer.add(t.id);const r=new UploadShareFileRequest({id:t.id,original_file:t.file});let o=null;try{o=await s.api.call(r)}catch(n){s.push_message(new UploadFileError(t.file.name)),console.log(n)}if(s.upload_progress_timer.remove(t.id),o instanceof NegativeResponse)return s.share_file_repository.delete(t.id),s.file_common_repository.delete(t.id),void s.push_message(new ApiError(o.data.code));if(o instanceof UploadShareFileResponse)return s.file_common_repository.set_size_complete(t.id),void s.push_message(new UploadFileSuccess);throw s.share_file_repository.delete(t.id),s.file_common_repository.delete(t.id),new service_handlers_WrongResponseError},delete_share_file=async(t,s)=>{const a=new DeleteShareFileRequest({id:t.id}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof DeleteShareFileResponse)return s.share_file_repository.delete(t.id),s.file_common_repository.delete(t.id),void s.push_message(new FileDeletedSuccess);throw new service_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},download_share_file=async(t,s)=>{const a=(0,Gt.Z)(),r=new Wt.m5(a,t.name,t.size);s.download_progress.set(a,r);const o=new DownloadShareFileRequest({set_size_method:t=>s.download_progress.set_size(a,t),id:t.id}),n=await s.api.call(o);if(n instanceof NegativeResponse)s.push_message(new ApiError(n.data.code));else{if(!(n instanceof DownloadShareFileResponse))throw new service_handlers_WrongResponseError;js_download_file({data:n.data.file,filename:n.data.name,inline:t.inline})}},drop_self_testing_questions=(t,s)=>{s.self_testing_question_repository.reset()},add_self_testing_question=(t,s)=>{s.self_testing_question_repository.set(t.id,t)};class counter_handlers_WrongResponseError extends Error{}const convert_counter_response_obj_to_model=t=>{const s=new Wt.AT(t.id,t.name,t.description,t.value,t.increment);return s},get_counters=async(t,s)=>{s.counter_repository.reset_keeping_refs();const a=new GetCountersRequest({}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof GetCountersResponse)return r.data.forEach((t=>{const a=convert_counter_response_obj_to_model(t);s.counter_repository.set(a.id,a)})),!0;throw new counter_handlers_WrongResponseError},add_counter=async(t,s)=>{const a=new AddCounterRequest({name:t.name,description:t.description,value:t.value,increment:t.increment}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof AddCounterResponse){const t=convert_counter_response_obj_to_model(r.data);return s.counter_repository.set(t.id,t),s.push_message(new CounterAddedSuccess),!0}throw new counter_handlers_WrongResponseError},update_counter=async(t,s)=>{const a=new UpdateCounterRequest({id:t.id,name:t.name,description:t.description,value:t.value,increment:t.increment}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof UpdateCounterResponse){const t=convert_counter_response_obj_to_model(r.data);return s.counter_repository.set(t.id,t),s.push_message(new CounterUpdatedSuccess),!0}throw new counter_handlers_WrongResponseError},delete_counter=async(t,s)=>{const a=new DeleteCounterRequest({id:t.id}),r=await s.api.call(a);if(r instanceof NegativeResponse)return s.push_message(new ApiError(r.data.code)),!1;if(r instanceof DeleteCounterResponse)return s.counter_repository.delete(t.id),s.push_message(new CounterDeletedSuccess),!0;throw new counter_handlers_WrongResponseError};class flow_handlers_WrongResponseError extends Error{}const convert_flow_response_obj_to_model=t=>new Wt.Zw(t.id,t.name,t.user,t.trigger,t.is_multiple,t.is_active,t.message_if_fail,t.process,new Date(t.created_at),new Date(t.updated_at)),get_flows=async(t,s)=>{const a=new GetFlowsRequest({query:t.query}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof GetFlowsResponse)return s.flow_repository.reset_keeping_refs(),void r.data.forEach((t=>s.flow_repository.set(t.id,convert_flow_response_obj_to_model(t))));throw new flow_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},add_flow=async(t,s)=>{const a=new AddFlowRequest({name:t.name,trigger:t.trigger,is_active:t.is_active,is_multiple:t.is_multiple,message_if_fail:t.message_if_fail,process:t.process}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof AddFlowResponse)return s.flow_repository.set(r.data.id,convert_flow_response_obj_to_model(r.data)),void s.push_message(new AddFlowSuccess);throw new flow_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},update_flow=async(t,s)=>{const a=new UpdateFlowRequest({id:t.id,name:t.name,trigger:t.trigger,is_active:t.is_active,is_multiple:t.is_multiple,message_if_fail:t.message_if_fail,process:t.process}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof UpdateFlowResponse)return s.flow_repository.set(r.data.id,convert_flow_response_obj_to_model(r.data)),void s.push_message(new UpdateFlowSuccess);throw new flow_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},delete_flow=async(t,s)=>{const a=new DeleteFlowRequest({id:t.id}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof DeleteFlowResponse)return s.flow_repository.delete(t.id),void s.push_message(new DeleteFlowSuccess);throw new flow_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},convert_flow_item_response_obj_to_model=t=>new Wt.qp(t.id,t.flow.name,t.flow.user,t.flow.trigger,t.success,t.is_active,t.message_if_fail,t.input,t.process,new Date(t.started_at),null===t.finished_at?null:new Date(t.finished_at)),get_many_flow_items=async(t,s)=>{const a=new GetManyFlowItemsRequest({query:t.query}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof GetManyFlowItemsResponse)return s.flow_item_repository.reset_keeping_refs(),void r.data.forEach((t=>s.flow_item_repository.set(t.id,convert_flow_item_response_obj_to_model(t))));throw new flow_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},get_flow_item=async(t,s)=>{const a=new GetFlowItemRequest({id:t.id}),r=await s.api.call(a);if(r instanceof NegativeResponse)s.push_message(new ApiError(r.data.code));else{if(!(r instanceof GetFlowItemResponse))throw new flow_handlers_WrongResponseError;s.flow_item_repository.set_current(convert_flow_item_response_obj_to_model(r.data))}},convert_flow_item_step_response_obj_to_model=t=>new Wt.JJ(t.id,t.name,t.description,t.flowitem_id,t.success,t.result_key,t.action,t.input,t.output,new Date(t.started_at),null===t.finished_at?null:new Date(t.finished_at)),get_flow_item_steps=async(t,s)=>{const a=new GetFlowItemStepsRequest({flowitem_id:t.flowitem_id}),r=await s.api.call(a);if(!(r instanceof NegativeResponse)){if(r instanceof GetFlowItemStepsResponse)return s.flow_item_step_repository.reset_keeping_refs(),void r.data.forEach((t=>{s.flow_item_step_repository.set(t.id,convert_flow_item_step_response_obj_to_model(t))}));throw new flow_handlers_WrongResponseError}s.push_message(new ApiError(r.data.code))},restart_flow_item=async(t,s)=>{const a=new RestartFlowItemRequest({id:t.id}),r=await s.api.call(a);if(r instanceof NegativeResponse)s.push_message(new ApiError(r.data.code));else{if(!(r instanceof RestartFlowItemResponse))throw new flow_handlers_WrongResponseError;s.push_message(new RestartFlowItemSuccess)}};class validation_handlers_WrongResponseError extends Error{}const reset_document_validation_errors=(t,s)=>{s.doc_repository.reset_errors(t.folder_id,t.document_id)},validate_document_against_constraints=(t,s)=>{if(!s.folder_repository.get_is_necessary_validate(t.folder_id))return;const a=s.folder_repository.get_validation_constraints(t.folder_id);if(!a)return;const r=s.folder_repository.get(t.folder_id),o=r.value.master_usergroup_slug;let n=""===o?null:s.usergroup_repository.get_id_by_slug(o);null===n&&(n=t.usergroup_id);const i={attribute_regex_validation:ValidateDocumentAgainstAttributeRegexValidationConstraint,attribute_together_regex_validation:ValidateDocumentAgainstAttributeTogetherRegexValidationConstraint,has_file:ValidateDocumentAgainstHasFileConstraint,has_approval:ValidateDocumentAgainstHasApprovalConstraint,unique_together:ValidateDocumentAgainstUniqueTogetherConstraint,attribute_has_previous_value:ValidateDocumentAgainstAttributeHasPreviousValueConstraint,single_union:ValidateDocumentAgainstSingleUnionConstraint,filename_match_pattern:ValidateDocumentAgainstFilenamePatternConstraint};s.doc_repository.start_validation(t.folder_id,t.document_id,a.length),a.forEach((a=>{const r=i[a.name];r?s.push_message(new r(t.folder_id,n,t.document_id,a.parameters,a.error_message)):console.log("Unknown validation contraint '"+a.name+"' ")}))},validate_document_against_unique_together_constraint=async(t,s)=>{const stop_validation=()=>{s.doc_repository.stop_validation(t.folder_id,t.document_id)},a=s.doc_repository.errors_container_id(t.folder_id,t.document_id),push_error=()=>s.doc_repository.add_error(t.folder_id,t.document_id,a,t.error_message),r=s.doc_repository.attributes(t.folder_id,t.document_id);let o={_LIMIT:2},n=!0;if(t.parameters.fields.forEach((t=>{r[t]||(n=!1),o[t+"__exact"]=r[t]})),!n)return void stop_validation();const i=new GetManyDocumentsRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,query:o}),_=await s.api.call(i);if(_ instanceof NegativeResponse)return s.push_message(new ApiError(_.data.code)),void stop_validation();if(!(_ instanceof GetManyDocumentsResponse))throw new validation_handlers_WrongResponseError;if(_.data.count>1||1===_.data.count&&_.data.documents[0].id!==t.document_id)return push_error(),void stop_validation();const l=s.doc_repository.values(t.folder_id);let d=0;l.forEach((s=>{if(s.value.id==t.document_id)return;let a=!0;t.parameters.fields.forEach((t=>{o[t+"__exact"]!==s.value.get_attribute(t)&&(a=!1)})),!0===a&&d++})),d>1&&push_error(),stop_validation()},validate_document_against_has_previous_value_constraint=async(t,s)=>{const stop_validation=()=>{s.doc_repository.stop_validation(t.folder_id,t.document_id)},a=s.doc_repository.errors_container_id(t.folder_id,t.document_id),push_error=()=>s.doc_repository.add_error(t.folder_id,t.document_id,a,t.error_message),r=s.doc_repository.attributes(t.folder_id,t.document_id);let o=!0;r[t.parameters.field_to_be_checked]||(o=!1);const n=r[t.parameters.field_to_be_checked];if(!o)return void stop_validation();const i=t.parameters.allowed_values.indexOf(n);if(0==i)return void stop_validation();if(-1==i)return push_error(),void stop_validation();let _={_LIMIT:2};if(_[t.parameters.field_to_be_checked+"__exact"]=t.parameters.allowed_values[i-1],t.parameters.fields.forEach((t=>{r[t]||(o=!1),_[t+"__exact"]=r[t]})),!o)return void stop_validation();const l=new GetManyDocumentsRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,query:_}),d=await s.api.call(l);if(d instanceof NegativeResponse)return stop_validation(),void s.push_message(new ApiError(d.data.code));if(!(d instanceof GetManyDocumentsResponse))throw new validation_handlers_WrongResponseError;if(d.data.count>1||1===d.data.count&&d.data.documents[0].id!==t.document_id)return void stop_validation();const p=s.doc_repository.values(t.folder_id);let c=0;p.forEach((s=>{let a=!0;_[t.parameters.field_to_be_checked+"__exact"]!==n&&(a=!1),t.parameters.fields.forEach((t=>{_[t+"__exact"]!==s.value.get_attribute(t)&&(a=!1)})),!0===a&&c++})),c>0||push_error(),stop_validation()},validate_document_against_has_file_constraint=(t,s)=>{const stop_validation=()=>{s.doc_repository.stop_validation(t.folder_id,t.document_id)},a=!0===t.parameters.case_insensitive?"i":"",r=new RegExp(t.parameters.pattern,a),o=s.doc_repository.get(t.folder_id,t.document_id);let n=0;o.value.files.forEach((t=>{t.name.toString().match(r)&&n++})),(Number.isInteger(t.parameters.min_count)&&n<t.parameters.min_count||Number.isInteger(t.parameters.max_count)&&n>t.parameters.max_count)&&s.doc_repository.add_error_easy(t.folder_id,t.document_id,t.error_message),stop_validation()},validate_document_against_attribute_regex_validation_constraint=(t,s)=>{const stop_validation=()=>{s.doc_repository.stop_validation(t.folder_id,t.document_id)},a=!0===t.parameters.case_insensitive?"i":"",r=new RegExp(t.parameters.pattern,a),o=s.doc_repository.get(t.folder_id,t.document_id),n=get_nested_attribute_from_document(o,t.parameters.field);void 0===n||null===n||"object"!==typeof n&&!n.match(r)?(s.doc_repository.add_error_easy(t.folder_id,t.document_id,t.error_message),stop_validation()):stop_validation()},validate_document_against_attribute_together_regex_validation_constraint=(t,s)=>{const stop_validation=()=>{s.doc_repository.stop_validation(t.folder_id,t.document_id)},a=!0===t.parameters.case_insensitive?"i":"",r=new RegExp(t.parameters.subject_pattern,a),o=new RegExp(t.parameters.object_pattern,a),n=s.doc_repository.get(t.folder_id,t.document_id),i=get_nested_attribute_from_document(n,t.parameters.subject_field),_=get_nested_attribute_from_document(n,t.parameters.object_field);if(void 0!==i&&null!==i&&void 0!==_&&null!==_){if(!i.toString().match(r))return void stop_validation();if(_.toString().match(o))return void stop_validation();s.doc_repository.add_error_easy(t.folder_id,t.document_id,t.error_message)}stop_validation()},validate_document_against_single_union_constraint=async(t,s)=>{const stop_validation=()=>{s.doc_repository.stop_validation(t.folder_id,t.document_id)},a=s.doc_repository.errors_container_id(t.folder_id,t.document_id),push_error=()=>s.doc_repository.add_error(t.folder_id,t.document_id,a,t.error_message),r=s.doc_repository.attributes(t.folder_id,t.document_id);let o={},n=!0;if(t.parameters.fields.forEach((t=>{r[t]||(n=!1),o[t+"__exact"]=r[t]})),!n)return void stop_validation();const i=new GetManyDocumentsRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,query:o}),_=await s.api.call(i);if(_ instanceof NegativeResponse)return s.push_message(new ApiError(_.data.code)),void stop_validation();if(_ instanceof GetManyDocumentsResponse){let a=!1,r={};_.data.documents.forEach((t=>{null!==t.union&&(r[t.union]=!0)}));const n=Object.keys(r);if(n.length>1)return push_error(),void stop_validation();if(1===n.length)return s.doc_repository.set_union(t.folder_id,t.document_id,n[0]),a=!0,void stop_validation();const i=s.doc_repository.values(t.folder_id);if(i.forEach((r=>{if(r.value.id===t.document_id||a)return;let n=!0;return t.parameters.fields.forEach((t=>{o[t+"__exact"]!==r.value.get_attribute(t)&&(n=!1)})),!0===n&&null!==r.union?(s.doc_repository.set_union(t.folder_id,t.document_id,r.value.union),void(a=!0)):void 0})),a)return void stop_validation();s.doc_repository.set_union(t.folder_id,t.document_id,(0,Gt.Z)())}throw stop_validation(),new validation_handlers_WrongResponseError},validate_document_against_filename_pattern_constraint=(t,s)=>{const stop_validation=()=>{s.doc_repository.stop_validation(t.folder_id,t.document_id)},a=s.doc_repository.get(t.folder_id,t.document_id),r=s.folder_repository.get_filename_pattern(t.folder_id,a.value.attributes);if(null===r||""==r)return;const o=new RegExp(r),n=t.parameters.min_count;let i=[];a.value.files.forEach((t=>{t.name.toString().match(o)||i.push(t.name)})),(n&&a.value.files.length-i.length<n||!n&&i.length>0)&&i.forEach((a=>s.doc_repository.add_error_easy(t.folder_id,t.document_id,a+" | "+t.error_message))),stop_validation()},validate_document_against_has_approval_constraint=async(t,s)=>{const stop_validation=()=>{s.doc_repository.stop_validation(t.folder_id,t.document_id)},a=s.doc_repository.get(t.folder_id,t.document_id);if(!a.value.is_saved)return void stop_validation();const r=s.doc_repository.errors_container_id(t.folder_id,t.document_id),push_error=()=>s.doc_repository.add_error(t.folder_id,t.document_id,r,t.error_message),o=new GetDocumentApprovalsRequest({folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_id:t.document_id}),n=await s.api.call(o);if(n instanceof NegativeResponse)return s.push_message(new ApiError(n.data.code)),void stop_validation();if(n instanceof GetDocumentApprovalsResponse){const s=n.data.map((t=>convert_approval_response_obj_to_model(t))).filter((t=>t.updated_at>a.value.updated_at&&["APPROVED","DELEGATED"].includes(t.state)));s.sort(((t,s)=>t.updated_at>s.updated_at));const r={};s.forEach((t=>r[t.id]=t));const o={};s.forEach((t=>{const s=t.state;let a=t;o[a.to_username]=s;while(a.delegated_from)a=r[a.delegated_from],o[a.to_username]=s}));let i=[];Object.keys(o).forEach((t=>{"APPROVED"===o[t]&&i.push(t)}));const _=t.parameters.usernames.filter((t=>!i.includes(t)));return _.length>0&&push_error(),void stop_validation()}throw stop_validation(),new validation_handlers_WrongResponseError},get_nested_attribute_from_document=(t,s)=>{const a=s.split("__"),r=a.shift();let o=t.value.get_attribute(r);while(a.length>0){const t=a.shift();o=o[t]}return o},handle_api_error=(t,s)=>{"Auth.Token.Fail"!==t.code&&s.push_message(new NotifyApiError(t.code))},handle_access_perm_fail_error=(t,s)=>{s.push_message(new Notify("error","Недостаточно прав для доступа к странице"))},user_login_success=async(t,s)=>{s.push_message(new Notify("success","Вы вошли в систему")),await message_bus_MessageBus.handle(new GetUserPermissions,s)},user_logout_success=(t,s)=>{s.push_message(new Notify("info","Вы вышли из системы"))},users_get_success=(t,s)=>{s.push_message(new Notify("info","Данные пользователей получены"))},users_update_success=(t,s)=>{s.push_message(new Notify("success","Сохранено"))},users_delete_success=(t,s)=>{s.push_message(new Notify("success","Удалено"))},user_replacement_add_success=(t,s)=>{s.push_message(new Notify("success","Замещение добавлено"))},user_replacement_delete_success=(t,s)=>{s.push_message(new Notify("success","Замещение удалено"))},on_behalf_user_change_success=(t,s)=>{s.push_message(new Notify("success","Установлено. Обновите страницу."))},on_behalf_user_delete_success=(t,s)=>{s.push_message(new Notify("success","Вы работаете от своего имени. Обновите станицу."))},folders_add_success=(t,s)=>{s.push_message(new Notify("success","Сохранено"))},folders_update_success=(t,s)=>{s.push_message(new Notify("success","Сохранено"))},folders_delete_success=(t,s)=>{s.push_message(new Notify("success","Удалено"))},handle_upload_file_error=(t,s)=>{s.push_message(new Notify("error",`Ошибка загрузки файла ${t.filename}`))},handle_upload_empty_file_error=(t,s)=>{s.push_message(new Notify("error",`Файл "${t.filename}" имеет нулевой размер`))},handle_upload_file_too_big_error=(t,s)=>{s.push_message(new Notify("error",`Файл "${t.filename}" слишком велик`))},handle_upload_file_wrong_extension_error=(t,s)=>{s.push_message(new Notify("error",`Файл "${t.filename}" имеет неправильное расширение`))},handle_upload_file_wrong_filename_error=(t,s)=>{s.push_message(new Notify("error",`Файл "${t.filename}" имеет неправильное имя`))},handle_upload_file_success=(t,s)=>{s.push_message(new Notify("success","Файл загружен"))},handle_save_many_documents_success=(t,s)=>{s.push_message(new Notify("success","Сохранение завершено"))},handle_delete_many_documents_success=(t,s)=>{s.push_message(new Notify("success","Удаление завершено"))},handle_document_attributes_changed=(t,s)=>{s.push_message(new ValidateDocument(t.folder_id,t.usergroup_id,t.document_id))},handle_duplicate_document_to_usergroup_success=(t,s)=>{s.push_message(new Notify("success","Документ успешно скопирован"))},handle_duplicate_many_documents_to_usergroup_success=(t,s)=>{s.push_message(new Notify("success","Документы успешно скопированы"))},handle_document_files_are_uploading=(t,s)=>{s.push_message(new Notify("error","Загрузка файлов еще продолжается"))},handle_file_updated_success=(t,s)=>{s.push_message(new Notify("success","Файл обновлен"))},handle_file_deleted_success=(t,s)=>{s.push_message(new Notify("success","Файл удален"))},handle_file_attached_to_document=(t,s)=>{s.push_message(new ValidateDocument(t.folder_id,t.usergroup_id,t.document_id))},handle_file_detached_from_document=(t,s)=>{s.push_message(new ValidateDocument(t.folder_id,t.usergroup_id,t.document_id))},handle_files_allocated=(t,s)=>{s.push_message(new Notify("success","Загруженные файлы распределены"))},handle_document_button_pushed=(t,s)=>{s.push_message(new Notify("success","Действие выполнено"))},handle_add_role_success=(t,s)=>{s.push_message(new Notify("success","Роль добавлена")),s.push_message(new GetRoles)},handle_delete_role_success=(t,s)=>{s.push_message(new Notify("success","Роль удалена")),s.push_message(new GetRoles)},handle_add_user_folder_settings_success=(t,s)=>{s.push_message(new Notify("success","Настройки добавлены"))},handle_set_user_folder_settings_success=(t,s)=>{s.push_message(new Notify("success","Настройки установлены"))},handle_delete_user_folder_settings_success=(t,s)=>{s.push_message(new Notify("success","Настройки удалены"))},handle_set_user_search_schema_success=(t,s)=>{s.push_message(new Notify("success","Пользовательская схема установлена"))},handle_add_permission_success=(t,s)=>{s.push_message(new Notify("success","Разрешение добавлено"))},handle_delete_permission_success=(t,s)=>{s.push_message(new Notify("success","Разрешение удалено"))},handle_document_link_copied=(t,s)=>{s.push_message(new Notify("success","Ссылка на документ скопирована"))},handle_file_link_copied=(t,s)=>{s.push_message(new Notify("success","Ссылка на файл скопирована"))},handle_add_user_group_success=(t,s)=>{s.push_message(new Notify("success","Группа пользователей добавлена"))},handle_update_user_group_success=(t,s)=>{s.push_message(new Notify("success","Группа пользователей обновлена"))},handle_delete_user_group_success=(t,s)=>{s.push_message(new Notify("success","Группа пользователей удалена"))},handle_user_group_has_not_been_assigned=(t,s)=>{s.push_message(new Notify("error","Не выбрана группа пользователей"))},handle_document_added_to_cart_success=(t,s)=>{s.push_message(new Notify("success","Документ добавлен в корзину"))},handle_document_removed_from_cart_success=(t,s)=>{s.push_message(new Notify("success","Документ удален из корзины"))},handle_many_documents_added_to_cart_success=(t,s)=>{s.push_message(new Notify("success","Документы добавлены в корзину"))},handle_add_flow_success=(t,s)=>{s.push_message(new Notify("success","Поток создан"))},handle_update_flow_success=(t,s)=>{s.push_message(new Notify("success","Поток обновлен"))},handle_delete_flow_success=(t,s)=>{s.push_message(new Notify("success","Поток удален"))},handle_restart_flow_item_success=(t,s)=>{s.push_message(new Notify("success","Экземпляр потока перезапущен"))},handle_self_testing_replied_success=(t,s)=>{s.push_message(new Notify("success","Правильно"))},handle_self_testing_replied_fail=(t,s)=>{s.push_message(new Notify("error","Неверно"))},handle_document_approval_added_success=(t,s)=>{s.push_message(new Notify("success","Запрос на согласование добавлен")),s.push_message(new GetInfo)},handle_document_approval_updated_success=(t,s)=>{s.push_message(new Notify("success","Согласование/Отклонение выполнено")),s.push_message(new GetInfo)},handle_document_approval_deleted_success=(t,s)=>{s.push_message(new Notify("success","Согласование удалено")),s.push_message(new GetInfo)},handle_document_approval_delegated_success=(t,s)=>{s.push_message(new Notify("success","Согласование делегировано")),s.push_message(new GetInfo)},handle_empty_approval_flow_saved=(t,s)=>{s.push_message(new Notify("error","Нельзя сохранить пустой поток согласований"))},handle_approval_flow_upload_error=(t,s)=>{s.push_message(new Notify("error","Ошибка загрузки потока согласований"))},handle_approval_flow_started=(t,s)=>{s.push_message(new Notify("success","Поток согласований запущен")),s.push_message(new GetInfo)},handle_approval_flow_stopped=(t,s)=>{s.push_message(new Notify("success","Поток согласований остановлен")),s.push_message(new GetInfo)},handle_server_setting_updated_success=(t,s)=>{s.push_message(new Notify("success","Параметр изменен"))},handle_mailbox_added_success=(t,s)=>{s.push_message(new Notify("success","Почтовый ящик добавлен"))},handle_mailbox_updated_success=(t,s)=>{s.push_message(new Notify("success","Почтовый ящик изменен"))},handle_mailbox_deleted_success=(t,s)=>{s.push_message(new Notify("success","Почтовый ящик удален"))},handle_mail_channel_added_success=(t,s)=>{s.push_message(new Notify("success","Почтовый канал добавлен"))},handle_mail_channel_updated_success=(t,s)=>{s.push_message(new Notify("success","Почтовый канал изменен"))},handle_mail_channel_deleted_success=(t,s)=>{s.push_message(new Notify("success","Почтовый канал удален"))},handle_mail_channel_fetched_success=(t,s)=>{s.push_message(new Notify("success","Письма в почтовом канале обновлены"))},handle_mail_message_deleted_success=(t,s)=>{s.push_message(new Notify("success","Письмо удалено"))},handle_counter_added_success=(t,s)=>{s.push_message(new Notify("success","Счетчик добавлен"))},handle_counter_updated_success=(t,s)=>{s.push_message(new Notify("success","Счетчик изменен"))},handle_counter_deleted_success=(t,s)=>{s.push_message(new Notify("success","Счетчик удален"))},$t={Notify:[notify],NotifyApiError:[notify_api_error],GetInfo:[get_info],LoginWithCredentials:[login_with_credentials],LoginWithToken:[login_with_token],Logout:[logout],GetUsers:[get_users],SetUser:[set_user],DeleteUser:[delete_user],GetUserReplacements:[get_user_replacements],AddUserReplacement:[add_user_replacement],DeleteUserReplacement:[delete_user_replacement],GetUserReplacementsOfUser:[get_user_replacements_of_user],AddUserReplacementToUser:[add_user_replacement_to_user],DeleteUserReplacementFromUser:[delete_user_replacement_from_user],GetOnBehalfUsers:[get_on_behalf_users],SetOnBehalfUser:[set_on_behalf_user],DeleteOnBehalfUser:[delete_on_behalf_user],GetUserGroups:[get_user_groups],AddUserGroup:[add_user_group],UpdateUserGroup:[update_user_group],DeleteUserGroup:[delete_user_group],AddUserToUserGroup:[add_user_to_user_group],DeleteUserFromUserGroup:[delete_user_from_user_group],SetCurrentUserGroup:[set_current_user_group],GetFolders:[get_folders],AddFolder:[add_folder],DeleteFolder:[delete_folder],UpdateFolder:[update_folder],GetRoles:[get_roles],AddRole:[add_role],DeleteRole:[delete_role],GetUserFolderSettings:[get_user_folder_settings],AddUserFolderSettings:[add_user_folder_settings],UpdateUserFolderSettings:[set_user_folder_settings],DeleteUserFolderSettings:[delete_user_folder_settings],GetPermissions:[get_permissions],AddPermission:[add_permission],DeletePermission:[delete_permission],GetUserPermissions:[get_user_permissions],GetUserPermissionsForFolder:[get_user_permissions_for_folder],GetUserSearchSchema:[get_user_search_schema],SetUserSearchSchema:[set_user_search_schema],DeleteUserSearchSchema:[delete_user_search_schema],GetManyDocuments:[get_many_documents],GetDocument:[get_document],AddDocument:[add_document],AddDocumentModel:[add_document_model],SetDocumentAttribute:[set_document_attribute],SaveDocumentsInFolder:[save_documents_in_folder],SaveManyDocuments:[save_many_documents],MarkDocumentAsDeleted:[mark_document_as_deleted],MarkDocumentAsNotDeleted:[mark_document_as_not_deleted],DeleteManyDocuments:[delete_many_documents],DuplicateDocumentToUsergroup:[duplicate_document_to_usergroup],DuplicateManyDocumentsToUsergroup:[duplicate_many_documents_to_usergroup],PushDocumentButton:[push_document_button],PerformActionOnDocuments:[perform_action_on_documents],GetDocumentApprovals:[get_document_approvals],GetManyDocumentsApprovals:[get_many_documents_approvals],AddDocumentApproval:[add_document_approval],UpdateDocumentApproval:[update_document_approval],DeleteDocumentApproval:[delete_document_approval],DelegateDocumentApproval:[delegate_document_approval],GetDocumentApprovalSpareFiles:[get_document_approval_spare_files],UploadDocumentApprovalFile:[upload_document_approval_file],DeleteDocumentApprovalFile:[delete_document_approval_file],GetWaitingDocumentApprovals:[get_waiting_document_approvals],CreateDocumentApprovalFlow:[create_document_approval_flow],AddDocumentApprovalFlowStep:[add_document_approval_flow_step],DeleteDocumentApprovalFlowStep:[delete_document_approval_flow_step],AttachUserToDocumentApprovalFlowStep:[attach_user_to_document_approval_flow_step],DeleteUserFromDocumentApprovalFlowStep:[delete_user_from_document_approval_flow_step],GetDocumentApprovalFlow:[get_document_approval_flow],SetDocumentApprovalFlow:[set_document_approval_flow],StartDocumentApprovalFlow:[start_document_approval_flow],StopDocumentApprovalFlow:[stop_document_approval_flow],GetCart:[get_cart_documents],AddDocumentToCart:[add_document_to_cart],AddManyDocumentsToCart:[add_many_documents_to_cart],RemoveDocumentFromCart:[remove_document_from_cart],EmptyCart:[empty_cart],GetServerSettings:[get_server_settings],UpdateServerSetting:[update_server_setting],GetMailBoxes:[get_mailboxes],AddMailBox:[add_mailbox],UpdateMailBox:[update_mailbox],DeleteMailBox:[delete_mailbox],GetMailChannels:[get_mail_channels],AddMailChannel:[add_mail_channel],UpdateMailChannel:[update_mail_channel],DeleteMailChannel:[delete_mail_channel],AddMailChannelToMailBox:[add_mail_channel_to_mailbox],DeleteMailChannelFromMailBox:[delete_mail_channel_from_mailbox],FetchMailChannel:[fetch_mail_channel],GetMailMessages:[get_mail_messages],DeleteMailMessage:[delete_mail_message],DownloadMailMessageInTextFormat:[download_mail_message],DownloadMailMessageInHtmlFormat:[download_mail_message],DownloadMailMessageInRawFormat:[download_mail_message],DownloadMailMessageAttachment:[download_mail_message_attachment],AttachFileToDocument:[attach_file_to_document],DetachFileFromDocument:[detach_file_from_document],FlushFileContainer:[flush_file_container],UploadFileToFolder:[upload_file_to_folder],DownloadFileFromFolder:[download_file_from_folder],DownloadManyDocumentsFilesAsArchive:[download_many_documents_files_as_archive],DownloadDocumentFilesAsArchive:[download_document_files_as_archive],DeleteFileFromFolder:[delete_file_from_folder],UpdateFileFromFolder:[update_file_from_folder],GetFileInfo:[get_file_info],AttachFilesToDocumentUsingPattern:[attach_files_to_document_using_pattern],AllocateFilesToDocumentsUsingPattern:[allocate_files_to_documents_using_pattern],GetSpareFiles:[get_spare_files],UpdateUploadProgress:[update_upload_progress],ValidateDocument:[reset_document_validation_errors,validate_document_against_constraints],ValidateDocumentAgainstAttributeRegexValidationConstraint:[validate_document_against_attribute_regex_validation_constraint],ValidateDocumentAgainstAttributeTogetherRegexValidationConstraint:[validate_document_against_attribute_together_regex_validation_constraint],ValidateDocumentAgainstUniqueTogetherConstraint:[validate_document_against_unique_together_constraint],ValidateDocumentAgainstAttributeHasPreviousValueConstraint:[validate_document_against_has_previous_value_constraint],ValidateDocumentAgainstHasFileConstraint:[validate_document_against_has_file_constraint],ValidateDocumentAgainstHasApprovalConstraint:[validate_document_against_has_approval_constraint],ValidateDocumentAgainstSingleUnionConstraint:[validate_document_against_single_union_constraint],ValidateDocumentAgainstFilenamePatternConstraint:[validate_document_against_filename_pattern_constraint],DownloadExcelFile:[download_excel_file],DownloadJsonFile:[download_json_file],GetPdfMergeFiles:[get_pdf_merge_files],UploadPdfMergeFile:[upload_pdf_merge_file],UpdatePdfMergeFile:[update_pdf_merge_file],DeletePdfMergeFile:[delete_pdf_merge_file],DeleteAllPdfMergeFiles:[delete_all_pdf_merge_files],DownloadPdfMergeResult:[download_pdf_merge_result],DownloadPdfMixResult:[download_pdf_mix_result],GetShareFiles:[get_share_files],UploadShareFile:[upload_share_file],DeleteShareFile:[delete_share_file],DownloadShareFile:[download_share_file],DropSelfTestingQuestions:[drop_self_testing_questions],AddSelfTestingQuestion:[add_self_testing_question],GetCounters:[get_counters],AddCounter:[add_counter],UpdateCounter:[update_counter],DeleteCounter:[delete_counter],GetFlows:[get_flows],AddFlow:[add_flow],UpdateFlow:[update_flow],DeleteFlow:[delete_flow],GetFlowItem:[get_flow_item],GetManyFlowItems:[get_many_flow_items],RestartFlowItem:[restart_flow_item],GetFlowItemSteps:[get_flow_item_steps],GetDocumentAttributesContext:[get_document_attributes_context],GetDocumentPreviousAttributeContext:[get_document_previous_attribute_context],GetUserEmailContext:[get_user_email_context]},Lt={ApiError:[handle_api_error],AccessPagePermissionCheckFail:[handle_access_perm_fail_error],UserLoginSuccess:[user_login_success],UserLogoutSuccess:[user_logout_success],UsersGetSuccess:[users_get_success],UsersUpdateSuccess:[users_update_success],UsersDeleteSuccess:[users_delete_success],UserReplacementAddSuccess:[user_replacement_add_success],UserReplacementDeleteSuccess:[user_replacement_delete_success],OnBehalfUserChangeSuccess:[on_behalf_user_change_success],OnBehalfUserDeleteSuccess:[on_behalf_user_delete_success],FoldersAddSuccess:[folders_add_success],FoldersUpdateSuccess:[folders_update_success],FoldersDeleteSuccess:[folders_delete_success],UploadFileError:[handle_upload_file_error],UploadEmptyFileError:[handle_upload_empty_file_error],UploadFileTooBigError:[handle_upload_file_too_big_error],UploadFileWrongExtensionError:[handle_upload_file_wrong_extension_error],UploadFileWrongFilenameError:[handle_upload_file_wrong_filename_error],UploadFileSuccess:[handle_upload_file_success],SaveManyDocumentsSuccess:[handle_save_many_documents_success],DeleteManyDocumentsSuccess:[handle_delete_many_documents_success],DocumentAttributesChanged:[handle_document_attributes_changed],DuplicateDocumentToUsergroupSuccess:[handle_duplicate_document_to_usergroup_success],DuplicateManyDocumentsToUsergroupSuccess:[handle_duplicate_many_documents_to_usergroup_success],DocumentFilesAreUploading:[handle_document_files_are_uploading],FileUpdatedSuccess:[handle_file_updated_success],FileDeletedSuccess:[handle_file_deleted_success],FilesAllocated:[handle_files_allocated],FileAttachedToDocument:[handle_file_attached_to_document],FileDetachedFromDocument:[handle_file_detached_from_document],DocumentButtonPushed:[handle_document_button_pushed],AddRoleSuccess:[handle_add_role_success],DeleteRoleSuccess:[handle_delete_role_success],AddUserFolderSettingsSuccess:[handle_add_user_folder_settings_success],UpdateUserFolderSettingsSuccess:[handle_set_user_folder_settings_success],DeleteUserFolderSettingsSuccess:[handle_delete_user_folder_settings_success],SetUserSearchSchemaSuccess:[handle_set_user_search_schema_success],AddPermissionSuccess:[handle_add_permission_success],DeletePermissionSuccess:[handle_delete_permission_success],DocumentLinkCopied:[handle_document_link_copied],FileLinkCopied:[handle_file_link_copied],AddUserGroupSuccess:[handle_add_user_group_success],UpdateUserGroupSuccess:[handle_update_user_group_success],DeleteUserGroupSuccess:[handle_delete_user_group_success],UserGroupHasNotBeenAssigned:[handle_user_group_has_not_been_assigned],DocumentAddedToCartSuccess:[handle_document_added_to_cart_success],DocumentRemovedFromCartSuccess:[handle_document_removed_from_cart_success],ManyDocumentsAddedToCartSuccess:[handle_many_documents_added_to_cart_success],SelfTestingRepliedSuccess:[handle_self_testing_replied_success],SelfTestingRepliedFail:[handle_self_testing_replied_fail],AddFlowSuccess:[handle_add_flow_success],UpdateFlowSuccess:[handle_update_flow_success],DeleteFlowSuccess:[handle_delete_flow_success],RestartFlowItemSuccess:[handle_restart_flow_item_success],DocumentApprovalAddedSuccess:[handle_document_approval_added_success],DocumentApprovalUpdatedSuccess:[handle_document_approval_updated_success],DocumentApprovalDeletedSuccess:[handle_document_approval_deleted_success],DocumentApprovalDelegatedSuccess:[handle_document_approval_delegated_success],EmptyApprovalFlowSaved:[handle_empty_approval_flow_saved],ApprovalFlowStarted:[handle_approval_flow_started],ApprovalFlowStopped:[handle_approval_flow_stopped],ApprovalFlowUploadError:[handle_approval_flow_upload_error],ServerSettingUpdatedSuccess:[handle_server_setting_updated_success],MailBoxAddedSuccess:[handle_mailbox_added_success],MailBoxUpdatedSuccess:[handle_mailbox_updated_success],MailBoxDeletedSuccess:[handle_mailbox_deleted_success],MailChannelAddedSuccess:[handle_mail_channel_added_success],MailChannelUpdatedSuccess:[handle_mail_channel_updated_success],MailChannelDeletedSuccess:[handle_mail_channel_deleted_success],MailChannelFetchedSuccess:[handle_mail_channel_fetched_success],MailMessageDeletedSuccess:[handle_mail_message_deleted_success],CounterAddedSuccess:[handle_counter_added_success],CounterUpdatedSuccess:[handle_counter_updated_success],CounterDeletedSuccess:[handle_counter_deleted_success]};class message_bus_NotImplementedError extends Error{}class message_bus_MessageBus{static async handle(t,s){let a=[],r=[t];while(1){if(0===r.length)break;const handle_function=async t=>{if(t instanceof Command){const o=await this.handle_command(t,s,a);r=r.concat(o)}if(t instanceof Event){const a=await this.handle_event(t,s);r=r.concat(a)}},t=r.map(handle_function);r=[],await Promise.all(t)}return a}static async handle_command(t,s,a){let r=[];if(!Object.prototype.hasOwnProperty.call($t,t.constructor.name))throw new message_bus_NotImplementedError('There is no handler for command "'+t.constructor.name+'"');const o=$t[t.constructor.name],handle_function=async o=>{try{const n=await o(t,s);a.push(n);const i=s.collect_new_messages();r=r.concat(i)}catch(n){console.log('Exception "'+n.toString()+'" handling command "'+t.constructor.name+'"')}},n=o.map(handle_function);return await Promise.all(n),r}static async handle_event(t,s){let a=[];if(!Object.prototype.hasOwnProperty.call(Lt,t.constructor.name))throw new message_bus_NotImplementedError('There is no handler for event "'+t.constructor.name+'"');const r=Lt[t.constructor.name],handle_function=async r=>{try{await r(t,s);const o=s.collect_new_messages();a=a.concat(o)}catch(o){console.log('Exception "'+o.toString()+'" handling event "'+t.constructor.name+'"')}},o=r.map(handle_function);return await Promise.all(o),a}}class base_repository_NotImplementedError extends Error{}class AbstractBaseRepository{_deep_copy(t){return JSON.parse(JSON.stringify(t))}_create_name(t){const s=Array.isArray(t)?t.join():t;return s}_set(){throw new base_repository_NotImplementedError('"set" method has not been implemented')}_get(){throw new base_repository_NotImplementedError('"get" method has not been implemented')}_delete(){throw new base_repository_NotImplementedError('"delete" method has not been implemented')}_add_key(){throw new base_repository_NotImplementedError('"add_key" method has not been implemented')}_remove_key(){throw new base_repository_NotImplementedError('"remove_key" method has not been implemented')}_keys(){throw new base_repository_NotImplementedError('"keys" method has not been implemented')}_values(){throw new base_repository_NotImplementedError('"values" method has not been implemented')}_pure_keys(){throw new base_repository_NotImplementedError('"pure keys" method has not been implemented')}_keys_box(){throw new base_repository_NotImplementedError('"keys box" method has not been implemented')}_values_box(){throw new base_repository_NotImplementedError('"values box" method has not been implemented')}_pure_keys_box(){throw new base_repository_NotImplementedError('"pure keys box" method has not been implemented')}_set_box(){throw new base_repository_NotImplementedError('"set_box" method has not been implemented')}_get_box(){throw new base_repository_NotImplementedError('"get_box" method has not been implemented')}_delete_box(){throw new base_repository_NotImplementedError('"delete_box" method has not been implemented')}_add_box_key(){throw new base_repository_NotImplementedError('"add_box_key" method has not been implemented')}_remove_box_key(){throw new base_repository_NotImplementedError('"remove_box_key" method has not been implemented')}}class VueBaseRepository extends AbstractBaseRepository{constructor(t){super(),this._properties=(0,o.f3)(t)}_reset(){Object.keys(this._properties).forEach((t=>{delete this._properties[t]}))}_set(t,s,a=!0){const r=t.toString();Object.prototype.hasOwnProperty.call(this._properties,r)?this._properties[r].value=s:this._properties[r]=(0,i.iH)(s),a&&this._add_key(r)}_get(t,s=null){return Object.prototype.hasOwnProperty.call(this._properties,t)||this._set(t,this._deep_copy(s),!1),this._properties[t]}_delete(t){const s=t.toString();this._set(s,null),this._remove_key(s)}_add_key(t){Object.prototype.hasOwnProperty.call(this._properties,"__KEYS__")||(this._properties["__KEYS__"]=(0,i.iH)([]));const s=this._get("__KEYS__");-1===s.value.indexOf(t)&&s.value.push(t)}_remove_key(t){Object.prototype.hasOwnProperty.call(this._properties,"__KEYS__")&&(this._properties["__KEYS__"].value=this._properties["__KEYS__"].value.filter((s=>s!==t)))}_keys(){return this._get("__KEYS__",[])}_pure_keys(){const t=this._keys();return(0,i.dq)(t)?t.value:t}_values(){return this._keys().value.map((t=>this._get(t)))}_keys_box(t){const s=this._create_name(["BOX",t,"__KEYS__"]);return this._get(s,[])}_pure_keys_box(t){const s=this._keys_box(t);return(0,i.dq)(s)?s.value:s}_values_box(t){return this._keys_box(t).value.map((s=>this._get_box(t,s)))}_set_box(t,s,a){const r=this._create_name(["BOX",t,s]);this._set(r,a,!1),this._add_box_key(t,s.toString())}_get_box(t,s,a=null){const r=this._create_name(["BOX",t,s]);return this._get(r,a)}_delete_box(t,s){const a=this._create_name(["BOX",t,s]);this._delete(a),this._remove_box_key(t,s.toString())}_add_box_key(t,s){const a=this._create_name(["BOX",t,"__KEYS__"]);Object.prototype.hasOwnProperty.call(this._properties,a)||(this._properties[a]=(0,i.iH)([]));const r=this._get(a);-1===r.value.indexOf(s)&&r.value.push(s)}_remove_box_key(t,s){const a=this._create_name(["BOX",t,"__KEYS__"]);Object.prototype.hasOwnProperty.call(this._properties,a)&&(this._properties[a].value=this._properties[a].value.filter((t=>t!==s)))}}const Vt={reset(){this._reset()},reset_keeping_refs(){this.keys().value.forEach((t=>this.delete(t)))},get(t){return this._get(t)},set(t,s){return this._set(t,s)},delete(t){return this._delete(t)},keys(){return this._keys()},pure_keys(){return this._pure_keys()},values(){return this._values()}};class VueFlatRepository extends VueBaseRepository{}Object.assign(VueBaseRepository.prototype,Vt);const Jt={reset(){this._reset()},reset_keeping_refs(t){this.keys(t).value.forEach((s=>this.delete(t,s)))},keys(t){return this._keys_box(t)},pure_keys(t){return this._pure_keys_box(t)},values(t){return this._values_box(t)},set(t,s,a){this._set_box(t,s,a)},get(t,s,a=null){return this._get_box(t,s,a)},delete(t,s){this._delete_box(t,s)}};class VueBoxRepository extends VueBaseRepository{}Object.assign(VueBoxRepository.prototype,Jt);const Yt={set_current(t){this._set_box("__CURRENT__","__CURRENT__",t)},get_current(){return this._get_box("__CURRENT__","__CURRENT__")},is_current_settled(){return null!==this._get_box("__CURRENT__","__CURRENT__").value}},Kt={is_authenticated(){return this.is_current_settled()}},Xt={get_role(t){const s=this.get(t).value;return s.role},set_role(t,s){const a=this.get(t).value;a.role=s},get_role_inside_group(t){const s=this.get(t).value;return s.role_inside_group},set_role_inside_group(t,s){const a=this.get(t).value;a.role_inside_group=s},get_role_outside_group(t){const s=this.get(t).value;return s.role_outside_group},set_role_outside_group(t,s){const a=this.get(t).value;a.role_outside_group=s}},Qt={get_isactive(t){const s=this.get(t).value;return s.is_active},set_isactive(t,s){const a=this.get(t).value;a.is_active=s}},es={set_on_behalf_users(t){this._set_box("__BEHALF__","__BEHALF__",t)},get_on_behalf_users(){return this._get_box("__BEHALF__","__BEHALF__")}};class VueUserRepository extends VueFlatRepository{}Object.assign(VueUserRepository.prototype,Yt,Kt,Xt,Qt,es);const ts={get_id_by_slug(t){const s=this.values().find((s=>s.value.slug===t));return void 0===s?null:s.value.id}};class VueUserGroupRepository extends VueFlatRepository{}Object.assign(VueUserGroupRepository.prototype,Yt,ts);var ss=a(1955);const as={get_auth_token(){return ss.Z.get("auth_token")},set_auth_token(t){ss.Z.set("auth_token",t,this._cookie_default)}},rs={reset(){ss.Z.remove("auth_token")}};class VueTokenRepository extends VueBaseRepository{constructor(t,s){super(t),this._cookie_default={expires:parseInt(s),sameSite:"strict"}}}Object.assign(VueTokenRepository.prototype,as,rs);const os={set_user_search_schema(t,s){const a=this.get(t).value;a&&(a.user_search_schema=s)},delete_user_search_schema(t){const s=this.get(t).value;s.user_search_schema=null},get_validation_schema(t){const s=this.get(t).value;return s?s.validation_schema:null},get_validation_constraints(t){const s=this.get(t).value;return s?s.validation_constraints:null},get_is_necessary_validate(t){const s=this.get(t).value;return s?s.is_necessary_validate:null},get_filename_pattern(t,s){const a=this.get(t).value;return a.get_filename_pattern(s)},get_strict_validation(t,s){const a=this.get(t).value;return!a||a.strict_validation_for_permission(s)}};class VueFolderRepository extends VueFlatRepository{}Object.assign(VueFolderRepository.prototype,os);const ns={set_count(t){this._set_box("__COUNT__","__COUNT__",t)},get_count(){return this._get_box("__COUNT__","__COUNT__")},is_count_settled(){return null!==this._get_box("__COUNT__","__COUNT__").value}},is={reset(t){this.keys(t).value.forEach((s=>this.delete(t,s))),this.set_count(0)},get_union(t,s){const a=this.get(t,s).value;return a.union},set_union(t,s,a){const r=this.get(t,s).value;null!==r&&(r.union=a)},set_attribute(t,s,a,r,o){const n=this.get(t,s).value;null!==n&&n.set_attribute(a,r,o)},mark_as_modified(t,s){const a=this.get(t,s).value;a.modify()},mark_as_saved(t,s){const a=this.get(t,s).value;a.save()},mark_all_as_saved(t){this.values(t).forEach((t=>t.value.save()))},mark_as_deleted(t,s){const a=this.get(t,s).value;a.delete()},mark_as_not_deleted(t,s){const a=this.get(t,s).value;a.recover()},uploaded(t,s){const a=this.get(t,s).value;return a.files.every((t=>t.uploaded))},is_saved(t,s){const a=this.get(t,s).value;return a.is_saved},is_deleted(t,s){const a=this.get(t,s).value;return a.is_deleted},is_blocked(t,s){const a=this.get(t,s).value;return a.is_blocked},is_created_first_time(t,s){const a=this.get(t,s).value;return a.is_created_first_time},raw_attributes(t,s){const a=this.get(t,s).value;return a.raw_attributes},attributes(t,s){const a=this.get(t,s).value;return a.attributes},files(t,s){const a=this.get(t,s).value;return a.files},get_file(t,s,a){const r=this.get(t,s).value;return r.get_file(a)},add_file(t,s,a){const r=this.get(t,s).value;r.add_file(a.id,a)},remove_file(t,s,a){const r=this.get(t,s).value;r.remove_file(a)},file_in_repository(t,s){const is_doc_has_not_file=t=>t.files.every((t=>t.id!=s));return!this.values(t).map((t=>t.value)).every(is_doc_has_not_file)},add_error(t,s,a,r){const o=this.get(t,s).value;o.add_error(a,r)},add_error_easy(t,s,a){const r=this.get(t,s).value;r.add_error(r.errors_container_id,a)},errors_container_id(t,s){const a=this.get(t,s).value;return a.errors_container_id},reset_errors(t,s){const a=this.get(t,s).value;a.reset_errors()},has_errors(t,s){const a=this.get(t,s).value;return!!a&&a.errors.length>0},validation_progress(t){const s=this.values(t).map((t=>t.value)),a=s.map((t=>t.is_validation_in_progress?0:1)).reduce(((t,s)=>t+s),0);return 0===s.length?100:Math.round(a/s.length*100)},start_validation(t,s,a=1){const r=this.get(t,s).value;return r.start_validation(a)},stop_validation(t,s){const a=this.get(t,s).value;return a.stop_validation()}};class VueDocRepository extends VueBoxRepository{}Object.assign(VueDocRepository.prototype,is,ns);const _s={reset(t){this.keys(t).value.forEach((s=>this.delete(t,s)))},set_size(t,s,a){const r=this._get_box(t,s).value;r&&r.set_size(a)},set_total_size(t,s,a){const r=this._get_box(t,s).value;r&&r.set_total_size(a)},set_size_complete(t,s){const a=this._get_box(t,s).value;a&&a.set_size_complete()},get_file(t,s){return this.get(t,s).value},get_name(t,s){const a=this.get(t,s).value;return a.name}};class VueFileBoxRepository extends VueBoxRepository{}Object.assign(VueFileBoxRepository.prototype,_s);const ls={reset(){this.keys().value.forEach((t=>this.delete(t)))},set_size(t,s){const a=this.get(t).value;a&&a.set_size(s)},set_total_size(t,s){const a=this.get(t).value;a&&a.set_total_size(s)},set_size_complete(t){const s=this.get(t).value;s&&s.set_size_complete()},get_file(t){return this.get(t).value},get_name(t){const s=this.get(t).value;return s.name}};class VueFileFlatRepository extends VueFlatRepository{}Object.assign(VueFileFlatRepository.prototype,ls);const ds="__VARIANTS__",ps={get_role_variants(){return Object.prototype.hasOwnProperty.call(this._properties,ds)||(this._properties[ds]=(0,i.iH)([])),this._properties[ds]},set_role_variants(t){Object.prototype.hasOwnProperty.call(this._properties,ds)?this._properties[ds].value=t:this._properties[ds]=(0,i.iH)(t)}},cs={set_role(t,s){const a=this.get(t).value;a.role=s}};class VueUserFolderSettingsRepository extends VueFlatRepository{}Object.assign(VueUserFolderSettingsRepository.prototype,ps,cs);const us={add(t){this._set(t,!0)},add_for_folder(t,s){this._set_box(t,s,!0)},remove_for_folder(t,s){this._set_box(t,s,!1)},reset(){this._pure_keys().forEach((t=>{this._set(t,!1)}))},reset_for_folder(t){this._pure_keys_box(t).forEach((s=>{this._set_box(t,s,!1)}))},has(t){return this._get(t)},has_for_folder(t,s){return this._get_box(t,s)}};class VuePermissionRepository extends VueBaseRepository{constructor(){super("permissions")}}Object.assign(VuePermissionRepository.prototype,us);const ms={get_variants(){return this._get("__VARIANTS__")},set_variants(t){this._set("__VARIANTS__",t)}};class VueRolePermissionsRepository extends VueBoxRepository{}Object.assign(VueRolePermissionsRepository.prototype,ms);class VueFlatCurrentRepository extends VueFlatRepository{}Object.assign(VueFlatCurrentRepository.prototype,Yt);var gs=a(9714),hs=a.n(gs);class HttpApiError extends Error{}class HttpApi extends AbstractApi{constructor(t){super(),(0,R.Z)(this,"login_with_credentials",(async t=>await this.perform_request(LoginCredentialsResponse,"/login/credentials/",{method:"post",data:JSON.stringify({username:t.data.username,password:t.data.password})}))),(0,R.Z)(this,"login_with_token",(async()=>await this.perform_request(LoginTokenResponse,"/login/token/"))),(0,R.Z)(this,"get_info",(async()=>await this.perform_request(GetInfoResponse,"/my/info/"))),(0,R.Z)(this,"get_users",(async()=>await this.perform_request(GetUsersResponse,"/users/"))),(0,R.Z)(this,"set_user",(async t=>await this.perform_request(SetUserResponse,`/users/${t.data.username}/`,{method:"put",data:JSON.stringify({is_active:t.data.is_active,access_group_regex:t.data.access_group_regex,role:t.data.role,role_inside_group:t.data.role_inside_group,role_outside_group:t.data.role_outside_group})}))),(0,R.Z)(this,"delete_user",(async t=>await this.perform_request(DeleteUserResponse,`/users/${t.data.username}/`,{method:"delete"}))),(0,R.Z)(this,"get_user_replacements",(async()=>await this.perform_request(GetUserReplacementsResponse,"/user-replacements/"))),(0,R.Z)(this,"add_user_replacement",(async t=>await this.perform_request(AddUserReplacementResponse,"/user-replacements/",{method:"post",data:JSON.stringify({username:t.data.username})}))),(0,R.Z)(this,"delete_user_replacement",(async t=>await this.perform_request(DeleteUserReplacementResponse,`/user-replacements/${t.data.username}/`,{method:"delete"}))),(0,R.Z)(this,"get_user_replacements_of_user",(async t=>await this.perform_request(GetUserReplacementsOfUserResponse,`/users/${t.data.username}/replacements/`))),(0,R.Z)(this,"add_user_replacement_to_user",(async t=>await this.perform_request(AddUserReplacementToUserResponse,`/users/${t.data.username_to_be_replaced}/replacements/`,{method:"post",data:JSON.stringify({username:t.data.replaced_with_username})}))),(0,R.Z)(this,"delete_user_replacement_from_user",(async t=>await this.perform_request(DeleteUserReplacementFromUserResponse,`/users/${t.data.username_to_be_replaced}/replacements/${t.data.replaced_with_username}/`,{method:"delete"}))),(0,R.Z)(this,"get_on_behalf_users",(async()=>await this.perform_request(GetOnBehalfUsersResponse,"/on-behalf/"))),(0,R.Z)(this,"set_on_behalf_user",(async t=>await this.perform_request(SetOnBehalfUserResponse,`/on-behalf/${t.data.username}/`,{method:"put"}))),(0,R.Z)(this,"delete_on_behalf_user",(async t=>await this.perform_request(DeleteOnBehalfUserResponse,`/on-behalf/${t.data.username}/`,{method:"delete"}))),(0,R.Z)(this,"get_folders",(async()=>await this.perform_request(GetFoldersResponse,"/folders/"))),(0,R.Z)(this,"add_folder",(async t=>await this.perform_request(AddFolderResponse,"/folders/",{method:"post",data:JSON.stringify({name:t.data.name,storage_path:t.data.storage_path,master_usergroup_slug:t.data.master_usergroup_slug,access_group:t.data.access_group,settings:t.data.settings})}))),(0,R.Z)(this,"update_folder",(async t=>await this.perform_request(UpdateFolderResponse,`/folders/${t.data.id}/`,{method:"put",data:JSON.stringify({name:t.data.name,storage_path:t.data.storage_path,master_usergroup_slug:t.data.master_usergroup_slug,access_group:t.data.access_group,settings:t.data.settings})}))),(0,R.Z)(this,"delete_folder",(async t=>await this.perform_request(DeleteFolderResponse,`/folders/${t.data.id}/`,{method:"delete"}))),(0,R.Z)(this,"get_roles",(async()=>await this.perform_request(GetRolesResponse,"/roles/"))),(0,R.Z)(this,"add_role",(async t=>await this.perform_request(AddRoleResponse,"/roles/",{method:"post",data:JSON.stringify({name:t.data.name})}))),(0,R.Z)(this,"delete_role",(async t=>await this.perform_request(DeleteRoleResponse,`/roles/${t.data.name}/`,{method:"delete"}))),(0,R.Z)(this,"get_user_folder_settings",(async()=>await this.perform_request(GetUserFolderSettingsResponse,"/user-folder-settings/"))),(0,R.Z)(this,"add_user_folder_settings",(async t=>await this.perform_request(AddUserFolderSettingsResponse,"/user-folder-settings/",{method:"post",data:JSON.stringify({folder:t.data.folder_id,usergroup:t.data.usergroup_slug,user:t.data.username,role:t.data.role,search_schema:t.data.search_schema})}))),(0,R.Z)(this,"set_user_folder_settings",(async t=>await this.perform_request(UpdateUserFolderSettingsResponse,`/user-folder-settings/${t.data.id}/`,{method:"put",data:JSON.stringify({folder:t.data.folder_id,usergroup:t.data.usergroup_slug,user:t.data.username,role:t.data.role,search_schema:t.data.search_schema})}))),(0,R.Z)(this,"delete_user_folder_settings",(async t=>await this.perform_request(DeleteUserFolderSettingsResponse,`/user-folder-settings/${t.data.id}/`,{method:"delete"}))),(0,R.Z)(this,"get_permissions",(async()=>await this.perform_request(GetPermissionsResponse,"/permissions/"))),(0,R.Z)(this,"add_permission",(async t=>await this.perform_request(AddPermissionResponse,`/roles/${t.data.role}/permissions/`,{method:"post",data:JSON.stringify({name:t.data.permission})}))),(0,R.Z)(this,"delete_permission",(async t=>await this.perform_request(DeletePermissionResponse,`/roles/${t.data.role}/permissions/${t.data.permission}/`,{method:"delete"}))),(0,R.Z)(this,"get_user_permissions",(async()=>await this.perform_request(GetUserPermissionsResponse,"/my/permissions/"))),(0,R.Z)(this,"get_user_permissions_for_folder",(async t=>await this.perform_request(GetUserPermissionsForFolderResponse,`/my/permissions/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/`))),(0,R.Z)(this,"get_user_search_schema",(async t=>await this.perform_request(GetUserSearchSchemaResponse,`/my/folder-search-schema/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/`))),(0,R.Z)(this,"set_user_search_schema",(async t=>await this.perform_request(SetUserSearchSchemaResponse,`/my/folder-search-schema/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/`,{method:"put",data:JSON.stringify({search_schema:t.data.search_schema})}))),(0,R.Z)(this,"delete_user_search_schema",(async t=>await this.perform_request(DeleteUserSearchSchemaResponse,`/my/folder-search-schema/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/`,{method:"delete"}))),(0,R.Z)(this,"get_document",(async t=>await this.perform_request(GetDocumentResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/${t.data.document_id}/`))),(0,R.Z)(this,"get_previous_documents",(async t=>await this.perform_request(GetPreviousDocumentsResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/${t.data.document_id}/previous/${t.data.count}/`))),(0,R.Z)(this,"get_many_documents",(async t=>{const s={};return Object.keys(t.data.query).forEach((a=>{const r=t.data.query[a];""!==r&&(s[a]=r)})),await this.perform_request(GetManyDocumentsResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/`,{parameters:s})})),(0,R.Z)(this,"get_waiting_document_approvals",(async()=>await this.perform_request(GetWaitingDocumentApprovalsResponse,"/documents/waiting-approvals/"))),(0,R.Z)(this,"push_document_button",(async t=>await this.perform_request(PushDocumentButtonResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/${t.data.document_id}/actions/`,{method:"post",data:JSON.stringify({action:t.data.action})}))),(0,R.Z)(this,"save_many_documents",(async t=>await this.perform_request(SaveManyDocumentsResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/`,{method:"put",data:JSON.stringify(t.data.docs)}))),(0,R.Z)(this,"duplicate_document_to_usergroup",(async t=>await this.perform_request(DuplicateDocumentToUsergroupResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.source_usergroup_id}/documents/${t.data.document_id}/copy_to_usergroup/${t.data.target_usergroup_id}/`,{method:"post",data:JSON.stringify({})}))),(0,R.Z)(this,"duplicate_many_documents_to_usergroup",(async t=>await this.perform_request(DuplicateManyDocumentsToUsergroupResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.source_usergroup_id}/documents/copy_to_usergroup/${t.data.target_usergroup_id}/`,{method:"post",data:JSON.stringify(t.data.document_ids)}))),(0,R.Z)(this,"delete_many_documents",(async t=>await this.perform_request(DeleteManyDocumentsResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/`,{method:"delete",data:JSON.stringify(t.data.ids)}))),(0,R.Z)(this,"upload_file_to_folder",(async t=>{const s=new FormData;return s.append("id",t.data.id),s.append("file",t.data.original_file),await this.perform_request(UploadFileToFolderResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/files/`,{method:"post",content_type:null,data:s,headers:{"X-FILE-ID":t.data.id}})})),(0,R.Z)(this,"download_file_from_folder",(async t=>await this.perform_request(DownloadFileFromFolderResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/files/${t.data.id}/`,{response_type:"blob",set_download_size_method:t.data.set_size_method}))),(0,R.Z)(this,"download_many_documents_files_as_archive",(async t=>await this.perform_request(DownloadManyDocumentsFilesAsArchiveResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/download/archive/`,{method:"post",data:JSON.stringify({ids:t.data.document_ids}),response_type:"blob",set_download_size_method:t.data.set_size_method}))),(0,R.Z)(this,"download_document_files_as_archive",(async t=>await this.perform_request(DownloadDocumentFilesAsArchiveResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/${t.data.document_id}/download/archive/`,{response_type:"blob",set_download_size_method:t.data.set_size_method}))),(0,R.Z)(this,"get_spare_files",(async t=>await this.perform_request(GetSpareFilesResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/files/spare/`))),(0,R.Z)(this,"delete_file_from_folder",(async t=>await this.perform_request(DeleteFileFromFolderResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/files/${t.data.id}/`,{method:"delete"}))),(0,R.Z)(this,"update_file_from_folder",(async t=>await this.perform_request(UpdateFileFromFolderResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/files/${t.data.id}/`,{method:"put",data:JSON.stringify({name:t.data.name})}))),(0,R.Z)(this,"get_file_info",(async t=>await this.perform_request(GetFileInfoResponse,`/files/${t.data.id}/info/`))),(0,R.Z)(this,"get_upload_progress",(async()=>await this.perform_request(GetUploadProgressResponse,"/files/upload/progress/"))),(0,R.Z)(this,"get_pdf_merge_files",(async()=>await this.perform_request(GetPdfMergeFilesResponse,"/service/pdfmerge/files/"))),(0,R.Z)(this,"upload_pdf_merge_file",(async t=>{const s=new FormData;return s.append("id",t.data.id),s.append("order",t.data.order),s.append("file",t.data.original_file),await this.perform_request(UploadPdfMergeFileResponse,"/service/pdfmerge/files/",{method:"post",content_type:null,data:s,headers:{"X-FILE-ID":t.data.id}})})),(0,R.Z)(this,"update_pdf_merge_file",(async t=>await this.perform_request(UpdatePdfMergeFileResponse,`/service/pdfmerge/files/${t.data.id}/`,{method:"put",data:JSON.stringify({order:t.data.order,page_from:t.data.page_from,page_to:t.data.page_to,angle:t.data.angle})}))),(0,R.Z)(this,"delete_pdf_merge_file",(async t=>await this.perform_request(DeletePdfMergeFileResponse,`/service/pdfmerge/files/${t.data.id}/`,{method:"delete"}))),(0,R.Z)(this,"download_pdf_merge_result",(async t=>await this.perform_request(DownloadPdfMergeResultResponse,"/service/pdfmerge/merge/",{response_type:"blob",set_download_size_method:t.data.set_size_method,parameters:{keep_bookmarks:t.data.keep_bookmarks,add_filenames_as_bookmarks:t.data.add_filenames_as_bookmarks}}))),(0,R.Z)(this,"download_pdf_mix_result",(async t=>await this.perform_request(DownloadPdfMixResultResponse,"/service/pdfmerge/mix/",{response_type:"blob",set_download_size_method:t.data.set_size_method}))),(0,R.Z)(this,"get_user_groups",(async()=>await this.perform_request(GetUserGroupsResponse,"/usergroups/"))),(0,R.Z)(this,"add_user_group",(async t=>await this.perform_request(AddUserGroupResponse,"/usergroups/",{method:"post",data:JSON.stringify({name:t.data.name,slug:t.data.slug,is_private:t.data.is_private})}))),(0,R.Z)(this,"set_user_group",(async t=>await this.perform_request(SetUserGroupResponse,`/usergroups/${t.data.id}/`,{method:"put",data:JSON.stringify({name:t.data.name,slug:t.data.slug,is_private:t.data.is_private})}))),(0,R.Z)(this,"delete_user_group",(async t=>await this.perform_request(DeleteUserGroupResponse,`/usergroups/${t.data.id}/`,{method:"delete"}))),(0,R.Z)(this,"add_user_to_user_group",(async t=>await this.perform_request(AddUserToUserGroupResponse,`/usergroups/${t.data.id}/users/`,{method:"post",data:JSON.stringify({username:t.data.username})}))),(0,R.Z)(this,"delete_user_from_user_group",(async t=>await this.perform_request(DeleteUserFromUserGroupResponse,`/usergroups/${t.data.id}/users/${t.data.username}/`,{method:"delete"}))),(0,R.Z)(this,"get_share_files",(async()=>await this.perform_request(GetShareFilesResponse,"/service/share/files/"))),(0,R.Z)(this,"upload_share_file",(async t=>{const s=new FormData;return s.append("id",t.data.id),s.append("file",t.data.original_file),await this.perform_request(UploadShareFileResponse,"/service/share/files/",{method:"post",content_type:null,data:s,headers:{"X-FILE-ID":t.data.id}})})),(0,R.Z)(this,"delete_share_file",(async t=>await this.perform_request(DeleteShareFileResponse,`/service/share/files/${t.data.id}/`,{method:"delete"}))),(0,R.Z)(this,"download_share_file",(async t=>await this.perform_request(DownloadShareFileResponse,`/service/share/files/${t.data.id}/`,{response_type:"blob",set_download_size_method:t.data.set_size_method}))),(0,R.Z)(this,"get_flows",(async t=>{const s={};return Object.keys(t.data.query).forEach((a=>{const r=t.data.query[a];""!==r&&(s[a]=r)})),await this.perform_request(GetFlowsResponse,"/workflow/flows/",{parameters:s})})),(0,R.Z)(this,"add_flow",(async t=>await this.perform_request(AddFlowResponse,"/workflow/flows/",{method:"post",data:JSON.stringify({name:t.data.name,trigger:t.data.trigger,is_active:t.data.is_active,is_multiple:t.data.is_multiple,message_if_fail:t.data.message_if_fail,process:t.data.process})}))),(0,R.Z)(this,"update_flow",(async t=>await this.perform_request(UpdateFlowResponse,`/workflow/flows/${t.data.id}/`,{method:"put",data:JSON.stringify({name:t.data.name,trigger:t.data.trigger,is_active:t.data.is_active,is_multiple:t.data.is_multiple,message_if_fail:t.data.message_if_fail,process:t.data.process})}))),(0,R.Z)(this,"delete_flow",(async t=>await this.perform_request(DeleteFlowResponse,`/workflow/flows/${t.data.id}/`,{method:"delete"}))),(0,R.Z)(this,"get_flow_item",(async t=>await this.perform_request(GetFlowItemResponse,`/workflow/flowitems/${t.data.id}/`))),(0,R.Z)(this,"restart_flow_item",(async t=>await this.perform_request(RestartFlowItemResponse,`/workflow/flowitems/${t.data.id}/restart/`))),(0,R.Z)(this,"get_many_flow_items",(async t=>{const s={};return Object.keys(t.data.query).forEach((a=>{const r=t.data.query[a];""!==r&&(s[a]=r)})),await this.perform_request(GetManyFlowItemsResponse,"/workflow/flowitems/",{parameters:s})})),(0,R.Z)(this,"get_flow_item_steps",(async t=>await this.perform_request(GetFlowItemStepsResponse,`/workflow/flowitems/${t.data.flowitem_id}/steps/`))),(0,R.Z)(this,"get_many_documents_approvals",(async t=>{const s={};return Object.keys(t.data.query).forEach((a=>{const r=t.data.query[a];""!==r&&(s[a]=r)})),await this.perform_request(GetManyDocumentsApprovalsResponse,"/documents/approvals/",{parameters:s})})),(0,R.Z)(this,"get_document_approvals",(async t=>await this.perform_request(GetDocumentApprovalsResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/${t.data.document_id}/approvals/`))),(0,R.Z)(this,"add_document_approval",(async t=>await this.perform_request(AddDocumentApprovalResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/${t.data.document_id}/approvals/`,{method:"post",data:JSON.stringify({username:t.data.username})}))),(0,R.Z)(this,"update_document_approval",(async t=>await this.perform_request(UpdateDocumentApprovalResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/${t.data.document_id}/approvals/${t.data.approval_id}/`,{method:"put",data:JSON.stringify({state:t.data.state,files:t.data.files,comments:t.data.comments})}))),(0,R.Z)(this,"delete_document_approval",(async t=>await this.perform_request(DeleteDocumentApprovalResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/${t.data.document_id}/approvals/${t.data.approval_id}/`,{method:"delete"}))),(0,R.Z)(this,"delegate_document_approval",(async t=>await this.perform_request(DelegateDocumentApprovalResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/${t.data.document_id}/approvals/${t.data.approval_id}/delegate/`,{method:"post",data:JSON.stringify({username:t.data.username,with_return:t.data.with_return})}))),(0,R.Z)(this,"get_document_approval_spare_files",(async t=>await this.perform_request(GetDocumentApprovalSpareFilesResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/${t.data.document_id}/approvals/files/spare/`))),(0,R.Z)(this,"upload_document_approval_file",(async t=>{const s=new FormData;return s.append("id",t.data.file_id),s.append("file",t.data.original_file),await this.perform_request(UploadDocumentApprovalFileResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/${t.data.document_id}/approvals/files/`,{method:"post",content_type:null,data:s,headers:{"X-FILE-ID":t.data.file_id}})})),(0,R.Z)(this,"delete_document_approval_file",(async t=>await this.perform_request(DeleteDocumentApprovalFileResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/${t.data.document_id}/approvals/files/${t.data.file_id}/`,{method:"delete"}))),(0,R.Z)(this,"empty_cart",(async()=>await this.perform_request(EmptyCartResponse,"/cart/empty/",{method:"delete"}))),(0,R.Z)(this,"get_cart_documents",(async()=>await this.perform_request(GetCartDocumentsResponse,"/cart/documents/"))),(0,R.Z)(this,"add_many_documents_to_cart",(async t=>await this.perform_request(AddManyDocumentsToCartResponse,`/cart/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/`,{method:"post",data:JSON.stringify({ids:t.data.document_ids})}))),(0,R.Z)(this,"add_document_to_cart",(async t=>await this.perform_request(AddDocumentToCartResponse,`/cart/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/${t.data.document_id}/`,{method:"post"}))),(0,R.Z)(this,"remove_document_from_cart",(async t=>await this.perform_request(RemoveDocumentFromCartResponse,`/cart/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/${t.data.document_id}/`,{method:"delete"}))),(0,R.Z)(this,"get_document_approval_flow",(async t=>await this.perform_request(GetDocumentApprovalFlowResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/${t.data.document_id}/approval-flow/`))),(0,R.Z)(this,"set_document_approval_flow",(async t=>await this.perform_request(SetDocumentApprovalFlowResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/${t.data.document_id}/approval-flow/`,{method:"put",data:JSON.stringify({steps:t.data.steps})}))),(0,R.Z)(this,"start_document_approval_flow",(async t=>await this.perform_request(StartDocumentApprovalFlowResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/${t.data.document_id}/approval-flow/start/`,{method:"put"}))),(0,R.Z)(this,"stop_document_approval_flow",(async t=>await this.perform_request(StopDocumentApprovalFlowResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/documents/${t.data.document_id}/approval-flow/stop/`,{method:"put"}))),(0,R.Z)(this,"get_server_settings",(async()=>await this.perform_request(GetServerSettingsResponse,"/server-settings/"))),(0,R.Z)(this,"update_server_setting",(async t=>await this.perform_request(UpdateServerSettingResponse,`/server-settings/${t.data.id}/`,{method:"put",data:JSON.stringify({value:t.data.value})}))),(0,R.Z)(this,"get_mailboxes",(async()=>await this.perform_request(GetMailBoxesResponse,"/mail/boxes/"))),(0,R.Z)(this,"add_mailbox",(async t=>await this.perform_request(AddMailBoxResponse,"/mail/boxes/",{method:"post",data:JSON.stringify({out_protocol:t.data.out_protocol,out_encryption:t.data.out_encryption,out_port:t.data.out_port,out_server:t.data.out_server,in_protocol:t.data.in_protocol,in_encryption:t.data.in_encryption,in_port:t.data.in_port,in_server:t.data.in_server,username:t.data.username,password:t.data.password,name:t.data.name})}))),(0,R.Z)(this,"update_mailbox",(async t=>await this.perform_request(UpdateMailBoxResponse,`/mail/boxes/${t.data.id}/`,{method:"put",data:JSON.stringify({out_protocol:t.data.out_protocol,out_encryption:t.data.out_encryption,out_port:t.data.out_port,out_server:t.data.out_server,in_protocol:t.data.in_protocol,in_encryption:t.data.in_encryption,in_port:t.data.in_port,in_server:t.data.in_server,username:t.data.username,password:t.data.password,name:t.data.name})}))),(0,R.Z)(this,"delete_mailbox",(async t=>await this.perform_request(DeleteMailBoxResponse,`/mail/boxes/${t.data.id}/`,{method:"delete"}))),(0,R.Z)(this,"get_mail_channels",(async()=>await this.perform_request(GetMailChannelsResponse,"/mail/channels/"))),(0,R.Z)(this,"add_mail_channel",(async t=>await this.perform_request(AddMailChannelResponse,"/mail/channels/",{method:"post",data:JSON.stringify({name:t.data.name,folder:t.data.folder,storage_path:t.data.storage_path,settings:t.data.settings,is_active:t.data.is_active})}))),(0,R.Z)(this,"update_mail_channel",(async t=>await this.perform_request(UpdateMailChannelResponse,`/mail/channels/${t.data.id}/`,{method:"put",data:JSON.stringify({name:t.data.name,folder:t.data.folder,storage_path:t.data.storage_path,settings:t.data.settings,is_active:t.data.is_active})}))),(0,R.Z)(this,"delete_mail_channel",(async t=>await this.perform_request(DeleteMailChannelResponse,`/mail/channels/${t.data.id}/`,{method:"delete"}))),(0,R.Z)(this,"add_mail_channel_to_mailbox",(async t=>await this.perform_request(AddMailChannelToMailBoxResponse,`/mail/boxes/${t.data.mailbox_id}/channels/`,{method:"post",data:JSON.stringify({id:t.data.mailchannel_id})}))),(0,R.Z)(this,"delete_mail_channel_from_mailbox",(async t=>await this.perform_request(DeleteMailChannelFromMailBoxResponse,`/mail/boxes/${t.data.mailbox_id}/channels/${t.data.mailchannel_id}/`,{method:"delete"}))),(0,R.Z)(this,"fetch_mail_channel",(async t=>await this.perform_request(FetchMailChannelResponse,`/mail/channels/${t.data.id}/fetch/`))),(0,R.Z)(this,"get_mail_messages",(async t=>{const s={};return Object.keys(t.data.query).forEach((a=>{const r=t.data.query[a];""!==r&&(s[a]=r)})),await this.perform_request(GetMailMessagesResponse,"/mail/messages/",{parameters:s})})),(0,R.Z)(this,"delete_mail_message",(async t=>await this.perform_request(DeleteMailMessageResponse,`/mail/messages/${t.data.id}/`,{method:"delete"}))),(0,R.Z)(this,"download_mail_message",(async t=>await this.perform_request(DownloadMailMessageResponse,`/mail/messages/${t.data.id}/${t.data.format}/`,{response_type:"blob",set_download_size_method:t.data.set_size_method}))),(0,R.Z)(this,"download_mail_message_attachment",(async t=>await this.perform_request(DownloadMailMessageAttachmentResponse,`/mail/messages/${t.data.message_id}/attachments/${t.data.id}/`,{response_type:"blob",set_download_size_method:t.data.set_size_method}))),(0,R.Z)(this,"get_counters",(async()=>await this.perform_request(GetCountersResponse,"/service/counters/"))),(0,R.Z)(this,"add_counter",(async t=>await this.perform_request(AddCounterResponse,"/service/counters/",{method:"post",data:JSON.stringify({name:t.data.name,description:t.data.description,value:t.data.value,increment:t.data.increment})}))),(0,R.Z)(this,"update_counter",(async t=>await this.perform_request(UpdateCounterResponse,`/service/counters/${t.data.id}/`,{method:"put",data:JSON.stringify({name:t.data.name,description:t.data.description,value:t.data.value,increment:t.data.increment})}))),(0,R.Z)(this,"delete_counter",(async t=>await this.perform_request(DeleteCounterResponse,`/service/counters/${t.data.id}/`,{method:"delete"}))),(0,R.Z)(this,"download_transmittal_cover_sheet",(async t=>await this.perform_request(DownloadTransmittalCoverSheetResponse,`/folders/${t.data.folder_id}/usergroups/${t.data.usergroup_id}/transmittal_cover_sheets/`,{response_type:"blob",set_download_size_method:t.data.set_size_method,parameters:{template:t.data.template,document_ids:t.data.document_ids.join(",")}}))),this.api_url=t,this.REQUEST_HANDLERS={GetInfoRequest:this.get_info,LoginCredentialsRequest:this.login_with_credentials,LoginTokenRequest:this.login_with_token,GetUsersRequest:this.get_users,SetUserRequest:this.set_user,DeleteUserRequest:this.delete_user,GetUserReplacementsRequest:this.get_user_replacements,AddUserReplacementRequest:this.add_user_replacement,DeleteUserReplacementRequest:this.delete_user_replacement,GetUserReplacementsOfUserRequest:this.get_user_replacements_of_user,AddUserReplacementToUserRequest:this.add_user_replacement_to_user,DeleteUserReplacementFromUserRequest:this.delete_user_replacement_from_user,GetOnBehalfUsersRequest:this.get_on_behalf_users,SetOnBehalfUserRequest:this.set_on_behalf_user,DeleteOnBehalfUserRequest:this.delete_on_behalf_user,GetUserGroupsRequest:this.get_user_groups,AddUserGroupRequest:this.add_user_group,SetUserGroupRequest:this.set_user_group,DeleteUserGroupRequest:this.delete_user_group,AddUserToUserGroupRequest:this.add_user_to_user_group,DeleteUserFromUserGroupRequest:this.delete_user_from_user_group,GetFoldersRequest:this.get_folders,AddFolderRequest:this.add_folder,DeleteFolderRequest:this.delete_folder,UpdateFolderRequest:this.update_folder,GetRolesRequest:this.get_roles,AddRoleRequest:this.add_role,DeleteRoleRequest:this.delete_role,GetUserFolderSettingsRequest:this.get_user_folder_settings,AddUserFolderSettingsRequest:this.add_user_folder_settings,UpdateUserFolderSettingsRequest:this.set_user_folder_settings,DeleteUserFolderSettingsRequest:this.delete_user_folder_settings,GetPermissionsRequest:this.get_permissions,AddPermissionRequest:this.add_permission,DeletePermissionRequest:this.delete_permission,GetUserPermissionsRequest:this.get_user_permissions,GetUserPermissionsForFolderRequest:this.get_user_permissions_for_folder,GetUserSearchSchemaRequest:this.get_user_search_schema,SetUserSearchSchemaRequest:this.set_user_search_schema,DeleteUserSearchSchemaRequest:this.delete_user_search_schema,GetDocumentRequest:this.get_document,GetManyDocumentsRequest:this.get_many_documents,GetWaitingDocumentApprovalsRequest:this.get_waiting_document_approvals,SaveManyDocumentsRequest:this.save_many_documents,DeleteManyDocumentsRequest:this.delete_many_documents,DuplicateDocumentToUsergroupRequest:this.duplicate_document_to_usergroup,DuplicateManyDocumentsToUsergroupRequest:this.duplicate_many_documents_to_usergroup,GetPreviousDocumentsRequest:this.get_previous_documents,PushDocumentButtonRequest:this.push_document_button,DownloadTransmittalCoverSheetRequest:this.download_transmittal_cover_sheet,GetManyDocumentsApprovalsRequest:this.get_many_documents_approvals,GetDocumentApprovalsRequest:this.get_document_approvals,AddDocumentApprovalRequest:this.add_document_approval,UpdateDocumentApprovalRequest:this.update_document_approval,DeleteDocumentApprovalRequest:this.delete_document_approval,DelegateDocumentApprovalRequest:this.delegate_document_approval,GetDocumentApprovalSpareFilesRequest:this.get_document_approval_spare_files,UploadDocumentApprovalFileRequest:this.upload_document_approval_file,DeleteDocumentApprovalFileRequest:this.delete_document_approval_file,GetDocumentApprovalFlowRequest:this.get_document_approval_flow,SetDocumentApprovalFlowRequest:this.set_document_approval_flow,StartDocumentApprovalFlowRequest:this.start_document_approval_flow,StopDocumentApprovalFlowRequest:this.stop_document_approval_flow,EmptyCartRequest:this.empty_cart,GetCartDocumentsRequest:this.get_cart_documents,AddDocumentToCartRequest:this.add_document_to_cart,AddManyDocumentsToCartRequest:this.add_many_documents_to_cart,RemoveDocumentFromCartRequest:this.remove_document_from_cart,UploadFileToFolderRequest:this.upload_file_to_folder,DownloadFileFromFolderRequest:this.download_file_from_folder,DownloadManyDocumentsFilesAsArchiveRequest:this.download_many_documents_files_as_archive,DownloadDocumentFilesAsArchiveRequest:this.download_document_files_as_archive,DeleteFileFromFolderRequest:this.delete_file_from_folder,UpdateFileFromFolderRequest:this.update_file_from_folder,GetFileInfoRequest:this.get_file_info,GetSpareFilesRequest:this.get_spare_files,GetUploadProgressRequest:this.get_upload_progress,GetServerSettingsRequest:this.get_server_settings,UpdateServerSettingRequest:this.update_server_setting,GetMailBoxesRequest:this.get_mailboxes,AddMailBoxRequest:this.add_mailbox,UpdateMailBoxRequest:this.update_mailbox,DeleteMailBoxRequest:this.delete_mailbox,GetMailChannelsRequest:this.get_mail_channels,AddMailChannelRequest:this.add_mail_channel,UpdateMailChannelRequest:this.update_mail_channel,DeleteMailChannelRequest:this.delete_mail_channel,AddMailChannelToMailBoxRequest:this.add_mail_channel_to_mailbox,DeleteMailChannelFromMailBoxRequest:this.delete_mail_channel_from_mailbox,FetchMailChannelRequest:this.fetch_mail_channel,GetMailMessagesRequest:this.get_mail_messages,DeleteMailMessageRequest:this.delete_mail_message,DownloadMailMessageRequest:this.download_mail_message,DownloadMailMessageAttachmentRequest:this.download_mail_message_attachment,GetPdfMergeFilesRequest:this.get_pdf_merge_files,UploadPdfMergeFileRequest:this.upload_pdf_merge_file,UpdatePdfMergeFileRequest:this.update_pdf_merge_file,DeletePdfMergeFileRequest:this.delete_pdf_merge_file,DownloadPdfMergeResultRequest:this.download_pdf_merge_result,DownloadPdfMixResultRequest:this.download_pdf_mix_result,GetShareFilesRequest:this.get_share_files,UploadShareFileRequest:this.upload_share_file,DownloadShareFileRequest:this.download_share_file,DeleteShareFileRequest:this.delete_share_file,GetCountersRequest:this.get_counters,AddCounterRequest:this.add_counter,UpdateCounterRequest:this.update_counter,DeleteCounterRequest:this.delete_counter,GetFlowsRequest:this.get_flows,AddFlowRequest:this.add_flow,UpdateFlowRequest:this.update_flow,DeleteFlowRequest:this.delete_flow,GetFlowItemRequest:this.get_flow_item,RestartFlowItemRequest:this.restart_flow_item,GetManyFlowItemsRequest:this.get_many_flow_items,GetFlowItemStepsRequest:this.get_flow_item_steps}}async perform_request(t,s,{method:a="get",data:r=null,parameters:o={},content_type:n="application/json",response_type:i="text",set_upload_size_method:_=null,set_download_size_method:l=null,headers:d={}}={}){try{const p=await this.http_call(s,a,n,r,o,i,_,l,d);return new t(p)}catch(p){if(console.log(p.message),p instanceof HttpApiError)return new NegativeResponse({code:p.message});throw p}}async http_call(t,s,a,r,o,n,i,_,l){let d=new URL(`${this.api_url}${t}`);d.search=new URLSearchParams(o).toString();let p=null;if(p=await new Promise(((t,o)=>{let i=new XMLHttpRequest;i.open(s,d),i.responseType=n,null!==a&&i.setRequestHeader("Content-Type",a),0!==Object.keys(l).length&&Object.keys(l).forEach((t=>{i.setRequestHeader(t,l[t])})),this._auth_token&&null!==this._auth_token&&i.setRequestHeader("Authorization","Token "+this._auth_token),null!==_&&(i.onprogress=t=>_(t.loaded)),i.onerror=function(){console.log("Server unavailable"),o(new HttpApiError("Api.Server.Unavailable"))},i.onload=function(){(i.status<200||i.status>=300)&&(console.log("HTTP status "+i.status),o(new HttpApiError("Api.Server.InternalError")));const s=i.getResponseHeader("Content-Type"),a=Number.parseInt(i.getResponseHeader("Content-Length")),r="application/octet-stream"===s?hs().decodeWords(i.getResponseHeader("Content-Disposition")):null;t({content_type:s,content_length:a,content_disposition:r,data:i.response})},null===r?i.send():i.send(r)})),"application/octet-stream"===p.content_type){const t=/filename\s*=\s*"(?<filename>.+)"/g,s=t.exec(p.content_disposition),a=/filename\*=utf-8''(?<filename>.+)/g,r=a.exec(p.content_disposition),o=null===s?r:s;return{file:p.data,name:decodeURI(o.groups.filename).replace(/%2C/g,",").replace(/%40/g,"@").replace(/%3F/g,"?"),size:p.content_length}}let c={};try{c=p.data instanceof Blob&&"application/json"===p.data.type?JSON.parse(await p.data.text()):JSON.parse(p.data)}catch(u){throw new HttpApiError("Api.Server.InternalError")}if(!c.success||c.code)throw console.log("Response error code ",c.code),new HttpApiError(c.code);return c.data}}class api_provider_NotImplementedError extends Error{}class AbstractApiProvider{constructor(){(0,R.Z)(this,"get",(()=>{throw new api_provider_NotImplementedError}))}}class HttpApiProvider extends AbstractApiProvider{constructor(...t){super(...t),(0,R.Z)(this,"get",(()=>new HttpApi(window.location.origin+"/api/v1")))}}var fs=a(2854),vs=a.n(fs);class notificator_NotImplementedError extends Error{}class AbstractNotificator{constructor(){(0,R.Z)(this,"success",(()=>{throw new notificator_NotImplementedError})),(0,R.Z)(this,"info",(()=>{throw new notificator_NotImplementedError})),(0,R.Z)(this,"warning",(()=>{throw new notificator_NotImplementedError})),(0,R.Z)(this,"error",(()=>{throw new notificator_NotImplementedError}))}}class NotyNotificator extends AbstractNotificator{constructor(){super(),(0,R.Z)(this,"do",((t,s)=>{new(vs())(Object.assign(this.default,{type:t,text:s})).show()})),(0,R.Z)(this,"success",(t=>{this.do("success",t)})),(0,R.Z)(this,"info",(t=>{this.do("info",t)})),(0,R.Z)(this,"warning",(t=>{this.do("warning",t)})),(0,R.Z)(this,"error",(t=>{this.do("error",t)})),this.default={layout:"topRight",theme:"relax",timeout:"3000",progressBar:!1}}}class timer_NotImplementedError extends Error{}class AbstractTimer{constructor(t){(0,R.Z)(this,"set_callback",(t=>{this._callback=t})),(0,R.Z)(this,"start",(()=>{this._timer=setInterval(this._callback,this._period)})),(0,R.Z)(this,"stop",(()=>{clearInterval(this._timer),this._timer=null})),this._callback=()=>{throw new timer_NotImplementedError},this._period=t,this._timer=null}}class UploadProgressTimer extends AbstractTimer{constructor(t){super(t),(0,R.Z)(this,"start",(()=>{0!==this._ids.length&&(this._timer=setInterval(this._callback,this._period))})),(0,R.Z)(this,"add",(t=>{this._ids.includes(t)||this._ids.push(t),null===this._timer&&this.start()})),(0,R.Z)(this,"remove",(t=>{this._ids=this._ids.filter((s=>s!==t)),0===this._ids.length&&this.stop()})),this._folder_id=null,this._ids=[]}}class WaitSecondsTimer{constructor(t=1e3){(0,R.Z)(this,"start",(()=>{this._timer=setInterval(this._decrease_seconds,this._period)})),(0,R.Z)(this,"stop",(()=>{clearInterval(this._timer),this._timer=null})),(0,R.Z)(this,"get",(t=>this._seconds[t]||0)),(0,R.Z)(this,"set",((t,s)=>{this._seconds[t]=s,null===this._timer&&this.start()})),this._timer=null,this._period=t,this._seconds=(0,i.qj)({}),this._decrease_seconds=()=>{Object.keys(this._seconds).forEach((t=>{this._seconds[t]>0&&this._seconds[t]--})),0===Object.values(this._seconds).reduce(((t,s)=>t+s),0)&&this.stop()}}}class VueFolderSettings extends VueBoxRepository{}const ws={get_approval_actions_count(){return this.get("approval_actions_count")},set_approval_actions_count(t){void 0!==t&&this.set("approval_actions_count",t)},get_approval_orders_count(){return this.get("approval_orders_count")},set_approval_orders_count(t){void 0!==t&&this.set("approval_orders_count",t)}};class VueInfoRepository extends VueFlatRepository{}Object.assign(VueInfoRepository.prototype,ws);const ys="documents",bs={reset_keeping_refs_for_docs(){this.reset_keeping_refs(ys)},doc_values(){return this.values(ys)},set_doc(t,s){this.set(ys,t,s)},get_doc(t){this.get(ys,t)},delete_doc(t){this.delete(ys,t)}};class VueCartRepository extends VueBoxRepository{}Object.assign(VueCartRepository.prototype,bs);class VueCountableFlatRepository extends VueFlatRepository{}Object.assign(VueFlatRepository.prototype,ns);class AbstractUnitOfWork{constructor(){(0,R.Z)(this,"collect_new_messages",(()=>{const t=[...this.messages];return this.messages=[],t})),(0,R.Z)(this,"push_message",(t=>{this.messages.push(t)})),this.messages=[]}}class VueUnitOfWork extends AbstractUnitOfWork{constructor(){super(),this.api=(new HttpApiProvider).get(),this.notificator=new NotyNotificator,this.upload_progress_timer=new UploadProgressTimer(2e3),this.wait_seconds_timer=new WaitSecondsTimer(1e3),this.info_repository=new VueInfoRepository("info"),this.user_repository=new VueUserRepository("users"),this.user_replacement_repository=new VueBoxRepository("user_replacements"),this.usergroup_repository=new VueUserGroupRepository("usergroups"),this.token_repository=new VueTokenRepository("tokens",30),this.folder_repository=new VueFolderRepository("folders"),this.doc_repository=new VueDocRepository("documents"),this.waiting_doc_approval_repository=new VueFlatRepository("waiting_document_approvals"),this.search_doc_approval_repository=new VueCountableFlatRepository("search_document_approvals"),this.doc_approval_repository=new VueBoxRepository("document_approvals"),this.doc_approval_flow_repository=new VueFlatRepository("document_approval_flows"),this.doc_approval_file_repository=new VueFileFlatRepository("files_document_approval"),this.cart_repository=new VueCartRepository("cart"),this.file_in_folder_repository=new VueFileBoxRepository("files_in_folders"),this.file_common_repository=new VueFileFlatRepository("files_common"),this.user_folder_settings_repository=new VueUserFolderSettingsRepository("user_folder_settings"),this.role_permissions_repository=new VueRolePermissionsRepository("role_permissions"),this.permission_repository=new VuePermissionRepository("permissions"),this.download_progress=new VueFileFlatRepository("download_progress"),this.folder_settings=new VueFolderSettings("folder_settings"),this.pdf_merge_file_repository=new VueFileFlatRepository("files_pdf_merge"),this.share_file_repository=new VueFileFlatRepository("files_share"),this.self_testing_question_repository=new VueFlatRepository("self_testing_questions"),this.context_repository=new VueBoxRepository("context"),this.flow_repository=new VueFlatRepository("flows"),this.flow_item_repository=new VueFlatCurrentRepository("flow_items"),this.flow_item_step_repository=new VueFlatRepository("flow_item_steps"),this.server_setting_repository=new VueFlatRepository("server_settings"),this.mailbox_repository=new VueFlatRepository("mailboxes"),this.mail_channel_repository=new VueFlatRepository("mail_channels"),this.mail_message_repository=new VueFlatRepository("mail_messages"),this.counter_repository=new VueFlatRepository("counters"),this.api.set_auth_token(this.token_repository.get_auth_token())}}const Rs={class:"page"},Fs={class:"page__input-block"},Ds={class:"page__button-block"};function LoginPagevue_type_template_id_7e14fab0_scoped_true_render(t,s,a,n,i,_){const l=(0,o.up)("heading-component"),d=(0,o.up)("form-text-input"),p=(0,o.up)("btn-component");return(0,o.wg)(),(0,o.iD)("div",Rs,[(0,o.Wm)(l,{class:"page__heading",text:"Вход",size:"middle"}),(0,o._)("form",Fs,[(0,o.Wm)(d,{class:"page__input",value:n.credentials.username,onUpdate:s[0]||(s[0]=t=>n.credentials.username=t),onKeyup:(0,r.D2)(n.login_action,["enter"]),parameters:{placeholder:"Логин Windows без домена"},autocomplete:"username"},null,8,["value","onKeyup"]),(0,o.Wm)(d,{class:"page__input",value:n.credentials.password,onUpdate:s[1]||(s[1]=t=>n.credentials.password=t),onKeyup:(0,r.D2)(n.login_action,["enter"]),parameters:{placeholder:"Пароль Windows",secure:!0},autocomplete:"current-password"},null,8,["value","onKeyup"])]),(0,o._)("div",Ds,[(0,o.Wm)(p,{class:"page__button",onClick:n.login_action,caption:"Войти",type:"primary"},null,8,["onClick"]),(0,o.Wm)(p,{class:"page__button",onClick:n.logout_action,caption:"Выйти",type:"secondary"},null,8,["onClick"])])])}const xs=["disabled"];function BtnComponentvue_type_template_id_6615cd5c_render(t,s,a,r,n,i){return(0,o.wg)(),(0,o.iD)("button",{class:(0,l.C_)(["btn",{btn_primary:"primary"===a.type,btn_secondary:"secondary"===a.type,btn_success:"success"===a.type,btn_warning:"warning"===a.type,btn_danger:"danger"===a.type,btn_disabled:!0===a.disabled,btn_small:"small"===a.size,btn_middle:"middle"===a.size,btn_big:"big"===a.size}]),disabled:a.disabled},(0,l.zw)(a.caption),11,xs)}var ks={name:"BtnComponent",props:{caption:{type:String,required:!0},type:{type:String,required:!0},disabled:{type:Boolean,required:!1,default:!1},size:{type:String,required:!1,default:"middle"}}},qs=a(3744);const Ss=(0,qs.Z)(ks,[["render",BtnComponentvue_type_template_id_6615cd5c_render]]);var Es=Ss;function HeadingComponentvue_type_template_id_e0de76cc_render(t,s,a,r,n,i){return(0,o.wg)(),(0,o.iD)("p",{class:(0,l.C_)(["heading",{heading_big:"big"===a.size,heading_middle:"middle"===a.size,heading_small:"small"===a.size}])},(0,l.zw)(a.text),3)}var As={name:"HeadingComponent",props:{text:{type:String,required:!0},size:{type:String,required:!0}}};const Cs=(0,qs.Z)(As,[["render",HeadingComponentvue_type_template_id_e0de76cc_render]]);var Us=Cs;const Ps={class:"formtextinput"},js=["type","value","placeholder","disabled"];function FormTextInputvue_type_template_id_fae75948_scoped_true_render(t,s,a,r,n,i){return(0,o.wg)(),(0,o.iD)("div",Ps,[(0,o._)("input",{class:"textinput",style:(0,l.j5)(r.style),type:!0===r.secure?"password":"text",value:a.value,placeholder:r.placeholder,disabled:r.is_disabled,onInput:s[0]||(s[0]=s=>t.$emit("update",s.target.value))},null,44,js)])}var Ms={name:"FormTextInput",props:{parameters:{type:Object,required:!1,default:()=>({})},value:{type:String,required:!1}},emits:["update"],setup(t,{emit:s}){const a=t.parameters["default"]||"";void 0!==t.value&&null!==t.value||s("update",a);const r=(0,o.Fl)((()=>t.parameters["height"]||0)),n=(0,o.Fl)((()=>0==r.value?{color:d.value}:{color:d.value,"min-height":r.value.toString()+"px","max-height":r.value.toString()+"px"})),i=(0,o.Fl)((()=>t.parameters["placeholder"]||"")),_=(0,o.Fl)((()=>t.parameters["secure"]||!1)),l=(0,o.Fl)((()=>t.parameters["is_disabled"]||!1)),d=(0,o.Fl)((()=>t.parameters["color"]||"black"));return{placeholder:i,secure:_,is_disabled:l,color:d,style:n}}};const Ts=(0,qs.Z)(Ms,[["render",FormTextInputvue_type_template_id_fae75948_scoped_true_render],["__scopeId","data-v-fae75948"]]);var Ns=Ts,Is={components:{BtnComponent:Es,HeadingComponent:Us,FormTextInput:Ns},name:"LoginPage",setup(){const t=(0,i.qj)({username:"",password:""}),s=(0,_.tv)(),a=(0,_.yj)(),r=new VueUnitOfWork,o=r.user_repository.get_current(),login_action=async()=>{const o=new LoginWithCredentials(t.username,t.password);await message_bus_MessageBus.handle(o,r),r.user_repository.is_authenticated()&&s.push({path:void 0===a.query.url?"/":decodeURIComponent(a.query.url)})},logout_action=async()=>{const t=new Logout;await message_bus_MessageBus.handle(t,r)};return{user:o,credentials:t,login_action:login_action,logout_action:logout_action,uow:r}}};const Bs=(0,qs.Z)(Is,[["render",LoginPagevue_type_template_id_7e14fab0_scoped_true_render],["__scopeId","data-v-7e14fab0"]]);var Os=Bs;const SearchDocumentPagevue_type_template_id_687d5ab8_scoped_true_withScopeId=t=>((0,o.dD)("data-v-687d5ab8"),t=t(),(0,o.Cn)(),t),zs={key:0,class:"page"},Ws={class:"page__container"},Gs={key:0,class:"page__listcontainer"},Zs={class:"page__buttonblock"},Hs={key:0,class:"page__additionalbuttonblock"},$s={class:"page__statusrow"},Ls={class:"page__resultblock"},Vs={key:0,class:"page__dropzonetitle"},Js={key:0,class:"page__dropzonetitle"},Ys=SearchDocumentPagevue_type_template_id_687d5ab8_scoped_true_withScopeId((()=>(0,o._)("div",{class:"page__filelistlabel"}," Если файлы не удаляются, значит необходимо 'Cохранить изменения'. ",-1))),Ks={key:1,class:"page"};function SearchDocumentPagevue_type_template_id_687d5ab8_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),d=(0,o.up)("document-page-download-progress-row"),p=(0,o.up)("document-page-buttons-row"),c=(0,o.up)("text-button"),u=(0,o.up)("document-page-search-row"),m=(0,o.up)("document-page-sort-row"),g=(0,o.up)("document-pagination-row"),h=(0,o.up)("form-text-field"),f=(0,o.up)("document-row"),v=(0,o.up)("json-file-drop-zone"),w=(0,o.up)("file-drop-zone"),y=(0,o.up)("file-list");return(0,o.wg)(),(0,o.iD)("div",null,[r.folder_name?((0,o.wg)(),(0,o.iD)("div",zs,[(0,o.Wm)(_,{class:"page__heading",text:`${r.folder_name} ${r.validation_progress<100?"(валидация "+r.validation_progress.toString()+"%)":""}`,size:"middle"},null,8,["text"]),(0,o._)("div",Ws,[r.is_list_container_required?((0,o.wg)(),(0,o.iD)("div",Gs,[(0,o.Wm)(d,{class:"page__downloadprogress",files:r.downloading_files},null,8,["files"]),(0,o._)("div",Zs,[(0,o.Wm)(p,{class:"page__primarybuttonblock",is_edit_mode:r.is_edit_mode,is_files_shown:r.is_files_shown,is_folder_saved:r.is_folder_saved,can_add_doc:r.can_add_doc,can_change_doc:r.can_change_doc,can_view_file:r.can_view_file,can_add_file:r.can_add_file,can_delete_file:r.can_delete_file,can_delete_doc:r.can_delete_doc,is_tuning_mode:r.is_tuning_mode,is_group_by_mode:r.is_group_by_mode,group_by_settings:r.group_by_settings,"onReset:search":s[0]||(s[0]=t=>r.is_search_clean_required=!0),"onToggle:shownfiles":s[1]||(s[1]=t=>r.is_files_shown=!r.is_files_shown),"onToggle:editmode":s[2]||(s[2]=t=>{r.is_edit_mode=!r.is_edit_mode,r.is_tuning_mode=!0!==r.is_edit_mode&&r.is_tuning_mode}),"onToggle:tuningmode":s[3]||(s[3]=t=>r.is_tuning_mode=!r.is_tuning_mode),"onToggle:groupbymode":s[4]||(s[4]=t=>r.is_group_by_mode=!r.is_group_by_mode),"onSave:docs":s[5]||(s[5]=t=>r.handle_save_documents()),"onFlush:filecontainer":s[6]||(s[6]=t=>r.handle_flush_file_container()),"onNew:doc":s[7]||(s[7]=t=>r.add_empty_document()),"onAllocate:files":s[8]||(s[8]=t=>r.handle_allocate_files()),"onReset:tuning":s[9]||(s[9]=t=>r.handle_delete_user_search_schema()),"onDelete:docs":s[10]||(s[10]=t=>r.mark_selected_documents_as_deleted()),"onDuplicate:docs":s[11]||(s[11]=t=>r.duplicate_selected_documents()),"onDownload:excel":s[12]||(s[12]=t=>r.handle_download_excel_file()),"onDownload:json":s[13]||(s[13]=t=>r.handle_download_json_file()),"onDownload:files_archive":s[14]||(s[14]=t=>r.handle_download_files_in_archive()),"onTo:cart":s[15]||(s[15]=t=>r.handle_add_to_cart())},null,8,["is_edit_mode","is_files_shown","is_folder_saved","can_add_doc","can_change_doc","can_view_file","can_add_file","can_delete_file","can_delete_doc","is_tuning_mode","is_group_by_mode","group_by_settings"]),r.is_edit_mode?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",Hs,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.action_buttons,((t,s)=>((0,o.wg)(),(0,o.j4)(c,{key:s,class:"page__actionbutton",title:t.caption,onClick:s=>r.handle_push_action_button(t.handler)},null,8,["title","onClick"])))),128))]))]),(0,o.Wm)(u,{class:"page__searchrow",search_schema:r.search_schema,is_disabled:!r.is_folder_saved,is_clean_required:r.is_search_clean_required,is_tuning_mode:r.is_tuning_mode,is_selection_required:!0,is_all_selected:r.is_all_selected,required_space_for_link:!0,"onSearch:docs":s[16]||(s[16]=t=>r.get_documents_action({search_by_user:!0,query:t})),"onClean:query":s[17]||(s[17]=t=>r.is_search_clean_required=!1),"onChange:size":s[18]||(s[18]=t=>r.handle_tuning_change_field("size",t.name,t.value)),"onChange:grow":s[19]||(s[19]=t=>r.handle_tuning_change_field("grow",t.name,t.value)),"onDelete:field":s[20]||(s[20]=t=>r.handle_tuning_delete_field(t)),"onSelectall:docs":s[21]||(s[21]=t=>r.handle_select_all_documents())},null,8,["search_schema","is_disabled","is_clean_required","is_tuning_mode","is_all_selected"]),(0,o.Wm)(m,{class:"page__sortrow",search_schema:r.search_schema,sort_asc:r.sort_asc,sort_by:r.sort_by,"onToggle:direction":s[22]||(s[22]=t=>r.sort_asc=!r.sort_asc),"onSort:by":s[23]||(s[23]=t=>[r.sort_by,r.sort_rule]=t)},null,8,["search_schema","sort_asc","sort_by"]),r.search_results.length>0?((0,o.wg)(),(0,o.j4)(g,{key:0,class:"page__paginationrow",total_count:Math.max(r.search_count,r.search_results.length),count_per_page:r.pagination_count_per_page,current_page:r.pagination_current_page,variants:r.pagination_variants,is_intermediate_part_shown:r.is_intermediate_pages_shown,"onSet:page_range":s[24]||(s[24]=t=>r.handle_set_page_range(t.min,t.max)),"onSelect:page":s[25]||(s[25]=t=>r.pagination_current_page=t),"onSet:count_per_page":s[26]||(s[26]=t=>r.pagination_count_per_page=t),"onShow:pages":s[27]||(s[27]=t=>r.is_intermediate_pages_shown=!0)},null,8,["total_count","count_per_page","current_page","variants","is_intermediate_part_shown"])):(0,o.kq)("",!0),(0,o._)("div",$s,[(0,o.Wm)(h,{value:r.search_status},null,8,["value"])]),(0,o._)("div",Ls,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.sorted_results,(t=>((0,o.wg)(),(0,o.iD)("div",{class:"page__documentblock",key:t.id},[(0,o.Wm)(f,{class:"page__documentrow",doc:t,search_schema:r.search_schema,is_selected:t.id in r.selected_document_ids,is_edit_mode:r.is_edit_mode,is_files_shown:r.is_files_shown,is_dragging:r.is_uploaded_file_dragging,has_link:!0,link_route_obj:r.generate_doc_link(t.id),"onRecover:doc":s=>r.mark_document_as_not_deleted(t.id),"onUpdate:doc":s[28]||(s[28]=t=>r.handle_update_doc_attribute(t.id,t.name,t.value)),"onDelete:file":s=>r.detach_file_from_document(t,s),"onAttach:file":s=>r.attach_file_to_document(t,s),"onDownload:file":s[29]||(s[29]=t=>r.handle_download_file(...t)),"onCopy_link_to:file":s[30]||(s[30]=t=>r.handle_copy_link_to_file_into_clipboard(t)),"onSelect:doc":s=>r.handle_select_document(t.id)},null,8,["doc","search_schema","is_selected","is_edit_mode","is_files_shown","is_dragging","link_route_obj","onRecover:doc","onDelete:file","onAttach:file","onSelect:doc"])])))),128))])])):(0,o.kq)("",!0),r.is_edit_mode&&(r.can_add_doc||r.can_add_file)?((0,o.wg)(),(0,o.iD)("div",{key:1,class:(0,l.C_)(["page__servicecontainer",{page__servicecontainer_alone:!r.is_list_container_required}])},[r.can_add_doc&&r.is_doc_container_required?((0,o.wg)(),(0,o.j4)(v,{key:0,class:(0,l.C_)(["page__docdropzone",{page__docdropzone_dragging:r.is_drag_above_doc_zone}]),"onUpdate:dragging":s[31]||(s[31]=t=>r.is_drag_above_doc_zone=t),"onUpdate:json":s[32]||(s[32]=t=>r.handle_new_docs_drop(t)),default:[],parsers:r.doc_container_parsers},{default:(0,o.w5)((()=>[r.is_drag_above_doc_zone?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("span",Vs,"> Документы (json) <"))])),_:1},8,["class","parsers"])):(0,o.kq)("",!0),r.can_add_file?((0,o.wg)(),(0,o.j4)(w,{key:1,class:(0,l.C_)(["page__filedropzone",{page__filedropzone_dragging:r.is_drag_above_file_zone}]),"onAdd:file":s[33]||(s[33]=t=>r.handle_new_file_drop(t)),"onUpdate:dragging":s[34]||(s[34]=t=>r.is_drag_above_file_zone=t)},{default:(0,o.w5)((()=>[r.is_drag_above_file_zone?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("span",Js," < "+(0,l.zw)(r.max_file_size)+" МБ",1))])),_:1},8,["class"])):(0,o.kq)("",!0),Ys,r.can_add_file?((0,o.wg)(),(0,o.j4)(y,{key:2,class:"page__filelist",files:r.spare_files,can_be_dragged:r.is_edit_mode,can_be_deleted:!0,"onDragstart:file":s[35]||(s[35]=t=>r.is_uploaded_file_dragging=!0),"onDragend:file":s[36]||(s[36]=t=>r.is_uploaded_file_dragging=!1),"onDownload:file":s[37]||(s[37]=t=>r.handle_download_file(...t)),"onDelete:file":s[38]||(s[38]=t=>r.handle_delete_file(t)),"onCopy_link_to:file":s[39]||(s[39]=t=>r.handle_copy_link_to_file_into_clipboard(t))},null,8,["files","can_be_dragged"])):(0,o.kq)("",!0)],2)):(0,o.kq)("",!0)])])):((0,o.wg)(),(0,o.iD)("div",Ks,[(0,o.Wm)(_,{class:"page__heading",text:"..невозможно загрузить данные..",size:"small"})]))])}function DocumentRowvue_type_template_id_18a3dd2d_scoped_true_render(t,s,a,n,i,_){const l=(0,o.up)("document-buttons-row"),d=(0,o.up)("document-attribute-row"),p=(0,o.up)("document-files-row"),c=(0,o.up)("document-errors-row");return(0,o.wg)(),(0,o.iD)("div",{class:"documentrow",onDrop:s[6]||(s[6]=(0,r.iM)((t=>n.handle_drop(t)),["prevent"])),onDragover:s[7]||(s[7]=(0,r.iM)((()=>{}),["prevent"])),onDragenter:s[8]||(s[8]=(0,r.iM)((()=>{}),["prevent"]))},[a.is_edit_mode?((0,o.wg)(),(0,o.j4)(l,{key:0,class:"documentrow__documentbuttonsrow",is_deleted:a.doc.is_deleted,"onRecover:doc":s[0]||(s[0]=s=>t.$emit("recover:doc"))},null,8,["is_deleted"])):(0,o.kq)("",!0),a.doc.is_deleted?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(d,{key:1,class:"documentrow__documentattributerow",id:a.doc.id,search_schema:a.search_schema,attributes:!0===a.is_edit_mode?a.doc.raw_attributes:a.doc.attributes,is_selection_required:!0,is_selected:a.is_selected,is_edit_mode:a.is_edit_mode,is_highlighted:!a.doc.is_saved,is_disabled:a.doc.is_blocked,has_link:a.has_link,link_route_obj:a.link_route_obj,"onUpdate:doc":s[1]||(s[1]=s=>t.$emit("update:doc",s)),"onSelect:doc":s[2]||(s[2]=s=>t.$emit("select:doc")),onClick:n.handle_click_attributerow},null,8,["id","search_schema","attributes","is_selected","is_edit_mode","is_highlighted","is_disabled","has_link","link_route_obj","onClick"])),a.is_files_shown&&!a.doc.is_deleted?((0,o.wg)(),(0,o.j4)(p,{key:2,class:"documentrow__documentfilesrow",files:a.doc.files,can_be_deleted:a.is_edit_mode&&!a.doc.is_blocked,can_be_dragged:a.is_edit_mode&&!a.doc.is_blocked,is_blocked:a.doc.is_blocked,"onDelete:file":s[3]||(s[3]=s=>t.$emit("delete:file",s)),"onDownload:file":s[4]||(s[4]=s=>t.$emit("download:file",s)),"onCopy_link_to:file":s[5]||(s[5]=s=>t.$emit("copy_link_to:file",s))},null,8,["files","can_be_deleted","can_be_dragged","is_blocked"])):(0,o.kq)("",!0),a.is_edit_mode&&!a.doc.is_deleted?((0,o.wg)(),(0,o.j4)(c,{key:3,class:"documentrow__documenterrorsrow",errors:a.doc.errors},null,8,["errors"])):(0,o.kq)("",!0)],32)}function DocumentAttributeRowvue_type_template_id_6127c01a_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("form-boolean-input"),d=(0,o.up)("sized-div"),p=(0,o.up)("form-text-field"),c=(0,o.up)("router-link"),u=(0,o.up)("form-text-input"),m=(0,o.up)("form-date-input");return(0,o.wg)(),(0,o.iD)("div",{class:(0,l.C_)(["documentattributerow",{documentattributerow_modified:a.is_highlighted}])},[a.is_selection_required?((0,o.wg)(),(0,o.j4)(d,{key:0,class:"documentattributerow__sizedblock_center",size:"w30"},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{class:"documentattributerow__checkbox",value:a.is_selected,parameters:{size:20},onClick:s[0]||(s[0]=s=>t.$emit("select:doc"))},null,8,["value"])])),_:1})):(0,o.kq)("",!0),a.has_link?((0,o.wg)(),(0,o.j4)(d,{key:1,class:"documentattributerow__sizedblock_center",size:"w30"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{class:"documentattributerow__href",to:a.link_route_obj},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{class:"documentattributerow__textfield",value:"@"})])),_:1},8,["to"])])),_:1})):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.search_schema,(s=>((0,o.wg)(),(0,o.j4)(d,{key:s.name,class:"documentattributerow__sizedblock",size:s.size,grow:s.grow},{default:(0,o.w5)((()=>[a.is_edit_mode&&!s.name.toLowerCase().includes("date")?((0,o.wg)(),(0,o.j4)(u,{key:0,class:"documentattributerow__textinput",value:a.attributes[s.name],parameters:{is_disabled:r.get_bool_attribute(s.is_disabled)||a.is_disabled,default:s.default},onUpdate:r=>t.$emit("update:doc",{id:a.id,name:s.name,value:r})},null,8,["value","parameters","onUpdate"])):(0,o.kq)("",!0),a.is_edit_mode&&s.name.toLowerCase().includes("date")?((0,o.wg)(),(0,o.j4)(m,{key:1,class:"documentattributerow__dateinput",value:a.attributes[s.name],parameters:{is_disabled:r.get_bool_attribute(s.is_disabled)||a.is_disabled,default:void 0===s.default||null===s.default?Math.round(Date.now()/1e3):s.default},onUpdate:r=>t.$emit("update:doc",{id:a.id,name:s.name,value:r})},null,8,["value","parameters","onUpdate"])):(0,o.kq)("",!0),a.is_edit_mode?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(p,{key:2,class:"documentattributerow__textfield",value:a.attributes[s.name],parameters:{align:s.align?s.align:"center",default:s.default}},null,8,["value","parameters"]))])),_:2},1032,["size","grow"])))),128))],2)}function SizedDivvue_type_template_id_09f6cb8c_render(t,s,a,r,n,i){return(0,o.wg)(),(0,o.iD)("div",{class:(0,l.C_)(["sizeddiv",{sizeddiv_w30:"w30"===a.size&&!1===a.grow,sizeddiv_w35:"w35"===a.size&&!1===a.grow,sizeddiv_w40:"w40"===a.size&&!1===a.grow,sizeddiv_w50:"w50"===a.size&&!1===a.grow,sizeddiv_w100:"w100"===a.size&&!1===a.grow,sizeddiv_w150:"w150"===a.size&&!1===a.grow,sizeddiv_w200:"w200"===a.size&&!1===a.grow,sizeddiv_w250:"w250"===a.size&&!1===a.grow,sizeddiv_w300:"w300"===a.size&&!1===a.grow,sizeddiv_w350:"w350"===a.size&&!1===a.grow,sizeddiv_w400:"w400"===a.size&&!1===a.grow,sizeddiv_growable:!0===a.grow}])},[(0,o.WI)(t.$slots,"default")],2)}var Xs={name:"SizedDiv",props:{size:{type:String,required:!1,default:""},grow:{type:Boolean,required:!1,default:!1}}};const Qs=(0,qs.Z)(Xs,[["render",SizedDivvue_type_template_id_09f6cb8c_render]]);var ea=Qs;const ta=["title"];function FormTextFieldvue_type_template_id_43049fc2_render(t,s,a,r,n,i){return(0,o.wg)(),(0,o.iD)("div",{class:"formtextfield",style:(0,l.j5)({"text-align":r.align,"font-weight":r.font_weight}),title:r.hint},(0,l.zw)(a.value),13,ta)}var sa={name:"FormTextField",props:{parameters:{type:Object,required:!1,default:()=>({})},value:{required:!0}},setup(t){const s=(0,o.Fl)((()=>t.parameters["align"]||"left")),a=(0,o.Fl)((()=>t.parameters["font_weight"]||"normal")),r=(0,o.Fl)((()=>t.parameters["hint"]||""));return{align:s,font_weight:a,hint:r}}};const aa=(0,qs.Z)(sa,[["render",FormTextFieldvue_type_template_id_43049fc2_render]]);var ra=aa;const oa=["value","disabled"];function FormDateInputvue_type_template_id_41f62af6_render(t,s,a,r,n,i){return(0,o.wg)(),(0,o.iD)("input",{class:"formdateinput",type:"date",value:r.date_str,onInput:s[0]||(s[0]=t=>r.handle_update_date(t)),disabled:r.is_disabled},null,40,oa)}var na={name:"FormDateInput",props:{parameters:{type:Object,required:!1,default:()=>({})},value:{type:Number,required:!1}},emits:["update"],setup(t,{emit:s}){const a=t.parameters["default"]||0;void 0!==t.value&&null!==t.value||s("update",a);const r=t.parameters["is_disabled"]||!1,n=(0,o.Fl)((()=>{const s=new Date(1e3*(t.value||a));return s.toISOString().slice(0,10)})),handle_update_date=t=>s("update",Math.floor(t.target.valueAsNumber/1e3)||0);return{date_str:n,is_disabled:r,handle_update_date:handle_update_date}}};const ia=(0,qs.Z)(na,[["render",FormDateInputvue_type_template_id_41f62af6_render]]);var _a=ia;const la={class:"formbooleaninput"},da=["title","checked","disabled"];function FormBooleanInputvue_type_template_id_1381d60c_scoped_true_render(t,s,a,r,n,i){return(0,o.wg)(),(0,o.iD)("div",la,[(0,o._)("input",{class:"booleaninput",style:(0,l.j5)(r.style),type:"checkbox",title:r.hint,checked:a.value,disabled:r.is_disabled,onChange:s[0]||(s[0]=s=>t.$emit("update",s.target.checked))},null,44,da)])}var pa={name:"FormBooleanInput",props:{parameters:{type:Object,required:!1,default:()=>({})},value:{type:Boolean,required:!1,default:void 0}},emits:["update"],setup(t,{emit:s}){const a=t.parameters["default"]||!1;void 0!==t.value&&null!==t.value||s("update",a);const r=(0,o.Fl)((()=>t.parameters["size"]||0)),n=(0,o.Fl)((()=>0==r.value?{}:{"min-width":r.value.toString()+"px","max-width":r.value.toString()+"px","min-height":r.value.toString()+"px","max-height":r.value.toString()+"px"})),i=(0,o.Fl)((()=>t.parameters["hint"]||"")),_=(0,o.Fl)((()=>t.parameters["is_disabled"]||!1));return{size:r,hint:i,is_disabled:_,style:n}}};const ca=(0,qs.Z)(pa,[["render",FormBooleanInputvue_type_template_id_1381d60c_scoped_true_render],["__scopeId","data-v-1381d60c"]]);var ua=ca,ma={components:{SizedDiv:ea,FormTextField:ra,FormTextInput:Ns,FormDateInput:_a,FormBooleanInput:ua},name:"DocumentAttributeRow",props:{id:{type:[String,Number],required:!0},search_schema:{type:Array,required:!0},attributes:{type:Object,required:!0},is_selection_required:{type:Boolean,required:!1,default:!1},is_selected:{type:Boolean,required:!1,default:!1},is_edit_mode:{type:Boolean,required:!1,default:!1},is_highlighted:{type:Boolean,required:!1,default:!1},is_disabled:{type:Boolean,required:!1,default:!1},has_link:{type:Boolean,required:!1,default:!1},link_route_obj:{type:Object}},emits:["update:doc","select:doc"],setup(){const get_bool_attribute=t=>!0===t;return{get_bool_attribute:get_bool_attribute}}};const ga=(0,qs.Z)(ma,[["render",DocumentAttributeRowvue_type_template_id_6127c01a_scoped_true_render],["__scopeId","data-v-6127c01a"]]);var ha=ga;const fa={key:0,class:"documentbuttonsrow"};function DocumentButtonsRowvue_type_template_id_187047f8_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("text-button"),l=(0,o.up)("form-text-field");return a.is_deleted?((0,o.wg)(),(0,o.iD)("div",fa,[(0,o.Wm)(_,{class:"documentbuttonsrow__button",title:"Восстановить",onClick:s[0]||(s[0]=s=>t.$emit("recover:doc"))}),(0,o.Wm)(l,{class:"documentbuttonsrow__deletedmessage",value:"ДОКУМЕНТ УДАЛЕН"})])):(0,o.kq)("",!0)}function TextButtonvue_type_template_id_2869d17a_render(t,s,a,r,n,i){return(0,o.wg)(),(0,o.iD)("div",{class:(0,l.C_)(["textbutton",{textbutton_disabled:a.disabled}])},(0,l.zw)(a.title),3)}var va={name:"TextButton",props:{title:{type:String,required:!0},disabled:{type:Boolean,required:!1,default:!1}}};const wa=(0,qs.Z)(va,[["render",TextButtonvue_type_template_id_2869d17a_render]]);var ya=wa,ba={name:"DocumentButtonsRow",components:{FormTextField:ra,TextButton:ya},props:{is_deleted:{type:Boolean,required:!0}},emits:["recover:doc"]};const Ra=(0,qs.Z)(ba,[["render",DocumentButtonsRowvue_type_template_id_187047f8_scoped_true_render],["__scopeId","data-v-187047f8"]]);var Fa=Ra;const Da={class:"documenterrorsrow"};function DocumentErrorsRowvue_type_template_id_153e39d4_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("form-text-field");return(0,o.wg)(),(0,o.iD)("div",Da,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.errors,((t,s)=>((0,o.wg)(),(0,o.j4)(_,{class:"documenterrorsrow__text",key:s,value:(s+1).toString()+") "+t},null,8,["value"])))),128))])}var xa={components:{FormTextField:ra},name:"DocumentErrorsRow",props:{errors:{type:Array,required:!0}}};const ka=(0,qs.Z)(xa,[["render",DocumentErrorsRowvue_type_template_id_153e39d4_scoped_true_render],["__scopeId","data-v-153e39d4"]]);var qa=ka;const Sa={class:"documentfilesrow"};function DocumentFilesRowvue_type_template_id_7c3004b6_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("file-block");return(0,o.wg)(),(0,o.iD)("div",Sa,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.files,(s=>((0,o.wg)(),(0,o.iD)("div",{class:"documentfilesrow__fileblock",key:s.id},[(0,o.Wm)(_,{class:"documentfilesrow__file",file:s,can_be_deleted:a.can_be_deleted,can_be_dragged:a.can_be_dragged,"onDelete:file":a=>t.$emit("delete:file",s.id),"onDownload:file":a=>t.$emit("download:file",[s,a]),"onCopy_link_to:file":a=>t.$emit("copy_link_to:file",s)},null,8,["file","can_be_deleted","can_be_dragged","onDelete:file","onDownload:file","onCopy_link_to:file"])])))),128))])}const Ea={key:0,class:"fileblock"},Aa=["draggable"],Ca={key:1,class:"fileblock__title"};function FileBlockvue_type_template_id_715ab352_render(t,s,a,r,n,i){const _=(0,o.up)("form-text-input"),d=(0,o.up)("toggle-text-button");return 100===a.file.progress?((0,o.wg)(),(0,o.iD)("div",Ea,[a.can_be_deleted?((0,o.wg)(),(0,o.iD)("span",{key:0,class:"fileblock__deletebutton",onClick:s[0]||(s[0]=s=>t.$emit("delete:file"))},"(X) ")):(0,o.kq)("",!0),(0,o._)("span",{class:"fileblock__linkbutton",onClick:s[1]||(s[1]=s=>t.$emit("download:file",!1))},"🡇 "),r.is_rename_active?((0,o.wg)(),(0,o.j4)(_,{key:1,class:"fileblock__input",value:r.filename,onUpdate:s[2]||(s[2]=t=>r.filename=t)},null,8,["value"])):((0,o.wg)(),(0,o.iD)("a",{key:2,class:"fileblock__link",href:"#",draggable:a.can_be_dragged,onDragstart:s[3]||(s[3]=t=>r.handle_drag_start(t)),onDragend:s[4]||(s[4]=s=>t.$emit("dragend:file")),onClick:s[5]||(s[5]=s=>{!0===r.is_uploaded&&t.$emit("download:file",!0)})},(0,l.zw)(a.file.name)+" ("+(0,l.zw)(a.file.formatted_size())+")",41,Aa)),(0,o._)("span",{class:"fileblock__linkbutton",onClick:s[6]||(s[6]=s=>t.$emit("copy_link_to:file"))},"🔗 "),a.can_be_renamed&&r.filename.length>0?((0,o.wg)(),(0,o.j4)(d,{key:3,class:(0,l.C_)(["fileblock__renamebutton",{fileblock__renamebutton_red:r.is_rename_active}]),activeTitle:"Сохранить",passiveTitle:"Переименовать",isActive:r.is_rename_active,onClick:s[7]||(s[7]=t=>r.handle_click_on_rename_button())},null,8,["class","isActive"])):(0,o.kq)("",!0)])):((0,o.wg)(),(0,o.iD)("span",Ca,(0,l.zw)(a.file.name)+" ("+(0,l.zw)(a.file.formatted_size())+")"+(0,l.zw)(r.progress_str),1))}const Ua={class:"toggletextbutton"};function ToggleTextButtonvue_type_template_id_cb9d649a_render(t,s,a,r,n,i){return(0,o.wg)(),(0,o.iD)("div",Ua,(0,l.zw)(a.isActive?a.activeTitle:a.passiveTitle),1)}var Pa={name:"ToggleTextButton",props:{isActive:{type:Boolean,required:!0},activeTitle:{type:String,required:!0},passiveTitle:{type:String,required:!0}}};const ja=(0,qs.Z)(Pa,[["render",ToggleTextButtonvue_type_template_id_cb9d649a_render]]);var Ma=ja,Ta={name:"FileBlock",components:{ToggleTextButton:Ma,FormTextInput:Ns},props:{file:{type:Object,required:!0},can_be_deleted:{type:Boolean,required:!1,default:!1},can_be_dragged:{type:Boolean,required:!1,default:!1},can_be_renamed:{type:Boolean,required:!1,default:!1}},emits:["delete:file","dragstart:file","dragend:file","download:file","copy_link_to:file","rename:file","rename:activated"],setup(t,{emit:s}){const a=(0,i.iH)("");(0,o.YP)((()=>t.file.progress),(t=>{a.value=t<100?` (${t}%)`:""}));const handle_drag_start=a=>{a.dataTransfer.setData("text/plain",t.file.id),s("dragstart:file")},r=(0,o.Fl)((()=>100===t.file.progress)),n=get_extension_of_file(t.file.name),_=n?t.file.name.substring(0,t.file.name.length-n.length-1):t.file.name,l=(0,i.iH)(!1),d=(0,i.iH)(_),handle_click_on_rename_button=()=>{l.value?s("rename:file",d.value+(n?"."+n:"")):s("rename:activated"),l.value=!l.value};return{progress_str:a,handle_drag_start:handle_drag_start,is_uploaded:r,is_rename_active:l,filename:d,handle_click_on_rename_button:handle_click_on_rename_button}}};const Na=(0,qs.Z)(Ta,[["render",FileBlockvue_type_template_id_715ab352_render]]);var Ia=Na,Ba={components:{FileBlock:Ia},name:"DocumentFilesRow",props:{files:{type:Array,required:!0},can_be_deleted:{type:Boolean,required:!1,default:!1},can_be_dragged:{type:Boolean,required:!1,default:!1}},emits:["delete:file","download:file","copy_link_to:file"]};const Oa=(0,qs.Z)(Ba,[["render",DocumentFilesRowvue_type_template_id_7c3004b6_scoped_true_render],["__scopeId","data-v-7c3004b6"]]);var za=Oa,Wa={name:"DocumentRow",components:{DocumentAttributeRow:ha,DocumentButtonsRow:Fa,DocumentFilesRow:za,DocumentErrorsRow:qa},props:{doc:{type:Object,required:!0},search_schema:{type:Array,required:!0},is_selected:{type:Boolean,required:!0},is_edit_mode:{type:Boolean,required:!0},is_files_shown:{type:Boolean,required:!0},is_dragging:{type:Boolean,required:!1,default:!1},has_link:{type:Boolean,required:!0},link_route_obj:{type:Object,required:!0}},emits:["update:doc","delete:doc","duplicate:doc","recover:doc","select:doc","delete:file","attach:file","download:file","copy_link_to:file","click:attributerow"],setup(t,{emit:s}){const handle_drop=t=>{const a=t.dataTransfer.getData("text");s("attach:file",a)},handle_click_attributerow=()=>{t.is_edit_mode||s("click:attributerow")};return{handle_drop:handle_drop,handle_click_attributerow:handle_click_attributerow}}};const Ga=(0,qs.Z)(Wa,[["render",DocumentRowvue_type_template_id_18a3dd2d_scoped_true_render],["__scopeId","data-v-18a3dd2d"]]);var Za=Ga;const Ha={class:"documentpagebuttonsrow"};function DocumentPageButtonsRowvue_type_template_id_59c3b184_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("text-button"),l=(0,o.up)("toggle-text-button");return(0,o.wg)(),(0,o.iD)("div",Ha,[(0,o.Wm)(_,{class:"documentpagebuttonsrow__button",title:"Очистить",onClick:s[0]||(s[0]=s=>t.$emit("reset:search"))}),a.can_view_file?((0,o.wg)(),(0,o.j4)(l,{key:0,class:"documentpagebuttonsrow__button",activeTitle:"Скрыть файлы",passiveTitle:"Показать файлы",isActive:a.is_files_shown,onClick:s[1]||(s[1]=s=>t.$emit("toggle:shownfiles"))},null,8,["isActive"])):(0,o.kq)("",!0),(0,o.Wm)(_,{class:"documentpagebuttonsrow__button",title:"XLSX",onClick:s[2]||(s[2]=s=>t.$emit("download:excel"))}),(0,o.Wm)(_,{class:"documentpagebuttonsrow__button",title:"JSON",onClick:s[3]||(s[3]=s=>t.$emit("download:json"))}),(0,o.Wm)(_,{class:"documentpagebuttonsrow__button",title:"ZIP",onClick:s[4]||(s[4]=s=>t.$emit("download:files_archive"))}),a.is_folder_saved&&a.can_change_doc?((0,o.wg)(),(0,o.j4)(l,{key:1,class:"documentpagebuttonsrow__button",activeTitle:"Режим просмотра",passiveTitle:"Режим редактирования",isActive:a.is_edit_mode,onClick:s[5]||(s[5]=s=>t.$emit("toggle:editmode"))},null,8,["isActive"])):(0,o.kq)("",!0),a.is_edit_mode?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(l,{key:2,class:"documentpagebuttonsrow__button",activeTitle:"Скрыть настройки",passiveTitle:"Настройка",isActive:a.is_tuning_mode,onClick:s[6]||(s[6]=s=>t.$emit("toggle:tuningmode"))},null,8,["isActive"])),a.is_edit_mode||null===a.group_by_settings?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(l,{key:3,class:"documentpagebuttonsrow__button",activeTitle:r.group_by_active_title,passiveTitle:r.group_by_passive_title,isActive:a.is_group_by_mode,onClick:s[7]||(s[7]=s=>t.$emit("toggle:groupbymode"))},null,8,["activeTitle","passiveTitle","isActive"])),a.is_edit_mode?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(_,{key:4,class:"documentpagebuttonsrow__button",title:"В корзину",onClick:s[8]||(s[8]=s=>t.$emit("to:cart"))})),a.is_tuning_mode?((0,o.wg)(),(0,o.j4)(_,{key:5,class:"documentpagebuttonsrow__button",title:"Сбросить",onClick:s[9]||(s[9]=s=>t.$emit("reset:tuning"))})):(0,o.kq)("",!0),a.is_edit_mode&&a.can_add_doc?((0,o.wg)(),(0,o.j4)(_,{key:6,class:"documentpagebuttonsrow__button",title:"Новый документ",onClick:s[10]||(s[10]=s=>t.$emit("new:doc"))})):(0,o.kq)("",!0),!a.is_folder_saved&&a.can_change_doc?((0,o.wg)(),(0,o.j4)(_,{key:7,class:"documentpagebuttonsrow__button documentpagebuttonsrow__button_red",title:"Сохранить изменения",onClick:s[11]||(s[11]=s=>t.$emit("save:docs"))})):(0,o.kq)("",!0),a.is_edit_mode&&a.can_delete_doc?((0,o.wg)(),(0,o.j4)(_,{key:8,class:"documentpagebuttonsrow__button documentpagebuttonsrow__button_red",title:"Удалить",onClick:s[12]||(s[12]=s=>t.$emit("delete:docs"))})):(0,o.kq)("",!0),a.is_edit_mode?((0,o.wg)(),(0,o.j4)(_,{key:9,class:"documentpagebuttonsrow__button",title:"Дублировать",onClick:s[13]||(s[13]=s=>t.$emit("duplicate:docs"))})):(0,o.kq)("",!0),a.is_edit_mode&&a.is_folder_saved&&a.can_delete_file?((0,o.wg)(),(0,o.j4)(_,{key:10,class:"documentpagebuttonsrow__button",title:"Очистить контейнер с файлами",onClick:s[14]||(s[14]=s=>t.$emit("flush:filecontainer"))})):(0,o.kq)("",!0),a.is_edit_mode&&a.can_add_file?((0,o.wg)(),(0,o.j4)(_,{key:11,class:"documentpagebuttonsrow__button",title:"Распределить файлы",onClick:s[15]||(s[15]=s=>t.$emit("allocate:files"))})):(0,o.kq)("",!0)])}var $a={name:"DocumentPageButtonsRow",components:{ToggleTextButton:Ma,TextButton:ya},props:{is_folder_saved:{type:Boolean,required:!0},is_edit_mode:{type:Boolean,required:!0},is_files_shown:{type:Boolean,required:!0},can_add_doc:{type:Boolean,required:!1,default:!1},can_change_doc:{type:Boolean,required:!1,default:!1},can_delete_file:{type:Boolean,required:!1,default:!1},can_add_file:{type:Boolean,required:!1,default:!1},can_view_file:{type:Boolean,required:!1,default:!1},can_delete_doc:{type:Boolean,required:!1,default:!1},is_tuning_mode:{type:Boolean,required:!1,default:!1},is_group_by_mode:{type:Boolean,required:!1,default:!1},group_by_settings:{type:Object,required:!1}},emits:["save:docs","delete:docs","duplicate:docs","toggle:editmode","toggle:tuningmode","toggle:groupbymode","toggle:shownfiles","reset:search","flush:filecontainer","new:doc","allocate:files","reset:tuning","download:excel","download:json","download:files_archive","to:cart"],setup(t){const s=null===t.group_by_settings?"":t.group_by_settings.button_active_name,a=null===t.group_by_settings?"":t.group_by_settings.button_passive_name;return{group_by_active_title:s,group_by_passive_title:a}}};const La=(0,qs.Z)($a,[["render",DocumentPageButtonsRowvue_type_template_id_59c3b184_scoped_true_render],["__scopeId","data-v-59c3b184"]]);var Va=La;const Ja={class:"documentpagesearchrow"};function DocumentPageSearchRowvue_type_template_id_74028ffa_scoped_true_render(t,s,a,n,i,_){const l=(0,o.up)("form-boolean-input"),d=(0,o.up)("sized-div"),p=(0,o.up)("tuning-item");return(0,o.wg)(),(0,o.iD)("div",Ja,[a.is_selection_required?((0,o.wg)(),(0,o.j4)(d,{key:0,class:"documentpagesearchrow__sizedblock",size:"w30"},{default:(0,o.w5)((()=>[(0,o.Wm)(l,{class:"documentpagesearchrow__input",value:a.is_all_selected,parameters:{size:30},onUpdate:s[0]||(s[0]=s=>t.$emit("selectall:docs"))},null,8,["value"])])),_:1})):(0,o.kq)("",!0),a.required_space_for_link?((0,o.wg)(),(0,o.j4)(d,{key:1,class:"documentpagesearchrow__sizedblock",size:"w30"})):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.search_schema,(i=>((0,o.wg)(),(0,o.j4)(d,{key:i.name,class:"documentpagesearchrow__sizedblock",size:i.size,grow:i.grow},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.fields,(t=>((0,o.wg)(),(0,o.j4)((0,o.LL)(n.get_component_name(t)),{class:"documentpagesearchrow__input",key:t,value:n.get_query_value(i,t),parameters:n.get_parameters(i,t),onKeyup:s[1]||(s[1]=(0,r.D2)((t=>n.emit_search_event()),["enter"])),onUpdate:s=>n.set_query_value(i,t,s)},null,40,["value","parameters","onUpdate"])))),128)),a.is_tuning_mode?((0,o.wg)(),(0,o.j4)(p,{key:0,class:"documentpagesearchrow__tuningitem",size:i.size,grow:i.grow,"onChange:size":s=>t.$emit("change:size",{name:i.name,value:s}),"onChange:grow":s=>t.$emit("change:grow",{name:i.name,value:s}),"onDelete:field":s=>t.$emit("delete:field",i.name)},null,8,["size","grow","onChange:size","onChange:grow","onDelete:field"])):(0,o.kq)("",!0)])),_:2},1032,["size","grow"])))),128))])}const Ya=["disabled","size"],Ka=["selected","value"];function FormSelectInputvue_type_template_id_20d58ba5_scoped_true_render(t,s,a,r,n,i){return(0,o.wg)(),(0,o.iD)("select",{class:"formselectinput",disabled:r.is_disabled,size:r.size.toString(),onInput:s[0]||(s[0]=t=>r.handle_choose_value(t.target.value))},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.parameters.options,((t,s)=>((0,o.wg)(),(0,o.iD)("option",{selected:void 0!==a.value&&null!==a.value&&t.value===a.value,key:t.value,value:s},(0,l.zw)(t.name),9,Ka)))),128))],40,Ya)}var Xa={name:"FormSelectInput",props:{parameters:{type:Object,required:!1,default:()=>({})},value:{required:!1}},emits:["update"],setup(t,{emit:s}){const a=t.parameters["default"]||"";void 0!==t.value&&null!==t.value||!a||s("update",a);const r=(0,o.Fl)((()=>t.parameters["size"]||1)),n=(0,o.Fl)((()=>t.parameters["is_disabled"]||!1)),handle_choose_value=a=>{s("update",t.parameters.options[parseInt(a)].value)};return{size:r,is_disabled:n,handle_choose_value:handle_choose_value}}};const Qa=(0,qs.Z)(Xa,[["render",FormSelectInputvue_type_template_id_20d58ba5_scoped_true_render],["__scopeId","data-v-20d58ba5"]]);var er=Qa;const tr={class:"formfilteredselectinput"};function FormFilteredSelectInputvue_type_template_id_3d606cee_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("form-select-input"),l=(0,o.up)("form-text-input");return(0,o.wg)(),(0,o.iD)("div",tr,[(0,o.Wm)(_,{class:"formfilteredselectinput__target",parameters:{options:a.parameters.options,is_disabled:r.is_disabled},value:a.value,onMousedown:s[0]||(s[0]=t=>r.handle_click_on_target(t))},null,8,["parameters","value"]),r.is_selected?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(l,{key:0,class:"formfilteredselectinput__search",parameters:{placeholder:r.placeholder,height:30},value:r.query,onUpdate:s[1]||(s[1]=t=>r.query=t)},null,8,["parameters","value"])),r.is_selected?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(_,{key:1,class:"formfilteredselectinput__list",parameters:{options:r.filtered_options,size:r.size},value:a.value,onUpdate:s[2]||(s[2]=s=>{t.$emit("update",s),r.is_selected=!r.is_selected})},null,8,["parameters","value"]))])}var sr={name:"FormFilteredSelectInput",components:{FormTextInput:Ns,FormSelectInput:er},props:{parameters:{type:Object,required:!1,default:()=>({})},value:{required:!1}},emits:["update"],setup(t,{emit:s}){const a=t.parameters["default"]||"";void 0!==t.value&&null!==t.value||!a||s("update",a);const r=(0,o.Fl)((()=>t.parameters["size"]||3)),n=(0,o.Fl)((()=>t.parameters["is_disabled"]||!1)),_=(0,o.Fl)((()=>t.parameters["placeholder"]||"")),l=(0,i.iH)(!0),d=(0,i.iH)(""),p=(0,o.Fl)((()=>t.parameters.options.filter((t=>t.name.toUpperCase().includes(d.value.toUpperCase()))))),handle_click_on_target=t=>{t.preventDefault(),!0!==n.value&&(l.value=!l.value)};return{size:r,is_disabled:n,placeholder:_,is_selected:l,query:d,filtered_options:p,handle_click_on_target:handle_click_on_target}}};const ar=(0,qs.Z)(sr,[["render",FormFilteredSelectInputvue_type_template_id_3d606cee_scoped_true_render],["__scopeId","data-v-3d606cee"]]);var rr=ar;const or={class:"tuningitem"};function TuningItemvue_type_template_id_9319ab66_render(t,s,a,r,n,i){const _=(0,o.up)("icon-button");return(0,o.wg)(),(0,o.iD)("div",or,[(0,o.Wm)(_,{class:"tuningitem__button",icon_on:"-",onClick:s[0]||(s[0]=s=>t.$emit("change:size",r.prev_size(a.size)))}),(0,o.Wm)(_,{class:"tuningitem__button",icon_on:"+",onClick:s[1]||(s[1]=s=>t.$emit("change:size",r.next_size(a.size)))}),(0,o.Wm)(_,{class:"tuningitem__button",icon_on:"⇔",icon_off:"⤄",is_active:a.grow,onClick:s[2]||(s[2]=s=>t.$emit("change:grow",!a.grow))},null,8,["is_active"]),(0,o.Wm)(_,{class:"tuningitem__button",icon_on:"X",onClick:s[3]||(s[3]=s=>t.$emit("delete:field"))})])}const nr={class:"iconbutton__icon"};function IconButtonvue_type_template_id_5f810ad4_render(t,s,a,r,n,i){return(0,o.wg)(),(0,o.iD)("div",{class:"iconbutton",onClick:s[0]||(s[0]=s=>t.$emit("toggle"))},[(0,o._)("div",nr,(0,l.zw)(!0===a.is_active?a.icon_on:a.icon_off),1)])}var ir={name:"IconButton",props:{icon_on:{type:String,required:!0},icon_off:{type:String,required:!1},is_active:{type:Boolean,required:!1,default:!0}}};const _r=(0,qs.Z)(ir,[["render",IconButtonvue_type_template_id_5f810ad4_render]]);var lr=_r,dr={components:{IconButton:lr},name:"TuningItem",props:{size:{type:String,required:!1,default:"w50"},grow:{type:Boolean,required:!1,default:!1}},emits:["change:size","change:grow","delete:field"],setup(){const t=["w50","w100","w150","w200","w250","w300","w350","w400"],prev_size=s=>{let a=t.indexOf(s)-1;return a=Math.max(0,a),t[a]},next_size=s=>{let a=t.indexOf(s)+1;return a=Math.min(a,t.length-1),t[a]};return{prev_size:prev_size,next_size:next_size}}};const pr=(0,qs.Z)(dr,[["render",TuningItemvue_type_template_id_9319ab66_render]]);var cr=pr,ur={name:"DocumentPageSearchRow",components:{SizedDiv:ea,FormTextInput:Ns,FormSelectInput:er,FormFilteredSelectInput:rr,TuningItem:cr,FormBooleanInput:ua},props:{search_schema:{type:Object,required:!0},is_disabled:{type:Boolean,required:!1,default:!1},is_clean_required:{type:Boolean,required:!1,default:!1},is_tuning_mode:{type:Boolean,required:!1,default:!1},required_space_for_link:{type:Boolean,required:!1,default:!1},is_selection_required:{type:Boolean,required:!1,default:!1},is_all_selected:{type:Boolean,required:!1,default:!1},should_emit_search_event_on_any_keypress:{type:Boolean,required:!1,default:!1}},emits:["search:docs","selectall:docs","clean:query","change:size","change:grow","delete:field"],setup(t,{emit:s}){const a=(0,i.qj)({}),get_query_key=(t,s)=>t+"__"+s,r=(0,o.Fl)((()=>{const t={};return Object.keys(a).forEach((s=>{const r=a[s],o=r.converter?r.converter:null;let n=r.value;r.re&&!1===is_pattern_valid(r.re,r.value)&&(n=""),t[s]=""===n?n:useDataEncode(n,r.rule,o)})),t})),get_initial_value=t=>"bool"!==t&&"",reset_query=()=>{t.search_schema.forEach((t=>{t.fields.forEach((s=>{a[get_query_key(t.name,s.rule)]={type:s.type,name:t.name,rule:s.rule,re:s.re,converter:s.converter,value:get_initial_value(s.type)}}))}))},is_pattern_valid=(t,s)=>null!==String.prototype.match.call(s,new RegExp(t));(0,o.YP)((()=>t.is_clean_required),(t=>{!0===t&&(reset_query(),s("clean:query"))})),reset_query();const emit_search_event=()=>s("search:docs",r.value),get_component_name=t=>"bool"===t.type?"FormBooleanInput":"select"===t.type?"FormSelectInput":"filtered_select"===t.type?"FormFilteredSelectInput":"FormTextInput",get_query_item=(t,s)=>a[get_query_key(t.name,s.rule)],get_query_value=(t,s)=>get_query_item(t,s)["value"],set_query_value=(s,a,r)=>{get_query_item(s,a)["value"]=r,t.should_emit_search_event_on_any_keypress&&emit_search_event()},get_parameters=(t,s)=>"bool"===s.type?boolean_input_parameters(s):["select","filtered_select"].includes(s.type)?select_input_parameters(s):text_input_parameters(t,s),text_input_parameters=(s,a)=>({color:is_pattern_valid(get_query_item(s,a)["re"],get_query_item(s,a)["value"])?"":"red",placeholder:a.placeholder,is_disabled:t.is_disabled,height:30}),boolean_input_parameters=s=>({hint:s.placeholder,is_disabled:t.is_disabled,size:28}),select_input_parameters=s=>({hint:s.placeholder,is_disabled:t.is_disabled,options:s.options});return{query:a,encoded_query:r,get_query_key:get_query_key,is_pattern_valid:is_pattern_valid,get_component_name:get_component_name,get_parameters:get_parameters,get_query_value:get_query_value,set_query_value:set_query_value,emit_search_event:emit_search_event}}};const mr=(0,qs.Z)(ur,[["render",DocumentPageSearchRowvue_type_template_id_74028ffa_scoped_true_render],["__scopeId","data-v-74028ffa"]]);var gr=mr;const hr={class:"documentpagesortrow"};function DocumentPageSortRowvue_type_template_id_29807a96_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("arrow-switch"),l=(0,o.up)("sized-div");return(0,o.wg)(),(0,o.iD)("div",hr,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.search_schema,(s=>((0,o.wg)(),(0,o.j4)(l,{key:s.name,class:"documentpagesortrow__sizedblock",size:s.size,grow:s.grow},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{class:"documentpagesortrow__arrow",is_checked:!0===a.sort_asc,is_selected:a.sort_by===s.name,onClick:o=>a.sort_by===s.name?t.$emit("toggle:direction"):t.$emit("sort:by",r.getSortNameAndFunction(s.name,s.sort_rule))},null,8,["is_checked","is_selected","onClick"])])),_:2},1032,["size","grow"])))),128))])}function ArrowSwitchvue_type_template_id_1e2cf47e_render(t,s,a,r,n,i){return(0,o.wg)(),(0,o.iD)("div",{class:(0,l.C_)(["arrowswitch",{arrowswitch_selected:!0===a.is_selected,arrowswitch_checked:!0===a.is_checked}])},(0,l.zw)(a.is_checked?"▼":"▲"),3)}var fr={name:"ArrowSwitch",props:{is_selected:{type:Boolean,required:!0},is_checked:{type:Boolean,required:!0}}};const vr=(0,qs.Z)(fr,[["render",ArrowSwitchvue_type_template_id_1e2cf47e_render]]);var wr=vr,yr={name:"DocumentPageSortRow",components:{SizedDiv:ea,ArrowSwitch:wr},props:{search_schema:{type:Object,required:!0},sort_asc:{type:Boolean,required:!0},sort_by:{type:String,required:!1}},emits:["toggle:direction","sort:by"],setup(){const getSortNameAndFunction=(t,s)=>[t,s];return{getSortNameAndFunction:getSortNameAndFunction}}};const br=(0,qs.Z)(yr,[["render",DocumentPageSortRowvue_type_template_id_29807a96_scoped_true_render],["__scopeId","data-v-29807a96"]]);var Rr=br;const Fr={class:"filelist"};function FileListvue_type_template_id_15d69ea0_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("file-block");return(0,o.wg)(),(0,o.iD)("div",Fr,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.files,(r=>((0,o.wg)(),(0,o.j4)(_,{class:"filelist__fileblock",key:r.id,file:r,can_be_dragged:a.can_be_dragged,can_be_deleted:a.can_be_deleted,can_be_renamed:a.can_be_renamed,"onDragstart:file":s[0]||(s[0]=s=>t.$emit("dragstart:file")),onDragend:s[1]||(s[1]=s=>t.$emit("dragend:file")),"onDownload:file":s=>t.$emit("download:file",[r,s]),"onDelete:file":s=>t.$emit("delete:file",r.id),"onRename:file":s=>t.$emit("rename:file",[r.id,s]),"onRename:activated":s=>t.$emit("rename:activated",r.id),"onCopy_link_to:file":s=>t.$emit("copy_link_to:file",r)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(r.name),1)])),_:2},1032,["file","can_be_dragged","can_be_deleted","can_be_renamed","onDownload:file","onDelete:file","onRename:file","onRename:activated","onCopy_link_to:file"])))),128))])}var Dr={components:{FileBlock:Ia},name:"FileList",props:{files:{type:Array,required:!0},can_be_dragged:{type:Boolean,required:!0},can_be_deleted:{type:Boolean,required:!0},can_be_renamed:{type:Boolean,required:!1,default:!1}},emits:["dragstart:file","dragend:file","download:file","delete:file","rename:file","rename:activated","copy_link_to:file"]};const xr=(0,qs.Z)(Dr,[["render",FileListvue_type_template_id_15d69ea0_scoped_true_render],["__scopeId","data-v-15d69ea0"]]);var kr=xr;function JsonFileDropZonevue_type_template_id_01352f1a_render(t,s,a,n,i,_){return(0,o.wg)(),(0,o.iD)("div",{class:"jsonfiledropzone",onDrop:s[0]||(s[0]=(0,r.iM)((t=>n.handleDrop(t)),["prevent"])),onDragover:s[1]||(s[1]=(0,r.iM)((()=>{}),["prevent"])),onDragenter:s[2]||(s[2]=(0,r.iM)((t=>n.is_dragging=!0),["prevent"])),onDragleave:s[3]||(s[3]=(0,r.iM)((t=>n.is_dragging=!1),["prevent"]))},[(0,o.WI)(t.$slots,"default")],32)}const get_extension=t=>t.split(".").pop(),get_base_name=t=>t.split(".")[0],default_json_parser=async t=>"json"!==get_extension(t.name)?null:JSON.parse(await t.text()),parser_1868_amm_transmittal=async t=>{if("xlsx"!==get_extension(t.name))return null;const s=get_base_name(t.name).trim(),a=Math.round(t.lastModified/1e3),r=Ht().read(await t.arrayBuffer());let o=[];return r.SheetNames.forEach((t=>{const n=r.Sheets[t],i=Ht().utils.sheet_to_json(n,{header:["CODE","REVISION","SHEET_NAME","COUNT","STATUS","RESPONSE_CODE"],raw:!1});console.log(i),o=o.concat(i.map((t=>Object.assign({},t,{TRANSMITTAL:s,DATE:a}))).filter((t=>t["CODE"]&&!t["CODE"].toLowerCase().includes("документ"))))})),o},parser_1882_dlenc_transmittal=async t=>{if("xlsx"!==get_extension(t.name))return null;const parse_date=t=>{if(console.log(t),!t)return 0;const s=t.split("/"),a=parseInt(s[2]),r=parseInt(s[1])-1,o=parseInt(s[0]),n=new Date(a,r,o);return Math.round(n/1e3)},s=Ht().read(await t.arrayBuffer()),a=s.Sheets["transmittal"],r=s.Sheets["List"],o=["ID","CODE","COL_1","SHEET_NAME","COL_2","REVISION","STATUS","LANGUAGE"],n=Ht().utils.sheet_to_json(a,{header:o,raw:!1}),i=Ht().utils.sheet_to_json(r,{header:o,raw:!1});console.log(n),console.log(i);let _="????",l=0,d=0;const p=n[1];_=p["COL_1"],l=parse_date(p["LANGUAGE"].trim());const c=n[2];d=parse_date(c["LANGUAGE"].trim()),console.log("TRM: ",_),console.log("ISSUED_DATE: ",l),console.log("DUE_DATE: ",d);const transform_row=t=>{if(t["CODE"]||t["SHEET_NAME"]||t["REVISION"]||t["STATUS"]||t["LANGUAGE"]){let s=Object.assign({CODE:t["CODE"],SHEET_NAME:t["SHEET_NAME"],REVISION:t["REVISION"],STATUS:t["STATUS"],LANGUAGE:t["LANGUAGE"],KIND:""},{TRANSMITTAL:_,DATE:l,DUE_DATE:d});return s}return null};let u=[];return u=u.concat(n.slice(4,29).map((t=>transform_row(t))).filter((t=>null!==t))).concat(i.slice(2).map((t=>transform_row(t))).filter((t=>null!==t))),u};var qr={name:"JsonFileDropZone",props:{default:{required:!1,default:null},parsers:{type:Array,required:!1,default:()=>[]}},emits:["update:json","update:dragging"],setup(t,{emit:s}){const a=(0,i.iH)(!1),r=new VueUnitOfWork,n={json_default:default_json_parser,"1868_amm_transmittal":parser_1868_amm_transmittal,"1882_dlenc_transmittal":parser_1882_dlenc_transmittal},_=["json_default"].concat(t.parsers),handleDrop=async o=>{a.value=!1,await Array.prototype.forEach.call(o.dataTransfer.files,(async a=>{try{let t=null;for(const s of _){if(null!==t)continue;if(!Object.prototype.hasOwnProperty.call(n,s)){console.log("Отсутствует парсер",s);continue}const r=n[s];t=await r(a)}if(null===t)throw"Ни один обработчик не смог обработать загруженный файл";s("update:json",t)}catch(o){console.log(o);const i=new UploadFileError(a.name);message_bus_MessageBus.handle(i,r),s("update:json",t.default)}}))};return(0,o.YP)(a,((t,a)=>{t!==a&&s("update:dragging",t)})),{handleDrop:handleDrop,is_dragging:a}}};const Sr=(0,qs.Z)(qr,[["render",JsonFileDropZonevue_type_template_id_01352f1a_render]]);var Er=Sr;function FileDropZonevue_type_template_id_1310559a_render(t,s,a,n,i,_){return(0,o.wg)(),(0,o.iD)("div",{class:"filedropzone",onDrop:s[0]||(s[0]=(0,r.iM)((t=>n.handleDrop(t)),["prevent"])),onDragover:s[1]||(s[1]=(0,r.iM)((()=>{}),["prevent"])),onDragenter:s[2]||(s[2]=(0,r.iM)((t=>n.is_dragging=!0),["prevent"])),onDragleave:s[3]||(s[3]=(0,r.iM)((t=>n.is_dragging=!1),["prevent"]))},[(0,o.WI)(t.$slots,"default")],32)}var Ar={name:"FileDropZone",props:{filename_pattern:{type:Object,required:!1,default:()=>/.*/}},emits:["add:file","update:dragging","wrong:filename"],setup(t,{emit:s}){const a=(0,i.iH)(!1),r=new RegExp(t.filename_pattern),handleDrop=t=>{a.value=!1,Array.prototype.forEach.call(t.dataTransfer.files,(t=>{t.name.toString().match(r)?s("add:file",t):s("wrong:filename",t.name.toString())}))};return(0,o.YP)(a,((t,a)=>{t!==a&&s("update:dragging",t)})),{handleDrop:handleDrop,is_dragging:a}}};const Cr=(0,qs.Z)(Ar,[["render",FileDropZonevue_type_template_id_1310559a_render]]);var Ur=Cr;const Pr={class:"documentpagedownloadprogressrow"},jr={key:0,class:"documentpagedownloadprogressrow__item"},Mr={key:1,class:"documentpagedownloadprogressrow__item"};function DocumentPageDownloadProgressRowvue_type_template_id_30857a85_scoped_true_render(t,s,a,r,n,i){return(0,o.wg)(),(0,o.iD)("div",Pr,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.files,(t=>((0,o.wg)(),(0,o.iD)("div",{class:"documentpagedownloadprogressrow__container",key:t.id},[a.full_format?((0,o.wg)(),(0,o.iD)("span",jr,'Происходит скачивание файла "'+(0,l.zw)(t.name)+'" объемом '+(0,l.zw)(t.formatted_size())+" - "+(0,l.zw)(t.progress)+"%",1)):(0,o.kq)("",!0),!a.full_format&&t.progress<100?((0,o.wg)(),(0,o.iD)("span",Mr,"("+(0,l.zw)(t.formatted_size())+" - "+(0,l.zw)(t.progress)+"%)",1)):(0,o.kq)("",!0)])))),128))])}var Tr={name:"DocumentPageDownloadProgressRow",props:{files:{type:Array,required:!0},full_format:{type:Boolean,default:!1}}};const Nr=(0,qs.Z)(Tr,[["render",DocumentPageDownloadProgressRowvue_type_template_id_30857a85_scoped_true_render],["__scopeId","data-v-30857a85"]]);var Ir=Nr;const DocumentPaginationRowvue_type_template_id_6eebb904_scoped_true_withScopeId=t=>((0,o.dD)("data-v-6eebb904"),t=t(),(0,o.Cn)(),t),Br={class:"documentpaginationrow"},Or=DocumentPaginationRowvue_type_template_id_6eebb904_scoped_true_withScopeId((()=>(0,o._)("span",null,"По",-1))),zr=DocumentPaginationRowvue_type_template_id_6eebb904_scoped_true_withScopeId((()=>(0,o._)("span",null," | Страницы ",-1))),Wr={key:0,class:"documentpaginationrow__container"},Gr={key:1,class:"documentpaginationrow__container"};function DocumentPaginationRowvue_type_template_id_6eebb904_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("text-button");return(0,o.wg)(),(0,o.iD)("div",Br,[Or,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.variants,(s=>((0,o.wg)(),(0,o.iD)("div",{class:"documentpaginationrow__variants",key:s},[(0,o.Wm)(_,{class:(0,l.C_)(["documentpaginationrow__textbutton",{documentpaginationrow__textbutton_active:s===a.count_per_page}]),title:s.toString(),onClick:a=>{t.$emit("select:page",1),t.$emit("set:count_per_page",s)}},null,8,["class","title","onClick"])])))),128)),zr,!a.is_intermediate_part_shown&&r.has_intermediate_part?((0,o.wg)(),(0,o.iD)("div",Wr,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.pages_before,(s=>((0,o.wg)(),(0,o.iD)("div",{class:"documentpaginationrow__subcontainer",key:s.index},[(0,o.Wm)(_,{class:(0,l.C_)(["documentpaginationrow__textbutton",{documentpaginationrow__textbutton_active:s.index===a.current_page}]),title:s.index.toString(),onClick:a=>t.$emit("select:page",s.index)},null,8,["class","title","onClick"])])))),128)),(0,o.Wm)(_,{class:"documentpaginationrow__textbutton",title:"...",onClick:s[0]||(s[0]=s=>t.$emit("show:pages"))}),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.pages_after,(s=>((0,o.wg)(),(0,o.iD)("div",{class:"documentpaginationrow__subcontainer",key:s.index},[(0,o.Wm)(_,{class:(0,l.C_)(["documentpaginationrow__textbutton",{documentpaginationrow__textbutton_active:s.index===a.current_page}]),title:s.index.toString(),onClick:a=>t.$emit("select:page",s.index)},null,8,["class","title","onClick"])])))),128))])):((0,o.wg)(),(0,o.iD)("div",Gr,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.pages,(s=>((0,o.wg)(),(0,o.iD)("div",{class:"documentpaginationrow__subcontainer",key:s.index},[(0,o.Wm)(_,{class:(0,l.C_)(["documentpaginationrow__textbutton",{documentpaginationrow__textbutton_active:s.index===a.current_page}]),title:s.index.toString(),onClick:a=>t.$emit("select:page",s.index)},null,8,["class","title","onClick"])])))),128))]))])}var Zr={components:{TextButton:ya},name:"DocumentPaginationRow",props:{total_count:{type:Number,required:!0},count_per_page:{type:Number,required:!0},current_page:{type:Number,required:!0},variants:{type:Array,required:!0},max_count_of_pages:{type:Number,required:!1,default:0},count_before:{type:Number,required:!1,default:10},count_after:{type:Number,required:!1,default:5},is_intermediate_part_shown:{type:Boolean,required:!1,default:!0}},emits:["select:page","set:count_per_page","set:page_range","show:pages"],setup(t,{emit:s}){const a=(0,o.Fl)((()=>Array.from(Array(Math.ceil(t.total_count/t.count_per_page)).keys()).map((s=>{const a=s*t.count_per_page,r=(s+1)*t.count_per_page-1;return{index:s+1,min:a,max:Math.min(r,t.total_count-1)}})))),r=(0,o.Fl)((()=>a.value.length-t.count_before-t.count_after>0)),n=(0,o.Fl)((()=>a.value.filter((s=>s.index<=t.count_before)))),i=(0,o.Fl)((()=>a.value.filter((s=>s.index>=a.value.length-t.count_after+1)))),_=(0,o.Fl)((()=>a.value.find((s=>s.index===t.current_page))));return(0,o.YP)(_,(t=>s("set:page_range",t))),(0,o.bv)((()=>s("set:page_range",_.value))),{page:_,pages:a,has_intermediate_part:r,pages_before:n,pages_after:i}}};const Hr=(0,qs.Z)(Zr,[["render",DocumentPaginationRowvue_type_template_id_6eebb904_scoped_true_render],["__scopeId","data-v-6eebb904"]]);var $r=Hr,Lr={components:{HeadingComponent:Us,DocumentRow:Za,DocumentPageButtonsRow:Va,DocumentPageSearchRow:gr,DocumentPageSortRow:Rr,FileList:kr,JsonFileDropZone:Er,FileDropZone:Ur,DocumentPageDownloadProgressRow:Ir,DocumentPaginationRow:$r,FormTextField:ra,TextButton:ya},name:"SearchDocumentPage",setup(){const t=(0,_.yj)(),s=(0,_.tv)(),a=new VueUnitOfWork,r=a.user_repository.get_current(),n=useValidateIntOr404(t.params.usergroup_id),generate_doc_link=t=>({name:"DocumentPage",params:{folder_id:l,usergroup_id:n,document_id:t}}),l=useValidateIntOr404(t.params.folder_id),d=a.folder_repository.get(l),p=(0,o.Fl)((()=>null===d.value?"":d.value.name)),c=(0,o.Fl)((()=>null===d.value?[]:!0===q.value?d.value.search_schema:d.value.user_search_schema)),u=(0,o.Fl)((()=>null!==d.value&&d.value.is_empty_search_allowed)),m=(0,o.Fl)((()=>null===d.value||d.value.is_list_container_required)),g=(0,o.Fl)((()=>null===d.value||d.value.is_doc_container_required)),h=(0,o.Fl)((()=>null===d.value?"view":d.value.default_mode)),f=(0,o.Fl)((()=>null===d.value?[]:d.value.doc_container_parsers)),v=a.permission_repository.has_for_folder(l,"can_view_document"),w=a.permission_repository.has_for_folder(l,"can_add_document"),y=a.permission_repository.has_for_folder(l,"can_change_document"),b=a.permission_repository.has_for_folder(l,"can_delete_document"),R=a.permission_repository.has_for_folder(l,"can_view_file"),F=a.permission_repository.has_for_folder(l,"can_add_file"),D=a.permission_repository.has_for_folder(l,"can_delete_file"),x=(0,i.iH)(!1),k=(0,i.iH)({}),q=a.folder_settings.get(l,"is_edit_mode");null===q.value&&(q.value="edit"===h.value);const handle_update_doc_attribute=(t,s,r)=>{const o=new SetDocumentAttribute(l,n,t,s,r);message_bus_MessageBus.handle(o,a)},S=(0,o.Fl)((()=>{let t=!0;return I.value.forEach((s=>{!1!==s.is_saved&&!0!==s.is_deleted||(t=!1)})),t})),handle_save_documents=()=>{message_bus_MessageBus.handle(new SaveDocumentsInFolder(l,n),a)},mark_selected_documents_as_deleted=()=>{de.value.forEach((t=>message_bus_MessageBus.handle(new MarkDocumentAsDeleted(l,t),a)))},mark_document_as_not_deleted=t=>{message_bus_MessageBus.handle(new MarkDocumentAsNotDeleted(l,t),a)},handle_new_docs_drop=t=>{Array.isArray(t)||(t=[t]),t.forEach((t=>{message_bus_MessageBus.handle(new AddDocument(l,n,(0,Gt.Z)(),null,t,[],!0,!0,!1),a)}))},add_empty_document=()=>{let t={};message_bus_MessageBus.handle(new AddDocument(l,n,(0,Gt.Z)(),null,t,[],!0,!0,!1),a)},duplicate_selected_documents=()=>de.value.forEach((t=>{const s=a.doc_repository.get(l,t);message_bus_MessageBus.handle(new AddDocument(l,n,(0,Gt.Z)(),null,s.value.raw_attributes,[],!0,!0,!1),a)})),E=a.folder_settings.get(l,"is_files_shown");null===E.value&&(E.value=!1);const A=(0,o.Fl)((()=>a.file_in_folder_repository.values(l).map((t=>t.value)))),C=(0,o.Fl)((()=>a.download_progress.values().map((t=>t.value)))),detach_file_from_document=(t,s)=>{t.is_blocked||message_bus_MessageBus.handle(new DetachFileFromDocument(l,n,t.id,s),a)},attach_file_to_document=(t,s)=>{t.is_blocked||message_bus_MessageBus.handle(new AttachFileToDocument(l,n,t.id,s),a)},U=(0,o.Fl)((()=>null===d.value?0:d.value.max_file_size)),handle_new_file_drop=async t=>{let s=null;s=0===t.size?new UploadEmptyFileError(t.name):t.size>1024*U.value*1024?new UploadFileTooBigError(t.name):new UploadFileToFolder(l,n,(0,Gt.Z)(),t),await message_bus_MessageBus.handle(s,a)},handle_download_file=async(t,s)=>{const r=new DownloadFileFromFolder(l,n,t.id,t.name,t.size,s);await message_bus_MessageBus.handle(r,a)},handle_flush_file_container=()=>{message_bus_MessageBus.handle(new FlushFileContainer(l,n),a)},handle_delete_file=async t=>{await message_bus_MessageBus.handle(new DeleteFileFromFolder(l,n,t),a)},handle_allocate_files=()=>{message_bus_MessageBus.handle(new AllocateFilesToDocumentsUsingPattern(l,n),a)},handle_copy_link_to_file_into_clipboard=t=>{const r=s.resolve({name:"DownloadFileFromFolderPage",params:{folder_id:l,usergroup_id:n,file_id:t.id}});navigator.clipboard.writeText(window.location.origin+r.href).then((()=>message_bus_MessageBus.handle(new FileLinkCopied,a)))},handle_download_files_in_archive=async()=>{await message_bus_MessageBus.handle(new DownloadManyDocumentsFilesAsArchive(l,n,de.value,pe.value.map((t=>t.files.map((t=>t.size)).reduce(((t,s)=>t+s),0))).reduce(((t,s)=>t+s),0)),a)},P=(0,i.iH)(!1),j=(0,i.iH)(!1),M=(0,i.iH)(!1),T=(0,i.iH)(!1);a.doc_repository.set_count(0);const N=(0,o.Fl)((()=>!0===O.value?"Поиск...":!0===T.value&&!1===u.value?"На данной странице запрещены пустые запросы. Введите что-нибудь...":"Для поиска нажмите ENTER в любом окошке. Найдено "+B.value.toString()+"шт. ("+z.value.toString()+" сек.) Показаны "+(V.value+1).toString()+"-"+(J.value+1).toString()+". Выделено "+ce.value.toString()+"шт.")),I=(0,o.Fl)((()=>a.doc_repository.values(l).map((t=>t.value)))),B=a.doc_repository.get_count(),O=(0,i.iH)(!1),z=(0,i.iH)(0),W=(0,i.iH)(!1),get_documents_action=async({search_by_user:t=!1,query:s=k.value,without_limits:r=!1})=>{if(!t&&!W.value)return;if(s!==k.value&&reset_pagination(),k.value=s,T.value=!1,0===Object.values(s).filter((t=>""!==t)).length&&(T.value=!0,!1===u.value))return;if(!0===O.value)return;const o=performance.now();O.value=!0;const i=r||oe.value?null:$.value,_=r||oe.value?null:$.value*(L.value-1),d=new GetManyDocuments(l,n,s,_,i,ee.value,se.value,te.value);await message_bus_MessageBus.handle(d,a);const p=performance.now();z.value=Math.round(p-o)/1e3,O.value=!1,W.value=!0},G=20,Z=1,H=(0,i.iH)([20,50,100]),$=(0,i.iH)(0),L=(0,i.iH)(0),V=(0,i.iH)(0),J=(0,i.iH)(0),Y=(0,i.iH)(!1),reset_pagination=()=>{$.value=G,L.value=Z,V.value=(Z-1)*G,J.value=Z*G};reset_pagination();const handle_set_page_range=async(t,s)=>{V.value=t,J.value=s};(0,o.YP)($,(async()=>await get_documents_action({}))),(0,o.YP)(L,(async()=>await get_documents_action({})));const K=(0,o.Fl)((()=>null===d.value?null:d.value.default_sort_attribute)),X=(0,o.Fl)((()=>{if(null===K.value)return"DEFAULT";const t=c.value.find((t=>t["name"]===K.value));return t?t["sort_rule"]:"DEFAULT"})),Q=(0,o.Fl)((()=>null===d.value?null:d.value.default_sort_order)),ee=(0,i.iH)(K.value),te=(0,i.iH)(X.value),se=(0,i.iH)(Q.value);(0,o.YP)(ee,(async()=>await get_documents_action({}))),(0,o.YP)(se,(async()=>await get_documents_action({}))),(0,o.YP)(te,(async()=>await get_documents_action({})));const ae=(0,o.Fl)((()=>ie.value||[])),re={MAX:(t,s)=>Number.parseInt(t)>Number.parseInt(s)},oe=(0,i.iH)(!1);(0,o.YP)(oe,(async t=>{t&&await get_documents_action({})}));const ne=(0,o.Fl)((()=>d.value?d.value.group_by:null)),ie=(0,o.Fl)((()=>{if(null===ne.value||!oe.value||null===I.value)return I.value;const t=ne.value.order_by,s=re[ne.value.aggregate_function],make_key_from_fields=t=>{let s="";return ne.value.fields.forEach((a=>{let r=t.get_raw_attribute(a);r||(r=""),s=s+a+"|"+r+"|"})),s};let a={};return I.value.forEach((r=>{const o=make_key_from_fields(r);if(Object.prototype.hasOwnProperty.call(a,o)){const n=a[o],i=r.get_raw_attribute(t);a[o]=s(n,i)?n:i}else a[o]=r.get_raw_attribute(t)})),I.value.filter((s=>s.get_raw_attribute(t)===a[make_key_from_fields(s)]))})),_e=(0,i.iH)(!1),handle_tuning_change_field=(t,s,r)=>{let o=c.value;const n=o.findIndex((t=>t.name===s));o[n][t]=r,a.folder_repository.set_user_search_schema(l,o)},handle_tuning_delete_field=t=>{a.folder_repository.set_user_search_schema(l,c.value.filter((s=>s.name!==t)))},handle_save_user_search_schema=()=>{message_bus_MessageBus.handle(new SetUserSearchSchema(l,n,c.value),a)},handle_delete_user_search_schema=()=>{message_bus_MessageBus.handle(new DeleteUserSearchSchema(l,n),a)},update_upload_progress=()=>{message_bus_MessageBus.handle(new UpdateUploadProgress,a)};a.upload_progress_timer.set_callback(update_upload_progress);const handle_download_excel_file=async()=>{const t=c.value.map((t=>t.name)),s=c.value.map((t=>t.description));await get_documents_action({without_limits:!0});const r=ie.value.map((s=>t.map((t=>s.get_attribute(t)))));message_bus_MessageBus.handle(new DownloadExcelFile("doc_list.xlsx",[t,s].concat(r)),a)},handle_download_json_file=async()=>{await get_documents_action({without_limits:!0});const t=ie.value.map((t=>{const s=structuredClone(t.raw_attributes);return delete s["_CREATED_AT_DATE"],delete s["_UPDATED_AT_DATE"],s}));message_bus_MessageBus.handle(new DownloadJsonFile("doc_list.json",t),a)},le=(0,i.iH)({}),de=(0,o.Fl)((()=>Object.entries(le.value).filter((t=>!0===t[1])).map((t=>t[0])))),pe=(0,o.Fl)((()=>de.value.map((t=>a.doc_repository.get(l,t).value)))),ce=(0,o.Fl)((()=>Object.values(le.value).filter((t=>!0===t)).length)),handle_select_document=t=>{t in le.value?le.value[t]=!le.value[t]:le.value[t]=!0},reset_selection=()=>{le.value={},ue.value=!1},ue=(0,i.iH)(!1),handle_select_all_documents=()=>{!0===ue.value?(reset_selection(),ue.value=!1):(ue.value=!0,ae.value.forEach((t=>le.value[t.id]=!0)))},handle_add_to_cart=()=>{message_bus_MessageBus.handle(new AddManyDocumentsToCart(l,n,de.value),a)},me=(0,o.Fl)((()=>a.doc_repository.validation_progress(l))),validate_documents=()=>{ae.value.filter((t=>!t.once_validated)).forEach((t=>message_bus_MessageBus.handle(new ValidateDocument(l,n,t.id),a)))},ge=(0,o.Fl)((()=>null===d.value?[]:d.value.search_action_buttons.filter((t=>is_action_button_shown(t))))),is_action_button_shown=t=>!t.allowed_usernames||t.allowed_usernames.includes(r.value.username),handle_push_action_button=async t=>{await message_bus_MessageBus.handle(new PerformActionOnDocuments(t,r.value.username,l,n,de.value),a)};return(0,o.YP)((()=>ae.value),(()=>{reset_selection(),!0===q.value&&validate_documents()})),(0,o.YP)(h,(t=>q.value="edit"===t)),(0,o.YP)(q,(t=>{d.value.is_necessary_validate=t,!0===t&&(validate_documents(),oe.value=!1)})),(0,o.YP)(K,(t=>{t&&(ee.value=t)})),(0,o.YP)(X,(t=>{t&&(te.value=t)})),(0,o.YP)(Q,(t=>{null!==t&&void 0!==t&&(se.value=t)})),(0,o.YP)(ne,(t=>{t&&(oe.value=!0===t.is_active)})),(0,o.YP)(_e,(t=>{!1===t&&handle_save_user_search_schema()})),(0,o.bv)((async()=>{await useBeforeEnterPage(a,["can_get_folders","can_view_document"],l,n),await Promise.all([useGetFolders(a),useGetUserGroups(a)]);const t=a.usergroup_repository.get(n);message_bus_MessageBus.handle(new SetCurrentUserGroup(t.value),a),await Promise.all([useGetUserSearchSchema(a,l,n),useGetSpareFiles(a,l,n)])})),(0,o.Jd)((async()=>a.upload_progress_timer.stop())),{router:s,user:r,can_view_doc:v,can_add_doc:w,can_change_doc:y,can_delete_doc:b,can_view_file:R,can_add_file:F,can_delete_file:D,is_search_clean_required:x,usergroup_id:n,folder_id:l,folder_name:p,search_schema:c,is_list_container_required:m,is_doc_container_required:g,doc_container_parsers:f,generate_doc_link:generate_doc_link,is_edit_mode:q,is_folder_saved:S,handle_update_doc_attribute:handle_update_doc_attribute,handle_save_documents:handle_save_documents,handle_new_docs_drop:handle_new_docs_drop,mark_document_as_not_deleted:mark_document_as_not_deleted,mark_selected_documents_as_deleted:mark_selected_documents_as_deleted,add_empty_document:add_empty_document,duplicate_selected_documents:duplicate_selected_documents,max_file_size:U,is_files_shown:E,spare_files:A,downloading_files:C,attach_file_to_document:attach_file_to_document,detach_file_from_document:detach_file_from_document,handle_new_file_drop:handle_new_file_drop,handle_download_file:handle_download_file,handle_flush_file_container:handle_flush_file_container,handle_delete_file:handle_delete_file,handle_allocate_files:handle_allocate_files,handle_copy_link_to_file_into_clipboard:handle_copy_link_to_file_into_clipboard,handle_download_files_in_archive:handle_download_files_in_archive,is_uploaded_file_dragging:P,is_drag_above_file_zone:j,is_drag_above_doc_zone:M,get_documents_action:get_documents_action,is_searching:O,search_time:z,search_status:N,is_empty_request_allowed:u,search_count:B,sort_by:ee,sort_asc:se,sort_rule:te,search_results:I,sorted_results:ae,is_group_by_mode:oe,group_by_settings:ne,grouped_results:ie,handle_set_page_range:handle_set_page_range,pagination_variants:H,pagination_count_per_page:$,pagination_current_page:L,pagination_min_doc_index:V,pagination_max_doc_index:J,is_intermediate_pages_shown:Y,is_tuning_mode:_e,handle_tuning_change_field:handle_tuning_change_field,handle_save_user_search_schema:handle_save_user_search_schema,handle_tuning_delete_field:handle_tuning_delete_field,handle_delete_user_search_schema:handle_delete_user_search_schema,handle_download_excel_file:handle_download_excel_file,handle_download_json_file:handle_download_json_file,selected_document_ids:le,selected_documents:pe,selected_document_count:ce,handle_select_document:handle_select_document,is_all_selected:ue,handle_select_all_documents:handle_select_all_documents,handle_add_to_cart:handle_add_to_cart,validation_progress:me,validate_documents:validate_documents,action_buttons:ge,handle_push_action_button:handle_push_action_button}}};const Vr=(0,qs.Z)(Lr,[["render",SearchDocumentPagevue_type_template_id_687d5ab8_scoped_true_render],["__scopeId","data-v-687d5ab8"]]);var Jr=Vr;const Yr={class:"page"},Kr={class:"page__header"},Xr={class:"page__container"},Qr={class:"page__searchcontainer"},eo={class:"page__buttonrow buttonrow"},to={class:"page__searchblock"},so={key:0,class:"page__statusrow statusrow"};function ApprovalsPagevue_type_template_id_6c22ea89_scoped_true_render(t,s,a,n,i,_){const d=(0,o.up)("heading-component"),p=(0,o.up)("text-button"),c=(0,o.up)("form-filtered-select-input"),u=(0,o.up)("form-boolean-input"),m=(0,o.up)("form-text-input"),g=(0,o.up)("form-text-field"),h=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",Yr,[(0,o._)("div",Kr,[(0,o.Wm)(d,{text:`Согласования ${n.action_progress<100?"(выполнение действий "+n.action_progress.toString()+"%)":""}  ${n.validation_progress<100?"(валидация "+n.validation_progress.toString()+"%)":""}`,size:"middle"},null,8,["text"])]),(0,o.wy)((0,o._)("div",Xr,[(0,o._)("div",Qr,[(0,o._)("div",eo,[(0,o.Wm)(p,{class:"buttonrow__button buttonrow__button_left",title:"Выделенные в корзину",disabled:0===n.selected_item_count,onClick:s[0]||(s[0]=t=>n.perform_action_on_selected_items("add_to_cart"))},null,8,["disabled"]),(0,o.Wm)(p,{class:"buttonrow__button",title:"Согласовать",disabled:0===n.selected_item_count,onClick:s[1]||(s[1]=t=>n.perform_action_on_selected_items("approve"))},null,8,["disabled"]),(0,o.Wm)(p,{class:"buttonrow__button",title:"Отклонить",disabled:0===n.selected_item_count,onClick:s[2]||(s[2]=t=>n.perform_action_on_selected_items("reject"))},null,8,["disabled"]),(0,o.Wm)(p,{class:"buttonrow__button",title:"Делегировать с возвратом",disabled:0===n.selected_item_count||!1===n.is_approval_action_username_chosen,onClick:s[3]||(s[3]=t=>n.perform_action_on_selected_items("delegate_approval_with_return"))},null,8,["disabled"]),(0,o.Wm)(p,{class:"buttonrow__button",title:"Делегировать без возврата",disabled:0===n.selected_item_count||!1===n.is_approval_action_username_chosen,onClick:s[4]||(s[4]=t=>n.perform_action_on_selected_items("delegate_approval_without_return"))},null,8,["disabled"]),(0,o.Wm)(c,{class:"buttonrow__button buttonrow__button_selectuser",parameters:{options:n.user_options,placeholder:"Поиск...",size:3},value:n.approval_action_username,onUpdate:s[5]||(s[5]=t=>n.approval_action_username=t)},null,8,["parameters","value"]),(0,o.Wm)(p,{class:"buttonrow__button",title:"ZIP",disabled:0===n.selected_item_count,onClick:s[6]||(s[6]=t=>n.perform_action_on_selected_items("download_files_as_archive"))},null,8,["disabled"]),(0,o.Wm)(p,{class:"buttonrow__button buttonrow__button_search",title:"Поиск по согласованиям ...",onClick:s[7]||(s[7]=t=>n.router.push({name:"DocumentApprovalSearchPage"}))})]),(0,o._)("div",to,[(0,o.Wm)(u,{class:"page__checkboxbutton",value:n.is_all_selected,parameters:{size:30},onClick:s[8]||(s[8]=t=>n.handle_select_all_approvals())},null,8,["value"]),(0,o.Wm)(m,{class:"page__searchtype",parameters:{placeholder:"Тип",height:30},value:n.query.type,onUpdate:s[9]||(s[9]=t=>n.query.type=t)},null,8,["value"]),(0,o.Wm)(m,{class:"page__searchuser",parameters:{placeholder:"Кто запросил согласование?",height:30},value:n.query.from_user,onUpdate:s[10]||(s[10]=t=>n.query.from_user=t)},null,8,["value"]),(0,o.Wm)(m,{class:"page__searchuser",parameters:{placeholder:"Кому нужно согласовать?",height:30},value:n.query.to_user,onUpdate:s[11]||(s[11]=t=>n.query.to_user=t)},null,8,["value"]),(0,o.Wm)(m,{class:"page__searchdescription",value:n.query.description,parameters:{placeholdert:"Что нужно согласовать?",height:30},onUpdate:s[12]||(s[12]=t=>n.query.description=t)},null,8,["value"])]),n.selected_item_count>0?((0,o.wg)(),(0,o.iD)("div",so,[(0,o.Wm)(g,{class:"statusrow__info",value:"*** Выделено "+n.selected_item_count.toString()+" шт. ***"},null,8,["value"])])):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.items,(t=>((0,o.wg)(),(0,o.iD)("div",{class:"page__listrow listrow",key:t},[(0,o.Wm)(g,{class:(0,l.C_)(["listrow__error",{listrow__error_exist:t.total_count>1}]),value:t.total_count.toString(),parameters:{hint:"Количество незавершенных согласований документа"}},null,8,["class","value"]),(0,o.Wm)(g,{class:(0,l.C_)(["listrow__error",{listrow__error_exist:t.errors.length>0}]),value:t.errors.length.toString(),parameters:{hint:"Количество ошибок при валидации"}},null,8,["class","value"]),(0,o.Wm)(u,{class:"listrow__checkbox",value:t.id in n.selected_item_ids,parameters:{size:30},onClick:s=>n.handle_select_approval(t.id)},null,8,["value","onClick"]),(0,o.Wm)(g,{class:"listrow__type",parameters:{align:"center"},value:t.type},null,8,["value"]),(0,o.Wm)(g,{class:"listrow__user",parameters:{align:"center"},value:t.from_user},null,8,["value"]),(0,o.Wm)(g,{class:"listrow__user",parameters:{align:"center"},value:t.to_user},null,8,["value"]),(0,o.Wm)(h,{class:"listrow__href",to:t.route_obj},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{class:"listrow__description",value:t.description},null,8,["value"])])),_:2},1032,["to"])])))),128))])],512),[[r.F8,100===n.action_progress]])])}var ao={components:{HeadingComponent:Us,FormTextField:ra,TextButton:ya,FormFilteredSelectInput:rr,FormTextInput:Ns,FormBooleanInput:ua},name:"ApprovalsPage",setup(){const t=(0,_.tv)(),s=new VueUnitOfWork,generate_doc_route_obj=t=>({name:"DocumentPage",params:{folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_id:t.id}}),convert_doc_approval_to_item=t=>({id:t.id,type:"Документ",total_count:t.active_approvals_count_of_document,description:""==t.document.raw_description?"Нет описания. Пересохраните документ.":t.document.raw_description,from_user:t.from_last_name+" "+t.from_first_name+" ("+t.from_username+")",to_user:t.to_last_name+" "+t.to_first_name+" ("+t.to_username+")",route_obj:generate_doc_route_obj(t.document),errors:t.document.errors,actions:{add_to_cart:async()=>await message_bus_MessageBus.handle(new AddDocumentToCart(t.document.folder_id,t.document.usergroup_id,t.document.id),s),approve:async()=>{await message_bus_MessageBus.handle(new UpdateDocumentApproval(t.document.folder_id,t.document.usergroup_id,t.document.id,t.id,"APPROVED",""),s)},reject:async()=>{await message_bus_MessageBus.handle(new UpdateDocumentApproval(t.document.folder_id,t.document.usergroup_id,t.document.id,t.id,"REJECTED",""),s)},delegate_approval_with_return:async()=>await message_bus_MessageBus.handle(new DelegateDocumentApproval(t.document.folder_id,t.document.usergroup_id,t.document.id,t.id,m.value,!0),s),delegate_approval_without_return:async()=>await message_bus_MessageBus.handle(new DelegateDocumentApproval(t.document.folder_id,t.document.usergroup_id,t.document.id,t.id,m.value,!1),s),download_files_as_archive:async()=>await message_bus_MessageBus.handle(new DownloadDocumentFilesAsArchive(t.document.folder_id,t.document.usergroup_id,t.document.id,t.document.files.map((t=>t.size)).reduce(((t,s)=>t+s),0)),s)}}),a=(0,o.Fl)((()=>s.waiting_doc_approval_repository.values().map((t=>convert_doc_approval_to_item(t.value))))),r=(0,i.qj)({type:"",from_user:"",to_user:"",description:""}),filter_objs=(t,s)=>filterArrayOfObjects(t,s,!1).sort(((t,s)=>t.description.localeCompare(s.description))),n=(0,o.Fl)((()=>filter_objs(a.value,r))),l=(0,i.iH)({}),d=(0,o.Fl)((()=>Object.values(l.value).filter((t=>!0===t)).length)),handle_select_approval=t=>{t in l.value?l.value[t]=!l.value[t]:l.value[t]=!0},reset_selection=()=>{p.value=!1,l.value={}};(0,o.YP)((()=>a.value),(()=>reset_selection()));const p=(0,i.iH)(!1),handle_select_all_approvals=()=>{!0===p.value?(reset_selection(),p.value=!1):(p.value=!0,n.value.forEach((t=>l.value[t.id]=!0)))},c=(0,o.Fl)((()=>s.user_repository.values().map((t=>t.value)))),u=(0,o.Fl)((()=>[{name:"Выберите пользователя",value:"NOT_CHOSEN"}].concat(c.value.filter((t=>!0===t.is_active)).map((t=>({name:(t.last_name+" "+t.first_name+" ("+t.username+")").trim(),value:t.username}))).sort(((t,s)=>t.name.localeCompare(s.name)))))),m=(0,i.iH)("NOT_CHOSEN"),g=(0,o.Fl)((()=>"NOT_CHOSEN"!==m.value)),h=(0,i.iH)(100),perform_action_on_selected_items=async t=>{h.value=0;let s=0;const a=n.value.filter((t=>t.id.toString()in l.value&&!0===l.value[t.id.toString()])).filter((s=>s.actions[t])).map((s=>s.actions[t]));let r=0;const o=30;while(r<a.length)await Promise.all(a.slice(r,r+o).map((async t=>{await t(),s++,h.value=Math.round(s/a.length*100)}))),r+=o},f=(0,i.iH)(100);return(0,o.bv)((async()=>{useBeforeEnterPage(s,["can_get_folders"]),await Promise.all([useGetFolders(s),useGetUserGroups(s)]),await Promise.all([useGetDocumentsWaitingApproval(s),useGetUsers(s)]);const t=s.waiting_doc_approval_repository.values().map((t=>t.value.document)).map((t=>{const a=s.folder_repository.get(t.folder_id);return a.value.is_necessary_validate=!0,t.description_pattern=a.value.description_pattern,async()=>{await message_bus_MessageBus.handle(new AddDocumentModel(t.folder_id,t.usergroup_id,t,!1),s),await message_bus_MessageBus.handle(new ValidateDocument(t.folder_id,t.usergroup_id,t.id),s)}}));let a=0;const r=6;let o=0;while(a<t.length)await Promise.all(t.slice(a,a+r).map((async s=>{await s(),o++,f.value=Math.round(o/t.length*100)}))),a+=r})),{router:t,doc_approvals:a,generate_doc_route_obj:generate_doc_route_obj,items:n,query:r,selected_item_ids:l,selected_item_count:d,handle_select_approval:handle_select_approval,reset_selection:reset_selection,is_all_selected:p,handle_select_all_approvals:handle_select_all_approvals,users:c,user_options:u,approval_action_username:m,is_approval_action_username_chosen:g,action_progress:h,perform_action_on_selected_items:perform_action_on_selected_items,validation_progress:f}}};const ro=(0,qs.Z)(ao,[["render",ApprovalsPagevue_type_template_id_6c22ea89_scoped_true_render],["__scopeId","data-v-6c22ea89"]]);var oo=ro;const DocumentPagevue_type_template_id_87ace392_scoped_true_withScopeId=t=>((0,o.dD)("data-v-87ace392"),t=t(),(0,o.Cn)(),t),no={key:0,class:"page"},io={class:"page__header"},_o={key:0,class:"page__container"},lo={class:"page__doccontainer"},po={class:"page__docbuttonblock docbuttonblock"},co={key:1,class:"docbuttonblock__lockicon"},uo=DocumentPagevue_type_template_id_87ace392_scoped_true_withScopeId((()=>(0,o._)("div",{class:"docbuttonblock__grow"},null,-1))),mo={class:"page__docattributeblock"},go={key:0,class:"page__docfiledropzonetitle"},ho={class:"page__docerrorblock docerrorblock"},fo={key:2,class:"page__copycontainer copycontainer"},vo={key:0,class:"copycontainer__row"},wo={key:1,class:"copycontainer__row"},yo={class:"copycontainer__row"},bo={class:"copycontainer__links"},Ro=(0,o.Uk)("Созданная копия документа "),Fo={key:3,class:"page__actioncontainer actioncontainer"},Do={key:0,class:"page__approvalcontainer"},xo={class:"page__approvalorderblock approvalorderblock"},ko={key:0,class:"page__approvalactionblock"},qo={class:"page__approvalbuttonblock approvalbuttonblock"},So={class:"page__approvaldropblock approvaldropblock"},Eo={class:"page__approvalfileblock approvalfileblock"},Ao={key:1,class:"page__approvalitemsblock"},Co={key:1,class:"page__approvalflowcontainer"},Uo={key:1,class:"page__form-backdrop"},Po={key:1,class:"page"},jo={class:"page__header"};function DocumentPagevue_type_template_id_87ace392_scoped_true_render(t,s,a,n,i,_){const d=(0,o.up)("heading-component"),p=(0,o.up)("toggle-text-button"),c=(0,o.up)("form-text-field"),u=(0,o.up)("text-button"),m=(0,o.up)("document-page-download-progress-row"),g=(0,o.up)("document-attribute-block"),h=(0,o.up)("file-drop-zone"),f=(0,o.up)("file-list"),v=(0,o.up)("document-errors-row"),w=(0,o.up)("btn-component"),y=(0,o.up)("form-select-input"),b=(0,o.up)("router-link"),R=(0,o.up)("form-filtered-select-input"),F=(0,o.up)("file-block"),D=(0,o.up)("approval-row"),x=(0,o.up)("approval-flow"),k=(0,o.up)("base-form");return(0,o.wg)(),(0,o.iD)("div",null,[n.folder_name?((0,o.wg)(),(0,o.iD)("div",no,[(0,o._)("div",io,[(0,o._)("span",{class:"page__linkbutton",onClick:s[0]||(s[0]=(...t)=>n.handle_copy_link_to_document_into_clipboard&&n.handle_copy_link_to_document_into_clipboard(...t))},"🔗 "),(0,o.Wm)(d,{text:n.usergroup_name+" > "+n.folder_name,size:"middle"},null,8,["text"])]),n.doc?((0,o.wg)(),(0,o.iD)("div",_o,[(0,o._)("div",lo,[(0,o._)("div",po,[!n.doc.is_blocked&&n.doc.is_saved&&n.are_files_saved&&n.can_change_doc?((0,o.wg)(),(0,o.j4)(p,{key:0,class:"docbuttonblock__button",activeTitle:"Режим просмотра",passiveTitle:"Режим редактирования",isActive:n.is_edit_mode,onClick:s[1]||(s[1]=t=>n.is_edit_mode=!n.is_edit_mode)},null,8,["isActive"])):(0,o.kq)("",!0),n.doc.is_blocked?((0,o.wg)(),(0,o.iD)("div",co)):(0,o.kq)("",!0),n.doc.is_blocked?((0,o.wg)(),(0,o.j4)(c,{key:2,class:"docbuttonblock__locktext",value:"Документ заблокирован"})):(0,o.kq)("",!0),!n.doc.is_saved&&n.can_change_doc?((0,o.wg)(),(0,o.j4)(u,{key:3,class:"docbuttonblock__button docbuttonblock__button_red",title:"Сохранить изменения",onClick:s[2]||(s[2]=t=>n.handle_save_document())})):(0,o.kq)("",!0),n.doc.files.length>0?((0,o.wg)(),(0,o.j4)(u,{key:4,class:"docbuttonblock__button",title:"Скачать все файлы",onClick:s[3]||(s[3]=t=>n.handle_download_all_files())})):(0,o.kq)("",!0),uo,n.form_schema?((0,o.wg)(),(0,o.iD)("div",{key:5,class:"docbuttonblock__linktoform",title:"Открыть форму",onClick:s[4]||(s[4]=t=>n.is_form_opened=!0)}," ✎ ")):(0,o.kq)("",!0)]),(0,o.Wm)(m,{class:"page__filedownloadblock",files:n.downloading_files},null,8,["files"]),(0,o.Wm)(m,{class:"page__filedownloadblock",files:n.uploading_files},null,8,["files"]),(0,o._)("div",mo,[(0,o.Wm)(g,{id:n.doc.id,search_schema:n.search_schema,attributes:!0===n.is_edit_mode?n.doc.raw_attributes:n.doc.attributes,is_edit_mode:n.is_edit_mode,is_highlighted:!n.doc.is_saved,is_disabled:n.doc.is_blocked,"onUpdate:doc":s[5]||(s[5]=t=>n.handle_update_doc_attribute(t.id,t.name,t.value))},null,8,["id","search_schema","attributes","is_edit_mode","is_highlighted","is_disabled"])]),n.is_edit_mode&&n.can_change_doc?((0,o.wg)(),(0,o.j4)(h,{key:0,class:(0,l.C_)(["page__docfiledropzone",{page__docfiledropzone_dragging:n.is_drag_above_doc_file_zone}]),"onAdd:file":s[6]||(s[6]=t=>n.handle_document_file_drop(t)),"onUpdate:dragging":s[7]||(s[7]=t=>n.is_drag_above_doc_file_zone=t)},{default:(0,o.w5)((()=>[n.is_drag_above_doc_file_zone?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("span",go," < "+(0,l.zw)(n.doc_max_file_size)+" МБ",1))])),_:1},8,["class"])):(0,o.kq)("",!0),n.can_view_file?((0,o.wg)(),(0,o.j4)(f,{key:1,class:"page__docfileblock",files:n.doc.files,can_be_dragged:!1,can_be_deleted:n.is_edit_mode,can_be_renamed:n.is_edit_mode,"onDownload:file":s[8]||(s[8]=t=>n.handle_download_file(...t)),"onRename:file":s[9]||(s[9]=t=>n.handle_rename_file(...t)),"onRename:activated":s[10]||(s[10]=t=>n.handle_rename_file_activated(t)),"onDelete:file":s[11]||(s[11]=t=>n.detach_file_from_document(n.doc,t)),"onCopy_link_to:file":s[12]||(s[12]=t=>n.handle_copy_link_to_document_file_into_clipboard(t))},null,8,["files","can_be_deleted","can_be_renamed"])):(0,o.kq)("",!0),(0,o._)("div",ho,[(0,o.Wm)(c,{class:"container__header",value:"Результаты проверки правильности документа:"}),n.doc.errors.length>0?((0,o.wg)(),(0,o.j4)(v,{key:0,class:"docerrorblock__errors",errors:n.doc.errors},null,8,["errors"])):((0,o.wg)(),(0,o.j4)(c,{key:1,class:"docerrorblock__noerrors",value:"OK"}))]),n.copy_list_usergroups.length>0?((0,o.wg)(),(0,o.iD)("div",fo,[(0,o.Wm)(c,{class:"container__header",value:"Действия над документом:"}),n.doc.is_blocked?((0,o.wg)(),(0,o.iD)("div",wo,[(0,o.Wm)(c,{class:"copycontainer__text",value:"Пусто"})])):((0,o.wg)(),(0,o.iD)("div",vo,[(0,o.Wm)(w,{class:"copycontainer__button",type:"warning",disabled:n.get_seconds_before_button_copy_to_usergroup_activated()>0,caption:n.get_text_of_action_button("Копировать в группу",n.COPY_TO_USERGROUP_ACTION),onClick:s[13]||(s[13]=t=>n.handle_copy_list_change_usergroup())},null,8,["disabled","caption"]),(0,o.Wm)(y,{class:"copycontainer__usergroupselect",parameters:{options:n.copy_list_usergroups},value:n.copy_list_usergroup_id.toString(),onUpdate:s[14]||(s[14]=t=>n.copy_list_usergroup_id=parseInt(t))},null,8,["parameters","value"])])),(0,o._)("div",yo,[(0,o._)("div",bo,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.doc.clones,(t=>((0,o.wg)(),(0,o.j4)(b,{key:t.id,class:"copycontainer__cloneref",to:n.generate_doc_link(t.id)},{default:(0,o.w5)((()=>[Ro])),_:2},1032,["to"])))),128))])])])):(0,o.kq)("",!0),n.action_buttons.length>0?((0,o.wg)(),(0,o.iD)("div",Fo,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.action_buttons,((t,s)=>((0,o.wg)(),(0,o.j4)(w,{class:"actioncontainer__button",key:s,type:t.type||"primary",disabled:n.is_action_button_disabled(t)||n.get_seconds_before_button_activated(t.action)>0,caption:n.get_text_of_action_button(t.caption,t.action),onClick:s=>n.handle_push_document_button(t.action)},null,8,["type","disabled","caption","onClick"])))),128))])):(0,o.kq)("",!0)]),n.can_view_approval&&!n.is_edit_mode?((0,o.wg)(),(0,o.iD)("div",Do,[(0,o.Wm)(c,{class:"container__header",value:"Согласования:"}),(0,o._)("div",xo,[n.can_add_approval||n.can_delegate_approval?((0,o.wg)(),(0,o.j4)(R,{key:0,class:"approvalorderblock__input",parameters:{placeholder:"Поиск...",size:3,options:n.user_options},value:n.approval_action_username,onUpdate:s[15]||(s[15]=t=>n.approval_action_username=t)},null,8,["parameters","value"])):(0,o.kq)("",!0),n.can_add_approval?((0,o.wg)(),(0,o.j4)(w,{key:1,class:"approvalorderblock__button",type:"primary",caption:"Запросить согласование",disabled:!1===n.is_approval_action_username_chosen,onClick:s[16]||(s[16]=t=>n.handle_add_document_approval())},null,8,["disabled"])):(0,o.kq)("",!0),n.can_delegate_approval&&n.approvals_to_be_closed_ids&&1==n.approvals_to_be_closed_ids.length&&n.has_right_to_delegate_with_return?((0,o.wg)(),(0,o.j4)(w,{key:2,class:"approvalorderblock__button",type:"success",caption:"Делегировать с возвратом",disabled:!1===n.is_approval_action_username_chosen,title:"Назначить согласование другому пользователю и оставить свое активным",onClick:s[17]||(s[17]=t=>n.handle_delegate_document_approval(!0))},null,8,["disabled"])):(0,o.kq)("",!0),n.can_delegate_approval&&n.approvals_to_be_closed_ids&&1==n.approvals_to_be_closed_ids.length&&n.has_right_to_delegate_without_return?((0,o.wg)(),(0,o.j4)(w,{key:3,class:"approvalorderblock__button",type:"warning",caption:"Делегировать без возвратa",disabled:!1===n.is_approval_action_username_chosen,title:"Назначить согласование другому пользователю, а свое закрыть",onClick:s[18]||(s[18]=t=>n.handle_delegate_document_approval(!1))},null,8,["disabled"])):(0,o.kq)("",!0)]),n.can_change_approval&&null!==n.approvals_to_be_closed_ids?((0,o.wg)(),(0,o.iD)("div",ko,[(0,o._)("div",qo,[n.has_right_to_approve?((0,o.wg)(),(0,o.j4)(w,{key:0,class:"approvalbuttonblock__button",type:"success",caption:"Согласовать",onClick:s[19]||(s[19]=t=>n.handle_approve_document())})):(0,o.kq)("",!0),n.has_right_to_reject?((0,o.wg)(),(0,o.j4)(w,{key:1,class:"approvalbuttonblock__button",type:"danger",caption:"Отклонить",onClick:s[20]||(s[20]=t=>n.handle_reject_document())})):(0,o.kq)("",!0)]),(0,o._)("div",So,[(0,o.Wm)(c,{class:"approvaldropblock__label",value:"Напишите здесь (картинки вставляйте, как файлы) или перетащите файлы с комментариями. Данное текстовое поле для коротких комментариев. Если Вам приходится оформлять комментарий в отдельном файле, а потом сюда вставлять, это неправильно. Просто перетащите сюда этот файл.",parameters:{align:"justify"}}),(0,o.Wm)(h,{class:(0,l.C_)(["approvaldropblock__filedropzone",{approvaldropblock__filedropzone_dragging:n.is_drag_above_approval_file_zone}]),filename_pattern:n.approval_filename_pattern,"onAdd:file":s[23]||(s[23]=t=>n.handle_document_approval_file_drop(t)),"onUpdate:dragging":s[24]||(s[24]=t=>n.is_drag_above_approval_file_zone=t),"onWrong:filename":s[25]||(s[25]=t=>n.handle_document_approval_filename_wrong(t))},{default:(0,o.w5)((()=>[(0,o.wy)((0,o._)("div",{id:"approvaldropblock__textzone",class:"approvaldropblock__dropzonetitle",contenteditable:"true",onInput:s[21]||(s[21]=t=>n.text_comments=t.target.innerHTML),onPaste:s[22]||(s[22]=t=>n.handle_paste(t))},null,544),[[r.F8,!n.is_drag_above_approval_file_zone]])])),_:1},8,["class","filename_pattern"])]),(0,o._)("div",Eo,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.document_approval_files,(t=>((0,o.wg)(),(0,o.j4)(F,{class:"approvalfileblock__file",key:t.id,file:t,can_be_deleted:!0,can_be_dragged:!1,"onDownload:file":s=>n.handle_download_file(t,s),"onDelete:file":s=>n.handle_delete_document_approval_file(t.id),"onCopy_link_to:file":s=>n.handle_copy_link_to_document_file_into_clipboard(t)},null,8,["file","onDownload:file","onDelete:file","onCopy_link_to:file"])))),128))])])):(0,o.kq)("",!0),n.approvals_after_last_update.length>0||n.approvals_before_last_update.length>0?((0,o.wg)(),(0,o.iD)("div",Ao,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.approvals_after_last_update,(t=>((0,o.wg)(),(0,o.j4)(D,{class:"page__approvalitem",key:t.id,obj:t,can_be_deleted:n.can_delete_approval&&n.approval_ids_can_be_deleted.includes(t.id),"onDelete:approval":s=>n.handle_delete_document_approval(t.id),"onDownload:file":s[26]||(s[26]=t=>n.handle_download_file(...t)),"onDelete:file":s[27]||(s[27]=t=>n.handle_delete_document_approval_file(t)),"onCopy_link_to:file":s[28]||(s[28]=t=>n.handle_copy_link_to_document_file_into_clipboard(t))},null,8,["obj","can_be_deleted","onDelete:approval"])))),128)),(0,o.Wm)(c,{class:"page__approvallastupdatetext",value:"Последнее обновление документа "+n.convertDateToDateTimeString(n.doc.updated_at)},null,8,["value"]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.approvals_before_last_update,(t=>((0,o.wg)(),(0,o.j4)(D,{class:"page__approvalitem",key:t.id,obj:t,can_be_deleted:n.can_delete_approval&&n.approval_ids_can_be_deleted.includes(t.id),"onDelete:approval":s=>n.handle_delete_document_approval(t.id),"onDownload:file":s[29]||(s[29]=t=>n.handle_download_file(...t)),"onDelete:file":s[30]||(s[30]=t=>n.handle_delete_document_approval_file(t)),"onCopy_link_to:file":s[31]||(s[31]=t=>n.handle_copy_link_to_document_file_into_clipboard(t))},null,8,["obj","can_be_deleted","onDelete:approval"])))),128))])):(0,o.kq)("",!0)])):(0,o.kq)("",!0),n.can_view_approvalflow&&!n.is_edit_mode?((0,o.wg)(),(0,o.iD)("div",Co,[(0,o.Wm)(c,{class:"container__header",value:"Поток согласований:"}),!n.approval_flow&&n.can_change_approvalflow?((0,o.wg)(),(0,o.j4)(u,{key:0,class:"approvalflowcontainer__createbutton",title:"Создать поток",onClick:s[32]||(s[32]=t=>n.handle_create_approval_flow())})):(0,o.kq)("",!0),n.approval_flow?((0,o.wg)(),(0,o.j4)(x,{key:1,class:"approvalflowcontainer__flow",is_active:n.approval_flow.is_active,is_saved:n.approval_flow.is_saved,success:n.approval_flow.success,created_at:n.approval_flow.created_at,updated_at:n.approval_flow.updated_at,steps:n.approval_flow.steps,states:n.approval_flow_states,users:n.users,can_be_modified:n.can_change_approvalflow,"onAdd:step":s[33]||(s[33]=t=>n.handle_add_approval_flow_step()),"onDelete:step":s[34]||(s[34]=t=>n.handle_delete_approval_flow_step(t)),"onAttach:user":s[35]||(s[35]=t=>n.handle_attach_user_to_approval_flow_step(...t)),"onDelete:user":s[36]||(s[36]=t=>n.handle_delete_user_from_approval_flow_step(...t)),onSave:s[37]||(s[37]=t=>n.handle_save_approval_flow()),onStart:s[38]||(s[38]=t=>n.handle_start_approval_flow()),onStop:s[39]||(s[39]=t=>n.handle_stop_approval_flow())},null,8,["is_active","is_saved","success","created_at","updated_at","steps","states","users","can_be_modified"])):(0,o.kq)("",!0)])):(0,o.kq)("",!0)])):(0,o.kq)("",!0),n.doc&&n.is_form_opened&&n.form_pages?((0,o.wg)(),(0,o.iD)("div",Uo,[(0,o.Wm)(k,{class:"page__form",attributes:!0===n.is_edit_mode?n.doc.raw_attributes:n.doc.attributes,settings:n.form_pages,context:n.form_context,onUpdate:s[40]||(s[40]=t=>n.handle_update_doc_attribute(n.doc.id,t.name,t.value)),onClose:s[41]||(s[41]=t=>n.is_form_opened=!1)},null,8,["attributes","settings","context"])])):(0,o.kq)("",!0)])):((0,o.wg)(),(0,o.iD)("div",Po,[(0,o._)("div",jo,[(0,o.Wm)(d,{text:"..невозможно загрузить данные..",size:"small"})])]))])}const Mo={class:"documentattributeblock__labelcontainer"},To={class:"documentattributeblock__valuecontainer"};function DocumentAttributeBlockvue_type_template_id_4b59af1a_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("form-text-field"),d=(0,o.up)("form-text-input"),p=(0,o.up)("form-date-input");return(0,o.wg)(),(0,o.iD)("div",{class:(0,l.C_)(["documentattributeblock",{documentattributeblock_modified:a.is_highlighted}])},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.search_schema,(s=>((0,o.wg)(),(0,o.iD)("div",{key:s.name,class:"documentattributeblock__row"},[(0,o._)("div",Mo,[(0,o.Wm)(_,{class:"documentattributeblock__textfield",value:s.description+":"},null,8,["value"])]),(0,o._)("div",To,[a.is_edit_mode&&!s.name.toLowerCase().includes("date")?((0,o.wg)(),(0,o.j4)(d,{key:0,class:"documentattributeblock__textinput",value:r.get_str_attribute(a.attributes[s.name],s.default),parameters:{is_disabled:r.get_bool_attribute(s.is_disabled)||a.is_disabled},onUpdate:r=>t.$emit("update:doc",{id:a.id,name:s.name,value:r})},null,8,["value","parameters","onUpdate"])):(0,o.kq)("",!0),a.is_edit_mode&&s.name.toLowerCase().includes("date")?((0,o.wg)(),(0,o.j4)(p,{key:1,class:"documentattributeblock__dateinput",parameters:{is_disabled:r.get_bool_attribute(s.is_disabled)||a.is_disabled},value:a.attributes[s.name],onUpdate:r=>t.$emit("update:doc",{id:a.id,name:s.name,value:r})},null,8,["parameters","value","onUpdate"])):(0,o.kq)("",!0),a.is_edit_mode?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(_,{key:2,class:"documentattributeblock__textfield",value:r.get_str_attribute(a.attributes[s.name],s.default)},null,8,["value"]))])])))),128))],2)}var No={components:{FormTextField:ra,FormTextInput:Ns,FormDateInput:_a},name:"DocumentAttributeBlock",props:{id:{type:[String,Number],required:!0},search_schema:{type:Array,required:!0},attributes:{type:Object,required:!0},is_edit_mode:{type:Boolean,required:!1,default:!1},is_highlighted:{type:Boolean,required:!1,default:!1},is_disabled:{type:Boolean,required:!1,default:!1}},emits:["update:doc"],setup(){const get_str_attribute=(t,s)=>{const a=s||"";return void 0!==t&&null!==t?t:a},get_bool_attribute=t=>!0===t;return{get_str_attribute:get_str_attribute,get_bool_attribute:get_bool_attribute}}};const Io=(0,qs.Z)(No,[["render",DocumentAttributeBlockvue_type_template_id_4b59af1a_scoped_true_render],["__scopeId","data-v-4b59af1a"]]);var Bo=Io;const Oo={class:"approvalrow"},zo={class:"approvalrow__infoblock"},Wo={class:"approvalrow__fileblock"};function ApprovalRowvue_type_template_id_4f03de9f_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("form-text-field"),d=(0,o.up)("file-block");return(0,o.wg)(),(0,o.iD)("div",Oo,[(0,o._)("div",zo,[(0,o._)("div",{class:(0,l.C_)(["approvalrow__state",{approvalrow__state_approved:"APPROVED"===a.obj.state,approvalrow__state_rejected:"REJECTED"===a.obj.state,approvalrow__state_delegated:"DELEGATED"===a.obj.state,approvalrow__state_waiting:"NONE"===a.obj.state}]),title:"Статус согласования"},null,2),(0,o.Wm)(_,{class:"approvalrow__user",value:a.obj.to_last_name+" "+a.obj.to_first_name+" ("+a.obj.to_username+")"},null,8,["value"]),(0,o.Wm)(_,{class:"approvalrow__request",value:"по запросу"}),(0,o.Wm)(_,{class:"approvalrow__user",value:a.obj.from_last_name+" "+a.obj.from_first_name+" ("+a.obj.from_username+")"},null,8,["value"]),(0,o.Wm)(_,{class:"approvalrow__date",value:r.convertDateToDateTimeString(a.obj.updated_at)},null,8,["value"]),(0,o._)("div",{class:(0,l.C_)(["approvalrow__delete",{approvalrow__delete_active:!0===a.can_be_deleted,approvalrow__delete_passive:!1===a.can_be_deleted}]),title:"Удалить строку",onClick:s[0]||(s[0]=t=>r.handle_delete_action())},null,2)]),(0,o._)("div",Wo,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.obj.files,(s=>((0,o.wg)(),(0,o.j4)(d,{class:"approvalrow__file",key:s.id,file:s,can_be_deleted:!1,can_be_dragged:!1,"onDelete:file":a=>t.$emit("delete:file",s.id),"onDownload:file":a=>t.$emit("download:file",[s,a]),"onCopy_link_to:file":a=>t.$emit("copy_link_to:file",s)},null,8,["file","onDelete:file","onDownload:file","onCopy_link_to:file"])))),128))])])}var Go={components:{FormTextField:ra,FileBlock:Ia},name:"ApprovalRow",props:{obj:{type:Object,required:!0},can_be_deleted:{type:Boolean,required:!1,default:!1}},emits:["delete:approval","delete:file","download:file","copy_link_to:file"],setup(t,{emit:s}){const handle_delete_action=()=>{!0===t.can_be_deleted&&s("delete:approval")};return{convertDateToDateTimeString:convertDateToDateTimeString,handle_delete_action:handle_delete_action}}};const Zo=(0,qs.Z)(Go,[["render",ApprovalRowvue_type_template_id_4f03de9f_scoped_true_render],["__scopeId","data-v-4f03de9f"]]);var Ho=Zo;const ApprovalFlowvue_type_template_id_1248b4b2_scoped_true_withScopeId=t=>((0,o.dD)("data-v-1248b4b2"),t=t(),(0,o.Cn)(),t),$o={class:"approvalflow"},Lo={class:"approvalflow__infoblock"},Vo=ApprovalFlowvue_type_template_id_1248b4b2_scoped_true_withScopeId((()=>(0,o._)("div",{class:"approvalflow__empty"},null,-1))),Jo={key:0,class:"approvalflow__buttonblock"},Yo={key:3,class:"approvalflow__empty"},Ko={key:1,class:"approvalflow__userblock"},Xo={class:"approvalflow__stepblock"},Qo={key:0,class:"approvalflow__row"},en={key:1,class:"approvalflow__row"},tn=ApprovalFlowvue_type_template_id_1248b4b2_scoped_true_withScopeId((()=>(0,o._)("div",{class:"approvalflow__button approvalflow__button_large approvalflow__button_onprogress approvalflow__button_rotating",title:"Поток запущен и работает"},null,-1))),sn=[tn],an={class:"approvalflow__row"},rn={class:"approvalflow__row"},on={key:0,class:"approvalflow_dropzonetitle"};function ApprovalFlowvue_type_template_id_1248b4b2_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("form-text-field"),d=(0,o.up)("form-filtered-select-input"),p=(0,o.up)("approval-flow-step-item"),c=(0,o.up)("approval-flow-step"),u=(0,o.up)("json-file-drop-zone");return(0,o.wg)(),(0,o.iD)("div",$o,[(0,o._)("div",Lo,[(0,o.Wm)(_,{class:"approvalflow__label",value:r.created_date_info},null,8,["value"]),Vo,(0,o.Wm)(_,{class:"approvalflow__label",value:r.updated_date_info},null,8,["value"])]),a.can_be_modified?((0,o.wg)(),(0,o.iD)("div",Jo,[a.is_saved?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",{key:0,class:"approvalflow__button approvalflow__button_save",title:"Сохранить поток",onClick:s[0]||(s[0]=t=>r.handle_save())})),a.is_saved&&!a.is_active?((0,o.wg)(),(0,o.iD)("div",{key:1,class:"approvalflow__button approvalflow__button_start",title:"Запустить поток",onClick:s[1]||(s[1]=s=>t.$emit("start"))})):(0,o.kq)("",!0),a.is_saved&&a.is_active?((0,o.wg)(),(0,o.iD)("div",{key:2,class:"approvalflow__button approvalflow__button_stop",title:"Остановить поток",onClick:s[2]||(s[2]=s=>t.$emit("stop"))})):(0,o.kq)("",!0),a.is_active?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",Yo)),a.is_active?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(d,{key:4,class:"approvalflow__username",parameters:{options:r.user_options,placeholder:"Поиск...",size:3},value:r.action_username,onUpdate:s[3]||(s[3]=t=>r.action_username=t)},null,8,["parameters","value"])),a.is_active?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",{key:5,class:(0,l.C_)(["approvalflow__button approvalflow__button_add",{approvalflow__button_gray:!r.is_action_username_chosen}]),title:"Добавить пользователя",onClick:s[4]||(s[4]=t=>r.handle_add_user())},null,2))])):(0,o.kq)("",!0),a.is_active?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",Ko,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.non_attached_usernames,((t,s)=>((0,o.wg)(),(0,o.j4)(p,{class:"approvalflow__user",key:s,id:t,text:r.find_user_description(t),can_be_deleted:!1,can_be_dragged:!0},null,8,["id","text"])))),128))])),(0,o._)("div",Xo,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.steps,((s,n)=>((0,o.wg)(),(0,o.j4)(c,{class:"approvalflow__step",key:n,id:n+1,items:r.modify_step(s),states:a.states,can_be_modified:!a.is_active&&a.can_be_modified,"onDelete:step":s=>t.$emit("delete:step",n),"onDelete:item":t=>r.handle_delete_user_from_step(n,t),onAttach:t=>r.handle_attach_user_to_step(n,t)},null,8,["id","items","states","can_be_modified","onDelete:step","onDelete:item","onAttach"])))),128)),!a.is_active&&a.can_be_modified?((0,o.wg)(),(0,o.iD)("div",Qo,[(0,o._)("div",{class:"approvalflow__button approvalflow__button_large approvalflow__button_add_large",title:"Добавить шаг потока",onClick:s[5]||(s[5]=s=>t.$emit("add:step"))})])):(0,o.kq)("",!0),a.is_active?((0,o.wg)(),(0,o.iD)("div",en,sn)):(0,o.kq)("",!0),(0,o._)("div",an,[(0,o._)("div",{class:"approvalflow__button approvalflow__button_large approvalflow__button_download_large",title:"Скачать поток",onClick:s[6]||(s[6]=t=>r.handle_download_json_file())})]),(0,o._)("div",rn,[(0,o.Wm)(u,{class:(0,l.C_)(["approvalflow__dropzone",{approvalflow__dropzone_dragging:r.is_drag_above_json_file_zone}]),default:[],"onUpdate:dragging":s[7]||(s[7]=t=>r.is_drag_above_json_file_zone=t),"onUpdate:json":s[8]||(s[8]=t=>r.handle_drop_json_file(t))},{default:(0,o.w5)((()=>[r.is_drag_above_json_file_zone?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("span",on," Сюда можно загрузить JSON файл потока"))])),_:1},8,["class"])])])])}const nn={class:"approvalflowstep__row"},_n={class:"approvalflowstep__container"},ln={key:0,class:"approvalflowstep__emptyblock"};function ApprovalFlowStepvue_type_template_id_330bf1f6_scoped_true_render(t,s,a,n,i,_){const l=(0,o.up)("form-text-field"),d=(0,o.up)("approval-flow-step-item");return(0,o.wg)(),(0,o.iD)("div",{class:"approvalflowstep",onDrop:s[1]||(s[1]=(0,r.iM)((t=>n.handle_drop(t)),["prevent"])),onDragover:s[2]||(s[2]=(0,r.iM)((()=>{}),["prevent"])),onDragenter:s[3]||(s[3]=(0,r.iM)((()=>{}),["prevent"]))},[(0,o._)("div",nn,[(0,o.Wm)(l,{class:"approvalflowstep__index",value:a.id.toString()},null,8,["value"]),(0,o._)("div",_n,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.items,((s,r)=>((0,o.wg)(),(0,o.j4)(d,{class:"approvalflowstep__item",key:r,id:s.id,text:s.text,can_be_deleted:a.can_be_modified,can_be_dragged:!1,state:a.states[s.id],onDelete:a=>t.$emit("delete:item",s.id)},null,8,["id","text","can_be_deleted","state","onDelete"])))),128)),0==a.items.length?((0,o.wg)(),(0,o.iD)("div",ln)):(0,o.kq)("",!0)]),a.can_be_modified?((0,o.wg)(),(0,o.iD)("div",{key:0,class:"approvalflowstep__button approvalflowstep__button_delete",title:"Удалить шаг потока",onClick:s[0]||(s[0]=s=>t.$emit("delete:step"))})):(0,o.kq)("",!0)])],32)}const dn=["draggable"],pn={class:"approvalflowstepitem__text"};function ApprovalFlowStepItemvue_type_template_id_4a3a4911_scoped_true_render(t,s,a,r,n,i){return(0,o.wg)(),(0,o.iD)("div",{class:"approvalflowstepitem",draggable:a.can_be_dragged,onDragstart:s[0]||(s[0]=t=>r.handle_drag_start(t)),onDragend:s[1]||(s[1]=s=>t.$emit("dragend")),onClick:s[2]||(s[2]=t=>r.handle_delete())},[a.state?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,l.C_)(["approvalflowstepitem__state",{approvalflowstepitem__state_approved:"APPROVED"===a.state,approvalflowstepitem__state_rejected:"REJECTED"===a.state,approvalflowstepitem__state_waiting:"NONE"===a.state}]),title:"Статус согласования"},null,2)):(0,o.kq)("",!0),(0,o._)("div",pn,(0,l.zw)(a.text),1)],40,dn)}var cn={name:"ApprovalFlowStepItem",props:{id:{type:String,required:!0},text:{type:String,required:!0},state:{type:String,validator:t=>["APPROVED","REJECTED","NONE"].includes(t)},can_be_deleted:{type:Boolean,required:!0},can_be_dragged:{type:Boolean,required:!0}},emits:["delete","dragstart","dragend"],setup(t,{emit:s}){const handle_drag_start=a=>{a.dataTransfer.setData("text/plain",t.id),s("dragstart")},handle_delete=()=>{t.can_be_deleted&&s("delete")};return{handle_drag_start:handle_drag_start,handle_delete:handle_delete}}};const un=(0,qs.Z)(cn,[["render",ApprovalFlowStepItemvue_type_template_id_4a3a4911_scoped_true_render],["__scopeId","data-v-4a3a4911"]]);var mn=un,gn={components:{ApprovalFlowStepItem:mn,FormTextField:ra},name:"ApprovalFlowStep",props:{id:{type:Number,required:!0},items:{type:Array,required:!0},states:{type:Object,required:!0},can_be_modified:{type:Boolean,required:!0}},emits:["delete:step","delete:item","attach"],setup(t,{emit:s}){const handle_drop=t=>{const a=t.dataTransfer.getData("text");s("attach",a)};return{handle_drop:handle_drop}}};const hn=(0,qs.Z)(gn,[["render",ApprovalFlowStepvue_type_template_id_330bf1f6_scoped_true_render],["__scopeId","data-v-330bf1f6"]]);var fn=hn,vn={components:{FormTextField:ra,ApprovalFlowStep:fn,ApprovalFlowStepItem:mn,FormFilteredSelectInput:rr,JsonFileDropZone:Er},name:"ApprovalFlow",props:{is_active:{type:Boolean,required:!0},is_saved:{type:Boolean,required:!0},success:{type:Boolean,required:!0},created_at:{type:Date,required:!0},updated_at:{type:Date,required:!0},steps:{type:Array,required:!0},states:{type:Object,required:!0},users:{type:Array,required:!0},can_be_modified:{type:Boolean,required:!0}},emits:["add:step","delete:step","delete:user","attach:user","save","start","stop"],setup(t,{emit:s}){const a=new VueUnitOfWork,r=(0,o.Fl)((()=>"Создан: "+convertDateToDateTimeString(t.created_at))),n=(0,o.Fl)((()=>"Обновлен: "+convertDateToDateTimeString(t.updated_at))),_=(0,i.iH)("NOT_CHOSEN"),l=(0,o.Fl)((()=>"NOT_CHOSEN"!==_.value)),d=(0,i.iH)([]),p=(0,i.iH)(!1),c=(0,o.Fl)((()=>[{name:"Выберите пользователя",value:"NOT_CHOSEN"}].concat(t.users.map((t=>({name:(t.last_name+" "+t.first_name+" ("+t.username+")").trim(),value:t.username}))).sort(((t,s)=>t.name.localeCompare(s.name)))))),u=(0,o.Fl)((()=>t.users.map((t=>t.username)))),find_user_description=t=>{const s=c.value.map((t=>t["value"])).indexOf(t);return c.value[s]["name"]},modify_step=t=>t.map((t=>({id:t,text:find_user_description(t)}))),handle_add_user=()=>{l.value&&d.value.push(_.value)},handle_attach_user_to_step=(t,a)=>{s("attach:user",[t,a]),d.value=d.value.filter((t=>t!=a))},handle_delete_user_from_step=(t,a)=>{s("delete:user",[t,a]),d.value.push(a)},handle_save=()=>{d.value=[],s("save")},handle_drop_json_file=r=>{const o=t.steps.length;for(let t=0;t<o;t++)s("delete:step",0);try{let t=0;r.forEach((a=>{s("add:step"),a.forEach((a=>{if(-1==u.value.indexOf(a))throw new Error("Wrong username: "+a);s("attach:user",[t,a])})),t++}))}catch(n){console.log(n),message_bus_MessageBus.handle(new ApprovalFlowUploadError,a)}},handle_download_json_file=async()=>{await message_bus_MessageBus.handle(new DownloadJsonFile("flow.json",t.steps),a)};return{convertDateToDateTimeString:convertDateToDateTimeString,created_date_info:r,updated_date_info:n,action_username:_,is_action_username_chosen:l,non_attached_usernames:d,user_options:c,usernames:u,is_drag_above_json_file_zone:p,find_user_description:find_user_description,modify_step:modify_step,handle_add_user:handle_add_user,handle_attach_user_to_step:handle_attach_user_to_step,handle_delete_user_from_step:handle_delete_user_from_step,handle_drop_json_file:handle_drop_json_file,handle_save:handle_save,handle_download_json_file:handle_download_json_file}}};const wn=(0,qs.Z)(vn,[["render",ApprovalFlowvue_type_template_id_1248b4b2_scoped_true_render],["__scopeId","data-v-1248b4b2"]]);var yn=wn;const bn={key:0,class:"baseform-header"},Rn={class:"baseform-header__pagenum"},Fn={class:"baseform-header__name"},Dn={class:"baseform-body"};function BaseFormvue_type_template_id_636131d2_scoped_true_render(t,s,a,r,n,i){return(0,o.wg)(),(0,o.iD)("div",{class:"baseform",style:(0,l.j5)({width:r.form_width.toString()+"px"})},[a.is_header_required?((0,o.wg)(),(0,o.iD)("div",bn,[(0,o._)("div",Rn,(0,l.zw)(r.page_index+1)+".",1),(0,o._)("div",Fn,(0,l.zw)(r.page_name),1),r.page_index>0?((0,o.wg)(),(0,o.iD)("div",{key:0,class:"baseform-header__button baseform-header__button_left",title:"Предыдущая страница",onClick:s[0]||(s[0]=t=>r.page_index=Math.max(0,r.page_index-1))})):(0,o.kq)("",!0),r.page_index<r.page_count-1?((0,o.wg)(),(0,o.iD)("div",{key:1,class:"baseform-header__button baseform-header__button_right",title:"Следующая страница",onClick:s[1]||(s[1]=t=>r.page_index=Math.min(r.page_index+1,r.page_count-1))})):(0,o.kq)("",!0),(0,o._)("div",{class:"baseform-header__button baseform-header__button_close",title:"Закрыть",onClick:s[2]||(s[2]=s=>t.$emit("close"))})])):(0,o.kq)("",!0),(0,o._)("div",Dn,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.page_fields,((s,n)=>((0,o.wg)(),(0,o.j4)((0,o.LL)(s.type),{class:"baseform-body__field",key:r.page_index.toString()+"|"+s.type+"|"+n.toString(),parameters:s.parameters,context:r.make_field_context(s),value:s.value?s.value:a.attributes[s.bind],onUpdate:a=>{s.bind&&t.$emit("update",{name:s.bind,value:a})}},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(a.attributes),1)])),_:2},1064,["parameters","context","value","onUpdate"])))),128))])],4)}const xn=["srcdoc"];function FormHtmlFieldvue_type_template_id_be019dbe_render(t,s,a,r,n,i){return(0,o.wg)(),(0,o.iD)("div",{class:"formhtmlfield",style:(0,l.j5)({height:r.height.toString()+"px"})},[(0,o._)("iframe",{class:"formhtmlfield__iframe",srcdoc:a.value}," ",8,xn)],4)}var kn={name:"FormHtmlField",props:{parameters:{type:Object,required:!1,default:()=>({})},value:{required:!0}},setup(t){const s=(0,o.Fl)((()=>t.parameters["height"]||500));return{height:s}}};const qn=(0,qs.Z)(kn,[["render",FormHtmlFieldvue_type_template_id_be019dbe_render]]);var Sn=qn;const En={class:"form-multiline-text-input"},An=["disabled","rows"];function FormMultilineTextInputvue_type_template_id_67b6f645_scoped_true_render(t,s,a,n,i,_){return(0,o.wg)(),(0,o.iD)("div",En,[(0,o.wy)((0,o._)("textarea",{class:"multiline-text-input",style:(0,l.j5)({color:n.color,resize:n.resize}),disabled:n.is_disabled,rows:n.rows,"onUpdate:modelValue":s[0]||(s[0]=t=>n.text=t),onInput:s[1]||(s[1]=s=>t.$emit("update",s.target.value))},null,44,An),[[r.nr,n.text]])])}var Cn={name:"FormMultilineTextInput",props:{parameters:{type:Object,required:!1,default:()=>({})},value:{type:String,required:!1}},emits:["update"],setup(t,{emit:s}){const a=t.parameters["default"]||"";void 0!==t.value&&null!==t.value||s("update",a);const r=(0,o.Fl)((()=>t.parameters["rows"]||10)),n=(0,o.Fl)((()=>t.parameters["is_disabled"]||!1)),_=(0,o.Fl)((()=>t.parameters["color"]||"black")),l=(0,o.Fl)((()=>t.parameters["resize"]||"none")),d=(0,i.iH)("");return(0,o.YP)((()=>t.value),(t=>d.value=t)),{rows:r,is_disabled:n,color:_,resize:l,text:d}}};const Un=(0,qs.Z)(Cn,[["render",FormMultilineTextInputvue_type_template_id_67b6f645_scoped_true_render],["__scopeId","data-v-67b6f645"]]);var Pn=Un;const jn={class:"formemailaddressfield"};function FormEmailToAddressFieldvue_type_template_id_2e722576_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("form-text-field");return(0,o.wg)(),(0,o.iD)("div",jn,[r.to?((0,o.wg)(),(0,o.j4)(_,{key:0,class:"formemailaddressfield__label",parameters:{font_weight:"bold"},value:"Кому:"})):(0,o.kq)("",!0),r.to?((0,o.wg)(),(0,o.j4)(_,{key:1,class:"formemailaddressfield__address",value:r.convert(r.to)},null,8,["value"])):(0,o.kq)("",!0),r.cc?((0,o.wg)(),(0,o.j4)(_,{key:2,class:"formemailaddressfield__label",parameters:{font_weight:"bold"},value:"Копия:"})):(0,o.kq)("",!0),r.cc?((0,o.wg)(),(0,o.j4)(_,{key:3,class:"formemailaddressfield__address",value:r.convert(r.cc)},null,8,["value"])):(0,o.kq)("",!0),r.bcc?((0,o.wg)(),(0,o.j4)(_,{key:4,class:"formemailaddressfield__label",parameters:{font_weight:"bold"},value:"Скрытая копия:"})):(0,o.kq)("",!0),r.bcc?((0,o.wg)(),(0,o.j4)(_,{key:5,class:"formemailaddressfield__address",value:r.convert(r.bcc)},null,8,["value"])):(0,o.kq)("",!0)])}var Mn={name:"FormEmailToAddressField",components:{FormTextField:ra},props:{parameters:{type:Object,required:!1,default:()=>({})},value:{type:Object,required:!0}},setup(t){const s=(0,o.Fl)((()=>t.value||{TO:"",CC:"",BCC:""})),a=(0,o.Fl)((()=>s.value["TO"])),r=(0,o.Fl)((()=>s.value["CC"])),n=(0,o.Fl)((()=>s.value["BCC"])),convert=t=>t.split(" ").join("; ");return{to:a,cc:r,bcc:n,convert:convert}}};const Tn=(0,qs.Z)(Mn,[["render",FormEmailToAddressFieldvue_type_template_id_2e722576_scoped_true_render],["__scopeId","data-v-2e722576"]]);var Nn=Tn;const FormEmailToAddressInputvue_type_template_id_c2578df8_scoped_true_withScopeId=t=>((0,o.dD)("data-v-c2578df8"),t=t(),(0,o.Cn)(),t),In={class:"formemailaddressinput"},Bn={class:"formemailaddressinput__container"},On={class:"formemailaddressinput__header"},zn={class:"formemailaddressinput__rowcontainer"},Wn=["title","onClick"],Gn={class:"formemailaddressinput__description"},Zn={class:"formemailaddressinput__email"},Hn=FormEmailToAddressInputvue_type_template_id_c2578df8_scoped_true_withScopeId((()=>(0,o._)("div",{class:"formemailaddressinput__@"},"@",-1))),$n={class:"formemailaddressinput__domain"};function FormEmailToAddressInputvue_type_template_id_c2578df8_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("form-text-field"),d=(0,o.up)("form-text-input");return(0,o.wg)(),(0,o.iD)("div",In,[(0,o._)("div",Bn,[(0,o.Wm)(_,{class:"formemailaddressinput__label",parameters:{align:"center"},value:0==r.variant_idx?"Текущее письмо":"Адресаты из прошлых писем: "+r.variant_idx.toString()},null,8,["value"]),(0,o._)("div",On,[(0,o._)("div",{class:(0,l.C_)(["formemailaddressinput__button formemailaddressinput__button_left",{formemailaddressinput__button_inactive:r.variant_idx===r.variant_count-1}]),onClick:s[0]||(s[0]=t=>r.goto_next_letter()),title:"Предыдущее письмо"},null,2),(0,o._)("div",{class:(0,l.C_)(["formemailaddressinput__button formemailaddressinput__button_right",{formemailaddressinput__button_inactive:0===r.variant_idx}]),title:"Следующее письмо",onClick:s[1]||(s[1]=t=>r.goto_previous_letter())},null,2),(0,o.Wm)(d,{class:"formemailaddressinput__search",parameters:r.search_field_parameters,value:r.search_query,onUpdate:s[2]||(s[2]=t=>r.search_query=t)},null,8,["parameters","value"]),(0,o._)("div",{class:(0,l.C_)(["formemailaddressinput__button formemailaddressinput__button_add",{formemailaddressinput__button_inactive:!1===r.validate_email(r.search_query)||r.variant_idx>0}]),onClick:s[3]||(s[3]=t=>r.add_email(r.search_query)),title:"Добавить e-mail"},null,2),(0,o._)("div",{class:(0,l.C_)(["formemailaddressinput__button formemailaddressinput__button_approve",{formemailaddressinput__button_inactive:0===r.variant_idx||""!=r.search_query}]),onClick:s[4]||(s[4]=t=>r.use_the_letter_as_current()),title:"Использовать адресатов из данного письма"},null,2)]),(0,o._)("div",zn,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.sorted_current_variant,(t=>((0,o.wg)(),(0,o.iD)("div",{class:(0,l.C_)(["formemailaddressinput__row",{formemailaddressinput__row_to:1==t.designation,formemailaddressinput__row_cc:2==t.designation,formemailaddressinput__row_bcc:3==t.designation}]),key:t.full_email,title:r.get_row_title(t.designation),onClick:s=>r.change_designation(t.full_email)},[(0,o._)("div",Gn,(0,l.zw)(t.description),1),(0,o._)("div",Zn,(0,l.zw)(t.email),1),Hn,(0,o._)("div",$n,(0,l.zw)(t.domain),1)],10,Wn)))),128))])])])}var Ln={name:"FormEmailToAddressInput",components:{FormTextInput:Ns,FormTextField:ra},props:{parameters:{type:Object,required:!1,default:()=>({})},context:{type:Object,required:!1,default:()=>({})},value:{type:Object,required:!1}},emits:["update"],setup(t,{emit:s}){const a=t.parameters["default"]||{TO:"",CC:"",BCC:""};void 0!==t.value&&null!==t.value||s("update",a);const r=(0,o.Fl)((()=>t.context["ADDRESS"])),n=(0,o.Fl)((()=>t.context["KNOWN_EMAILS"])),address_decode_str=(t,s,a)=>{s&&s.split(" ").filter((t=>""!=t)).forEach((s=>t[s]=a))},address_decode=t=>{let s={};return address_decode_str(s,t["NA"],4),address_decode_str(s,t["BCC"],3),address_decode_str(s,t["CC"],2),address_decode_str(s,t["TO"],1),Object.entries(s).map((([t,s])=>({description:n.value&&n.value[t]||"",email:t.split("@")[0],domain:t.split("@")[1],full_email:t,designation:s})))},address_encode=t=>{let s={1:[],2:[],3:[],4:[]};return t.forEach((t=>s[t.designation].push(t.full_email))),{TO:s[1].join(" "),CC:s[2].join(" "),BCC:s[3].join(" ")}},_=(0,o.Fl)((()=>{let s=[];return t.value&&(s=s.concat(t.value["TO"],t.value["CC"],t.value["BCC"])),r.value&&r.value.forEach((t=>s=s.concat(t["TO"]||[]).concat(t["CC"]||[]).concat(t["BCC"]||[]))),n.value&&(s=s.concat(Object.keys(n.value))),{NA:s.filter((t=>""!=t)).join(" ")}})),l=(0,o.Fl)((()=>{let s=[address_decode(Object.assign({},t.value,_.value))];return r.value?(r.value.forEach((t=>s.push(address_decode(t)))),s):s})),d=(0,i.iH)(0),p=(0,o.Fl)((()=>l.value.length)),c=(0,o.Fl)((()=>l.value[d.value])),goto_previous_letter=()=>{d.value=Math.max(0,d.value-1)},goto_next_letter=()=>{d.value=Math.min(d.value+1,p.value-1)},use_the_letter_as_current=()=>{0!=d.value&&""==u.value&&(s("update",r.value[d.value-1]),d.value=0)},get_row_title=t=>{switch(t){case 1:return"Кому";case 2:return"Копия";case 3:return"Скрытая копия";default:return null}},validate_email=t=>/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t),add_email=t=>{if(!1===validate_email(t)||d.value>0)return;let a=structuredClone(c.value);a.push({description:"",designation:1,domain:"",email:"",full_email:t.toLowerCase()}),s("update",address_encode(a)),u.value=""},next_designation=t=>4==t?1:t+1,change_designation=t=>{if(d.value>0)return;let a=structuredClone(c.value);a.forEach((s=>{s.full_email===t&&(s.designation=next_designation(s.designation))})),s("update",address_encode(a))},u=(0,i.iH)(""),m={placeholder:"Введите email или имя пользователя..",height:30},g=(0,o.Fl)((()=>c.value.filter((t=>t.description.toLowerCase().includes(u.value.toLowerCase())||(t.email+"@"+t.domain).toLowerCase().includes(u.value.toLowerCase()))))),h=(0,o.Fl)((()=>{let t=structuredClone(g.value);return t.sort(((t,s)=>{let a=0;return 4!=t.designation&&4!=s.designation||(a=t.designation-s.designation),0!=a?a:(a=t.description.localeCompare(s.description),0!=a||(a=t.email.localeCompare(s.email)),a)})),t}));return{variants:l,variant_idx:d,variant_count:p,current_variant:c,sorted_current_variant:h,search_query:u,search_field_parameters:m,obj_with_all_NA_addresses:_,change_designation:change_designation,get_row_title:get_row_title,goto_previous_letter:goto_previous_letter,goto_next_letter:goto_next_letter,use_the_letter_as_current:use_the_letter_as_current,validate_email:validate_email,add_email:add_email}}};const Vn=(0,qs.Z)(Ln,[["render",FormEmailToAddressInputvue_type_template_id_c2578df8_scoped_true_render],["__scopeId","data-v-c2578df8"]]);var Jn=Vn;const Yn={class:"formhtmlinput"};function FormHtmlInputvue_type_template_id_74cfadbf_render(t,s,a,r,n,i){const _=(0,o.up)("ckeditor");return(0,o.wg)(),(0,o.iD)("div",Yn,[(0,o.Wm)(_,{id:"formhtmlinput-editor",class:"formhtmlinput__editor",style:(0,l.j5)({height:r.height}),modelValue:r.body_html,"onUpdate:modelValue":s[0]||(s[0]=t=>r.body_html=t),config:r.editor_config,onNamespaceloaded:r.onNamespaceLoaded},null,8,["style","modelValue","config","onNamespaceloaded"])])}var Kn={name:"FormHtmlInput",props:{parameters:{type:Object,required:!1,default:()=>({})},value:{type:String,required:!1}},setup(t,{emit:s}){const a=(0,o.Fl)((()=>t.parameters["height"]||500)),r=(0,o.Fl)((()=>t.parameters["default"]||"")),n=(0,i.iH)(t.value||r.value),_=a.value-30,l={fullPage:!0,allowedContent:!0,extraPlugins:["autogrow","colorbutton"],resize_enabled:!1,autoGrow_minHeight:_,autoGrow_maxHeight:_,toolbar:[{name:"clipboard",items:["Undo"]},{name:"basicstyles",items:["Bold","Italic","RemoveFormat"]},{name:"colorbutton",items:["BGColor","TextColor"]}],colorButton_colors:"000,800000,8B4513,2F4F4F,008080,000080,4B0082,696969,B22222,A52A2A,DAA520,006400,40E0D0,0000CD,800080,808080,F00,FF8C00,FFD700,008000,0FF,00F,EE82EE,A9A9A9,FFA07A,FFA500,FFFF00,00FF00,AFEEEE,ADD8E6,DDA0DD,D3D3D3,FFF0F5,FAEBD7,FFFFE0,F0FFF0,F0FFFF,F0F8FF,E6E6FA,FFF",removePlugins:"elementspath"},onNamespaceLoaded=t=>{t.plugins.addExternal("colorbutton","/colorbutton/")};return(0,o.YP)(n,(t=>s("update",t))),{height:a,body_html:n,editor_config:l,onNamespaceLoaded:onNamespaceLoaded}}};const Xn=(0,qs.Z)(Kn,[["render",FormHtmlInputvue_type_template_id_74cfadbf_render]]);var Qn=Xn;const ei={class:"formhiddeninput"};function FormHiddenInputvue_type_template_id_52d4f2ea_render(t,s,a,r,n,i){return(0,o.wg)(),(0,o.iD)("div",ei)}var ti={name:"FormHiddenInput",props:{parameters:{type:Object,required:!1,default:()=>({})},context:{type:Object,required:!1,default:()=>({})},value:{required:!1,default:""}},emits:["update"],setup(t,{emit:s}){const a=(0,o.Fl)((()=>t.parameters["pattern"]||"")),r=(0,o.Fl)((()=>{if(a.value||t.context["ATTRIBUTES"])try{return(0,Wt.W6)(a,t.context["ATTRIBUTES"],!1)}catch(s){console.log(`Error during evaluation of FormHiddenInput with pattern "${a.value}" and attributes "${t.context["ATTRIBUTES"]}"`)}return null}));r.value&&t.value!=r.value&&s("update",r.value),(0,o.YP)(r,(a=>{a&&t.value!=a&&s("update",a)}));const n=t.parameters["default"]||"";return t.value||r.value||s("update",n),{pattern:a,evaluated_value:r,default_value:n}}};const si=(0,qs.Z)(ti,[["render",FormHiddenInputvue_type_template_id_52d4f2ea_render]]);var ai=si,ri={name:"BaseForm",components:{FormTextField:ra,FormHtmlField:Sn,FormBooleanInput:ua,FormTextInput:Ns,FormMultilineTextInput:Pn,FormEmailToAddressField:Nn,FormEmailToAddressInput:Jn,FormDateInput:_a,FormHtmlInput:Qn,FormHiddenInput:ai,FormSelectInput:er,FormFilteredSelectInput:rr},props:{settings:{type:Object,required:!0},context:{type:Object,required:!1,default:()=>({})},attributes:{type:Object,required:!0},is_header_required:{type:Boolean,required:!1,default:!0}},emits:["close","update"],setup(t){const s=(0,i.iH)(0),a=(0,o.Fl)((()=>t.settings.length)),r=(0,o.Fl)((()=>t.settings[s.value])),n=(0,o.Fl)((()=>r.value["size"]||"w500")),_=(0,o.Fl)((()=>r.value["name"]||"")),l=(0,o.Fl)((()=>r.value["fields"]||[])),make_field_context=s=>{if(!s.bind_context)return{};let a={};return Object.keys(s.bind_context).forEach((r=>a[r]=t.context[s.bind_context[r]])),a};return{page_settings:r,page_index:s,page_count:a,page_name:_,form_width:n,page_fields:l,make_field_context:make_field_context}}};const oi=(0,qs.Z)(ri,[["render",BaseFormvue_type_template_id_636131d2_scoped_true_render],["__scopeId","data-v-636131d2"]]);var ni=oi,ii={components:{BtnComponent:Es,HeadingComponent:Us,TextButton:ya,ToggleTextButton:Ma,DocumentErrorsRow:qa,DocumentAttributeBlock:Bo,FileList:kr,FileBlock:Ia,FileDropZone:Ur,DocumentPageDownloadProgressRow:Ir,ApprovalRow:Ho,ApprovalFlow:yn,FormTextField:ra,FormSelectInput:er,FormFilteredSelectInput:rr,BaseForm:ni},name:"DocumentPage",setup(){const t=(0,_.yj)(),s=(0,_.tv)(),a=new VueUnitOfWork,r=t.fullPath,n=useValidateIntOr404(t.params.usergroup_id),l=useValidateIntOr404(t.params.folder_id),d=t.params.document_id,p=a.user_repository.get_current(),c=(0,o.Fl)((()=>a.user_repository.values().map((t=>t.value)).filter((t=>!0===t.is_active)))),u=(0,o.Fl)((()=>[{name:"Выберите пользователя",value:"NOT_CHOSEN"}].concat(c.value.map((t=>({name:(t.last_name+" "+t.first_name+" ("+t.username+")").trim(),value:t.username}))).sort(((t,s)=>t.name.localeCompare(s.name)))))),m=(0,i.iH)("NOT_CHOSEN"),g=(0,o.Fl)((()=>"NOT_CHOSEN"!==m.value)),h=a.folder_repository.get(l),f=(0,o.Fl)((()=>null===h.value?"":h.value.name)),v=(0,o.Fl)((()=>null===h.value?[]:h.value.search_schema)),w=(0,o.Fl)((()=>h.value.form_schema)),y=(0,o.Fl)((()=>w.value?w.value.pages.map((t=>({size:t.size,name:t.name,fields:t.fields[k.value?"edit_mode":"read_mode"]}))):{})),b=a.usergroup_repository.get(n),R=(0,o.Fl)((()=>null===b.value?"":b.value.name)),F=(0,o.Fl)((()=>{let t=a.usergroup_repository.values().filter((t=>t.value.id!=b.value.id&&(!t.value.is_private||t.value.has_username(p.value.username)))).map((t=>({id:t.value.id,name:t.value.name,value:t.value.id.toString()})));return t.sort(((t,s)=>t.name.localeCompare(s.name))),t})),D=(0,i.iH)(0);(0,o.YP)(F,(t=>{0===D.value&&t.length>0&&(D.value=t[0].id)}));const handle_copy_list_change_usergroup=()=>{message_bus_MessageBus.handle(new DuplicateDocumentToUsergroup(l,n,D.value,d),a),set_seconds_before_button_copy_to_usergroup_activated(10)},x=a.doc_repository.get(l,d),k=(0,i.iH)(!1);(0,o.YP)(x,(t=>{t&&!0!==t.is_blocked||(k.value=!1)}));const handle_update_doc_attribute=(t,s,r)=>{message_bus_MessageBus.handle(new SetDocumentAttribute(l,n,t,s,r),a)},handle_save_document=async()=>{await message_bus_MessageBus.handle(new SaveDocumentsInFolder(l,n),a),await useValidateDocument(a,l,n,d)},handle_download_file=async(t,s)=>{const r=new DownloadFileFromFolder(l,n,t.id,t.name,t.size,s);await message_bus_MessageBus.handle(r,a)},handle_rename_file=async(t,s)=>{const r=new UpdateFileFromFolder(l,n,t,s);await message_bus_MessageBus.handle(r,a),delete q.value[t],await useValidateDocument(a,l,n,d)},q=(0,i.iH)({}),S=(0,o.Fl)((()=>0==Object.keys(q.value).length)),handle_rename_file_activated=t=>{q.value[t]=!0},handle_copy_link_to_document_into_clipboard=()=>{navigator.clipboard.writeText(window.location.href).then((()=>message_bus_MessageBus.handle(new DocumentLinkCopied,a)))},handle_copy_link_to_document_file_into_clipboard=t=>{const r=s.resolve({name:"DownloadFileFromFolderPage",params:{folder_id:l,usergroup_id:n,file_id:t.id}});navigator.clipboard.writeText(window.location.origin+r.href).then((()=>message_bus_MessageBus.handle(new FileLinkCopied,a)))},generate_doc_link=t=>({name:"DocumentPage",params:{folder_id:l,usergroup_id:D.value,document_id:t}}),E=(0,i.iH)(!1),A=(0,i.iH)(!1),C=64,U=(0,o.Fl)((()=>a.file_in_folder_repository.values(l).map((t=>t.value)).filter((t=>!t.uploaded)))),P=(0,o.Fl)((()=>a.download_progress.values().map((t=>t.value)))),handle_document_approval_file_drop=async t=>{let s=null;s=0===t.size?new UploadEmptyFileError(t.name):t.size>1024*C*1024?new UploadFileTooBigError(t.name):new UploadDocumentApprovalFile(l,n,d,(0,Gt.Z)(),t),await message_bus_MessageBus.handle(s,a)},handle_document_approval_filename_wrong=async t=>await message_bus_MessageBus.handle(new UploadFileWrongFilenameError(t),a),handle_delete_document_approval_file=async t=>{await message_bus_MessageBus.handle(new DeleteDocumentApprovalFile(l,n,d,t),a)},j=(0,o.Fl)((()=>a.doc_approval_file_repository.values().map((t=>t.value)))),handle_download_all_files=async()=>{await message_bus_MessageBus.handle(new DownloadDocumentFilesAsArchive(l,n,d,x.value.files.map((t=>t.size)).reduce(((t,s)=>t+s),0)),a)},M=(0,o.Fl)((()=>null===h.value?0:h.value.max_file_size)),handle_document_file_drop=async t=>{if(!x.is_blocked){if(0===t.size)return void message_bus_MessageBus.handle(new UploadEmptyFileError(t.name),a);if(t.size>1024*M.value*1024)return void message_bus_MessageBus.handle(new UploadFileTooBigError(t.name),a);const s=(0,Gt.Z)(),r=new UploadFileToFolder(l,n,s,t);await message_bus_MessageBus.handle(r,a),await message_bus_MessageBus.handle(new AttachFileToDocument(l,n,d,s),a)}},detach_file_from_document=(t,s)=>{t.is_blocked||message_bus_MessageBus.handle(new DetachFileFromDocument(l,n,t.id,s),a)},T=(0,i.iH)(""),N=(0,o.Fl)((()=>{let t=a.doc_approval_repository.values(x.value.id).map((t=>t.value));return t.sort(((t,s)=>s.updated_at-t.updated_at)),t})),I=(0,o.Fl)((()=>N.value.filter((t=>t.updated_at<=x.value.updated_at)).sort(((t,s)=>s.updated_at-t.updated_at)))),B=(0,o.Fl)((()=>N.value.filter((t=>t.updated_at>x.value.updated_at)).sort(((t,s)=>s.updated_at-t.updated_at)))),O=(0,o.Fl)((()=>N.value.filter((t=>"NONE"===t.state&&(p.value.username===t.from_username||p.value.username===t.to_username))).map((t=>t.id)))),z=(0,o.Fl)((()=>{const t=N.value.filter((t=>"NONE"===t.state&&t.to_username===p.value.username)).map((t=>t.id));return 0===t.length?null:t})),handle_paste=t=>{t.stopPropagation(),t.preventDefault();const s=t.clipboardData||window.clipboardData;insert_text_in_editable(s.getData("Text"))},insert_text_in_editable=t=>{if(window.getSelection){const s=window.getSelection();if(s.getRangeAt&&s.rangeCount){const a=s.getRangeAt(0);a.deleteContents(),a.insertNode(document.createTextNode(t))}}else document.selection&&document.selection.createRange&&(document.selection.createRange().text=t);const s=document.getElementById("approvaldropblock__textzone");T.value=s.textContent},handle_add_document_approval=async()=>{await message_bus_MessageBus.handle(new AddDocumentApproval(l,n,d,m.value),a),await useGetDocument(a,l,n,d),await useValidateDocument(a,l,n,d)},handle_delete_document_approval=async t=>{await message_bus_MessageBus.handle(new DeleteDocumentApproval(l,n,d,t),a),await useGetDocument(a,l,n,d),await useValidateDocument(a,l,n,d),await useGetDocumentApprovalsWithSpareFiles(a,l,n,d)},handle_delegate_document_approval=async t=>{await message_bus_MessageBus.handle(new DelegateDocumentApproval(l,n,d,z.value[0],m.value,t),a),await useGetDocument(a,l,n,d),await useValidateDocument(a,l,n,d),await useGetDocumentApprovalsWithSpareFiles(a,l,n,d)},handle_approve_document=()=>handle_update_document_approval("APPROVED"),handle_reject_document=()=>handle_update_document_approval("REJECTED"),handle_update_document_approval=async t=>{z.value.forEach((async s=>await message_bus_MessageBus.handle(new UpdateDocumentApproval(l,n,x.value.id,s,t,T.value),a))),await useGetDocument(a,l,n,d),await useValidateDocument(a,l,n,d),await Promise.all([await useGetDocumentApprovalsWithSpareFiles(a,l,n,d),await useGetDocumentApprovalFlow(a,l,n,d)])},W=(0,o.Fl)((()=>null===h.value?{}:h.value.approval_rules)),G=(0,o.Fl)((()=>null===W.value?{}:W.value.filename)),Z=(0,o.Fl)((()=>{if(!G.value)return;const t=G.value.case_insensitive?"i":"";return new RegExp(G.value.pattern,t)})),H=(0,o.Fl)((()=>null===W.value?null:W.value.can_approve)),$=(0,o.Fl)((()=>null===W.value?null:W.value.can_reject)),L=(0,o.Fl)((()=>null===W.value?null:W.value.can_delegate_with_return)),V=(0,o.Fl)((()=>null===W.value?null:W.value.can_delegate_without_return)),is_user_included_rights_list=t=>!Array.isArray(t)||t.includes(p.value.username),J=(0,o.Fl)((()=>is_user_included_rights_list(H.value))),Y=(0,o.Fl)((()=>is_user_included_rights_list($.value))),K=(0,o.Fl)((()=>is_user_included_rights_list(L.value))),X=(0,o.Fl)((()=>is_user_included_rights_list(V.value))),Q=a.doc_approval_flow_repository.get(d),ee=(0,o.Fl)((()=>generate_states_obj_from_approvals(B.value))),handle_create_approval_flow=()=>{message_bus_MessageBus.handle(new CreateDocumentApprovalFlow(d),a)},handle_add_approval_flow_step=()=>{message_bus_MessageBus.handle(new AddDocumentApprovalFlowStep(d),a)},handle_delete_approval_flow_step=t=>{message_bus_MessageBus.handle(new DeleteDocumentApprovalFlowStep(d,t),a)},handle_attach_user_to_approval_flow_step=(t,s)=>{message_bus_MessageBus.handle(new AttachUserToDocumentApprovalFlowStep(d,t,s),a)},handle_delete_user_from_approval_flow_step=(t,s)=>{message_bus_MessageBus.handle(new DeleteUserFromDocumentApprovalFlowStep(d,t,s),a)},handle_save_approval_flow=()=>{message_bus_MessageBus.handle(new SetDocumentApprovalFlow(l,n,d),a)},handle_start_approval_flow=async()=>{await message_bus_MessageBus.handle(new StartDocumentApprovalFlow(l,n,d),a),await useGetDocumentApprovalsWithSpareFiles(a,l,n,d),await useGetDocumentApprovalFlow(a,l,n,d),await useGetDocument(a,l,n,d),await useValidateDocument(a,l,n,d)},handle_stop_approval_flow=async()=>{await message_bus_MessageBus.handle(new StopDocumentApprovalFlow(l,n,d),a),await useGetDocumentApprovalsWithSpareFiles(a,l,n,d)},te=(0,Gt.Z)(),se=(0,i.iH)(!1),ae=(0,o.Fl)((()=>{if(!w.value||!w.value["context"])return{};let t={};return w.value["context"].forEach((s=>{const r=a.context_repository.get(te,s.name);t[s.name]=r.value})),t})),calculate_strict_permission=t=>a.permission_repository.has_for_folder(l,t)&&!(a.folder_repository.get_strict_validation(l,t)&&a.doc_repository.has_errors(l,d)),re=a.permission_repository.has_for_folder(l,"can_change_document"),oe=a.permission_repository.has_for_folder(l,"can_view_file"),ne=(0,o.Fl)((()=>calculate_strict_permission("can_view_documentapproval"))),ie=(0,o.Fl)((()=>calculate_strict_permission("can_add_documentapproval"))),_e=(0,o.Fl)((()=>calculate_strict_permission("can_change_documentapproval"))),le=(0,o.Fl)((()=>calculate_strict_permission("can_delete_documentapproval"))),de=(0,o.Fl)((()=>calculate_strict_permission("can_delegate_documentapproval"))),pe=(0,o.Fl)((()=>calculate_strict_permission("can_view_documentapprovalflow"))),ce=(0,o.Fl)((()=>calculate_strict_permission("can_change_documentapprovalflow")));(0,o.bv)((async()=>{await useBeforeEnterPage(a,["can_get_folders","can_view_document"],l,n),await Promise.all([useGetFolders(a),useGetUserGroups(a)]),h.value&&(await Promise.all([useGetUserSearchSchema(a,l,n),useGetDocument(a,l,n,d)]),h.value.is_necessary_validate=!0,await useValidateDocument(a,l,n,d),await useGetDocumentApprovalsWithSpareFiles(a,l,n,d),await useGetUsers(a),await useGetDocumentApprovalFlow(a,l,n,d),w.value&&w.value.context&&await useGetContext(a,te,w.value.context,l,n,d))}));const update_upload_progress=()=>{message_bus_MessageBus.handle(new UpdateUploadProgress,a)};a.upload_progress_timer.set_callback(update_upload_progress),(0,o.Jd)((async()=>a.upload_progress_timer.stop()));const ue=(0,o.Fl)((()=>null===h.value?[]:h.value.action_buttons.filter((t=>is_action_button_shown(t))))),me=(0,o.Fl)((()=>B.value.filter((t=>"APPROVED"==t.state)).map((t=>t.to_username)))),is_action_button_shown=t=>!t.allowed_usernames||t.allowed_usernames.includes(p.value.username),is_action_button_disabled=t=>{let s=!1;return t.required_approvals?(t.required_approvals.all&&(s=t.required_approvals.all.filter((t=>!me.value.includes(t))).length>0),t.required_approvals.anyOf&&(s=s||t.required_approvals.anyOf.filter((t=>!me.value.includes(t))).length==t.required_approvals.anyOf.length),s):s},handle_push_document_button=async t=>{await message_bus_MessageBus.handle(new PushDocumentButton(l,n,d,t),a),set_seconds_before_button_activated(t,10)},ge="__COPY_TO_USERGROUP__",get_text_of_action_button=(t,s)=>0===get_seconds_before_button_activated(s)?t:t+" (через "+get_seconds_before_button_activated(s).toString()+" сек.)",get_seconds_before_button_activated=t=>a.wait_seconds_timer.get(t),set_seconds_before_button_activated=(t,s)=>a.wait_seconds_timer.set(t,s),get_seconds_before_button_copy_to_usergroup_activated=()=>a.wait_seconds_timer.get(ge),set_seconds_before_button_copy_to_usergroup_activated=t=>a.wait_seconds_timer.set(ge,t);return{route_full_path:r,router:s,convertDateToDateTimeString:convertDateToDateTimeString,users:c,user_options:u,approval_action_username:m,is_approval_action_username_chosen:g,can_change_doc:re,can_view_file:oe,can_view_approval:ne,can_add_approval:ie,can_change_approval:_e,can_delete_approval:le,can_delegate_approval:de,folder_id:l,usergroup_id:n,document_id:d,folder:h,folder_name:f,search_schema:v,usergroup_name:R,copy_list_usergroups:F,copy_list_usergroup_id:D,handle_copy_list_change_usergroup:handle_copy_list_change_usergroup,doc:x,is_edit_mode:k,handle_update_doc_attribute:handle_update_doc_attribute,handle_save_document:handle_save_document,handle_copy_link_to_document_into_clipboard:handle_copy_link_to_document_into_clipboard,generate_doc_link:generate_doc_link,handle_push_document_button:handle_push_document_button,text_comments:T,approvals:N,approvals_before_last_update:I,approvals_after_last_update:B,approval_ids_can_be_deleted:O,approvals_to_be_closed_ids:z,handle_paste:handle_paste,insert_text_in_editable:insert_text_in_editable,handle_add_document_approval:handle_add_document_approval,handle_delete_document_approval:handle_delete_document_approval,handle_update_document_approval:handle_update_document_approval,handle_delegate_document_approval:handle_delegate_document_approval,handle_approve_document:handle_approve_document,handle_reject_document:handle_reject_document,approval_filename_pattern:Z,has_right_to_approve:J,has_right_to_reject:Y,has_right_to_delegate_with_return:K,has_right_to_delegate_without_return:X,can_view_approvalflow:pe,can_change_approvalflow:ce,approval_flow:Q,approval_flow_states:ee,handle_create_approval_flow:handle_create_approval_flow,handle_add_approval_flow_step:handle_add_approval_flow_step,handle_delete_approval_flow_step:handle_delete_approval_flow_step,handle_attach_user_to_approval_flow_step:handle_attach_user_to_approval_flow_step,handle_delete_user_from_approval_flow_step:handle_delete_user_from_approval_flow_step,handle_save_approval_flow:handle_save_approval_flow,handle_start_approval_flow:handle_start_approval_flow,handle_stop_approval_flow:handle_stop_approval_flow,is_drag_above_doc_file_zone:E,is_drag_above_approval_file_zone:A,are_files_saved:S,approval_max_file_size:C,doc_max_file_size:M,downloading_files:P,uploading_files:U,document_approval_files:j,handle_download_file:handle_download_file,handle_rename_file:handle_rename_file,handle_rename_file_activated:handle_rename_file_activated,handle_copy_link_to_document_file_into_clipboard:handle_copy_link_to_document_file_into_clipboard,handle_document_approval_file_drop:handle_document_approval_file_drop,handle_document_approval_filename_wrong:handle_document_approval_filename_wrong,handle_delete_document_approval_file:handle_delete_document_approval_file,handle_download_all_files:handle_download_all_files,handle_document_file_drop:handle_document_file_drop,detach_file_from_document:detach_file_from_document,is_form_opened:se,form_uid:te,form_schema:w,form_pages:y,form_context:ae,action_buttons:ue,is_action_button_shown:is_action_button_shown,is_action_button_disabled:is_action_button_disabled,APPROVED_after_last_update_usernames:me,get_seconds_before_button_activated:get_seconds_before_button_activated,set_seconds_before_button_activated:set_seconds_before_button_activated,get_seconds_before_button_copy_to_usergroup_activated:get_seconds_before_button_copy_to_usergroup_activated,set_seconds_before_button_copy_to_usergroup_activated:set_seconds_before_button_copy_to_usergroup_activated,get_text_of_action_button:get_text_of_action_button,COPY_TO_USERGROUP_ACTION:ge}}};const _i=(0,qs.Z)(ii,[["render",DocumentPagevue_type_template_id_87ace392_scoped_true_render],["__scopeId","data-v-87ace392"]]);var li=_i;const di={class:"page"},pi={class:"page__container"};function FoldersPagevue_type_template_id_80e01fc0_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),l=(0,o.up)("form-text-input"),d=(0,o.up)("toggle-text-button"),p=(0,o.up)("folder-tree-node");return(0,o.wg)(),(0,o.iD)("div",di,[(0,o.Wm)(_,{class:"page__heading",text:"Выборки по типам документов",size:"middle"}),(0,o.Wm)(l,{class:"page__search",value:r.query,parameters:{placeholder:"Поиск..."},onUpdate:s[0]||(s[0]=t=>r.query=t)},null,8,["value","parameters"]),(0,o.Wm)(d,{class:"page__expandbutton",activeTitle:"Вернуться в обычный режим",passiveTitle:"Развернуть все",isActive:r.is_all_expanded,onClick:s[1]||(s[1]=t=>r.is_all_expanded=!r.is_all_expanded)},null,8,["isActive"]),(0,o._)("div",pi,[(0,o.Wm)(p,{tree:r.folders,usergroup_id:r.usergroup_id,expand_all:r.is_all_expanded},null,8,["tree","usergroup_id","expand_all"])])])}const ci={class:"foldertreenode"},ui={class:"foldertreenode__list"},mi={key:2,class:"foldertreenode__label"};function FolderTreeNodevue_type_template_id_2c04dcae_render(t,s,a,r,n,i){const _=(0,o.up)("icon-button"),d=(0,o.up)("router-link"),p=(0,o.up)("folder-tree-node",!0);return(0,o.wg)(),(0,o.iD)("ul",ci,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.keysWithoutTarget,(t=>((0,o.wg)(),(0,o.iD)("li",{key:t,class:"foldertreenode__element"},[(0,o._)("div",ui,[r.hasNonTargetKeys(a.tree[t])?((0,o.wg)(),(0,o.j4)(_,{key:0,class:"foldertreenode__listicon",icon_on:"➤",icon_off:"▼",is_active:!r.is_opened[t]&&!a.expand_all,onClick:s=>r.is_opened[t]=!r.is_opened[t]},null,8,["is_active","onClick"])):(0,o.kq)("",!0),r.hasTargetKey(a.tree[t])?((0,o.wg)(),(0,o.j4)(d,{key:1,class:"foldertreenode__label",to:{name:"SearchDocumentPage",params:{folder_id:a.tree[t]["_target"].id,usergroup_id:a.usergroup_id}}},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(t),1)])),_:2},1032,["to"])):((0,o.wg)(),(0,o.iD)("span",mi,(0,l.zw)(t),1))]),r.hasNonTargetKeys(a.tree[t])&&"_target"!==t&&(r.is_opened[t]||a.expand_all)?((0,o.wg)(),(0,o.j4)(p,{key:0,tree:a.tree[t],usergroup_id:a.usergroup_id,expand_all:a.expand_all},null,8,["tree","usergroup_id","expand_all"])):(0,o.kq)("",!0)])))),128))])}var gi={components:{IconButton:lr},name:"FolderTreeNode",props:{tree:{type:Object,required:!0},usergroup_id:{type:Number,required:!0},expand_all:{type:Boolean,required:!0}},setup(t){const s=(0,o.Fl)((()=>{let s=Object.keys(t.tree).filter((t=>"_target"!==t));return s.sort(),s})),a=(0,i.qj)({}),hasTargetKey=t=>Object.prototype.hasOwnProperty.call(t,"_target"),hasNonTargetKeys=t=>Object.keys(t).filter((t=>"_target"!==t)).length>0;return{keysWithoutTarget:s,hasNonTargetKeys:hasNonTargetKeys,hasTargetKey:hasTargetKey,is_opened:a}}};const hi=(0,qs.Z)(gi,[["render",FolderTreeNodevue_type_template_id_2c04dcae_render]]);var fi=hi,vi={components:{HeadingComponent:Us,FolderTreeNode:fi,FormTextInput:Ns,ToggleTextButton:Ma},name:"FoldersPage",setup(){const t=new VueUnitOfWork,s=(0,o.Fl)((()=>{const s=t.usergroup_repository.get_current();return null===s.value?0:s.value.id})),a=(0,o.Fl)((()=>{let s=t.folder_repository.values().map((t=>t.value)).filter((t=>t.name.toLowerCase().includes(r.value.toLowerCase())));s.sort(((t,s)=>t.name-s.name));const insert_into=(t,s,a)=>{Array.prototype.forEach.call(s,(s=>{Object.prototype.hasOwnProperty.call(t,s)||(t[s]={}),t=t[s]})),t["_target"]=a};let a={};return s.forEach((t=>{insert_into(a,t.name.split("|").map((t=>t.trim())),t)})),a})),r=(0,i.iH)(""),n=(0,i.iH)(!1),_=t.user_repository.get_current();return(0,o.bv)((async()=>{await useBeforeEnterPage(t,["can_get_folders"]),await Promise.all([useGetFolders(t),useGetUserGroups(t)])})),{usergroup_id:s,folders:a,query:r,user:_,is_all_expanded:n}}};const wi=(0,qs.Z)(vi,[["render",FoldersPagevue_type_template_id_80e01fc0_scoped_true_render],["__scopeId","data-v-80e01fc0"]]);var yi=wi;const bi={class:"page"},Ri={class:"page__header"},Fi={class:"page__container"},Di={class:"page__searchcontainer"},xi={class:"page__searchblock"},ki=["onClick"],qi={key:0,class:"page__actioncontainer actioncontainer"},Si={key:1,class:"page__actioncontainer actioncontainer"},Ei={class:"actioncontainer__row"},Ai={class:"actioncontainer__row"},Ci={class:"actioncontainer__cell actioncontainer__cell_left"},Ui={class:"actioncontainer__cell"},Pi={class:"actioncontainer__row"},ji={class:"actioncontainer__row"},Mi={class:"actioncontainer__cell actioncontainer__cell_left"},Ti={class:"actioncontainer__cell"},Ni={class:"actioncontainer__row"},Ii={class:"actioncontainer__approvalflowcontainer approvalflowcontainer"},Bi={class:"actioncontainer__row"};function CartPagevue_type_template_id_0a15f685_scoped_true_render(t,s,a,n,i,_){const d=(0,o.up)("heading-component"),p=(0,o.up)("form-boolean-input"),c=(0,o.up)("form-text-input"),u=(0,o.up)("form-text-field"),m=(0,o.up)("router-link"),g=(0,o.up)("text-button"),h=(0,o.up)("form-select-input"),f=(0,o.up)("form-filtered-select-input"),v=(0,o.up)("approval-flow");return(0,o.wg)(),(0,o.iD)("div",bi,[(0,o._)("div",Ri,[(0,o.Wm)(d,{text:"Корзина "+(n.action_progress<100?"(выполнение действий "+n.action_progress.toString()+"%)":""),size:"middle"},null,8,["text"])]),(0,o.wy)((0,o._)("div",Fi,[(0,o._)("div",Di,[(0,o._)("div",xi,[(0,o.Wm)(p,{class:"page__checkboxbutton",parameters:{size:30},value:n.is_all_selected,onClick:s[0]||(s[0]=t=>n.handle_select_all_items())},null,8,["value"]),(0,o.Wm)(c,{class:"page__searchtype",value:n.query.type,parameters:{height:30,placeholder:"Тип"},onUpdate:s[1]||(s[1]=t=>n.query.type=t)},null,8,["value"]),(0,o.Wm)(c,{class:"page__searchdescription",value:n.query.description,parameters:{height:30,placeholder:"Описание"},onUpdate:s[2]||(s[2]=t=>n.query.description=t)},null,8,["value"])]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.filtered_items,(t=>((0,o.wg)(),(0,o.iD)("div",{class:"page__listrow listrow",key:t},[(0,o._)("div",{class:"listrow__delete",title:"Удалить строку",onClick:s=>t.remove_from_cart()},null,8,ki),(0,o._)("div",{class:(0,l.C_)(["listrow__lockicon",{listrow__lockicon_closed:!0===t.is_blocked}])},null,2),(0,o.Wm)(p,{class:"listrow__checkbox",value:t.id in n.selected_item_ids,parameters:{size:30},onClick:s=>n.handle_select_item(t.id)},null,8,["value","onClick"]),(0,o.Wm)(u,{class:"listrow__type",parameters:{align:"center"},value:t.type},null,8,["value"]),(0,o.Wm)(m,{class:"listrow__href",to:t.route_obj},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{class:"listrow__description",value:t.description},null,8,["value"])])),_:2},1032,["to"])])))),128))]),0==n.count_of_selected_items?((0,o.wg)(),(0,o.iD)("div",qi,[(0,o.Wm)(u,{class:"actioncontainer__header",value:"Произведите выбор объектов и здесь появятся возможные действия",parameters:{align:"left"}})])):(0,o.kq)("",!0),n.count_of_selected_items>0?((0,o.wg)(),(0,o.iD)("div",Si,[(0,o.Wm)(u,{class:"actioncontainer__header",value:"Действия над незаблокированными объектами:",parameters:{align:"left"}}),(0,o._)("div",Ei,[(0,o.Wm)(u,{class:"container__header",value:"Действия над документами:",parameters:{align:"left"}})]),(0,o._)("div",Ai,[(0,o._)("div",Ci,[(0,o.Wm)(g,{disabled:n.seconds_before_document_copy_is_allowed>0,title:0==n.seconds_before_document_copy_is_allowed?"Копировать в группу":"Копировать в группу (через "+n.seconds_before_document_copy_is_allowed.toString()+" сек.)",onClick:s[3]||(s[3]=t=>n.handle_copy_documents_to_usergroup())},null,8,["disabled","title"])]),(0,o._)("div",Ui,[(0,o.Wm)(h,{class:"copycontainer__usergroupselect",value:n.copy_list_usergroup_id.toString(),parameters:{options:n.copy_list_usergroups},onUpdate:s[4]||(s[4]=t=>n.copy_list_usergroup_id=parseInt(t))},null,8,["value","parameters"])])]),(0,o._)("div",Pi,[(0,o.Wm)(u,{class:"container__header",value:"Согласования:",parameters:{align:"left"}})]),(0,o._)("div",ji,[(0,o._)("div",Mi,[(0,o.Wm)(g,{title:"Запросить согласование",disabled:!1===n.is_approval_action_username_chosen,onClick:s[5]||(s[5]=t=>n.perform_action_on_selected_items("add_approval"))},null,8,["disabled"])]),(0,o._)("div",Ti,[(0,o.Wm)(f,{class:"approvalorderblock__input",parameters:{options:n.user_options,placeholder:"Поиск...",size:3},value:n.approval_action_username,onUpdate:s[6]||(s[6]=t=>n.approval_action_username=t)},null,8,["parameters","value"])])]),(0,o._)("div",Ni,[(0,o._)("div",Ii,[n.approval_flow?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(g,{key:0,class:"approvalflowcontainer__createbutton",title:"Создать поток согласований",onClick:s[7]||(s[7]=t=>n.handle_create_approval_flow())})),n.approval_flow?((0,o.wg)(),(0,o.j4)(v,{key:1,class:"approvalflowcontainer__flow",is_active:n.approval_flow.is_active,is_saved:n.approval_flow.is_saved,success:n.approval_flow.success,created_at:n.approval_flow.created_at,updated_at:n.approval_flow.updated_at,steps:n.approval_flow.steps,states:{},users:n.users,can_be_modified:!0,"onAdd:step":s[8]||(s[8]=t=>n.handle_add_approval_flow_step()),"onDelete:step":s[9]||(s[9]=t=>n.handle_delete_approval_flow_step(t)),"onAttach:user":s[10]||(s[10]=t=>n.handle_attach_user_to_approval_flow_step(...t)),"onDelete:user":s[11]||(s[11]=t=>n.handle_delete_user_from_approval_flow_step(...t)),onSave:s[12]||(s[12]=t=>n.handle_save_approval_flow()),onStart:s[13]||(s[13]=t=>n.handle_start_approval_flow())},null,8,["is_active","is_saved","success","created_at","updated_at","steps","users"])):(0,o.kq)("",!0)])]),(0,o._)("div",Bi,[(0,o.Wm)(g,{title:"Остановить поток согласований",onClick:s[14]||(s[14]=t=>n.handle_stop_approval_flow())})])])):(0,o.kq)("",!0)],512),[[r.F8,100===n.action_progress]])])}var Oi={components:{HeadingComponent:Us,TextButton:ya,ApprovalFlow:yn,FormTextField:ra,FormTextInput:Ns,FormBooleanInput:ua,FormSelectInput:er,FormFilteredSelectInput:rr},name:"CartPage",setup(){const t=new VueUnitOfWork,s=t.user_repository.get_current(),a=(0,o.Fl)((()=>{let a=t.usergroup_repository.values().filter((t=>!t.value.is_private||t.value.has_username(s.value.username))).map((t=>({id:t.value.id,name:t.value.name,value:t.value.id.toString()})));return a.sort(((t,s)=>t.name.localeCompare(s.name))),a})),r=(0,i.iH)(0);(0,o.YP)(a,(t=>{0===r.value&&t.length>0&&(r.value=t[0].id)}));const n=(0,i.iH)(0),decrease_seconds_before_document_copy=()=>{n.value>0&&n.value--};setInterval(decrease_seconds_before_document_copy,1e3);const generate_doc_route_obj=t=>({name:"DocumentPage",params:{folder_id:t.folder_id,usergroup_id:t.usergroup_id,document_id:t.id}}),convert_doc_to_item=s=>({type:"Документ",id:s.id,folder_id:s.folder_id,usergroup_id:s.usergroup_id,is_blocked:s.is_blocked,description:""==s.raw_description?"Нет описания. Пересохраните документ.":s.raw_description,route_obj:generate_doc_route_obj(s),remove_from_cart:async()=>{await message_bus_MessageBus.handle(new RemoveDocumentFromCart(s.folder_id,s.usergroup_id,s.id),t)},actions:{add_approval:async()=>{await message_bus_MessageBus.handle(new AddDocumentApproval(s.folder_id,s.usergroup_id,s.id,y.value),t)},create_approval_flow:async()=>{await message_bus_MessageBus.handle(new CreateDocumentApprovalFlow(s.id),t)},add_approval_flow_step:async()=>{await message_bus_MessageBus.handle(new AddDocumentApprovalFlowStep(s.id),t)},delete_approval_flow_step:async()=>{await message_bus_MessageBus.handle(new DeleteDocumentApprovalFlowStep(s.id,x.value),t)},attach_user_to_approval_flow_step:async()=>{await message_bus_MessageBus.handle(new AttachUserToDocumentApprovalFlowStep(s.id,x.value,k.value),t)},delete_user_from_approval_flow_step:async()=>{await message_bus_MessageBus.handle(new DeleteUserFromDocumentApprovalFlowStep(s.id,x.value,k.value),t)},save_approval_flow:async()=>{await message_bus_MessageBus.handle(new SetDocumentApprovalFlow(s.folder_id,s.usergroup_id,s.id),t)},start_approval_flow:async()=>{await message_bus_MessageBus.handle(new StartDocumentApprovalFlow(s.folder_id,s.usergroup_id,s.id),t)},stop_approval_flow:async()=>{await message_bus_MessageBus.handle(new StopDocumentApprovalFlow(s.folder_id,s.usergroup_id,s.id),t)}}}),_=(0,o.Fl)((()=>t.cart_repository.doc_values().map((t=>convert_doc_to_item(t.value))))),l=(0,i.qj)({type:"",description:""}),filter_objs=(t,s)=>filterArrayOfObjects(t,s,!1).sort(((t,s)=>t.description.localeCompare(s.description))),d=(0,o.Fl)((()=>filter_objs(_.value,l))),{selected_item_ids:p,selected_items:c,is_all_selected:u,count_of_selected_items:m,handle_select_all_items:g,handle_select_item:h,reset_selection:f}=useSelectionMixin(_,d),v=(0,o.Fl)((()=>t.user_repository.values().map((t=>t.value)))),w=(0,o.Fl)((()=>[{name:"Выберите пользователя",value:"NOT_CHOSEN"}].concat(v.value.filter((t=>!0===t.is_active)).map((t=>({name:(t.last_name+" "+t.first_name+" ("+t.username+")").trim(),value:t.username}))).sort(((t,s)=>t.name.localeCompare(s.name)))))),y=(0,i.iH)("NOT_CHOSEN"),b=(0,o.Fl)((()=>"NOT_CHOSEN"!==y.value)),{action_progress:R,perform_action_on_items:F}=usePerformActionMixin(c,30),handle_copy_documents_to_usergroup=async()=>{n.value=10;let s={};c.value.forEach((t=>{const a=t.folder_id.toString()+" "+t.usergroup_id.toString();a in s?s[a].push(t.id):s[a]=[t.id]}));let a=[];Object.keys(s).forEach((o=>{const n=o.split(" "),i=parseInt(n[0]),_=parseInt(n[1]);a.push(message_bus_MessageBus.handle(new DuplicateManyDocumentsToUsergroup(i,_,r.value,s[o]),t))})),await Promise.all(a)},D=(0,i.iH)(null),x=(0,i.iH)(null),k=(0,i.iH)(null),handle_create_approval_flow=()=>{D.value=new Wt.GX(null,!1,!1,[[]],new Date,new Date),F("create_approval_flow")},handle_add_approval_flow_step=()=>{D.value.add_step(),F("add_approval_flow_step")},handle_delete_approval_flow_step=t=>{D.value.delete_step(t),x.value=t,F("delete_approval_flow_step")},handle_attach_user_to_approval_flow_step=(t,s)=>{D.value.add_username_to_step(t,s),x.value=t,k.value=s,F("attach_user_to_approval_flow_step")},handle_delete_user_from_approval_flow_step=(t,s)=>{D.value.delete_username_from_step(t,s),x.value=t,k.value=s,F("delete_user_from_approval_flow_step")},handle_save_approval_flow=()=>{D.value.flush_empty_steps(),D.value.save(),F("save_approval_flow")},handle_start_approval_flow=()=>{F("start_approval_flow")},handle_stop_approval_flow=()=>{F("stop_approval_flow")};return(0,o.bv)((async()=>{useBeforeEnterPage(t,["can_get_folders"]),await Promise.all([useGetFolders(t),useGetCart(t)]),await Promise.all([useGetUserGroups(t),useGetUsers(t)])})),{docs:_,filtered_items:d,query:l,selected_item_ids:p,selected_items:c,count_of_selected_items:m,handle_select_item:h,reset_selection:f,is_all_selected:u,handle_select_all_items:g,user:s,users:v,user_options:w,approval_action_username:y,is_approval_action_username_chosen:b,copy_list_usergroups:a,copy_list_usergroup_id:r,action_progress:R,seconds_before_document_copy_is_allowed:n,perform_action_on_selected_items:F,handle_copy_documents_to_usergroup:handle_copy_documents_to_usergroup,approval_flow:D,approval_flow_step_index:x,handle_create_approval_flow:handle_create_approval_flow,handle_add_approval_flow_step:handle_add_approval_flow_step,handle_delete_approval_flow_step:handle_delete_approval_flow_step,handle_attach_user_to_approval_flow_step:handle_attach_user_to_approval_flow_step,handle_delete_user_from_approval_flow_step:handle_delete_user_from_approval_flow_step,handle_save_approval_flow:handle_save_approval_flow,handle_start_approval_flow:handle_start_approval_flow,handle_stop_approval_flow:handle_stop_approval_flow}}};const zi=(0,qs.Z)(Oi,[["render",CartPagevue_type_template_id_0a15f685_scoped_true_render],["__scopeId","data-v-0a15f685"]]);var Wi=zi;const Gi={class:"page"},Zi={class:"page__header"},Hi={class:"page__container"},$i={class:"container__row"},Li={class:"container__cell container__cell_left"},Vi={class:"container__cell"},Ji={class:"container__cell"},Yi={class:"container__row"},Ki={class:"container__cell container__cell_left"},Xi={class:"container__cell"};function ProfilePagevue_type_template_id_672bfaef_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),l=(0,o.up)("form-text-field"),d=(0,o.up)("text-button"),p=(0,o.up)("form-filtered-select-input"),c=(0,o.up)("form-select-input");return(0,o.wg)(),(0,o.iD)("div",Gi,[(0,o._)("div",Zi,[(0,o.Wm)(_,{text:"Мой профиль",size:"middle"})]),(0,o._)("div",Hi,[(0,o.Wm)(l,{class:"container__header",value:"Настройка замещения пользователя:",parameters:{align:"left"}}),(0,o._)("div",$i,[(0,o._)("div",Li,[(0,o.Wm)(d,{title:"Назначить заместителя",disabled:!1===r.is_replacement_username_chosen,onClick:s[0]||(s[0]=t=>r.handle_add_user_replacement())},null,8,["disabled"])]),(0,o._)("div",Vi,[(0,o.Wm)(p,{value:r.replacement_username,parameters:{options:r.user_options,placeholder:"Поиск...",size:3},onUpdate:s[1]||(s[1]=t=>r.replacement_username=t)},null,8,["value","parameters"])]),(0,o._)("div",Ji,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.user_replacements,(t=>((0,o.wg)(),(0,o.j4)(d,{class:"container__cellbutton",key:t.id,title:t.last_name+" "+t.first_name+" (X)",onClick:s=>r.handle_delete_user_replacement(t.username)},null,8,["title","onClick"])))),128))])]),(0,o._)("div",Yi,[(0,o._)("div",Ki,[(0,o.Wm)(l,{class:"container__celllabel",value:"Работаю от имени:"})]),(0,o._)("div",Xi,[(0,o.Wm)(c,{value:r.behalf_username,parameters:{options:r.behalf_users_options},onUpdate:s[2]||(s[2]=t=>r.handle_change_on_behalf_user(t))},null,8,["value","parameters"])])])])])}var Qi={components:{HeadingComponent:Us,TextButton:ya,FormTextField:ra,FormSelectInput:er,FormFilteredSelectInput:rr},name:"CartPage",setup(){const t=new VueUnitOfWork,s=t.user_repository.get_current(),a=(0,o.Fl)((()=>t.user_repository.values().map((t=>t.value)))),r=(0,o.Fl)((()=>t.user_replacement_repository.values(s.value.username).map((t=>t.value)))),n=(0,o.Fl)((()=>[{name:"Выберите пользователя",value:"NOT_CHOSEN"}].concat(a.value.filter((t=>!0===t.is_active)).map((t=>({name:(t.last_name+" "+t.first_name+" ("+t.username+")").trim(),value:t.username}))).sort(((t,s)=>t.name.localeCompare(s.name)))))),_=(0,i.iH)("NOT_CHOSEN"),l=(0,o.Fl)((()=>"NOT_CHOSEN"!==_.value)),handle_add_user_replacement=async()=>{message_bus_MessageBus.handle(new AddUserReplacement(_.value),t)},handle_delete_user_replacement=async s=>{message_bus_MessageBus.handle(new DeleteUserReplacement(s),t)},d=t.user_repository.get_on_behalf_users(),p=(0,o.Fl)((()=>{if(null===d.value)return[];let t=d.value.map((t=>({name:t.last_name+" "+t.first_name,value:t.username})));return t.sort(((t,s)=>t.name.localeCompare(s.name))),t})),c=(0,o.Fl)((()=>null===s.value?null:null===s.value.on_behalf?s.value.username:s.value.on_behalf)),handle_change_on_behalf_user=s=>{s&&message_bus_MessageBus.handle(new SetOnBehalfUser(s),t)};return(0,o.bv)((async()=>{useBeforeEnterPage(t,[]),await Promise.all([useGetUsers(t),useGetUserReplacements(t),useGetOnBehalfUsers(t)])})),{user:s,users:a,user_replacements:r,user_options:n,replacement_username:_,is_replacement_username_chosen:l,handle_add_user_replacement:handle_add_user_replacement,handle_delete_user_replacement:handle_delete_user_replacement,behalf_users:d,behalf_users_options:p,behalf_username:c,handle_change_on_behalf_user:handle_change_on_behalf_user}}};const e_=(0,qs.Z)(Qi,[["render",ProfilePagevue_type_template_id_672bfaef_scoped_true_render],["__scopeId","data-v-672bfaef"]]);var t_=e_;const s_={class:"page"},a_=(0,o.Uk)(" Пользователи "),r_=(0,o.Uk)(" Заместители пользователей "),o_=(0,o.Uk)(" Группы пользователей "),n_=(0,o.Uk)(" Пользователи в группах "),i_=(0,o.Uk)(" Выборки "),__=(0,o.Uk)(" Настройки пользователей в папках "),l_=(0,o.Uk)(" Права "),d_=(0,o.Uk)(" Потоки "),p_=(0,o.Uk)(" Экземпляры потоков "),c_=(0,o.Uk)(" Серверные переменные "),u_=(0,o.Uk)(" Счетчики "),m_=(0,o.Uk)(" Почтовые ящики "),g_=(0,o.Uk)(" Почтовые каналы "),h_=(0,o.Uk)(" Привязка почтовых каналов к ящикам "),f_=(0,o.Uk)(" Письма ");function SettingsPagevue_type_template_id_baa4e3c8_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),l=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",s_,[(0,o.Wm)(_,{class:"page__heading",text:"Настройки",size:"middle"}),(0,o.Wm)(l,{class:"page__item",to:{name:"UserSettingsPage"}},{default:(0,o.w5)((()=>[a_])),_:1}),(0,o.Wm)(l,{class:"page__item",to:{name:"UserReplacementsPage"}},{default:(0,o.w5)((()=>[r_])),_:1}),(0,o.Wm)(l,{class:"page__item",to:{name:"UserGroupSettingsPage"}},{default:(0,o.w5)((()=>[o_])),_:1}),(0,o.Wm)(l,{class:"page__item",to:{name:"UsersInUserGroupsSettingsPage"}},{default:(0,o.w5)((()=>[n_])),_:1}),(0,o.Wm)(l,{class:"page__item",to:{name:"FolderSettingsPage"}},{default:(0,o.w5)((()=>[i_])),_:1}),(0,o.Wm)(l,{class:"page__item",to:{name:"UserFolderSettingsPage"}},{default:(0,o.w5)((()=>[__])),_:1}),(0,o.Wm)(l,{class:"page__item",to:{name:"PermissionSettingsPage"}},{default:(0,o.w5)((()=>[l_])),_:1}),(0,o.Wm)(l,{class:"page__item",to:{name:"FlowsPage"}},{default:(0,o.w5)((()=>[d_])),_:1}),(0,o.Wm)(l,{class:"page__item",to:{name:"FlowItemsPage"}},{default:(0,o.w5)((()=>[p_])),_:1}),(0,o.Wm)(l,{class:"page__item",to:{name:"ServerSettingsPage"}},{default:(0,o.w5)((()=>[c_])),_:1}),(0,o.Wm)(l,{class:"page__item",to:{name:"CounterSettingsPage"}},{default:(0,o.w5)((()=>[u_])),_:1}),(0,o.Wm)(l,{class:"page__item",to:{name:"MailBoxSettingsPage"}},{default:(0,o.w5)((()=>[m_])),_:1}),(0,o.Wm)(l,{class:"page__item",to:{name:"MailChannelSettingsPage"}},{default:(0,o.w5)((()=>[g_])),_:1}),(0,o.Wm)(l,{class:"page__item",to:{name:"MailChannelsInMailBoxesSettingsPage"}},{default:(0,o.w5)((()=>[h_])),_:1}),(0,o.Wm)(l,{class:"page__item",to:{name:"MailMessagesPage"}},{default:(0,o.w5)((()=>[f_])),_:1})])}var v_={components:{HeadingComponent:Us},name:"UserSettingsPage",setup(){const t=new VueUnitOfWork;(0,o.bv)((()=>{useBeforeEnterPage(t,["can_view_settings"])}))}};const w_=(0,qs.Z)(v_,[["render",SettingsPagevue_type_template_id_baa4e3c8_scoped_true_render],["__scopeId","data-v-baa4e3c8"]]);var y_=w_;const b_={class:"page"},R_={class:"page__container"},F_={class:"page__editblock"},D_={class:"page__editrow"};function UserSettingsPagevue_type_template_id_68ce86f4_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),l=(0,o.up)("base-form"),d=(0,o.up)("btn-component"),p=(0,o.up)("search-component");return(0,o.wg)(),(0,o.iD)("div",b_,[(0,o.Wm)(_,{class:"page__heading",text:"Пользователи",size:"middle"}),(0,o._)("div",R_,[(0,o._)("div",F_,[(0,o.Wm)(l,{class:"page__form",attributes:r.current,settings:r.form_pages,is_edit_mode:!0,is_header_required:!1,onUpdate:s[0]||(s[0]=t=>r.handle_update_attribute(t.name,t.value))},null,8,["attributes","settings"]),(0,o._)("div",D_,[r.can_change&&r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:0,class:"page__button",onClick:s[1]||(s[1]=t=>r.update_action()),caption:"Сохранить",type:"success",disabled:!r.is_edit_block_valid},null,8,["disabled"])):(0,o.kq)("",!0),r.can_delete&&r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:1,class:"page__button",onClick:s[2]||(s[2]=t=>r.delete_action()),caption:"Удалить",type:"danger"})):(0,o.kq)("",!0)])]),(0,o.Wm)(p,{class:"page__searchblock",schema:r.search_schema,model_objects:r.model_objects,convert_obj_to_item:r.convert_model_to_item,current_id:r.current_id,sort_by:"name",search_time:r.search_time,is_searching:r.is_searching,should_emit_search_event_on_any_keypress:!0,onChoose:s[3]||(s[3]=t=>r.current_id=t),onSearch:s[4]||(s[4]=t=>r.search_action(t))},null,8,["schema","model_objects","convert_obj_to_item","current_id","search_time","is_searching"])])])}const x_={class:"searchcomponent"},k_=["onClick"];function SearchComponentvue_type_template_id_1a8d1a54_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("document-page-search-row"),d=(0,o.up)("document-search-status-row"),p=(0,o.up)("document-page-sort-row"),c=(0,o.up)("document-pagination-row"),u=(0,o.up)("document-attribute-row"),m=(0,o.up)("document-files-row");return(0,o.wg)(),(0,o.iD)("div",x_,[(0,o.Wm)(_,{class:"searchcomponent__searchrow",search_schema:a.schema,should_emit_search_event_on_any_keypress:a.should_emit_search_event_on_any_keypress,required_space_for_link:a.has_link,is_selection_required:a.is_selection_required,is_all_selected:!1,"onSearch:docs":s[0]||(s[0]=s=>t.$emit("search",s)),"onSelectall:docs":s[1]||(s[1]=t=>r.handle_select_all_items())},null,8,["search_schema","should_emit_search_event_on_any_keypress","required_space_for_link","is_selection_required"]),(0,o.Wm)(d,{class:"searchcomponent__searchstatus",count:r.items.length,time:a.search_time,min_index:r.pagination_min_index,max_index:r.pagination_max_index},null,8,["count","time","min_index","max_index"]),(0,o.Wm)(p,{class:"searchcomponent__sortrow",search_schema:a.schema,sort_asc:r.var_sort_asc,sort_by:r.var_sort_by,"onToggle:direction":s[2]||(s[2]=t=>r.var_sort_asc=!r.var_sort_asc),"onSort:by":s[3]||(s[3]=t=>[r.var_sort_by,r.var_sort_rule]=t)},null,8,["search_schema","sort_asc","sort_by"]),r.items.length>0?((0,o.wg)(),(0,o.j4)(c,{key:0,class:"searchcomponent__paginationrow",total_count:r.items.length,count_per_page:r.pagination_count_per_page,current_page:r.pagination_current_page,variants:r.pagination_variants,"onSet:page_range":s[4]||(s[4]=t=>r.handle_set_page_range(t.min,t.max)),"onSelect:page":s[5]||(s[5]=t=>r.pagination_current_page=t),"onSet:count_per_page":s[6]||(s[6]=t=>r.pagination_count_per_page=t)},null,8,["total_count","count_per_page","current_page","variants"])):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.paginated_items,(s=>((0,o.wg)(),(0,o.iD)("div",{class:(0,l.C_)(["searchcomponent__row",{searchcomponent__row_selected:a.current_id===s.id}]),key:s.id,onClick:a=>t.$emit("choose",s.id)},[(0,o.Wm)(u,{class:"searchcomponent__attributerow",id:s.id,search_schema:a.schema,has_link:a.has_link,link_route_obj:s.link_to_single_page,attributes:s.attributes,is_selection_required:a.is_selection_required,is_selected:s.id in r.selected_item_ids,"onSelect:doc":t=>r.handle_select_item(s.id)},null,8,["id","search_schema","has_link","link_route_obj","attributes","is_selection_required","is_selected","onSelect:doc"]),a.is_files_shown?((0,o.wg)(),(0,o.j4)(m,{key:0,class:"searchcomponent__filerow",files:s.attachments,"onDownload:file":a=>t.$emit("download:file",{id:s.id,file:a[0],inline:a[1]}),"onCopy_link_to:file":a=>t.$emit("copy_link_to:file",{id:s.id,file:a})},null,8,["files","onDownload:file","onCopy_link_to:file"])):(0,o.kq)("",!0)],10,k_)))),128))])}const q_={class:"documentsearchstatusrow"};function DocumentSearchStatusRowvue_type_template_id_8c4e4b98_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("form-text-field");return(0,o.wg)(),(0,o.iD)("div",q_,[(0,o.Wm)(_,{value:r.status},null,8,["value"])])}var S_={components:{FormTextField:ra},name:"DocumentSearchStatusRow",props:{time:{type:Number,required:!1},count:{type:Number,required:!0},min_index:{type:Number,required:!1},max_index:{type:Number,required:!1},count_of_selected:{type:Number,required:!1},is_searching:{type:Boolean,required:!1,default:!1}},setup(t){const s=(0,o.Fl)((()=>{if(t.is_searching)return"Поиск...";let s="Для поиска нажмите ENTER в любом окошке. Найдено "+t.count.toString()+"шт.";return t.time&&(s+=" ("+t.time.toString()+" сек.)"),void 0!==t.min_index&&void 0!==t.max_index&&(s+=" Показаны "+(t.min_index+1).toString()+"-"+(t.max_index+1).toString()+"."),void 0!==t.count_of_selected&&(s+=" Выделено "+t.count_of_selected.toString()+"шт."),s}));return{status:s}}};const E_=(0,qs.Z)(S_,[["render",DocumentSearchStatusRowvue_type_template_id_8c4e4b98_scoped_true_render],["__scopeId","data-v-8c4e4b98"]]);var A_=E_,C_={components:{DocumentPageSearchRow:gr,DocumentAttributeRow:ha,DocumentPageSortRow:Rr,DocumentPaginationRow:$r,DocumentSearchStatusRow:A_,DocumentFilesRow:za},name:"SearchComponent",props:{model_objects:{type:Array,required:!0},schema:{type:Object,required:!0},sort_by:{type:String,required:!0},sort_asc:{type:Boolean,required:!1,default:!1},sort_rule:{type:String,required:!1,default:"DEFAULT"},convert_obj_to_item:{type:Function,required:!0},current_id:{type:[Number,String],required:!1,default:0},search_time:{type:Number,required:!1,default:0},is_searching:{type:Boolean,required:!1,default:!1},should_emit_search_event_on_any_keypress:{type:Boolean,required:!1,default:!1},is_selection_required:{type:Boolean,required:!1,default:!1},has_link:{type:Boolean,required:!1,default:!1},is_files_shown:{type:Boolean,required:!1,default:!1}},emits:["choose","search","download:file","copy_link_to:file","select"],setup(t,{emit:s}){const a=(0,i.iH)(t.sort_by),r=(0,i.iH)(t.sort_asc),n=(0,i.iH)(t.sort_rule),_=(0,i.iH)(useGetSortFunction(n.value));(0,o.YP)(n,(t=>_.value=useGetSortFunction(t)));const l=(0,o.Fl)((()=>{let s=t.model_objects;return s.sort(((t,s)=>(!0===r.value?1:-1)*_.value(t[a.value],s[a.value]))),s.map((s=>t.convert_obj_to_item(s)))})),{pagination_variants:d,pagination_count_per_page:p,pagination_current_page:c,pagination_min_index:u,pagination_max_index:m,paginated_items:g,handle_set_page_range:h}=usePaginationMixin(l),{selected_item_ids:f,selected_items:v,count_of_selected_items:w,handle_select_all_items:y,handle_select_item:b,reset_selection:R}=useSelectionMixin(l,g);return(0,o.YP)(v,(t=>s("select",t))),{items:l,var_sort_by:a,var_sort_asc:r,var_sort_rule:n,paginated_items:g,handle_set_page_range:h,pagination_variants:d,pagination_count_per_page:p,pagination_current_page:c,pagination_min_index:u,pagination_max_index:m,selected_item_ids:f,selected_items:v,count_of_selected_items:w,handle_select_all_items:y,handle_select_item:b,reset_selection:R}}};const U_=(0,qs.Z)(C_,[["render",SearchComponentvue_type_template_id_1a8d1a54_scoped_true_render],["__scopeId","data-v-1a8d1a54"]]);var P_=U_,j_={components:{HeadingComponent:Us,BtnComponent:Es,BaseForm:ni,SearchComponent:P_},name:"UserSettingsPage",setup(){const t=new VueUnitOfWork,convert_model_to_item=t=>({id:t.username,attributes:{username:t.username,email:t.email,first_name:t.first_name,last_name:t.last_name,is_active:!0===t.is_active?"Y":"N",access_group_regex:t.access_group_regex,role:t.role,role_inside_group:t.role_inside_group,role_outside_group:t.role_outside_group,on_behalf:t.on_behalf},actions:{}}),s=(0,i.iH)({}),a=(0,o.Fl)((()=>filterArrayOfObjectsByQuery(t.user_repository.values().map((t=>t.value)),s.value))),r=t.permission_repository.has("can_change_user"),n=t.permission_repository.has("can_delete_user"),_=(0,i.iH)(0),l=(0,i.iH)(!1),search_action=t=>s.value=t,d=[{name:"username",size:"w200",grow:!0,align:"left",fields:[{placeholder:"Имя пользователя",rule:"icontains"}]},{name:"email",size:"w300",fields:[{placeholder:"E-mail",rule:"icontains"}]},{name:"last_name",size:"w200",grow:!0,fields:[{placeholder:"Фамилия",rule:"icontains"}]},{name:"first_name",grow:!0,size:"w200",fields:[{placeholder:"Имя",rule:"icontains"}]},{name:"is_active",size:"w30",fields:[{type:"bool",placeholder:"Активен?",rule:"exact"}]}],p={username:"",email:"",first_name:"",last_name:"",patronomic:"",position:"",department:"",is_active:!1,access_group_regex:"^$",role:"",role_inside_group:"",role_outside_group:"",on_behalf:null},c={},u={},{current_id:m,current:g,handle_update_attribute:h}=useCurrentMixin(p,t.user_repository,u),f=(0,o.Fl)((()=>!0)),update_action=async()=>{const s=new SetUser(...["username","is_active","access_group_regex","role","role_inside_group","role_outside_group"].map((t=>convertObject(g.value,c)[t])));await message_bus_MessageBus.handle(s,t)},delete_action=async()=>{const s=new DeleteUser(...["username"].map((t=>convertObject(g.value,c)[t])));await message_bus_MessageBus.handle(s,t)},v=t.user_folder_settings_repository.get_role_variants(),w=(0,o.Fl)((()=>v.value?v.value.map((t=>({name:t,value:t}))):[])),y=(0,o.Fl)((()=>[{size:"w450",fields:[{type:"FormTextField",parameters:{font_weight:"bold"},value:"Имя пользователя:"},{type:"FormTextField",bind:"username"},{type:"FormTextField",parameters:{font_weight:"bold"},value:"E-mail:"},{type:"FormTextField",bind:"email"},{type:"FormTextField",parameters:{font_weight:"bold"},value:"Фамилия:"},{type:"FormTextField",bind:"last_name"},{type:"FormTextField",parameters:{font_weight:"bold"},value:"Имя:"},{type:"FormTextField",bind:"first_name"},{type:"FormTextField",parameters:{font_weight:"bold"},value:"Позиция:"},{type:"FormTextField",bind:"position"},{type:"FormTextField",parameters:{font_weight:"bold"},value:"Департамент"},{type:"FormTextField",bind:"department"},{type:"FormTextField",parameters:{font_weight:"bold"},value:"Активен ?"},{type:"FormBooleanInput",parameters:{size:20},bind:"is_active"},{type:"FormTextField",parameters:{font_weight:"bold"},value:"Регулярное выражение группы доступа:"},{type:"FormTextInput",bind:"access_group_regex"},{type:"FormTextField",parameters:{font_weight:"bold"},value:"Роль общая:"},{type:"FormSelectInput",parameters:{options:w.value},bind:"role"},{type:"FormTextField",parameters:{font_weight:"bold"},value:"Роль внутри группы пользователей:"},{type:"FormSelectInput",parameters:{options:w.value},bind:"role_inside_group"},{type:"FormTextField",parameters:{font_weight:"bold"},value:"Роль вне группы пользователей:"},{type:"FormSelectInput",parameters:{options:w.value},bind:"role_outside_group"},{type:"FormTextField",parameters:{font_weight:"bold"},value:"Работает от имени пользователя:"},{type:"FormTextField",bind:"on_behalf"}]}]));return(0,o.bv)((async()=>{await useBeforeEnterPage(t,["can_view_user"]),await Promise.all([useGetRoles(t),useGetUsers(t)])})),{search_action:search_action,update_action:update_action,delete_action:delete_action,can_change:r,can_delete:n,current_id:m,current:g,is_edit_block_valid:f,handle_update_attribute:h,form_pages:y,search_schema:d,model_objects:a,convert_model_to_item:convert_model_to_item,search_time:_,is_searching:l}}};const M_=(0,qs.Z)(j_,[["render",UserSettingsPagevue_type_template_id_68ce86f4_scoped_true_render],["__scopeId","data-v-68ce86f4"]]);var T_=M_;const N_={class:"page"},I_={class:"page__container"},B_={class:"page__halfcontainer halfcontainer"},O_={class:"page__titleblock"},z_={class:"halfcontainer__searchblock searchblock"},W_={class:"page__halfcontainer halfcontainer"},G_={class:"page__titleblock"},Z_={class:"halfcontainer__searchblock searchblock"};function UserReplacementsPagevue_type_template_id_077a0600_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),l=(0,o.up)("form-text-field"),d=(0,o.up)("form-text-input"),p=(0,o.up)("user-item"),c=(0,o.up)("form-select-input");return(0,o.wg)(),(0,o.iD)("div",N_,[(0,o.Wm)(_,{class:"page__heading",text:"Заместители пользователей",size:"middle"}),(0,o._)("div",I_,[(0,o._)("div",B_,[(0,o._)("div",O_,[(0,o.Wm)(l,{class:"halfcontainer__title",value:"Все пользователи:"})]),(0,o._)("div",z_,[(0,o.Wm)(d,{class:"searchblock__searchinput searchinput",value:r.query_left.last_name,parameters:{placeholder:"Фамилия"},onUpdate:s[0]||(s[0]=t=>r.query_left.last_name=t)},null,8,["value"]),(0,o.Wm)(d,{class:"searchblock__searchinput searchinput",value:r.query_left.first_name,parameters:{placeholder:"Имя"},onUpdate:s[1]||(s[1]=t=>r.query_left.first_name=t)},null,8,["value"]),(0,o.Wm)(d,{class:"searchblock__searchinput searchinput",value:r.query_left.username,parameters:{placeholder:"Имя пользователя"},"onUpdate:value":s[2]||(s[2]=t=>r.query_left.username=t)},null,8,["value"])]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.users_excluded_from_replacements,(t=>((0,o.wg)(),(0,o.j4)(p,{class:"searchblock__useritem",key:t.username,obj:t,can_delete:!1,can_add:!0,onAdd:s=>r.handle_add(t)},null,8,["obj","onAdd"])))),128))]),(0,o._)("div",W_,[(0,o._)("div",G_,[(0,o.Wm)(l,{class:"halfcontainer__title",value:"Пользователь:"}),(0,o.Wm)(c,{class:"halfcontainer__selectgroup",parameters:{options:r.users},value:r.current_username,onUpdate:s[3]||(s[3]=t=>r.current_username=t)},null,8,["parameters","value"])]),(0,o._)("div",Z_,[(0,o.Wm)(d,{class:"searchblock__searchinput searchinput",parameters:{placeholder:"Фамилия"},value:r.query_right.last_name,onUpdate:s[4]||(s[4]=t=>r.query_right.last_name=t)},null,8,["value"]),(0,o.Wm)(d,{class:"searchblock__searchinput searchinput",parameters:{placeholder:"Имя"},value:r.query_right.first_name,onUpdate:s[5]||(s[5]=t=>r.query_right.first_name=t)},null,8,["value"]),(0,o.Wm)(d,{class:"searchblock__searchinput searchinput",value:r.query_right.username,parameters:{placeholder:"Имя пользователя"},onUpdate:s[6]||(s[6]=t=>r.query_right.username=t)},null,8,["value"])]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.users_included_in_replacements,(t=>((0,o.wg)(),(0,o.j4)(p,{class:"searchblock__useritem",key:t.username,obj:t,can_delete:!0,can_add:!1,onDelete:s=>r.handle_delete(t)},null,8,["obj","onDelete"])))),128))])])])}const H_={class:"useritem"};function UserItemvue_type_template_id_b08b1a68_render(t,s,a,r,n,i){const _=(0,o.up)("form-text-field"),l=(0,o.up)("btn-component");return(0,o.wg)(),(0,o.iD)("div",H_,[(0,o.Wm)(_,{class:"useritem__description",value:a.obj.last_name+" "+a.obj.first_name+" ("+a.obj.username+")"},null,8,["value"]),a.can_add?((0,o.wg)(),(0,o.j4)(l,{key:0,class:"useritem__button",caption:"Добавить",type:"success",onClick:s[0]||(s[0]=s=>t.$emit("add"))})):(0,o.kq)("",!0),a.can_delete?((0,o.wg)(),(0,o.j4)(l,{key:1,class:"useritem__button",caption:"Удалить",type:"danger",onClick:s[1]||(s[1]=s=>t.$emit("delete"))})):(0,o.kq)("",!0)])}var $_={components:{FormTextField:ra,BtnComponent:Es},name:"UserItem",props:{obj:{type:Object,required:!0},can_delete:{type:Boolean,required:!1,default:!1},can_add:{type:Boolean,required:!1,default:!1}},emits:["delete","add"]};const L_=(0,qs.Z)($_,[["render",UserItemvue_type_template_id_b08b1a68_render]]);var V_=L_,J_={name:"UserReplacementsPage",components:{HeadingComponent:Us,UserItem:V_,FormTextInput:Ns,FormTextField:ra,FormSelectInput:er},setup(){const t=new VueUnitOfWork,s=(0,o.Fl)((()=>{let s=t.user_repository.values().map((t=>({id:t.value.username,name:t.value.last_name+" "+t.value.first_name,value:t.value.username})));return s.sort(((t,s)=>t.name.localeCompare(s.name))),s})),a=(0,i.iH)(null);(0,o.YP)(s,(t=>{null===a.value&&t.length>0&&(a.value=t[0].id)})),(0,o.YP)(a,(()=>handle_get()));const r=(0,o.Fl)((()=>null===a.value?[]:t.user_replacement_repository.values(a.value).map((t=>t.value.username)))),filter_users=(s,a)=>{let r=filterArrayOfObjects(t.user_repository.values().map((t=>t.value)),s);return null===r&&(r=[]),r=r.filter((t=>a(t.username))),r.sort(((t,s)=>t.last_name.localeCompare(s.last_name))),r},n=(0,o.Fl)((()=>filter_users(d,(t=>r.value.includes(t))))),_=(0,o.Fl)((()=>filter_users(l,(t=>!r.value.includes(t))))),handle_get=async()=>{await message_bus_MessageBus.handle(new GetUserReplacementsOfUser(a.value),t)},handle_add=async s=>{await message_bus_MessageBus.handle(new AddUserReplacementToUser(a.value,s.username),t)},handle_delete=async s=>{await message_bus_MessageBus.handle(new DeleteUserReplacementFromUser(a.value,s.username),t)},l=(0,i.qj)({username:"",first_name:"",last_name:""}),d=(0,i.qj)({username:"",first_name:"",last_name:""});return(0,o.bv)((async()=>{await useBeforeEnterPage(t,["can_view_user"]),await Promise.all([useGetUsers(t)])})),{users:s,current_username:a,current_user_replacements:r,users_included_in_replacements:n,users_excluded_from_replacements:_,query_left:l,query_right:d,handle_add:handle_add,handle_delete:handle_delete}}};const Y_=(0,qs.Z)(J_,[["render",UserReplacementsPagevue_type_template_id_077a0600_scoped_true_render],["__scopeId","data-v-077a0600"]]);var K_=Y_;const X_={class:"page"},Q_={class:"page__container"},el={class:"page__editblock"},tl={class:"page__editrow"};function UserFolderSettingsPagevue_type_template_id_41a68488_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),l=(0,o.up)("base-form"),d=(0,o.up)("btn-component"),p=(0,o.up)("search-component");return(0,o.wg)(),(0,o.iD)("div",X_,[(0,o.Wm)(_,{class:"page__heading",text:"Настройки пользователей в выборках",size:"middle"}),(0,o._)("div",Q_,[(0,o._)("div",el,[(0,o.Wm)(l,{class:"page__form",attributes:r.current,settings:r.form_pages,is_edit_mode:!0,is_header_required:!1,onUpdate:s[0]||(s[0]=t=>r.handle_update_attribute(t.name,t.value))},null,8,["attributes","settings"]),(0,o._)("div",tl,[r.can_add&&!r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:0,class:"page__button",onClick:s[1]||(s[1]=t=>r.add_action()),caption:"Добавить",type:"primary",disabled:!r.is_edit_block_valid},null,8,["disabled"])):(0,o.kq)("",!0),r.can_change&&r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:1,class:"page__button",onClick:s[2]||(s[2]=t=>r.update_action()),caption:"Сохранить",type:"success",disabled:!r.is_edit_block_valid},null,8,["disabled"])):(0,o.kq)("",!0),r.can_delete&&r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:2,class:"page__button",onClick:s[3]||(s[3]=t=>r.delete_action()),caption:"Удалить",type:"danger"})):(0,o.kq)("",!0)])]),(0,o.Wm)(p,{class:"page__searchblock",schema:r.search_schema,model_objects:r.model_objects,convert_obj_to_item:r.convert_model_to_item,current_id:r.current_id,sort_by:"username",search_time:r.search_time,is_searching:r.is_searching,should_emit_search_event_on_any_keypress:!0,onChoose:s[4]||(s[4]=t=>r.current_id=t),onSearch:s[5]||(s[5]=t=>r.search_action(t))},null,8,["schema","model_objects","convert_obj_to_item","current_id","search_time","is_searching"])])])}var sl={components:{HeadingComponent:Us,BtnComponent:Es,BaseForm:ni,SearchComponent:P_},name:"UserFolderSettingsPage",setup(){const t=new VueUnitOfWork,convert_model_to_item=t=>({id:t.id,attributes:{id:t.id.toString(),folder_id:t.folder_id,usergroup_slug:t.usergroup_slug,username:t.username,role:t.role,search_schema:t.search_schema?"Y":"N"},actions:{}}),s=(0,i.iH)({}),a=(0,o.Fl)((()=>filterArrayOfObjectsByQuery(t.user_folder_settings_repository.values().map((t=>t.value)),s.value))),r=t.permission_repository.has("can_add_role"),n=t.permission_repository.has("can_change_role"),_=t.permission_repository.has("can_delete_role"),l=(0,i.iH)(0),d=(0,i.iH)(!1),search_action=t=>s.value=t,p=[{name:"id",size:"w50",fields:[{placeholder:"ID",rule:"exact"}]},{name:"username",size:"w200",align:"left",fields:[{placeholder:"Имя пользователя",rule:"icontains"}]},{name:"folder_id",size:"w100",fields:[{placeholder:"ID выборки",rule:"exact"}]},{name:"usergroup_slug",size:"w300",fields:[{placeholder:"Группа пользователей",rule:"icontains"}]},{name:"role",size:"w200",fields:[{placeholder:"Роль",rule:"icontains"}]},{name:"search_schema",size:"w100",fields:[{type:"bool",placeholder:"Есть схема?",rule:"exact"}]}],c={id:null,folder_id:"",usergroup_slug:"",username:"",role:null,search_schema:null},u={folder_id:parseInt,role:t=>"__NONE__"===t?null:t,search_schema:t=>JSON.parse(t)},m={folder_id:t=>t.toString(),role:t=>null===t?"__NONE__":t,search_schema:t=>JSON.stringify(t,null,3)},{current_id:g,current:h,handle_update_attribute:f}=useCurrentMixin(c,t.user_folder_settings_repository,m),v=(0,o.Fl)((()=>h.value.folder_id>0&&h.value.usergroup_slug.length>0&&h.value.username.length>0&&null!==h.value.role&&h.value.role.length>0)),add_action=async()=>{const s=new AddUserFolderSettings(...["folder_id","usergroup_slug","username","role","search_schema"].map((t=>convertObject(h.value,u)[t])));await message_bus_MessageBus.handle(s,t)},update_action=async()=>{const s=new UpdateUserFolderSettings(...["id","folder_id","usergroup_slug","username","role","search_schema"].map((t=>convertObject(h.value,u)[t])));await message_bus_MessageBus.handle(s,t)},delete_action=async()=>{const s=new DeleteUserFolderSettings(g.value);await message_bus_MessageBus.handle(s,t),g.value=null},w=t.user_folder_settings_repository.get_role_variants(),y=(0,o.Fl)((()=>w.value?[{name:"Отсутствует",value:"__NONE__"}].concat(w.value.map((t=>({name:t,value:t})))):[])),b=(0,o.Fl)((()=>[{size:"w450",fields:[{type:"FormTextField",bind:"id"},{type:"FormTextField",parameters:{font_weight:"bold"},value:"ID выборки:"},{type:"FormTextInput",bind:"folder_id"},{type:"FormTextField",parameters:{font_weight:"bold"},value:"Slug группы пользователей:"},{type:"FormTextInput",bind:"usergroup_slug"},{type:"FormTextField",parameters:{font_weight:"bold"},value:"Имя пользователя:"},{type:"FormTextInput",bind:"username"},{type:"FormTextField",parameters:{font_weight:"bold"},value:"Роль:"},{type:"FormSelectInput",parameters:{options:y.value},bind:"role"},{type:"FormTextField",parameters:{font_weight:"bold"},value:"Схема поиска в формате JSON"},{type:"FormMultilineTextInput",parameters:{rows:15,resize:"vertical",is_disabled:!0},bind:"search_schema"}]}]));return(0,o.bv)((async()=>{await useBeforeEnterPage(t,["can_view_role"]),await Promise.all([useGetRoles(t),useGetUserFolderSettings(t),useGetFolders(t)])})),{search_action:search_action,add_action:add_action,update_action:update_action,delete_action:delete_action,can_add:r,can_change:n,can_delete:_,current_id:g,current:h,is_edit_block_valid:v,handle_update_attribute:f,form_pages:b,search_schema:p,model_objects:a,convert_model_to_item:convert_model_to_item,search_time:l,is_searching:d}}};const al=(0,qs.Z)(sl,[["render",UserFolderSettingsPagevue_type_template_id_41a68488_scoped_true_render],["__scopeId","data-v-41a68488"]]);var rl=al;const ol={class:"page"},nl={class:"page__container"},il={class:"page__editblock"},_l={class:"page__editrow"};function FolderSettingsPagevue_type_template_id_d709dc8c_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),l=(0,o.up)("base-form"),d=(0,o.up)("btn-component"),p=(0,o.up)("search-component");return(0,o.wg)(),(0,o.iD)("div",ol,[(0,o.Wm)(_,{class:"page__heading",text:"Выборки",size:"middle"}),(0,o._)("div",nl,[(0,o._)("div",il,[(0,o.Wm)(l,{class:"page__form",attributes:r.current,settings:r.form_pages,is_edit_mode:!0,is_header_required:!1,onUpdate:s[0]||(s[0]=t=>r.handle_update_attribute(t.name,t.value))},null,8,["attributes","settings"]),(0,o._)("div",_l,[r.can_add&&!r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:0,class:"page__button",onClick:s[1]||(s[1]=t=>r.add_action()),caption:"Добавить",type:"primary",disabled:!r.is_edit_block_valid},null,8,["disabled"])):(0,o.kq)("",!0),r.can_change&&r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:1,class:"page__button",onClick:s[2]||(s[2]=t=>r.update_action()),caption:"Сохранить",type:"success",disabled:!r.is_edit_block_valid},null,8,["disabled"])):(0,o.kq)("",!0),r.can_delete&&r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:2,class:"page__button",onClick:s[3]||(s[3]=t=>r.delete_action()),caption:"Удалить",type:"danger"})):(0,o.kq)("",!0)])]),(0,o.Wm)(p,{class:"page__searchblock",schema:r.search_schema,model_objects:r.model_objects,convert_obj_to_item:r.convert_model_to_item,current_id:r.current_id,sort_by:"name",search_time:r.search_time,is_searching:r.is_searching,should_emit_search_event_on_any_keypress:!0,onChoose:s[4]||(s[4]=t=>r.current_id=t),onSearch:s[5]||(s[5]=t=>r.search_action(t))},null,8,["schema","model_objects","convert_obj_to_item","current_id","search_time","is_searching"])])])}var ll={components:{HeadingComponent:Us,BtnComponent:Es,BaseForm:ni,SearchComponent:P_},name:"FolderSettingsPage",setup(){const t=new VueUnitOfWork,convert_model_to_item=t=>({id:t.id,attributes:{id:t.id.toString(),name:t.name,storage_path:t.storage_path,master_usergroup_slug:t.master_usergroup_slug,access_group:t.access_group},actions:{}}),s=(0,i.iH)({}),a=(0,o.Fl)((()=>filterArrayOfObjectsByQuery(t.folder_repository.values().map((t=>t.value)),s.value))),r=t.permission_repository.has("can_add_folder"),n=t.permission_repository.has("can_change_folder"),_=t.permission_repository.has("can_delete_folder"),l=(0,i.iH)(0),d=(0,i.iH)(!1),search_action=t=>s.value=t,p=[{name:"id",size:"w50",fields:[{placeholder:"ID",rule:"exact"}]},{name:"name",size:"w200",align:"left",grow:!0,fields:[{placeholder:"Наименование",rule:"icontains"}]},{name:"storage_path",size:"w400",fields:[{placeholder:"Хранилище",rule:"icontains"}]}],c={id:null,name:"",settings:"",storage_path:"",master_usergroup_slug:"",access_group:"ACCESS_RESTRICTED"},u={settings:t=>JSON.parse(t)},m={settings:t=>JSON.stringify(t,null,3)},{current_id:g,current:h,handle_update_attribute:f}=useCurrentMixin(c,t.folder_repository,m),v=(0,o.Fl)((()=>validate_json(h.value.settings,fe))),w=(0,o.Fl)((()=>v.value&&h.value.name.length>0)),add_action=async()=>{const s=new AddFolder(...["name","storage_path","master_usergroup_slug","access_group","settings"].map((t=>convertObject(h.value,u)[t])));await message_bus_MessageBus.handle(s,t)},update_action=async()=>{const s=new UpdateFolder(...["id","name","storage_path","master_usergroup_slug","access_group","settings"].map((t=>convertObject(h.value,u)[t])));await message_bus_MessageBus.handle(s,t)},delete_action=async()=>{const s=new DeleteFolder(g.value);await message_bus_MessageBus.handle(s,t),g.value=null},y=(0,o.Fl)((()=>[{size:"w450",fields:[{type:"FormTextField",bind:"id"},{type:"FormTextField",value:"Выборка:"},{type:"FormTextInput",bind:"name"},{type:"FormTextField",value:"Название хранилища / имя папки:"},{type:"FormTextInput",bind:"storage_path"},{type:"FormTextField",value:"Короткое имя (slug) мастер группы пользователей:"},{type:"FormTextInput",bind:"master_usergroup_slug"},{type:"FormTextField",value:"Группа доступа:"},{type:"FormTextInput",bind:"access_group"},{type:"FormTextField",value:"Описание в формате JSON"},{type:"FormMultilineTextInput",parameters:{rows:15,resize:"vertical",color:v.value?"green":"red"},bind:"settings"}]}]));return(0,o.bv)((async()=>{await useBeforeEnterPage(t,["can_view_flow"]),await useGetFolders(t)})),{search_action:search_action,add_action:add_action,update_action:update_action,delete_action:delete_action,can_add:r,can_change:n,can_delete:_,current_id:g,current:h,is_edit_block_valid:w,handle_update_attribute:f,form_pages:y,search_schema:p,model_objects:a,convert_model_to_item:convert_model_to_item,search_time:l,is_searching:d}}};const dl=(0,qs.Z)(ll,[["render",FolderSettingsPagevue_type_template_id_d709dc8c_scoped_true_render],["__scopeId","data-v-d709dc8c"]]);var pl=dl;const PermissionSettingsPagevue_type_template_id_9ea14bf8_scoped_true_withScopeId=t=>((0,o.dD)("data-v-9ea14bf8"),t=t(),(0,o.Cn)(),t),cl={class:"page"},ul={class:"page__container"},ml={class:"page__row"},gl={class:"page__row"},hl=PermissionSettingsPagevue_type_template_id_9ea14bf8_scoped_true_withScopeId((()=>(0,o._)("div",{class:"page__namecolumn"},null,-1))),fl={class:"page__namecolumn"},vl=["checked","onClick"];function PermissionSettingsPagevue_type_template_id_9ea14bf8_scoped_true_render(t,s,a,n,i,_){const d=(0,o.up)("heading-component"),p=(0,o.up)("form-text-input"),c=(0,o.up)("btn-component");return(0,o.wg)(),(0,o.iD)("div",cl,[(0,o.Wm)(d,{class:"page__heading",text:"Права",size:"middle"}),(0,o._)("div",ul,[(0,o._)("div",ml,[(0,o.Wm)(p,{class:"page__roleinput",value:n.new_role,parameters:{placeholder:"Имя роли"},onChange:s[0]||(s[0]=(0,r.iM)((t=>n.new_role=t.target.value),["prevent"]))},null,8,["value"]),(0,o.Wm)(c,{class:"page__rolebutton",caption:"Добавить роль",type:"success",onClick:s[1]||(s[1]=(0,r.iM)((t=>n.add_role()),["prevent"]))}),(0,o.Wm)(c,{class:"page__rolebutton",caption:"Удалить роль",type:"danger",onClick:s[2]||(s[2]=(0,r.iM)((t=>n.delete_role()),["prevent"]))})]),(0,o._)("div",gl,[hl,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.role_variants,(t=>((0,o.wg)(),(0,o.iD)("div",{key:t,class:"page__valuecolumn"},(0,l.zw)(t),1)))),128))]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.permission_names,(t=>((0,o.wg)(),(0,o.iD)("div",{key:t.name,class:"page__row"},[(0,o._)("div",fl,(0,l.zw)(t.description),1),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.role_variants,(s=>((0,o.wg)(),(0,o.iD)("div",{key:s,class:"page__valuecolumn"},[(0,o._)("input",{type:"checkbox",class:"page__checkbox",checked:n.permissions[s][t.name].value,onClick:(0,r.iM)((a=>!0===n.permissions[s][t.name].value?n.delete_permission(s,t.name):n.add_permission(s,t.name)),["prevent"])},null,8,vl)])))),128))])))),128))])])}var wl={name:"PermissionSettingsPage",components:{HeadingComponent:Us,FormTextInput:Ns,BtnComponent:Es},setup(){const t=new VueUnitOfWork,s=t.user_folder_settings_repository.get_role_variants(),a=[{name:"can_get_folders",description:"Данные о папках - просмотр"},{name:"can_view_settings",description:"Настройки - Просмотр"},{name:"can_view_folder",description:"Папка - Просмотр"},{name:"can_add_folder",description:"Папка - Добавление"},{name:"can_change_folder",description:"Папка - Изменение"},{name:"can_delete_folder",description:"Папка - Удаление"},{name:"can_view_usergroup",description:"Группа пользователей - Просмотр"},{name:"can_add_usergroup",description:"Группа пользователей - Добавление"},{name:"can_change_usergroup",description:"Группа пользователей - Изменение"},{name:"can_delete_usergroup",description:"Группа пользователей - Удаление"},{name:"can_view_user",description:"Пользователь - Просмотр"},{name:"can_change_user",description:"Пользователь - Изменение"},{name:"can_delete_user",description:"Пользователь - Удаление"},{name:"can_view_role",description:"Роль - Просмотр"},{name:"can_view_permission",description:"Права - Просмотр"},{name:"can_change_permission",description:"Права - Изменение"},{name:"can_add_role",description:"Роль - Добавление"},{name:"can_change_role",description:"Роль - Изменение"},{name:"can_delete_role",description:"Роль - Удаление"},{name:"can_view_userfoldersetting",description:"Настройки пользователя для папки - Просмотр"},{name:"can_add_userfoldersetting",description:"Настройки пользователя для папки - Добавление"},{name:"can_change_userfoldersetting",description:"Настройки пользователя для папки - Изменение"},{name:"can_delete_userfoldersetting",description:"Настройки пользователя для папки - Удаление"},{name:"can_view_document",description:"Документ - Просмотр"},{name:"can_add_document",description:"Документ - Добавление"},{name:"can_change_document",description:"Документ - Изменение"},{name:"can_delete_document",description:"Документ - Удаление"},{name:"can_view_file",description:"Файл - Просмотр"},{name:"can_add_file",description:"Файл - Добавление"},{name:"can_delete_file",description:"Файл - Удаление"},{name:"can_view_service",description:"Сервис - Просмотр"},{name:"can_view_flow",description:"Поток - Просмотр"},{name:"can_add_flow",description:"Поток - Добавление"},{name:"can_change_flow",description:"Поток - Изменение"},{name:"can_delete_flow",description:"Поток - Удаление"},{name:"can_view_flowitem",description:"Экземпляр потока - Просмотр"},{name:"can_add_flowitem",description:"Экземпляр потока - Добавление"},{name:"can_change_flowitem",description:"Экземпляр потока - Изменение"},{name:"can_delete_flowitem",description:"Экземпляр потока - Удаление"},{name:"can_view_flowitemstep",description:"Шаг потока - Просмотр"},{name:"can_view_documentapproval",description:"Согласование документа - Просмотр"},{name:"can_add_documentapproval",description:"Согласование документа - Добавление"},{name:"can_change_documentapproval",description:"Согласование документа - Изменение"},{name:"can_delete_documentapproval",description:"Согласование документа - Удаление"},{name:"can_delegate_documentapproval",description:"Согласование документа - Делегирование"},{name:"can_view_documentapprovalflow",description:"Поток согласований документа - Просмотр"},{name:"can_change_documentapprovalflow",description:"Поток согласований документа - Изменение"},{name:"can_delete_documentapprovalflow",description:"Поток согласований документа - Удаление"},{name:"can_empty_cart",description:"Корзина - Очистка"},{name:"can_view_cart",description:"Корзина - Просмотр"},{name:"can_add_to_cart",description:"Корзина - Добавление"},{name:"can_remove_from_cart",description:"Корзина - Удаление"},{name:"can_view_userreplacement",description:"Замещение своего пользователя - Просмотр"},{name:"can_add_userreplacement",description:"Замещение своего пользователя - Добавление"},{name:"can_delete_userreplacement",description:"Замещение своего пользователя - Удаление"},{name:"can_view_alluserreplacement",description:"Замещение любого пользователя - Просмотр"},{name:"can_add_alluserreplacement",description:"Замещение любого пользователя - Добавление"},{name:"can_delete_alluserreplacement",description:"Замещение любого пользователя - Удаление"},{name:"can_view_onbehalfuser",description:"Работа от имени другого пользователя - Просмотр"},{name:"can_change_onbehalfuser",description:"Работа от имени другого пользователя - Изменение"},{name:"can_delete_onbehalfuser",description:"Работа от имени другого пользователя - Удаление"},{name:"can_view_serversetting",description:"Серверные переменные - Просмотр"},{name:"can_change_serversetting",description:"Серверные переменные - Изменение"},{name:"can_view_mailbox",description:"Почтовый ящик - Просмотр"},{name:"can_add_mailbox",description:"Почтовый ящик - Добавление"},{name:"can_change_mailbox",description:"Почтовый ящик - Изменение"},{name:"can_delete_mailbox",description:"Почтовый ящик - Удаление"},{name:"can_view_mailchannel",description:"Почтовый канал - Просмотр"},{name:"can_add_mailchannel",description:"Почтовый канал - Добавление"},{name:"can_change_mailchannel",description:"Почтовый канал - Изменение"},{name:"can_delete_mailchannel",description:"Почтовый канал - Удаление"},{name:"can_fetch_mailchannel",description:"Почтовый канал - Получение писем"},{name:"can_view_mail",description:"Письмо - Просмотр"},{name:"can_delete_mail",description:"Письмо - Удаление"}],r=(0,o.Fl)((()=>{let r={};const o=a.map((t=>t.name));return s.value.forEach((s=>{let a={};o.forEach((r=>a[r]=t.role_permissions_repository.get(s,r,!1))),r[s]=a})),r})),add_permission=async(s,a)=>{await message_bus_MessageBus.handle(new AddPermission(s,a),t)},delete_permission=async(s,a)=>{await message_bus_MessageBus.handle(new DeletePermission(s,a),t)},n=(0,i.iH)(""),add_role=async()=>{await message_bus_MessageBus.handle(new AddRole(n.value),t)},delete_role=async()=>{await message_bus_MessageBus.handle(new DeleteRole(n.value),t)};return(0,o.bv)((async()=>{await useBeforeEnterPage(t,["can_view_role","can_view_permission"]),await useGetRoles(t)})),{permission_names:a,role_variants:s,permissions:r,add_permission:add_permission,delete_permission:delete_permission,new_role:n,add_role:add_role,delete_role:delete_role}}};const yl=(0,qs.Z)(wl,[["render",PermissionSettingsPagevue_type_template_id_9ea14bf8_scoped_true_render],["__scopeId","data-v-9ea14bf8"]]);var bl=yl;const Rl={class:"page"},Fl={class:"page__container"},Dl={class:"page__editblock"},xl={class:"page__editrow"};function UserGroupSettingsPagevue_type_template_id_3efc68f5_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),l=(0,o.up)("base-form"),d=(0,o.up)("btn-component"),p=(0,o.up)("search-component");return(0,o.wg)(),(0,o.iD)("div",Rl,[(0,o.Wm)(_,{class:"page__heading",text:"Группы пользователей",size:"middle"}),(0,o._)("div",Fl,[(0,o._)("div",Dl,[(0,o.Wm)(l,{class:"page__form",attributes:r.current,settings:r.form_pages,is_edit_mode:!0,is_header_required:!1,onUpdate:s[0]||(s[0]=t=>r.handle_update_attribute(t.name,t.value))},null,8,["attributes","settings"]),(0,o._)("div",xl,[r.can_add&&!r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:0,class:"page__button",onClick:s[1]||(s[1]=t=>r.add_action()),caption:"Добавить",type:"primary",disabled:!r.is_edit_block_valid},null,8,["disabled"])):(0,o.kq)("",!0),r.can_change&&r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:1,class:"page__button",onClick:s[2]||(s[2]=t=>r.update_action()),caption:"Сохранить",type:"success",disabled:!r.is_edit_block_valid},null,8,["disabled"])):(0,o.kq)("",!0),r.can_delete&&r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:2,class:"page__button",onClick:s[3]||(s[3]=t=>r.delete_action()),caption:"Удалить",type:"danger"})):(0,o.kq)("",!0)])]),(0,o.Wm)(p,{class:"page__searchblock",schema:r.search_schema,model_objects:r.model_objects,convert_obj_to_item:r.convert_model_to_item,current_id:r.current_id,sort_by:"name",search_time:r.search_time,is_searching:r.is_searching,should_emit_search_event_on_any_keypress:!0,onChoose:s[4]||(s[4]=t=>r.current_id=t),onSearch:s[5]||(s[5]=t=>r.search_action(t))},null,8,["schema","model_objects","convert_obj_to_item","current_id","search_time","is_searching"])])])}var kl={components:{HeadingComponent:Us,BtnComponent:Es,BaseForm:ni,SearchComponent:P_},name:"UserGroupSettingsPage",setup(){const t=new VueUnitOfWork,convert_model_to_item=t=>({id:t.id,attributes:{id:t.id.toString(),name:t.name,slug:t.slug,is_private:!0===t.is_private?"Y":"N"},actions:{}}),s=(0,i.iH)({}),a=(0,o.Fl)((()=>filterArrayOfObjectsByQuery(t.usergroup_repository.values().map((t=>t.value)),s.value))),r=t.permission_repository.has("can_add_usergroup"),n=t.permission_repository.has("can_change_usergroup"),_=t.permission_repository.has("can_delete_usergroup"),l=(0,i.iH)(0),d=(0,i.iH)(!1),search_action=t=>s.value=t,p=[{name:"id",size:"w50",fields:[{placeholder:"ID",rule:"exact"}]},{name:"name",grow:!0,size:"w300",fields:[{placeholder:"Наименование",rule:"icontains"}]},{name:"slug",grow:!0,size:"w300",fields:[{placeholder:"Короткое имя",rule:"icontains"}]},{name:"is_private",size:"w30",align:"center",fields:[{type:"bool",placeholder:"Закрытая?",rule:"exact"}]}],c={id:null,name:"",slug:"",is_private:!0},u={},m={},{current_id:g,current:h,handle_update_attribute:f}=useCurrentMixin(c,t.usergroup_repository,m),v=(0,o.Fl)((()=>h.value.name.length>0)),add_action=async()=>{const s=new AddUserGroup(...["name","slug","is_private"].map((t=>convertObject(h.value,u)[t])));await message_bus_MessageBus.handle(s,t)},update_action=async()=>{const s=new UpdateUserGroup(...["id","name","slug","is_private"].map((t=>convertObject(h.value,u)[t])));await message_bus_MessageBus.handle(s,t)},delete_action=async()=>{const s=new DeleteUserGroup(g.value);await message_bus_MessageBus.handle(s,t),g.value=null},w=(0,o.Fl)((()=>[{size:"w450",fields:[{type:"FormTextField",bind:"id"},{type:"FormTextField",parameters:{font_weight:"bold"},value:"Наименование:"},{type:"FormTextInput",bind:"name"},{type:"FormTextField",parameters:{font_weight:"bold"},value:"Короткое имя (slug):"},{type:"FormTextInput",bind:"slug"},{type:"FormTextField",parameters:{font_weight:"bold"},value:"Закрытая группа ?"},{type:"FormBooleanInput",parameters:{size:20},bind:"is_private"}]}]));return(0,o.bv)((async()=>{await useBeforeEnterPage(t,["can_view_usergroup","can_view_settings"]),await useGetUserGroups(t)})),{search_action:search_action,add_action:add_action,update_action:update_action,delete_action:delete_action,can_add:r,can_change:n,can_delete:_,current_id:g,current:h,is_edit_block_valid:v,handle_update_attribute:f,form_pages:w,search_schema:p,model_objects:a,convert_model_to_item:convert_model_to_item,search_time:l,is_searching:d}}};const ql=(0,qs.Z)(kl,[["render",UserGroupSettingsPagevue_type_template_id_3efc68f5_scoped_true_render],["__scopeId","data-v-3efc68f5"]]);var Sl=ql;const El={class:"page"},Al={class:"page__container"},Cl={class:"page__halfcontainer halfcontainer"},Ul={class:"page__titleblock"},Pl={class:"halfcontainer__searchblock searchblock"},jl={class:"page__halfcontainer halfcontainer"},Ml={class:"page__titleblock"},Tl={class:"halfcontainer__searchblock searchblock"};function UsersInUserGroupsSettingsPagevue_type_template_id_27907846_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),l=(0,o.up)("form-text-field"),d=(0,o.up)("form-text-input"),p=(0,o.up)("user-item"),c=(0,o.up)("form-select-input");return(0,o.wg)(),(0,o.iD)("div",El,[(0,o.Wm)(_,{class:"page__heading",text:"Пользователи в группах",size:"middle"}),(0,o._)("div",Al,[(0,o._)("div",Cl,[(0,o._)("div",Ul,[(0,o.Wm)(l,{class:"halfcontainer__title",value:"Все пользователи:"})]),(0,o._)("div",Pl,[(0,o.Wm)(d,{class:"searchblock__searchinput searchinput",value:r.query_left.last_name,parameters:{placeholder:"Фамилия"},onUpdate:s[0]||(s[0]=t=>r.query_left.last_name=t)},null,8,["value"]),(0,o.Wm)(d,{class:"searchblock__searchinput searchinput",value:r.query_left.first_name,parameters:{placeholder:"Имя"},onUpdate:s[1]||(s[1]=t=>r.query_left.first_name=t)},null,8,["value"]),(0,o.Wm)(d,{class:"searchblock__searchinput searchinput",value:r.query_left.username,parameters:{placeholder:"Имя пользователя"},"onUpdate:value":s[2]||(s[2]=t=>r.query_left.username=t)},null,8,["value"])]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.users_excluded_from_group,(t=>((0,o.wg)(),(0,o.j4)(p,{class:"searchblock__useritem",key:t.username,obj:t,can_delete:!1,can_add:!0,onAdd:s=>r.handle_add(t)},null,8,["obj","onAdd"])))),128))]),(0,o._)("div",jl,[(0,o._)("div",Ml,[(0,o.Wm)(l,{class:"halfcontainer__title",value:"Группа:"}),(0,o.Wm)(c,{class:"halfcontainer__selectgroup",parameters:{options:r.groups},value:r.group_id.toString(),onUpdate:s[3]||(s[3]=t=>r.group_id=Number.parseInt(t))},null,8,["parameters","value"])]),(0,o._)("div",Tl,[(0,o.Wm)(d,{class:"searchblock__searchinput searchinput",parameters:{placeholder:"Фамилия"},value:r.query_right.last_name,onUpdate:s[4]||(s[4]=t=>r.query_right.last_name=t)},null,8,["value"]),(0,o.Wm)(d,{class:"searchblock__searchinput searchinput",parameters:{placeholder:"Имя"},value:r.query_right.first_name,onUpdate:s[5]||(s[5]=t=>r.query_right.first_name=t)},null,8,["value"]),(0,o.Wm)(d,{class:"searchblock__searchinput searchinput",value:r.query_right.username,parameters:{placeholder:"Имя пользователя"},onUpdate:s[6]||(s[6]=t=>r.query_right.username=t)},null,8,["value"])]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.users_included_to_group,(t=>((0,o.wg)(),(0,o.j4)(p,{class:"searchblock__useritem",key:t.username,obj:t,can_delete:!0,can_add:!1,onDelete:s=>r.handle_delete(t)},null,8,["obj","onDelete"])))),128))])])])}var Nl={name:"UsersInUserGroupsSettingsPage",components:{HeadingComponent:Us,UserItem:V_,FormTextInput:Ns,FormTextField:ra,FormSelectInput:er},setup(){const t=new VueUnitOfWork,s=(0,o.Fl)((()=>{let s=t.usergroup_repository.values().map((t=>({id:t.value.id,name:t.value.name,value:t.value.id.toString()})));return s.sort(((t,s)=>t.name.localeCompare(s.name))),s})),a=(0,i.iH)(0);(0,o.YP)(s,(t=>{0===a.value&&t.length>0&&(a.value=t[0].id)}));const r=(0,o.Fl)((()=>{if(0===a.value)return[];const s=t.usergroup_repository.get(a.value);return s.value.users.map((t=>t.username))})),n=(0,o.Fl)((()=>{let s=filterArrayOfObjects(t.user_repository.values().map((t=>t.value)),d);return null===s&&(s=[]),s=s.filter((t=>r.value.includes(t.username))),s})),_=(0,o.Fl)((()=>{let s=filterArrayOfObjects(t.user_repository.values().map((t=>t.value)),l);return null===s&&(s=[]),s=s.filter((t=>!r.value.includes(t.username))),s})),handle_add=async s=>{await message_bus_MessageBus.handle(new AddUserToUserGroup(a.value,s.username),t)},handle_delete=async s=>{await message_bus_MessageBus.handle(new DeleteUserFromUserGroup(a.value,s.username),t)},l=(0,i.qj)({username:"",first_name:"",last_name:""}),d=(0,i.qj)({username:"",first_name:"",last_name:""});return(0,o.bv)((async()=>{await useBeforeEnterPage(t,["can_view_usergroup"]),await Promise.all([useGetUsers(t),useGetUserGroups(t)])})),{groups:s,group_id:a,actual_group_usernames:r,users_included_to_group:n,users_excluded_from_group:_,query_left:l,query_right:d,handle_add:handle_add,handle_delete:handle_delete}}};const Il=(0,qs.Z)(Nl,[["render",UsersInUserGroupsSettingsPagevue_type_template_id_27907846_scoped_true_render],["__scopeId","data-v-27907846"]]);var Bl=Il;const Ol={class:"page"},zl={class:"page__container"};function ServerSettingsPagevue_type_template_id_3012b6e8_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),l=(0,o.up)("form-text-field"),d=(0,o.up)("form-text-input"),p=(0,o.up)("btn-component");return(0,o.wg)(),(0,o.iD)("div",Ol,[(0,o.Wm)(_,{class:"page__heading",text:"Серверные переменные",size:"middle"}),(0,o._)("div",zl,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.items,(t=>((0,o.wg)(),(0,o.iD)("div",{class:"page__row",key:t.id},[(0,o.Wm)(l,{class:"page__rowitem page__rowitem_name",parameters:{align:"left"},value:t.name},null,8,["value"]),(0,o.Wm)(d,{class:"page__rowitem page__rowitem_value",value:t.value,onUpdate:s=>t.value=s},null,8,["value","onUpdate"]),t.has_modified&&r.can_change?((0,o.wg)(),(0,o.j4)(p,{key:0,class:"page__button",onClick:s=>r.update_action(t.id,t.value),caption:"Сохранить",type:"warning",size:"small"},null,8,["onClick"])):(0,o.kq)("",!0)])))),128))])])}var Wl={components:{HeadingComponent:Us,BtnComponent:Es,FormTextInput:Ns,FormTextField:ra},name:"ServerSettingSettingsPage",setup(){const t=new VueUnitOfWork,s=(0,o.Fl)((()=>{let s=t.server_setting_repository.values().map((t=>t.value));return s.sort(((t,s)=>t.name.localeCompare(s.name))),s})),a=t.permission_repository.has("can_change_serversetting"),update_action=async(s,a)=>{const r=new UpdateServerSetting(s,a);await message_bus_MessageBus.handle(r,t)};return(0,o.bv)((async()=>{await useBeforeEnterPage(t,["can_view_settings"]),await useGetServerSettings(t)})),{items:s,update_action:update_action,can_change:a}}};const Gl=(0,qs.Z)(Wl,[["render",ServerSettingsPagevue_type_template_id_3012b6e8_scoped_true_render],["__scopeId","data-v-3012b6e8"]]);var Zl=Gl;const Hl={class:"page"},$l={class:"page__container"},Ll={class:"page__editblock"},Vl={class:"page__editrow"};function CounterSettingsPagevue_type_template_id_78bfade5_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),l=(0,o.up)("base-form"),d=(0,o.up)("btn-component"),p=(0,o.up)("search-component");return(0,o.wg)(),(0,o.iD)("div",Hl,[(0,o.Wm)(_,{class:"page__heading",text:"Счетчики",size:"middle"}),(0,o._)("div",$l,[(0,o._)("div",Ll,[(0,o.Wm)(l,{class:"page__form",attributes:r.current,settings:r.form_pages,is_edit_mode:!0,is_header_required:!1,onUpdate:s[0]||(s[0]=t=>r.handle_update_attribute(t.name,t.value))},null,8,["attributes","settings"]),(0,o._)("div",Vl,[r.can_add&&!r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:0,class:"page__button",onClick:s[1]||(s[1]=t=>r.add_action()),caption:"Добавить",type:"primary",disabled:!r.is_edit_block_valid},null,8,["disabled"])):(0,o.kq)("",!0),r.can_change&&r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:1,class:"page__button",onClick:s[2]||(s[2]=t=>r.update_action()),caption:"Сохранить",type:"success",disabled:!r.is_edit_block_valid},null,8,["disabled"])):(0,o.kq)("",!0),r.can_delete&&r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:2,class:"page__button",onClick:s[3]||(s[3]=t=>r.delete_action()),caption:"Удалить",type:"danger"})):(0,o.kq)("",!0)])]),(0,o.Wm)(p,{class:"page__searchblock",schema:r.search_schema,model_objects:r.model_objects,convert_obj_to_item:r.convert_model_to_item,current_id:r.current_id,sort_by:"name",search_time:r.search_time,is_searching:r.is_searching,should_emit_search_event_on_any_keypress:!0,onChoose:s[4]||(s[4]=t=>r.current_id=t),onSearch:s[5]||(s[5]=t=>r.search_action(t))},null,8,["schema","model_objects","convert_obj_to_item","current_id","search_time","is_searching"])])])}var Jl={components:{HeadingComponent:Us,BtnComponent:Es,BaseForm:ni,SearchComponent:P_},name:"CounterSettingsPage",setup(){const t=new VueUnitOfWork,convert_model_to_item=t=>({id:t.id,attributes:{id:t.id.toString(),name:t.name,description:t.description,value:t.value,increment:t.increment},actions:{}}),s=(0,i.iH)({}),a=(0,o.Fl)((()=>filterArrayOfObjectsByQuery(t.counter_repository.values().map((t=>t.value)),s.value))),r=t.permission_repository.has("can_add_counter"),n=t.permission_repository.has("can_change_counter"),_=t.permission_repository.has("can_delete_counter"),l=(0,i.iH)(0),d=(0,i.iH)(!1),search_action=t=>s.value=t,p=[{name:"id",size:"w50",fields:[{placeholder:"ID",rule:"exact"}]},{name:"name",size:"w300",grow:!0,fields:[{placeholder:"Наименование",rule:"icontains"}]},{name:"description",size:"w300",grow:!0,align:"left",fields:[{placeholder:"Описание",rule:"exact"}]},{name:"value",size:"w150",fields:[{placeholder:"Значение",rule:"icontains"}]},{name:"increment",size:"w150",fields:[{placeholder:"Приращение",rule:"icontains"}]}],c={id:null,name:"",description:"",value:0,increment:1},u={value:parseInt,increment:parseInt},m={value:t=>t.toString(),increment:t=>t.toString()},{current_id:g,current:h,handle_update_attribute:f}=useCurrentMixin(c,t.counter_repository,m),v=(0,o.Fl)((()=>h.value.name.length>0&&h.value.description.length>0&&h.value.value>=0)),add_action=async()=>{const s=new AddCounter(...["name","description","value","increment"].map((t=>convertObject(h.value,u)[t])));await message_bus_MessageBus.handle(s,t)},update_action=async()=>{const s=new UpdateCounter(...["id","name","description","value","increment"].map((t=>convertObject(h.value,u)[t])));await message_bus_MessageBus.handle(s,t)},delete_action=async()=>{const s=new DeleteCounter(g.value);await message_bus_MessageBus.handle(s,t),g.value=null},w=[{size:400,fields:[{type:"FormTextField",value:"Наименование:"},{type:"FormTextInput",bind:"name"},{type:"FormTextField",value:"Описание:"},{type:"FormTextInput",bind:"description"},{type:"FormTextField",value:"Значение:"},{type:"FormTextInput",bind:"value"},{type:"FormTextField",value:"Шаг:"},{type:"FormTextInput",bind:"increment"}]}];return(0,o.bv)((async()=>{await useBeforeEnterPage(t,["can_view_counter","can_view_settings"]),await useGetCounters(t)})),{search_action:search_action,add_action:add_action,update_action:update_action,delete_action:delete_action,can_add:r,can_change:n,can_delete:_,current_id:g,current:h,is_edit_block_valid:v,handle_update_attribute:f,form_pages:w,search_schema:p,model_objects:a,convert_model_to_item:convert_model_to_item,search_time:l,is_searching:d}}};const Yl=(0,qs.Z)(Jl,[["render",CounterSettingsPagevue_type_template_id_78bfade5_scoped_true_render],["__scopeId","data-v-78bfade5"]]);var Kl=Yl;const Xl={class:"page"},Ql={class:"page__container"},ed={class:"page__editblock"},td={class:"page__editrow"};function MailBoxSettingsPagevue_type_template_id_ef6ff230_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),l=(0,o.up)("base-form"),d=(0,o.up)("btn-component"),p=(0,o.up)("search-component");return(0,o.wg)(),(0,o.iD)("div",Xl,[(0,o.Wm)(_,{class:"page__heading",text:"Почтовые ящики",size:"middle"}),(0,o._)("div",Ql,[(0,o._)("div",ed,[(0,o.Wm)(l,{class:"page__form",attributes:r.current,settings:r.form_pages,is_edit_mode:!0,is_header_required:!1,onUpdate:s[0]||(s[0]=t=>r.handle_update_attribute(t.name,t.value))},null,8,["attributes","settings"]),(0,o._)("div",td,[r.can_add&&!r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:0,class:"page__button",onClick:s[1]||(s[1]=t=>r.add_action()),caption:"Добавить",type:"primary",disabled:!r.is_edit_block_valid},null,8,["disabled"])):(0,o.kq)("",!0),r.can_change&&r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:1,class:"page__button",onClick:s[2]||(s[2]=t=>r.update_action()),caption:"Сохранить",type:"success",disabled:!r.is_edit_block_valid},null,8,["disabled"])):(0,o.kq)("",!0),r.can_delete&&r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:2,class:"page__button",onClick:s[3]||(s[3]=t=>r.delete_action()),caption:"Удалить",type:"danger"})):(0,o.kq)("",!0)])]),(0,o.Wm)(p,{class:"page__searchblock",schema:r.search_schema,model_objects:r.model_objects,convert_obj_to_item:r.convert_model_to_item,current_id:r.current_id,sort_by:"name",search_time:r.search_time,is_searching:r.is_searching,should_emit_search_event_on_any_keypress:!0,onChoose:s[4]||(s[4]=t=>r.current_id=t),onSearch:s[5]||(s[5]=t=>r.search_action(t))},null,8,["schema","model_objects","convert_obj_to_item","current_id","search_time","is_searching"])])])}var sd={components:{HeadingComponent:Us,BtnComponent:Es,BaseForm:ni,SearchComponent:P_},name:"MailBoxSettingsPage",setup(){const t=new VueUnitOfWork,convert_model_to_item=t=>({id:t.id,attributes:{id:t.id.toString(),name:t.name,username:t.username,password:t.password,out_protocol:t.out_protocol,out_encryption:t.out_encryption,out_port:t.out_port,out_server:t.out_server,in_protocol:t.in_protocol,in_encryption:t.in_encryption,in_port:t.in_port,in_server:t.in_server},actions:{}}),s=(0,i.iH)({}),a=(0,o.Fl)((()=>filterArrayOfObjectsByQuery(t.mailbox_repository.values().map((t=>t.value)),s.value))),r=t.permission_repository.has("can_add_mailbox"),n=t.permission_repository.has("can_change_mailbox"),_=t.permission_repository.has("can_delete_mailbox"),l=(0,i.iH)(0),d=(0,i.iH)(!1),search_action=t=>s.value=t,p=[{name:"id",size:"w50",fields:[{placeholder:"ID",rule:"exact"}]},{name:"name",size:"w300",grow:!0,fields:[{placeholder:"Наименование",rule:"icontains"}]},{name:"username",size:"w300",grow:!0,align:"left",fields:[{placeholder:"Имя пользователя",rule:"exact"}]}],c={id:null,name:"",username:"",password:"",out_protocol:"SMTP",in_protocol:"IMAP",out_encryption:"NONE",in_encryption:"NONE",out_port:25,in_port:143,out_server:"",in_server:""},u={in_port:parseInt,out_port:parseInt},m={in_port:t=>t.toString(),out_port:t=>t.toString()},{current_id:g,current:h,handle_update_attribute:f}=useCurrentMixin(c,t.mailbox_repository,m),v=(0,o.Fl)((()=>h.value.name.length>0&&h.value.username.length>0&&h.value.password.length>0&&h.value.out_protocol.length>0&&h.value.in_protocol.length>0&&h.value.out_encryption.length>0&&h.value.in_encryption.length>0&&h.value.out_port>0&&h.value.out_port<1e3&&h.value.in_port>0&&h.value.in_port<1e3&&h.value.out_server.length>0&&h.value.in_server.length>0)),add_action=async()=>{const s=new AddMailBox(...["out_protocol","out_encryption","out_port","out_server","in_protocol","in_encryption","in_port","in_server","username","password","name"].map((t=>convertObject(h.value,u)[t])));await message_bus_MessageBus.handle(s,t)},update_action=async()=>{const s=new UpdateMailBox(...["id","out_protocol","out_encryption","out_port","out_server","in_protocol","in_encryption","in_port","in_server","username","password","name"].map((t=>convertObject(h.value,u)[t])));await message_bus_MessageBus.handle(s,t)},delete_action=async()=>{const s=new DeleteMailBox(g.value);await message_bus_MessageBus.handle(s,t),g.value=null},w=[{name:"NONE",value:"NONE"},{name:"STARTTLS",value:"STARTTLS"},{name:"SSL/TLS",value:"SSL/TLS"}],y=[{size:"w600",fields:[{type:"FormTextField",value:"Наименование:"},{type:"FormTextInput",bind:"name"},{type:"FormTextField",value:"Имя пользователя:"},{type:"FormTextInput",bind:"username"},{type:"FormTextField",value:"Пароль:"},{type:"FormTextInput",parameters:{secure:!0},bind:"password"},{type:"FormTextField",value:"Протокол исходящих писем:"},{type:"FormSelectInput",parameters:{options:[{name:"SMTP",value:"SMTP"}]},bind:"out_protocol"},{type:"FormTextField",value:"Шифрование исходящих писем:"},{type:"FormSelectInput",parameters:{options:w},bind:"out_encryption"},{type:"FormTextField",value:"Порт исходящих писем:"},{type:"FormTextInput",bind:"out_port"},{type:"FormTextField",value:"Сервер исходящих писем:"},{type:"FormTextInput",bind:"out_server"},{type:"FormTextField",value:"Протокол входящих писем:"},{type:"FormSelectInput",parameters:{options:[{name:"IMAP",value:"IMAP"}]},bind:"in_protocol"},{type:"FormTextField",value:"Шифрование входящих писем:"},{type:"FormSelectInput",parameters:{options:w},bind:"in_encryption"},{type:"FormTextField",value:"Порт входящих писем:"},{type:"FormTextInput",bind:"in_port"},{type:"FormTextField",value:"Сервер входящих писем:"},{type:"FormTextInput",bind:"in_server"}]}];return(0,o.bv)((async()=>{await useBeforeEnterPage(t,["can_view_mailbox","can_view_settings"]),await useGetMailBoxes(t)})),{search_action:search_action,add_action:add_action,update_action:update_action,delete_action:delete_action,can_add:r,can_change:n,can_delete:_,current_id:g,current:h,is_edit_block_valid:v,handle_update_attribute:f,form_pages:y,search_schema:p,model_objects:a,convert_model_to_item:convert_model_to_item,search_time:l,is_searching:d}}};const ad=(0,qs.Z)(sd,[["render",MailBoxSettingsPagevue_type_template_id_ef6ff230_scoped_true_render],["__scopeId","data-v-ef6ff230"]]);var rd=ad;const od={class:"page"},nd={class:"page__container"},id={class:"page__editblock"},_d={class:"page__editrow"};function MailChannelSettingsPagevue_type_template_id_2b02d070_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),l=(0,o.up)("base-form"),d=(0,o.up)("btn-component"),p=(0,o.up)("search-component");return(0,o.wg)(),(0,o.iD)("div",od,[(0,o.Wm)(_,{class:"page__heading",text:"Почтовые каналы",size:"middle"}),(0,o._)("div",nd,[(0,o._)("div",id,[(0,o.Wm)(l,{class:"page__form",attributes:r.current,settings:r.form_pages,is_edit_mode:!0,is_header_required:!1,onUpdate:s[0]||(s[0]=t=>r.handle_update_attribute(t.name,t.value))},null,8,["attributes","settings"]),(0,o._)("div",_d,[r.can_add&&!r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:0,class:"page__button",onClick:s[1]||(s[1]=t=>r.add_action()),caption:"Добавить",type:"primary",disabled:!r.is_edit_block_valid},null,8,["disabled"])):(0,o.kq)("",!0),r.can_change&&r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:1,class:"page__button",onClick:s[2]||(s[2]=t=>r.update_action()),caption:"Сохранить",type:"success",disabled:!r.is_edit_block_valid},null,8,["disabled"])):(0,o.kq)("",!0),r.can_delete&&r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:2,class:"page__button",onClick:s[3]||(s[3]=t=>r.delete_action()),caption:"Удалить",type:"danger"})):(0,o.kq)("",!0)])]),(0,o.Wm)(p,{class:"page__searchblock",schema:r.search_schema,model_objects:r.model_objects,convert_obj_to_item:r.convert_model_to_item,current_id:r.current_id,sort_by:"name",search_time:r.search_time,is_searching:r.is_searching,should_emit_search_event_on_any_keypress:!0,onChoose:s[4]||(s[4]=t=>r.current_id=t),onSearch:s[5]||(s[5]=t=>r.search_action(t))},null,8,["schema","model_objects","convert_obj_to_item","current_id","search_time","is_searching"])])])}var ld={components:{HeadingComponent:Us,BtnComponent:Es,BaseForm:ni,SearchComponent:P_},name:"MailChannelSettingsPage",setup(){const t=new VueUnitOfWork,convert_model_to_item=t=>({id:t.id,attributes:{id:t.id.toString(),name:t.name,folder:t.folder,storage_path:t.storage_path,settings:t.settings,is_active:!0===t.is_active?"Y":"N"},actions:{}}),s=(0,i.iH)({}),a=(0,o.Fl)((()=>filterArrayOfObjectsByQuery(t.mail_channel_repository.values().map((t=>t.value)),s.value))),r=t.permission_repository.has("can_add_mailchannel"),n=t.permission_repository.has("can_change_mailchannel"),_=t.permission_repository.has("can_delete_mailchannel"),l=t.permission_repository.has("can_fetch_mailchannel"),d=(0,i.iH)(0),p=(0,i.iH)(!1),search_action=t=>s.value=t,c=[{name:"id",size:"w50",fields:[{placeholder:"ID",rule:"exact"}]},{name:"name",size:"w200",align:"left",grow:!0,fields:[{placeholder:"Наименование",rule:"icontains"}]},{name:"folder",size:"w300",fields:[{placeholder:"Выборка",rule:"icontains"}]},{name:"storage_path",size:"w300",fields:[{placeholder:"Хранилище",rule:"icontains"}]},{name:"is_active",size:"w30",fields:[{type:"bool",placeholder:"Активен?",rule:"exact"}]}],u={id:null,name:"",folder:"",storage_path:"",settings:"",is_active:!1},m={settings:t=>JSON.parse(t)},g={settings:t=>JSON.stringify(t,null,3)},{current_id:h,current:f,handle_update_attribute:v}=useCurrentMixin(u,t.mail_channel_repository,g),w=(0,o.Fl)((()=>validate_json(f.value.settings,Pt))),y=(0,o.Fl)((()=>f.value.name.length>0&&f.value.folder.length>0&&f.value.storage_path.length>0&&w.value)),b=(0,o.Fl)((()=>[{size:"w500",fields:[{type:"FormTextField",value:"Наименование:"},{type:"FormTextInput",bind:"name"},{type:"FormTextField",value:"Наименование папки"},{type:"FormTextInput",bind:"folder"},{type:"FormTextField",value:"Название хранилища / имя папки:"},{type:"FormTextInput",bind:"storage_path"},{type:"FormTextField",value:"Активен ?"},{type:"FormBooleanInput",bind:"is_active"},{type:"FormTextField",value:"Описание в формате JSON"},{type:"FormMultilineTextInput",parameters:{rows:15,resize:"vertical",color:w.value?"green":"red"},bind:"settings"}]}])),add_action=async()=>{const s=new AddMailChannel(...["name","folder","storage_path","settings","is_active"].map((t=>convertObject(f.value,m)[t])));await message_bus_MessageBus.handle(s,t)},update_action=async()=>{const s=new UpdateMailChannel(...["id","name","folder","storage_path","settings","is_active"].map((t=>convertObject(f.value,m)[t])));await message_bus_MessageBus.handle(s,t)},delete_action=async()=>{const s=new DeleteMailChannel(h.value);await message_bus_MessageBus.handle(s,t),h.value=null},fetch_action=async s=>{const a=new FetchMailChannel(s);await message_bus_MessageBus.handle(a,t)};return(0,o.bv)((async()=>{await useBeforeEnterPage(t,["can_view_mailchannel","can_view_settings"]),await useGetMailChannels(t)})),{search_action:search_action,add_action:add_action,update_action:update_action,delete_action:delete_action,fetch_action:fetch_action,can_add:r,can_change:n,can_delete:_,can_fetch:l,current_id:h,current:f,is_settings_valid:w,is_edit_block_valid:y,handle_update_attribute:v,form_pages:b,search_schema:c,model_objects:a,convert_model_to_item:convert_model_to_item,search_time:d,is_searching:p}}};const dd=(0,qs.Z)(ld,[["render",MailChannelSettingsPagevue_type_template_id_2b02d070_scoped_true_render],["__scopeId","data-v-2b02d070"]]);var pd=dd;const cd={class:"page"},ud={class:"page__container"},md={class:"page__halfcontainer halfcontainer"},gd={class:"page__titleblock"},hd={class:"halfcontainer__searchblock searchblock"},fd={class:"page__halfcontainer halfcontainer"},vd={class:"page__titleblock"},wd={class:"halfcontainer__searchblock searchblock"};function MailChannelsInMailBoxesSettingsPagevue_type_template_id_3a6d5912_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),l=(0,o.up)("form-text-field"),d=(0,o.up)("form-text-input"),p=(0,o.up)("group-item"),c=(0,o.up)("form-select-input");return(0,o.wg)(),(0,o.iD)("div",cd,[(0,o.Wm)(_,{class:"page__heading",text:"Привязка почтовых каналов к ящикам",size:"middle"}),(0,o._)("div",ud,[(0,o._)("div",md,[(0,o._)("div",gd,[(0,o.Wm)(l,{class:"halfcontainer__title",value:"Все почтовые каналы:"})]),(0,o._)("div",hd,[(0,o.Wm)(d,{class:"searchblock__searchinput searchinput",value:r.query_left.name,parameters:{placeholder:"Наименование"},onUpdate:s[0]||(s[0]=t=>r.query_left.name=t)},null,8,["value"])]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.items_excluded_from_group,(t=>((0,o.wg)(),(0,o.j4)(p,{class:"searchblock__groupitem",key:t.id,description:t.name,can_delete:!1,can_add:!0,onAdd:s=>r.handle_add(t)},null,8,["description","onAdd"])))),128))]),(0,o._)("div",fd,[(0,o._)("div",vd,[(0,o.Wm)(l,{class:"halfcontainer__title",value:"Почтовый ящик:"}),(0,o.Wm)(c,{class:"halfcontainer__selectgroup",parameters:{options:r.groups},value:r.group_id.toString(),onUpdate:s[1]||(s[1]=t=>r.group_id=Number.parseInt(t))},null,8,["parameters","value"])]),(0,o._)("div",wd,[(0,o.Wm)(d,{class:"searchblock__searchinput searchinput",value:r.query_right.name,parameters:{placeholder:"Наименование"},onUpdate:s[2]||(s[2]=t=>r.query_right.name=t)},null,8,["value"])]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.items_included_to_group,(t=>((0,o.wg)(),(0,o.j4)(p,{class:"searchblock__groupitem",key:t.id,description:t.name,can_delete:!0,can_add:!1,onDelete:s=>r.handle_delete(t)},null,8,["description","onDelete"])))),128))])])])}const yd={class:"groupitem"};function GroupItemvue_type_template_id_a0f86538_render(t,s,a,r,n,i){const _=(0,o.up)("form-text-field"),l=(0,o.up)("btn-component");return(0,o.wg)(),(0,o.iD)("div",yd,[(0,o.Wm)(_,{class:"groupitem__description",value:a.description},null,8,["value"]),a.can_add?((0,o.wg)(),(0,o.j4)(l,{key:0,class:"groupitem__button",caption:"Добавить",type:"success",onClick:s[0]||(s[0]=s=>t.$emit("add"))})):(0,o.kq)("",!0),a.can_delete?((0,o.wg)(),(0,o.j4)(l,{key:1,class:"groupitem__button",caption:"Удалить",type:"danger",onClick:s[1]||(s[1]=s=>t.$emit("delete"))})):(0,o.kq)("",!0)])}var bd={components:{FormTextField:ra,BtnComponent:Es},name:"GroupItem",props:{description:{type:String,required:!0},can_delete:{type:Boolean,required:!1,default:!1},can_add:{type:Boolean,required:!1,default:!1}},emits:["delete","add"]};const Rd=(0,qs.Z)(bd,[["render",GroupItemvue_type_template_id_a0f86538_render]]);var Fd=Rd,Dd={name:"MailChannelsInMailBoxesSettingsPage",components:{HeadingComponent:Us,GroupItem:Fd,FormTextInput:Ns,FormTextField:ra,FormSelectInput:er},setup(){const t=new VueUnitOfWork,s=(0,o.Fl)((()=>{let s=t.mailbox_repository.values().map((t=>({id:t.value.id,name:t.value.name,value:t.value.id.toString()})));return s.sort(((t,s)=>t.name.localeCompare(s.name))),s})),a=(0,i.iH)(0);(0,o.YP)(s,(t=>{0===a.value&&t.length>0&&(a.value=t[0].id)}));const r=(0,o.Fl)((()=>{if(0===a.value)return[];const s=t.mailbox_repository.get(a.value);return s.value.mail_channels.map((t=>t.id))})),n=(0,o.Fl)((()=>{let s=filterArrayOfObjects(t.mail_channel_repository.values().map((t=>t.value)),d);return null===s&&(s=[]),s=s.filter((t=>r.value.includes(t.id))),s})),_=(0,o.Fl)((()=>{let s=filterArrayOfObjects(t.mail_channel_repository.values().map((t=>t.value)),l);return null===s&&(s=[]),s=s.filter((t=>!r.value.includes(t.id))),s})),handle_add=async s=>{await message_bus_MessageBus.handle(new AddMailChannelToMailBox(a.value,s.id),t)},handle_delete=async s=>{await message_bus_MessageBus.handle(new DeleteMailChannelFromMailBox(a.value,s.id),t)},l=(0,i.qj)({name:""}),d=(0,i.qj)({name:""});return(0,o.bv)((async()=>{await useBeforeEnterPage(t,["can_view_mailbox"]),await Promise.all([useGetMailBoxes(t),useGetMailChannels(t)])})),{groups:s,group_id:a,actual_group_ids:r,items_included_to_group:n,items_excluded_from_group:_,query_left:l,query_right:d,handle_add:handle_add,handle_delete:handle_delete}}};const xd=(0,qs.Z)(Dd,[["render",MailChannelsInMailBoxesSettingsPagevue_type_template_id_3a6d5912_scoped_true_render],["__scopeId","data-v-3a6d5912"]]);var kd=xd;const qd={class:"page"},Sd={class:"page__container"},Ed={class:"page__searchblock"},Ad={class:"page__searchrow"},Cd={class:"page__buttonrow"},Ud={class:"page__buttonrow"},Pd={class:"page__buttonrow"},jd={class:"page__buttonrow"};function MailMessagesPagevue_type_template_id_f9d191fa_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),l=(0,o.up)("toggle-text-button"),d=(0,o.up)("text-button"),p=(0,o.up)("search-component");return(0,o.wg)(),(0,o.iD)("div",qd,[(0,o.Wm)(_,{class:"page__heading",text:"Письма",size:"middle"}),(0,o._)("div",Sd,[(0,o._)("div",Ed,[(0,o._)("div",Ad,[(0,o.Wm)(l,{class:"page__buttonrow",activeTitle:"Скрыть файлы",passiveTitle:"Показать файлы",isActive:r.is_files_shown,onClick:s[0]||(s[0]=t=>r.is_files_shown=!r.is_files_shown)},null,8,["isActive"]),(0,o._)("div",Cd,[(0,o.Wm)(d,{class:"page__buttonrow page__buttonrow_red",title:"Удалить",onClick:s[1]||(s[1]=t=>r.perform_action_on_items("delete"))})]),(0,o._)("div",Ud,[(0,o.Wm)(d,{class:"page__buttonrow",title:"TEXT",onClick:s[2]||(s[2]=t=>r.perform_action_on_items("download_in_text_format"))})]),(0,o._)("div",Pd,[(0,o.Wm)(d,{class:"page__buttonrow",title:"HTML",onClick:s[3]||(s[3]=t=>r.perform_action_on_items("download_in_html_format"))})]),(0,o._)("div",jd,[(0,o.Wm)(d,{class:"page__buttonrow",title:"EML",onClick:s[4]||(s[4]=t=>r.perform_action_on_items("download_in_raw_format"))})])]),(0,o.Wm)(p,{class:"page__searchblock",schema:r.search_schema,model_objects:r.model_objects,convert_obj_to_item:r.convert_model_to_item,current_id:r.current_id,sort_by:"received_at",search_time:r.search_time,is_searching:r.is_searching,should_emit_search_event_on_any_keypress:!1,is_files_shown:r.is_files_shown,is_selection_required:!0,onChoose:s[5]||(s[5]=t=>r.current_id=t),onSearch:s[6]||(s[6]=t=>r.search_action(t)),"onDownload:file":s[7]||(s[7]=t=>r.handle_download_file(t)),"onCopy_link_to:file":s[8]||(s[8]=t=>r.handle_copy_link_to_file_into_clipboard(t)),onSelect:s[9]||(s[9]=t=>r.handle_change_selected_items(t))},null,8,["schema","model_objects","convert_obj_to_item","current_id","search_time","is_searching","is_files_shown"])])])])}var Md={components:{HeadingComponent:Us,TextButton:ya,ToggleTextButton:Ma,SearchComponent:P_},name:"MailMessagesPage",setup(){const t=(0,_.tv)(),s=new VueUnitOfWork,convert_model_to_item=t=>({id:t.id,attributes:{id:t.id.toString(),subject:t.subject,mailbox:s.mailbox_repository.get(t.mailbox).value?s.mailbox_repository.get(t.mailbox).value.name:t.mailbox.toString(),mailchannel:s.mail_channel_repository.get(t.mailchannel).value?s.mail_channel_repository.get(t.mailchannel).value.name:t.mailchannel.toString(),has_text:!0===t.has_text?"Y":"N",has_html:!0===t.has_html?"Y":"N",received_at:convertDateToDateTimeString(t.received_at)},attachments:t.attachments,actions:{delete:async()=>{await message_bus_MessageBus.handle(new DeleteMailMessage(t.id),s)},download_in_text_format:async()=>{await message_bus_MessageBus.handle(new DownloadMailMessageInTextFormat(t.id),s)},download_in_html_format:async()=>{await message_bus_MessageBus.handle(new DownloadMailMessageInHtmlFormat(t.id),s)},download_in_raw_format:async()=>{await message_bus_MessageBus.handle(new DownloadMailMessageInRawFormat(t.id),s)}}}),a=(0,i.iH)({}),r=(0,o.Fl)((()=>filterArrayOfObjectsByQuery(s.mail_message_repository.values().map((t=>t.value)),a.value))),n=(0,i.iH)(0),l=(0,i.iH)(!1),search_action=async t=>{await useExecutionTimeDecorator(s,new GetMailMessages(t),n,l)},d=(0,i.iH)(0),p=(0,i.iH)([]),handle_change_selected_items=t=>p.value=t,{perform_action_on_items:c}=usePerformActionMixin(p,1),u=(0,i.iH)(!1),handle_download_file=async({id:t,file:a,inline:r})=>{const o=new DownloadMailMessageAttachment(t,a.id,a.name,a.size,r);await message_bus_MessageBus.handle(o,s)},handle_copy_link_to_file_into_clipboard=({id:a,file:r})=>{const o=t.resolve({name:"DownloadMailMessageFilePage",params:{message_id:a,file_id:r.id}});navigator.clipboard.writeText(window.location.origin+o.href).then((()=>message_bus_MessageBus.handle(new FileLinkCopied,s)))};(0,o.bv)((async()=>{await useBeforeEnterPage(s,["can_view_mail","can_view_mailbox","can_view_mailchannel"]),await Promise.all([useGetMailBoxes(s),useGetMailChannels(s)])}));const m=[{name:"id",size:"w50",fields:[{placeholder:"ID",rule:"exact"}]},{name:"subject",size:"w200",grow:!0,align:"left",fields:[{placeholder:"Тема",rule:"icontains"}]},{name:"mailbox",size:"w200",fields:[{placeholder:"Ящик",rule:"icontains"}]},{name:"mailchannel",size:"w200",fields:[{placeholder:"Канал",rule:"icontains"}]},{name:"has_text",size:"w30",fields:[{type:"bool",placeholder:"Тело сообщения в формате text?",rule:"exact"}]},{name:"has_html",size:"w30",fields:[{type:"bool",placeholder:"Тело сообщения в формате html?",rule:"exact"}]},{name:"received_at",size:"w200",fields:[{placeholder:"Дата (от)",rule:"gte",re:"^\\d{2}\\.\\d{2}\\.\\d{4}$",converter:"date_to_iso_string"},{placeholder:"Дата (до)",rule:"lte",re:"^\\d{2}\\.\\d{2}\\.\\d{4}$",converter:"date_to_iso_string"}]}];return{current_id:d,perform_action_on_items:c,search_action:search_action,search_schema:m,model_objects:r,convert_model_to_item:convert_model_to_item,search_time:n,is_searching:l,is_files_shown:u,handle_download_file:handle_download_file,handle_copy_link_to_file_into_clipboard:handle_copy_link_to_file_into_clipboard,selected_items:p,handle_change_selected_items:handle_change_selected_items}}};const Td=(0,qs.Z)(Md,[["render",MailMessagesPagevue_type_template_id_f9d191fa_scoped_true_render],["__scopeId","data-v-f9d191fa"]]);var Nd=Td;const Id={class:"page"},Bd=(0,o.Uk)(" Объединить PDF файлы "),Od=(0,o.Uk)(" Файлообменник "),zd=(0,o.Uk)(" Самоподготовка к тестированию ");function ServicePagevue_type_template_id_f758b34a_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),l=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",Id,[(0,o.Wm)(_,{class:"page__heading",text:"Сервис",size:"middle"}),(0,o.Wm)(l,{class:"page__item",to:{name:"PdfMergeToolPage"}},{default:(0,o.w5)((()=>[Bd])),_:1}),(0,o.Wm)(l,{class:"page__item",to:{name:"ShareFilePage"}},{default:(0,o.w5)((()=>[Od])),_:1}),(0,o.Wm)(l,{class:"page__item",to:{name:"SelfTestingPage"}},{default:(0,o.w5)((()=>[zd])),_:1})])}var Wd={components:{HeadingComponent:Us},name:"ServicePage",setup(){const t=new VueUnitOfWork;(0,o.bv)((()=>{useBeforeEnterPage(t,["can_view_service"])}))}};const Gd=(0,qs.Z)(Wd,[["render",ServicePagevue_type_template_id_f758b34a_scoped_true_render],["__scopeId","data-v-f758b34a"]]);var Zd=Gd;const PdfMergeToolPagevue_type_template_id_0b86a7bb_scoped_true_withScopeId=t=>((0,o.dD)("data-v-0b86a7bb"),t=t(),(0,o.Cn)(),t),Hd={class:"page"},$d={class:"page__container"},Ld={class:"page__listcontainer"},Vd={class:"page__buttonblock buttonblock"},Jd={class:"page__headerblock headerblock"},Yd={class:"page__servicecontainer"},Kd={key:0,class:"page__dropzonetitle"},Xd=PdfMergeToolPagevue_type_template_id_0b86a7bb_scoped_true_withScopeId((()=>(0,o._)("div",{class:"page__explanation"},[(0,o._)("p",{class:"page__explanationblock"}," Данная страница предназначена для объединения PDF файлов. Доступен выбор диапазона и вращения страниц. "),(0,o._)("p",{class:"page__explanationblock"}," При объединении можно сохранить существующие в документах закладки, а также добавить закладки в начале каждого файла. "),(0,o._)("p",{class:"page__explanationblock page__explanationblock_important"}," При модификации файла (диапазон, вращение) функции работы с закладками недоступны. ")],-1)));function PdfMergeToolPagevue_type_template_id_0b86a7bb_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),d=(0,o.up)("text-button"),p=(0,o.up)("toggle-text-button"),c=(0,o.up)("form-text-field"),u=(0,o.up)("sized-div"),m=(0,o.up)("pdf-document-row"),g=(0,o.up)("file-drop-zone");return(0,o.wg)(),(0,o.iD)("div",Hd,[(0,o.Wm)(_,{class:"page__heading",text:"Объединить PDF файлы",size:"middle"}),(0,o._)("div",$d,[(0,o._)("div",Ld,[(0,o._)("div",Vd,[r.is_all_uploaded&&r.pdf_docs.length>0?((0,o.wg)(),(0,o.j4)(d,{key:0,class:"buttonblock__button",title:"Объединить",onClick:s[0]||(s[0]=t=>r.handle_download())})):(0,o.kq)("",!0),r.is_all_uploaded&&r.pdf_docs.length>0?((0,o.wg)(),(0,o.j4)(d,{key:1,class:"buttonblock__button buttonblock__button_important",title:"Удалить все",onClick:s[1]||(s[1]=t=>r.handle_delete_all())})):(0,o.kq)("",!0),r.to_be_editted?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(p,{key:2,class:"buttonblock__button",activeTitle:"Удалить закладки",passiveTitle:"Сохранить закладки",isActive:r.keep_bookmarks,onClick:s[2]||(s[2]=t=>r.keep_bookmarks=!r.keep_bookmarks)},null,8,["isActive"])),r.to_be_editted?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(p,{key:3,class:"buttonblock__button",activeTitle:"Не добавлять имена файлов в закладки",passiveTitle:"Добавить имена файлов в закладки",isActive:r.add_filenames_as_bookmarks,onClick:s[3]||(s[3]=t=>r.add_filenames_as_bookmarks=!r.add_filenames_as_bookmarks)},null,8,["isActive"])),r.is_all_uploaded&&r.pdf_docs.length>0&&r.is_same_page_count_and_not_edited?((0,o.wg)(),(0,o.j4)(d,{key:4,class:"buttonblock__button",title:"Слить одинаковые файлы",onClick:s[4]||(s[4]=t=>r.handle_merge_annotations())})):(0,o.kq)("",!0)]),(0,o._)("div",Jd,[(0,o.Wm)(u,{class:"headerblock__sizedblock",size:"w50"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{class:"headerblock__textfield",value:"%",parameters:{align:"center"}})])),_:1}),(0,o.Wm)(u,{class:"headerblock__sizedblock",size:"w50"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{class:"headerblock__textfield",value:"No."})])),_:1}),(0,o.Wm)(u,{class:"headerblock__sizedblock",size:"w100",grow:!0},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{class:"headerblock__textfield",value:"Наименование"})])),_:1}),(0,o.Wm)(u,{class:"headerblock__sizedblock headerblock__sizedblock_select",size:"w100"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{class:"headerblock__textfield",value:"От (стр.)"})])),_:1}),(0,o.Wm)(u,{class:"headerblock__sizedblock headerblock__sizedblock_select",size:"w100"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{class:"headerblock__textfield",value:"До (стр.)"})])),_:1}),(0,o.Wm)(u,{class:"headerblock__sizedblock headerblock__sizedblock_select",size:"w50"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{class:"headerblock__textfield",value:"Вращ."})])),_:1}),(0,o.Wm)(u,{class:"headerblock__sizedblock",size:"w50"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{class:"headerblock__textfield",value:"Вверх"})])),_:1}),(0,o.Wm)(u,{class:"headerblock__sizedblock",size:"w50"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{class:"headerblock__textfield",value:"Вниз"})])),_:1}),(0,o.Wm)(u,{class:"headerblock__sizedblock",size:"w100"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{class:"headerblock__textfield",value:"Кол-во стр."})])),_:1}),(0,o.Wm)(u,{class:"headerblock__sizedblock",size:"w100"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{class:"headerblock__textfield",value:"Размер"})])),_:1}),(0,o.Wm)(u,{class:"headerblock__sizedblock",size:"w100"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{class:"headerblock__textfield",value:""})])),_:1})]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.pdf_docs,(t=>((0,o.wg)(),(0,o.iD)("div",{class:"page__documentblock",key:t.id},[(0,o.Wm)(m,{class:"page__documentrow",order:t.order,page_count:t.page_count,page_to:t.page_to,page_from:t.page_from,angle:t.angle,name:t.file.name,progress:t.file.progress,size:t.file.formatted_size(),uploaded:t.uploaded,onDelete:s=>r.handle_delete(t.id),"onMove:up":s=>r.handle_move_up(t.id),"onMove:down":s=>r.handle_move_down(t.id),"onUpdate:page_from":s=>r.handle_update_page_from(t,s),"onUpdate:page_to":s=>r.handle_update_page_to(t,s),"onUpdate:angle":s=>r.handle_update_angle(t,s)},null,8,["order","page_count","page_to","page_from","angle","name","progress","size","uploaded","onDelete","onMove:up","onMove:down","onUpdate:page_from","onUpdate:page_to","onUpdate:angle"])])))),128))]),(0,o._)("div",Yd,[(0,o.Wm)(g,{class:(0,l.C_)(["page__filedropzone",{page__filedropzone_dragging:r.is_drag_above_file_zone}]),"onAdd:file":s[5]||(s[5]=t=>r.handle_new_file_drop(t)),"onUpdate:dragging":s[6]||(s[6]=t=>r.is_drag_above_file_zone=t)},{default:(0,o.w5)((()=>[r.is_drag_above_file_zone?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("span",Kd," < "+(0,l.zw)(r.max_file_size)+" МБ",1))])),_:1},8,["class"]),Xd])])])}const Qd={class:"pdfdocumentrow"};function PdfDocumentRowvue_type_template_id_4fb13056_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("form-text-field"),l=(0,o.up)("sized-div"),d=(0,o.up)("form-select-input"),p=(0,o.up)("text-button");return(0,o.wg)(),(0,o.iD)("div",Qd,[(0,o.Wm)(l,{class:"pdfdocumentrow__sizedblock",size:"w50"},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{class:"pdfdocumentrow__textfield",value:r.progress_str},null,8,["value"])])),_:1}),(0,o.Wm)(l,{class:"pdfdocumentrow__sizedblock",size:"w50"},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{class:"pdfdocumentrow__textfield",value:a.order.toString()},null,8,["value"])])),_:1}),(0,o.Wm)(l,{class:"pdfdocumentrow__sizedblock",size:"w100",grow:!0},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{class:"pdfdocumentrow__textfield",value:a.name},null,8,["value"])])),_:1}),(0,o.Wm)(l,{class:"pdfdocumentrow__selectsizedblock",size:"w100"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{class:"pdfdocumentrow__selectinput",parameters:{options:r.page_select_options},value:a.page_from.toString(),onUpdate:s[0]||(s[0]=s=>t.$emit("update:page_from",Number.parseInt(s)))},null,8,["parameters","value"])])),_:1}),(0,o.Wm)(l,{class:"pdfdocumentrow__selectsizedblock",size:"w100"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{class:"pdfdocumentrow__selectinput",parameters:{options:r.page_select_options},value:a.page_to.toString(),onUpdate:s[1]||(s[1]=s=>t.$emit("update:page_to",Number.parseInt(s)))},null,8,["parameters","value"])])),_:1}),(0,o.Wm)(l,{class:"pdfdocumentrow__selectsizedblock",size:"w50"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{class:"pdfdocumentrow__selectinput",parameters:{options:r.angle_select_options},value:a.angle.toString(),onUpdate:s[2]||(s[2]=s=>t.$emit("update:angle",Number.parseInt(s)))},null,8,["parameters","value"])])),_:1}),(0,o.Wm)(l,{class:"pdfdocumentrow__buttonsizedblock",size:"w50"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{class:"pdfdocumentrow__button pdfdocumentrow__button_arrow",title:"▲",onClick:s[3]||(s[3]=s=>t.$emit("move:up"))})])),_:1}),(0,o.Wm)(l,{class:"pdfdocumentrow__buttonsizedblock",size:"w50"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{class:"pdfdocumentrow__button pdfdocumentrow__button_arrow",title:"▼",onClick:s[4]||(s[4]=s=>t.$emit("move:down"))})])),_:1}),(0,o.Wm)(l,{class:"pdfdocumentrow__sizedblock",size:"w100"},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{class:"pdfdocumentrow__textfield",value:a.page_count.toString()},null,8,["value"])])),_:1}),(0,o.Wm)(l,{class:"pdfdocumentrow__sizedblock",size:"w100"},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{class:"pdfdocumentrow__textfield",value:a.size},null,8,["value"])])),_:1}),(0,o.Wm)(l,{class:"pdfdocumentrow__deleteblock",size:"w100"},{default:(0,o.w5)((()=>[a.uploaded?((0,o.wg)(),(0,o.j4)(p,{key:0,class:"pdfdocumentrow__button",title:"Удалить",onClick:s[5]||(s[5]=s=>t.$emit("delete"))})):(0,o.kq)("",!0)])),_:1})])}var ep={components:{SizedDiv:ea,FormTextField:ra,TextButton:ya,FormSelectInput:er},name:"PdfDocumentRow",props:{name:{type:String,required:!0},order:{type:Number,required:!0},page_count:{type:Number,required:!0},page_from:{type:Number,required:!0},page_to:{type:Number,required:!0},angle:{type:Number,required:!0},progress:{type:Number,required:!0},size:{type:String,required:!0},uploaded:{type:Boolean,required:!0}},emits:["delete","move:up","move:down","update:page_from","update:page_to","update:angle"],setup(t){const s=(0,o.Fl)((()=>t.progress<100?`${t.progress}%`:"✓")),a=[{name:"0",value:"0"},{name:"90",value:"90"},{name:"180",value:"180"},{name:"270",value:"270"}],r=(0,o.Fl)((()=>[...Array(t.page_count).keys()].map((t=>{const s=(t+1).toString();return{name:s,value:s}}))));return{progress_str:s,angle_select_options:a,page_select_options:r}}};const tp=(0,qs.Z)(ep,[["render",PdfDocumentRowvue_type_template_id_4fb13056_scoped_true_render],["__scopeId","data-v-4fb13056"]]);var sp=tp,ap={components:{HeadingComponent:Us,FileDropZone:Ur,PdfDocumentRow:sp,TextButton:ya,FormTextField:ra,ToggleTextButton:Ma,SizedDiv:ea},name:"PdfMergeToolPage",setup(){const t=new VueUnitOfWork,s=256,a=(0,i.iH)(!0),r=(0,i.iH)(!0),n=(0,o.Fl)((()=>{let s=t.pdf_merge_file_repository.values().map((t=>t.value));return s.sort(((t,s)=>t.order-s.order)),s})),_=(0,o.Fl)((()=>{const t=n.value.map((t=>t.order));return 0===t.length?0:Math.max(...t)})),l=(0,o.Fl)((()=>{let t=!1;return n.value.forEach((s=>{!0===s.to_be_editted&&(t=!0)})),t})),d=(0,o.Fl)((()=>!n.value.map((t=>t.uploaded)).includes(!1))),p=(0,o.Fl)((()=>n.value.reduce(((t,s)=>t&&s.page_count===n.value[0].page_count&&1===s.page_from&&s.page_to===n.value[0].page_count&&0==s.angle),!0))),c=(0,i.iH)(!1),handle_new_file_drop=async a=>{let r=null;r=a.size>1024*s*1024?new UploadFileTooBigError(a.name):"pdf"!==get_extension_of_file(a.name).toLowerCase()?new UploadFileWrongExtensionError(a.name):new UploadPdfMergeFile((0,Gt.Z)(),_.value+1,a),await message_bus_MessageBus.handle(r,t)},handle_delete=async s=>{await message_bus_MessageBus.handle(new DeletePdfMergeFile(s),t)},handle_delete_all=async()=>{await message_bus_MessageBus.handle(new DeleteAllPdfMergeFiles,t)},handle_download=async()=>{await message_bus_MessageBus.handle(new DownloadPdfMergeResult(a.value,r.value),t)},handle_merge_annotations=async()=>{await message_bus_MessageBus.handle(new DownloadPdfMixResult,t)},update_upload_progress=()=>{message_bus_MessageBus.handle(new UpdateUploadProgress,t)},swap=async(s,a)=>{const r=n.value[s],o=n.value[a],i=r.order,_=o.order;await Promise.all([message_bus_MessageBus.handle(new UpdatePdfMergeFile(r.id,_,r.page_from,r.page_to,r.angle),t),message_bus_MessageBus.handle(new UpdatePdfMergeFile(o.id,i,o.page_from,o.page_to,o.angle),t)])},handle_move_up=async t=>{const s=n.value.findIndex((s=>s.id===t));s>0&&swap(s,s-1)},handle_move_down=async t=>{const s=n.value.findIndex((s=>s.id===t));s<n.value.length-1&&swap(s,s+1)};t.upload_progress_timer.set_callback(update_upload_progress),t.upload_progress_timer.start(),(0,o.bv)((async()=>{useBeforeEnterPage(t,["can_view_service"]),await message_bus_MessageBus.handle(new GetPdfMergeFiles,t)}));const handle_update_page_from=async(s,a)=>{await message_bus_MessageBus.handle(new UpdatePdfMergeFile(s.id,s.order,a,s.page_to,s.angle),t)},handle_update_page_to=async(s,a)=>{await message_bus_MessageBus.handle(new UpdatePdfMergeFile(s.id,s.order,s.page_from,a,s.angle),t)},handle_update_angle=async(s,a)=>{await message_bus_MessageBus.handle(new UpdatePdfMergeFile(s.id,s.order,s.page_from,s.page_to,a),t)};return(0,o.Jd)((async()=>t.upload_progress_timer.stop())),{max_file_size:s,keep_bookmarks:a,add_filenames_as_bookmarks:r,handle_new_file_drop:handle_new_file_drop,handle_delete:handle_delete,handle_delete_all:handle_delete_all,handle_download:handle_download,handle_move_up:handle_move_up,handle_move_down:handle_move_down,handle_update_page_from:handle_update_page_from,handle_update_page_to:handle_update_page_to,handle_update_angle:handle_update_angle,is_drag_above_file_zone:c,pdf_docs:n,max_order:_,to_be_editted:l,is_all_uploaded:d,is_same_page_count_and_not_edited:p,handle_merge_annotations:handle_merge_annotations}}};const rp=(0,qs.Z)(ap,[["render",PdfMergeToolPagevue_type_template_id_0b86a7bb_scoped_true_render],["__scopeId","data-v-0b86a7bb"]]);var op=rp;const np={class:"page"},ip={class:"page__container"},_p={class:"page__servicecontainer"},lp={key:0,class:"page__dropzonetitle"};function ShareFilePagevue_type_template_id_41d90c57_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),d=(0,o.up)("document-page-download-progress-row"),p=(0,o.up)("file-drop-zone"),c=(0,o.up)("file-list");return(0,o.wg)(),(0,o.iD)("div",np,[(0,o.Wm)(_,{class:"page__heading",text:"Файлообменник",size:"middle"}),(0,o._)("div",ip,[(0,o._)("div",_p,[(0,o.Wm)(d,{class:"page__downloadprogress",files:r.downloading_files,full_format:!1},null,8,["files"]),(0,o.Wm)(p,{class:(0,l.C_)(["page__filedropzone",{page__filedropzone_dragging:r.is_drag_above_file_zone}]),"onAdd:file":s[0]||(s[0]=t=>r.handle_new_file_drop(t)),"onUpdate:dragging":s[1]||(s[1]=t=>r.is_drag_above_file_zone=t)},{default:(0,o.w5)((()=>[r.is_drag_above_file_zone?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("span",lp," < "+(0,l.zw)(r.max_file_size)+" МБ",1))])),_:1},8,["class"]),(0,o.Wm)(c,{class:"page__filelist",files:r.share_files,can_be_dragged:!1,can_be_deleted:!0,"onDownload:file":s[2]||(s[2]=t=>r.handle_download(...t)),"onDelete:file":s[3]||(s[3]=t=>r.handle_delete(t)),"onCopy_link_to:file":s[4]||(s[4]=t=>r.handle_copy_link_to_file_into_clipboard(t))},null,8,["files"])])])])}var dp={components:{HeadingComponent:Us,FileDropZone:Ur,FileList:kr,DocumentPageDownloadProgressRow:Ir},name:"ShareFilePage",setup(){const t=(0,_.tv)(),s=new VueUnitOfWork,a=1024,r=(0,o.Fl)((()=>s.share_file_repository.values().map((t=>t.value)))),n=(0,i.iH)(!1),handle_new_file_drop=async t=>{let r=null;r=t.size>1024*a*1024?new UploadFileTooBigError(t.name):new UploadShareFile((0,Gt.Z)(),t),await message_bus_MessageBus.handle(r,s)},handle_delete=async t=>{await message_bus_MessageBus.handle(new DeleteShareFile(t),s)},l=(0,o.Fl)((()=>s.download_progress.values().map((t=>t.value)))),handle_download=async(t,a)=>{await message_bus_MessageBus.handle(new DownloadShareFile(t.id,t.name,t.size,a),s)},handle_copy_link_to_file_into_clipboard=a=>{const r=t.resolve({name:"DownloadShareFilePage",params:{file_id:a.id}});navigator.clipboard.writeText(window.location.origin+r.href).then((()=>message_bus_MessageBus.handle(new FileLinkCopied,s)))},update_upload_progress=()=>{message_bus_MessageBus.handle(new UpdateUploadProgress,s)};return s.upload_progress_timer.set_callback(update_upload_progress),s.upload_progress_timer.start(),(0,o.bv)((async()=>{await useBeforeEnterPage(s,["can_view_service"]),await message_bus_MessageBus.handle(new GetShareFiles,s)})),(0,o.Jd)((async()=>s.upload_progress_timer.stop())),{max_file_size:a,handle_new_file_drop:handle_new_file_drop,handle_delete:handle_delete,handle_download:handle_download,handle_copy_link_to_file_into_clipboard:handle_copy_link_to_file_into_clipboard,is_drag_above_file_zone:n,share_files:r,downloading_files:l}}};const pp=(0,qs.Z)(dp,[["render",ShareFilePagevue_type_template_id_41d90c57_scoped_true_render],["__scopeId","data-v-41d90c57"]]);var cp=pp;const SelfTestingPagevue_type_template_id_47409a36_scoped_true_withScopeId=t=>((0,o.dD)("data-v-47409a36"),t=t(),(0,o.Cn)(),t),up={class:"page"},mp={class:"page__container"},gp={class:"page__listcontainer"},hp={class:"page__managecontainer"},fp=["value","max"],vp={key:3,id:"test_counts"},wp=SelfTestingPagevue_type_template_id_47409a36_scoped_true_withScopeId((()=>(0,o._)("option",{value:"0",label:"0"},null,-1))),yp={key:0,value:"20",label:"20"},bp=["value","label"],Rp={class:"page__questioncontainer"},Fp={key:0,class:"page__servicecontainer"},Dp=SelfTestingPagevue_type_template_id_47409a36_scoped_true_withScopeId((()=>(0,o._)("span",{class:"page__dropzonetitle"},"Перетащи сюда вопросы (json)",-1)));function SelfTestingPagevue_type_template_id_47409a36_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),d=(0,o.up)("btn-component"),p=(0,o.up)("form-text-field"),c=(0,o.up)("question-block"),u=(0,o.up)("json-file-drop-zone");return(0,o.wg)(),(0,o.iD)("div",up,[(0,o.Wm)(_,{class:"page__heading",text:"Самоподготовка к тестированию",size:"middle"}),(0,o._)("div",mp,[(0,o._)("div",gp,[(0,o._)("div",hp,[r.is_test_active?((0,o.wg)(),(0,o.j4)(d,{key:1,caption:"Завершить тест",type:"danger",onClick:s[1]||(s[1]=t=>r.handle_stop_test())})):((0,o.wg)(),(0,o.j4)(d,{key:0,caption:"Начать тест",type:"success",onClick:s[0]||(s[0]=t=>r.handle_start_test())})),r.is_test_active?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("input",{key:2,type:"range",list:"test_counts",value:r.count_of_questions_in_test,min:"0",max:r.total_count_of_questions,onChange:s[2]||(s[2]=t=>r.handle_count_of_questions_changed(t.target.valueAsNumber))},null,40,fp)),r.total_count_of_questions>0?((0,o.wg)(),(0,o.iD)("datalist",vp,[wp,r.total_count_of_questions>20?((0,o.wg)(),(0,o.iD)("option",yp)):(0,o.kq)("",!0),(0,o._)("option",{value:r.total_count_of_questions,label:r.total_count_of_questions},null,8,bp)])):(0,o.kq)("",!0),(0,o.Wm)(p,{value:"Тест из "+r.count_of_questions_in_test+" вопросов. Всего загружено вопросов: "+r.total_count_of_questions+". Прогресс ("+r.active_question_id.toString()+"/"+r.count_of_questions_in_test.toString()+"). Допущено ошибок "+r.count_of_errors,parameters:{align:"left"}},null,8,["value"])]),(0,o._)("div",Rp,[r.is_test_active&&null!==r.active_question?((0,o.wg)(),(0,o.j4)(c,{key:0,id:r.active_question.value.id,question:r.active_question.value.question,answers:r.active_question.value.answers,"onUser:replied":s[3]||(s[3]=t=>r.handle_user_replied(t))},null,8,["id","question","answers"])):(0,o.kq)("",!0)])]),r.is_test_active?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",Fp,[(0,o.Wm)(u,{class:(0,l.C_)(["page__docdropzone",{page__docdropzone_dragging:r.is_drag_above_drop_zone}]),"onUpdate:dragging":s[4]||(s[4]=t=>r.is_drag_above_drop_zone=t),"onUpdate:json":s[5]||(s[5]=t=>r.handle_new_questions_drop(t)),default:[]},{default:(0,o.w5)((()=>[Dp])),_:1},8,["class"])]))])])}const xp={class:"questionblock"},kp={class:"questionblock__text"},qp=["onChange","checked"],Sp={class:"questionblock__buttons"};function QuestionBlockvue_type_template_id_7db06534_render(t,s,a,r,n,i){const _=(0,o.up)("btn-component");return(0,o.wg)(),(0,o.iD)("div",xp,[(0,o._)("span",kp,(0,l.zw)(a.id)+") "+(0,l.zw)(a.question),1),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.shuffled_answers,(t=>((0,o.wg)(),(0,o.iD)("div",{class:"questionblock__answers",key:t.id},[(0,o._)("div",{class:(0,l.C_)(["questionblock__rowanswer",{questionblock__rowanswer_correct:r.show_correct_answer&&t.is_correct}])},[(0,o._)("input",{type:"checkbox",onChange:s=>r.replies[t.id]=!r.replies[t.id],checked:r.replies[t.id]},null,40,qp),(0,o.Uk)((0,l.zw)(t.text),1)],2)])))),128)),(0,o._)("div",Sp,[(0,o.Wm)(_,{class:"questionblock__button",caption:"Ответить",type:"primary",onClick:s[0]||(s[0]=t=>r.handle_check_reply())}),(0,o.Wm)(_,{class:"questionblock__button",caption:!0===r.show_correct_answer?"Скрыть ответы":"Показать ответы",type:"warning",onClick:s[1]||(s[1]=t=>r.show_correct_answer=!r.show_correct_answer)},null,8,["caption"])])])}var Ep={components:{BtnComponent:Es},name:"QuestionBlock",props:{id:{type:Number,required:!0},question:{type:String,required:!0},answers:{type:Array,required:!0}},emits:["user:replied"],setup(t,{emit:s}){const a=(0,i.iH)(!1),r=(0,i.iH)({}),n=(0,o.Fl)((()=>shuffleArray(t.answers))),reset_replies=()=>{r.value={},n.value.forEach((t=>{r.value[t.id]=!1}))};(0,o.YP)((()=>t.id),(()=>{a.value=!1,reset_replies()}));const _=(0,o.Fl)((()=>{let t=!0;return n.value.forEach((s=>{s.is_correct!==r.value[s.id]&&(t=!1)})),t})),handle_check_reply=()=>{s("user:replied",_.value)};return(0,o.bv)((()=>{reset_replies()})),{shuffled_answers:n,show_correct_answer:a,replies:r,handle_check_reply:handle_check_reply}}};const Ap=(0,qs.Z)(Ep,[["render",QuestionBlockvue_type_template_id_7db06534_render]]);var Cp=Ap,Up={components:{HeadingComponent:Us,JsonFileDropZone:Er,BtnComponent:Es,FormTextField:ra,QuestionBlock:Cp},name:"SelfTestingPage",setup(){const t=new VueUnitOfWork,s=t.self_testing_question_repository,a=(0,i.iH)(!1),r=(0,i.iH)(0),n=(0,i.iH)(0),_=(0,i.iH)(0),l=(0,i.iH)([]),d=(0,i.iH)(0);(0,o.YP)((()=>_.value),(()=>{_.value>=n.value&&handle_stop_test()}));const p=(0,o.Fl)((()=>0===l.value.length||_.value>=n.value?null:s.get(l.value[_.value]))),handle_start_test=()=>{if(n.value<=r.value){const t=Array.from({length:r.value},((t,s)=>s+1)),s=shuffleArray(t);l.value=s.slice(0,n.value),_.value=0,d.value=0,a.value=!0}},handle_stop_test=()=>{a.value=!1},handle_user_replied=s=>{!0===s?(message_bus_MessageBus.handle(new SelfTestingRepliedSuccess,t),_.value++):(message_bus_MessageBus.handle(new SelfTestingRepliedFail,t),d.value++)},handle_new_questions_drop=s=>{message_bus_MessageBus.handle(new DropSelfTestingQuestions,t),s.forEach((s=>{message_bus_MessageBus.handle(new AddSelfTestingQuestion(s.question.id,s.question.text,s.answers),t)})),r.value=s.length},handle_count_of_questions_changed=t=>{n.value=t},c=(0,i.iH)(!1);return{is_test_active:a,count_of_questions_in_test:n,total_count_of_questions:r,active_question_id:_,active_question:p,chosen_questions:l,count_of_errors:d,handle_start_test:handle_start_test,handle_stop_test:handle_stop_test,handle_new_questions_drop:handle_new_questions_drop,handle_user_replied:handle_user_replied,handle_count_of_questions_changed:handle_count_of_questions_changed,is_drag_above_drop_zone:c}}};const Pp=(0,qs.Z)(Up,[["render",SelfTestingPagevue_type_template_id_47409a36_scoped_true_render],["__scopeId","data-v-47409a36"]]);var jp=Pp;const Mp={class:"message"},Tp={class:"message__text"};function MessagePagevue_type_template_id_78023fef_render(t,s,a,r,n,i){return(0,o.wg)(),(0,o.iD)("div",Mp,[(0,o._)("div",Tp,(0,l.zw)(a.text),1)])}var Np={name:"MessagePage",props:{text:{type:String,required:!0}}};const Ip=(0,qs.Z)(Np,[["render",MessagePagevue_type_template_id_78023fef_render]]);var Bp=Ip;const Op={class:"page"},zp={class:"page__container"};function DocumentApprovalSearchPagevue_type_template_id_48a5e211_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),l=(0,o.up)("document-page-search-row"),d=(0,o.up)("document-page-sort-row"),p=(0,o.up)("document-search-status-row"),c=(0,o.up)("document-pagination-row"),u=(0,o.up)("document-attribute-row");return(0,o.wg)(),(0,o.iD)("div",Op,[(0,o.Wm)(_,{class:"page__heading",text:"Поиск согласований документов",size:"middle"}),(0,o._)("div",zp,[(0,o.Wm)(l,{class:"page__searchrow",search_schema:r.search_schema,required_space_for_link:!0,"onSearch:docs":s[0]||(s[0]=t=>r.handle_search_action(t))},null,8,["search_schema"]),(0,o.Wm)(d,{class:"page__sortrow",search_schema:r.search_schema,sort_asc:r.sort_asc,sort_by:r.sort_by,"onToggle:direction":s[1]||(s[1]=t=>r.sort_asc=!r.sort_asc),"onSort:by":s[2]||(s[2]=t=>[r.sort_by,r.sort_rule]=t)},null,8,["search_schema","sort_asc","sort_by"]),(0,o.Wm)(p,{class:"page__searchstatus",count:Math.max(r.search_count,r.items.length),time:r.search_time,min_index:r.pagination_min_index,max_index:r.pagination_max_index,is_searching:r.is_searching},null,8,["count","time","min_index","max_index","is_searching"]),r.items.length>0?((0,o.wg)(),(0,o.j4)(c,{key:0,class:"page__paginationrow",total_count:Math.max(r.search_count,r.items.length),count_per_page:r.pagination_count_per_page,current_page:r.pagination_current_page,variants:r.pagination_variants,is_intermediate_part_shown:r.is_intermediate_pages_shown,"onSet:page_range":s[3]||(s[3]=t=>r.handle_set_page_range(t.min,t.max)),"onSelect:page":s[4]||(s[4]=t=>r.pagination_current_page=t),"onSet:count_per_page":s[5]||(s[5]=t=>r.pagination_count_per_page=t),"onShow:pages":s[6]||(s[6]=t=>r.is_intermediate_pages_shown=!0)},null,8,["total_count","count_per_page","current_page","variants","is_intermediate_part_shown"])):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.items,(t=>((0,o.wg)(),(0,o.iD)("div",{class:"page__listrow",key:t.id},[(0,o.Wm)(u,{class:"page__attributerow",id:t.id,search_schema:r.search_schema,has_link:!0,link_route_obj:t.link_to_single_page,attributes:t.attributes},null,8,["id","search_schema","link_route_obj","attributes"])])))),128))])])}var Wp={components:{HeadingComponent:Us,DocumentPageSearchRow:gr,DocumentAttributeRow:ha,DocumentPageSortRow:Rr,DocumentPaginationRow:$r,DocumentSearchStatusRow:A_},name:"DocumentApprovalSearchPage",setup(){const t=new VueUnitOfWork,s=t.user_repository.get_current(),a=(0,o.Fl)((()=>t.user_repository.values().map((t=>t.value)).filter((t=>!0===t.is_active)))),r=(0,o.Fl)((()=>a.value.map((t=>({name:make_full_name(t.last_name,t.first_name,t.username),value:t.username}))).sort(((t,s)=>t.name.localeCompare(s.name))))),n=(0,o.Fl)((()=>{let a=t.usergroup_repository.values().filter((t=>!t.value.is_private||t.value.has_username(s.value.username))).map((t=>({name:t.value.name,value:t.value.id.toString()})));return a.sort(((t,s)=>t.name.localeCompare(s.name))),a})),make_full_name=(t,s,a)=>t+" "+s+" ("+a+")",convert_state=t=>{switch(t){case"APPROVED":return"Согласовано";case"REJECTED":return"Отклонено";case"DELEGATED":return"Делегировано";case"NONE":return"В работе"}},convert_usergroup=s=>{const a=t.usergroup_repository.get(s);return a?a.value.name:s.toString()},convert_model_to_item=t=>({id:t.id,attributes:{id:t.id.toString(),USERGROUP:convert_usergroup(t.document.usergroup_id),STATE:convert_state(t.state),FROM_USER:make_full_name(t.from_last_name,t.from_first_name,t.from_username),TO_USER:make_full_name(t.to_last_name,t.to_first_name,t.to_username),DESCRIPTION:t.document.raw_description,UPDATED_AT:convertDateToDateTimeString(t.updated_at)},link_to_single_page:{name:"DocumentPage",params:{folder_id:t.document.folder_id,usergroup_id:t.document.usergroup_id,document_id:t.document.id}},actions:{}}),_=(0,o.Fl)((()=>t.search_doc_approval_repository.values().map((t=>convert_model_to_item(t.value))))),l=(0,i.iH)(0),d=(0,i.iH)(!1),p=(0,i.iH)(0),c=(0,i.iH)({}),handle_search_action=async t=>{t!==c.value&&reset_pagination(),c.value=t,await search()},search=async()=>{d.value||await useExecutionTimeDecorator(t,new GetManyDocumentsApprovals(c.value,R.value*(F.value-1),R.value,g.value,f.value),l,d)},u=t.search_doc_approval_repository.get_count(),m=(0,o.Fl)((()=>[{name:"USERGROUP",size:"w200",fields:[{type:"select",options:[{name:"Гр. пользователей ?",value:""}].concat(n.value),default:"",rule:"exact"}]},{name:"FROM_USER",size:"w350",fields:[{type:"select",options:[{name:"От кого ?",value:""}].concat(r.value),default:"",rule:"exact"}]},{name:"TO_USER",size:"w350",fields:[{type:"select",options:[{name:"Кому ?",value:""}].concat(r.value),default:"",rule:"exact"}]},{name:"STATE",size:"w150",fields:[{type:"select",options:[{name:"Не выбрано",value:""},{name:"В работе",value:"NONE"},{name:"Согласовано",value:"APPROVED"},{name:"Отклонено",value:"REJECTED"},{name:"Делегировано",value:"DELEGATED"}],default:"",rule:"exact"}]},{name:"DESCRIPTION",size:"w200",align:"left",grow:!0,fields:[{placeholder:"Наименование",rule:"icontains"}]},{name:"UPDATED_AT",size:"w150",fields:[{placeholder:"Дата (от)",rule:"gte",re:"^\\d{2}\\.\\d{2}\\.\\d{4}$",converter:"date_to_iso_string"},{placeholder:"Дата (до)",rule:"lte",re:"^\\d{2}\\.\\d{2}\\.\\d{4}$",converter:"date_to_iso_string"}]}])),g=(0,i.iH)("UPDATED_AT"),h=(0,i.iH)("DEFAULT"),f=(0,i.iH)(!1);(0,o.YP)(g,(async()=>await search())),(0,o.YP)(f,(async()=>await search())),(0,o.YP)(h,(async()=>await search()));const v=(0,i.iH)(!1),w=20,y=1,b=(0,i.iH)([20,50,100]),R=(0,i.iH)(0),F=(0,i.iH)(0),D=(0,i.iH)(0),x=(0,i.iH)(0),handle_set_page_range=async(t,s)=>{D.value=t,x.value=s},reset_pagination=()=>{R.value=w,F.value=y,D.value=(y-1)*w,x.value=y*w};return reset_pagination(),(0,o.YP)(R,(async()=>await search({}))),(0,o.YP)(F,(async()=>await search({}))),(0,o.bv)((async()=>{await useBeforeEnterPage(t,["can_search_documentapproval"]),await Promise.all([useGetUsers(t),useGetUserGroups(t)])})),{user_options:r,usergroup_options:n,handle_search_action:handle_search_action,current_id:p,search_schema:m,items:_,convert_model_to_item:convert_model_to_item,search_time:l,is_searching:d,search_count:u,current_query:c,sort_by:g,sort_rule:h,sort_asc:f,is_intermediate_pages_shown:v,handle_set_page_range:handle_set_page_range,pagination_variants:b,pagination_count_per_page:R,pagination_current_page:F,pagination_min_index:D,pagination_max_index:x}}};const Gp=(0,qs.Z)(Wp,[["render",DocumentApprovalSearchPagevue_type_template_id_48a5e211_scoped_true_render],["__scopeId","data-v-48a5e211"]]);var Zp=Gp;function DownloadFileFromFolderPagevue_type_template_id_0af6f3e1_render(t,s,a,r,n,i){const _=(0,o.up)("download-file-page");return(0,o.wg)(),(0,o.j4)(_,{generate_message:r.make_message},null,8,["generate_message"])}const Hp={class:"page"};function DownloadFilePagevue_type_template_id_330f0eb2_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("document-page-download-progress-row");return(0,o.wg)(),(0,o.iD)("div",Hp,[(0,o.Wm)(_,{class:"page__downloadprogress",files:r.downloading_files,full_format:!0},null,8,["files"])])}var $p={components:{DocumentPageDownloadProgressRow:Ir},name:"DownloadFilePage",props:{generate_message:{type:Function,required:!0}},setup(t){const s=new VueUnitOfWork,a=(0,_.yj)(),r=a.params.file_id,n=(0,o.Fl)((()=>s.download_progress.values().map((t=>t.value)))),handle_get_file_info=async()=>{const t=new GetFileInfo(r),a=await message_bus_MessageBus.handle(t,s);return a[0]},handle_download_file=async(a,r)=>await message_bus_MessageBus.handle(t.generate_message(a,r),s);return(0,o.bv)((async()=>{const t=await handle_get_file_info();t&&await handle_download_file(t.name,t.size)})),{downloading_files:n}}};const Lp=(0,qs.Z)($p,[["render",DownloadFilePagevue_type_template_id_330f0eb2_scoped_true_render],["__scopeId","data-v-330f0eb2"]]);var Vp=Lp,Jp={components:{DownloadFilePage:Vp},name:"DownloadFileFromFolderPage",setup(){const t=(0,_.yj)(),s=new VueUnitOfWork,a=useValidateIntOr404(t.params.folder_id),r=useValidateIntOr404(t.params.usergroup_id),make_message=(s,o)=>new DownloadFileFromFolder(a,r,t.params.file_id,s,o,!0);return(0,o.bv)((async()=>await useBeforeEnterPage(s,["can_view_file"],a,r))),{make_message:make_message}}};const Yp=(0,qs.Z)(Jp,[["render",DownloadFileFromFolderPagevue_type_template_id_0af6f3e1_render]]);var Kp=Yp;function DownloadShareFilePagevue_type_template_id_d4f62930_render(t,s,a,r,n,i){const _=(0,o.up)("download-file-page");return(0,o.wg)(),(0,o.j4)(_,{generate_message:r.make_message},null,8,["generate_message"])}var Xp={components:{DownloadFilePage:Vp},name:"DownloadFileFromFolderPage",setup(){const t=(0,_.yj)(),s=new VueUnitOfWork,make_message=(s,a)=>new DownloadShareFile(t.params.file_id,s,a);return(0,o.bv)((async()=>await useBeforeEnterPage(s,["can_view_service"]))),{make_message:make_message}}};const Qp=(0,qs.Z)(Xp,[["render",DownloadShareFilePagevue_type_template_id_d4f62930_render]]);var ec=Qp;function DownloadMailMessageFilePagevue_type_template_id_065914e2_render(t,s,a,r,n,i){const _=(0,o.up)("download-file-page");return(0,o.wg)(),(0,o.j4)(_,{generate_message:r.make_message},null,8,["generate_message"])}var tc={components:{DownloadFilePage:Vp},name:"DownloadMailMessageFilePage",setup(){const t=(0,_.yj)(),s=new VueUnitOfWork,a=useValidateIntOr404(t.params.message_id),make_message=(s,r)=>new DownloadMailMessageAttachment(a,t.params.file_id,s,r);return(0,o.bv)((async()=>await useBeforeEnterPage(s,["can_view_mail"]))),{make_message:make_message}}};const sc=(0,qs.Z)(tc,[["render",DownloadMailMessageFilePagevue_type_template_id_065914e2_render]]);var ac=sc;const rc={class:"page"},oc={class:"page__container"},nc={class:"page__editblock"},ic={class:"page__editrow"};function FlowsPagevue_type_template_id_50a187aa_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),l=(0,o.up)("base-form"),d=(0,o.up)("btn-component"),p=(0,o.up)("search-component");return(0,o.wg)(),(0,o.iD)("div",rc,[(0,o.Wm)(_,{class:"page__heading",text:"Потоки",size:"middle"}),(0,o._)("div",oc,[(0,o._)("div",nc,[(0,o.Wm)(l,{class:"page__form",attributes:r.current,settings:r.form_pages,is_edit_mode:!0,is_header_required:!1,onUpdate:s[0]||(s[0]=t=>r.handle_update_attribute(t.name,t.value))},null,8,["attributes","settings"]),(0,o._)("div",ic,[r.can_add&&!r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:0,class:"page__button",onClick:s[1]||(s[1]=t=>r.add_action()),caption:"Добавить",type:"primary",disabled:!r.is_edit_block_valid},null,8,["disabled"])):(0,o.kq)("",!0),r.can_change&&r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:1,class:"page__button",onClick:s[2]||(s[2]=t=>r.update_action()),caption:"Сохранить",type:"success",disabled:!r.is_edit_block_valid},null,8,["disabled"])):(0,o.kq)("",!0),r.can_delete&&r.current_id?((0,o.wg)(),(0,o.j4)(d,{key:2,class:"page__button",onClick:s[3]||(s[3]=t=>r.delete_action()),caption:"Удалить",type:"danger"})):(0,o.kq)("",!0)])]),(0,o.Wm)(p,{class:"page__searchblock",schema:r.search_schema,model_objects:r.model_objects,convert_obj_to_item:r.convert_model_to_item,current_id:r.current_id,sort_by:"name",search_time:r.search_time,is_searching:r.is_searching,should_emit_search_event_on_any_keypress:!1,onChoose:s[4]||(s[4]=t=>r.current_id=t),onSearch:s[5]||(s[5]=t=>r.search_action(t))},null,8,["schema","model_objects","convert_obj_to_item","current_id","search_time","is_searching"])])])}var _c={components:{HeadingComponent:Us,BtnComponent:Es,BaseForm:ni,SearchComponent:P_},name:"FlowsPage",setup(){const t=new VueUnitOfWork,convert_model_to_item=t=>({id:t.id,attributes:{id:t.id.toString(),name:t.name,username:t.username,trigger:t.trigger,process:t.process,is_active:!0===t.is_active?"Y":"N",is_multiple:!0===t.is_multiple?"Y":"N",created_at:convertDateToDateString(t.created_at),updated_at:convertDateToDateString(t.updated_at)},actions:{}}),s=(0,i.iH)({}),a=(0,o.Fl)((()=>filterArrayOfObjectsByQuery(t.flow_repository.values().map((t=>t.value)),s.value))),r=t.permission_repository.has("can_add_flow"),n=t.permission_repository.has("can_change_flow"),_=t.permission_repository.has("can_delete_flow"),l=(0,i.iH)(0),d=(0,i.iH)(!1),search_action=async s=>{await useExecutionTimeDecorator(t,new GetFlows(s),l,d)},p=[{name:"id",size:"w50",align:"center",fields:[{placeholder:"ID",rule:"exact"}]},{name:"username",size:"w150",align:"center",fields:[{placeholder:"Пользователь",rule:"icontains"}]},{name:"name",size:"w200",grow:!0,fields:[{placeholder:"Наименование",rule:"icontains"}]},{name:"trigger",size:"w200",grow:!0,fields:[{placeholder:"Триггер",rule:"icontains"}]},{name:"is_active",size:"w30",align:"center",fields:[{type:"bool",placeholder:"Активен?",rule:"exact"}]},{name:"is_multiple",size:"w30",align:"center",fields:[{type:"bool",placeholder:"Множественный?",rule:"exact"}]},{name:"created_at",size:"w150",align:"center",fields:[{placeholder:"Создан (от)",rule:"gte",re:"^\\d{2}\\.\\d{2}\\.\\d{4}$",converter:"date_to_iso_string"},{placeholder:"Создан (до)",rule:"lte",re:"^\\d{2}\\.\\d{2}\\.\\d{4}$",converter:"date_to_iso_string"}]},{name:"updated_at",size:"w150",align:"center",fields:[{placeholder:"Обновлен (от)",rule:"gte",re:"^\\d{2}\\.\\d{2}\\.\\d{4}$",converter:"date_to_iso_string"},{placeholder:"Обновлен (до)",rule:"lte",re:"^\\d{2}\\.\\d{2}\\.\\d{4}$",converter:"date_to_iso_string"}]}],c={id:null,name:"",trigger:"",is_multiple:!1,is_active:!1,message_if_fail:!0,process:""},u={process:t=>JSON.parse(t)},m={process:t=>JSON.stringify(t,null,3)},{current_id:g,current:h,handle_update_attribute:f}=useCurrentMixin(c,t.flow_repository,m),v=(0,o.Fl)((()=>validate_json(h.value.process,yt))),w=(0,o.Fl)((()=>v.value&&h.value.name.length>0)),add_action=async()=>{const s=new AddFlow(...["name","trigger","is_active","is_multiple","message_if_fail","process"].map((t=>convertObject(h.value,u)[t])));await message_bus_MessageBus.handle(s,t)},update_action=async()=>{const s=new UpdateFlow(...["id","name","trigger","is_active","is_multiple","message_if_fail","process"].map((t=>convertObject(h.value,u)[t])));await message_bus_MessageBus.handle(s,t)},delete_action=async()=>{const s=new DeleteFlow(g.value);await message_bus_MessageBus.handle(s,t),g.value=null},y=(0,o.Fl)((()=>[{size:"w450",fields:[{type:"FormTextField",bind:"id"},{type:"FormTextField",value:"Наименование:"},{type:"FormTextInput",parameters:{height:30},bind:"name"},{type:"FormTextField",value:"Имя тригера:"},{type:"FormTextInput",parameters:{height:30},bind:"trigger"},{type:"FormTextField",value:"Поток активен:"},{type:"FormBooleanInput",parameters:{size:20},bind:"is_active"},{type:"FormTextField",value:"Может иметь несколько экземпляров:"},{type:"FormBooleanInput",parameters:{size:20},bind:"is_multiple"},{type:"FormTextField",value:"Нужно ли оповещать при сбое"},{type:"FormBooleanInput",parameters:{size:20},bind:"message_if_fail"},{type:"FormTextField",value:"Описание в формате JSON"},{type:"FormMultilineTextInput",parameters:{rows:15,resize:"vertical",color:v.value?"green":"red"},bind:"process"}]}]));return(0,o.bv)((async()=>{await useBeforeEnterPage(t,["can_view_flow"])})),{search_action:search_action,add_action:add_action,update_action:update_action,delete_action:delete_action,can_add:r,can_change:n,can_delete:_,current_id:g,current:h,is_process_valid:v,is_edit_block_valid:w,handle_update_attribute:f,form_pages:y,search_schema:p,model_objects:a,convert_model_to_item:convert_model_to_item,search_time:l,is_searching:d}}};const lc=(0,qs.Z)(_c,[["render",FlowsPagevue_type_template_id_50a187aa_scoped_true_render],["__scopeId","data-v-50a187aa"]]);var dc=lc;const pc={class:"page"},cc={class:"page__caption"},uc={class:"page__container"},mc={class:"page__infoblock"},gc={class:"page__inforow"},hc={class:"page__inforow"},fc={class:"page__inforow"},vc={class:"page__inforow"},wc={class:"page__stepblock stepblock"};function FlowItemPagevue_type_template_id_0e74ad10_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),d=(0,o.up)("text-button"),p=(0,o.up)("form-text-field"),c=(0,o.up)("flow-item-step");return(0,o.wg)(),(0,o.iD)("div",pc,[(0,o._)("div",cc,[(0,o.Wm)(_,{class:"page__heading",text:"Поток",size:"middle"}),(0,o._)("div",{class:(0,l.C_)(["page__state",{page__state_running:"RUNNING"===r.flowitem_state,page__state_finished_fail:"FINISHED_FAIL"===r.flowitem_state,page__state_finished_success:"FINISHED_SUCCESS"===r.flowitem_state}])},null,2),(0,o.Wm)(d,{class:"page__restartbutton",title:"Перезапустить",onClick:s[0]||(s[0]=t=>r.handle_restart_flowitem())})]),(0,o._)("div",uc,[(0,o._)("div",mc,[(0,o._)("div",gc,[(0,o.Wm)(p,{class:"infoitem__label",value:"Наименование:"}),(0,o.Wm)(p,{class:"infoitem__value",value:r.flowitem_name},null,8,["value"])]),(0,o._)("div",hc,[(0,o.Wm)(p,{class:"infoitem__label",value:"Триггер:"}),(0,o.Wm)(p,{class:"infoitem__value",value:r.flowitem_trigger},null,8,["value"])]),(0,o._)("div",fc,[(0,o.Wm)(p,{class:"infoitem__label",value:"Время старта:"}),(0,o.Wm)(p,{class:"infoitem__value",value:null===r.flowitem_started_at?"-":r.convertDateToDateTimeString(r.flowitem_started_at)},null,8,["value"])]),(0,o._)("div",vc,[(0,o.Wm)(p,{class:"infoitem__label",value:"Время финиша:"}),(0,o.Wm)(p,{class:"infoitem__value",value:null===r.flowitem_finished_at?"-":r.convertDateToDateTimeString(r.flowitem_finished_at)},null,8,["value"])])]),(0,o._)("div",wc,[(0,o.Wm)(c,{class:"stepblock__item stepblock__item_trigger",name:"input",description:r.flowitem_name,action:r.flowitem_trigger,input:r.flowitem_input,started_at:r.flowitem_started_at,finished_at:r.flowitem_started_at,success:!0,ref:"trigger_el",onUpdated:s[1]||(s[1]=t=>r.handle_updated())},null,8,["description","action","input","started_at","finished_at"]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.steps,((t,a)=>((0,o.wg)(),(0,o.j4)(c,{class:"stepblock__item stepblock__item_regular",key:t.name,name:t.name,variable_name:t.variable_name,description:t.description,action:t.action,attributes:t.attributes,input:t.input,output:t.output,started_at:t.started_at,finished_at:t.finished_at,success:t.success,ref_for:!0,ref:t=>{r.step_el_arr[a]=t},onUpdated:s[2]||(s[2]=t=>r.handle_updated())},null,8,["name","variable_name","description","action","attributes","input","output","started_at","finished_at","success"])))),128))])])])}var yc=a(9366);const bc={class:"flowitemstep"},Rc={class:"flowitemstep__row flowitemstep__row_date"},Fc=(0,o._)("div",{class:"flowitemstep__freespace"},null,-1),Dc=(0,o._)("div",{class:"flowitemstep__freespace"},null,-1),xc={class:"flowitemstep__row"},kc={key:0,class:"flowitemstep__row"},qc={key:1,class:"flowitemstep__row"},Sc=["value"],Ec={key:3,class:"flowitemstep__row"},Ac=["value"];function FlowItemStepvue_type_template_id_cb691232_render(t,s,a,r,n,i){const _=(0,o.up)("form-text-field");return(0,o.wg)(),(0,o.iD)("div",bc,[(0,o._)("div",Rc,[(0,o._)("div",{class:(0,l.C_)(["flowitemstep__state",{flowitemstep__state_running:"RUNNING"===r.state,flowitemstep__state_waiting:"WAITING"===r.state,flowitemstep__state_finished_fail:"FINISHED_FAIL"===r.state,flowitemstep__state_finished_success:"FINISHED_SUCCESS"===r.state}])},null,2),(0,o.Wm)(_,{class:"flowitemstep__date",value:r.formatted_started_at},null,8,["value"]),Fc,(0,o.Wm)(_,{class:"flowitemstep__name",value:a.name},null,8,["value"]),a.variable_name?((0,o.wg)(),(0,o.j4)(_,{key:0,class:"flowitemstep__name",value:"["+(a.variable_name||a.name)+"]"},null,8,["value"])):(0,o.kq)("",!0),Dc,(0,o.Wm)(_,{class:"flowitemstep__date",value:r.formatted_finished_at},null,8,["value"])]),(0,o._)("div",xc,[(0,o.Wm)(_,{class:"flowitemstep__action",value:a.action},null,8,["value"]),(0,o.Wm)(_,{class:"flowitemstep__description",value:a.description},null,8,["value"])]),0!==Object.keys(a.attributes).length?((0,o.wg)(),(0,o.iD)("div",kc,[(0,o.Wm)(_,{class:"flowitemstep__caption",value:"Правила формирования входных данных:"}),(0,o._)("div",{class:(0,l.C_)(["flowitemstep__arrow",{flowitemstep__arrow_selected:r.is_attributes_shown}]),onClick:s[0]||(s[0]=t=>r.is_attributes_shown=!r.is_attributes_shown)},(0,l.zw)(r.is_attributes_shown?"▼":"◆"),3)])):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.attributes,((t,s)=>((0,o.wg)(),(0,o.iD)("div",{class:"flowitemstep__row",key:s},[r.is_attributes_shown?((0,o.wg)(),(0,o.j4)(_,{key:0,class:"flowitemstep__label",value:s},null,8,["value"])):(0,o.kq)("",!0),r.is_attributes_shown?((0,o.wg)(),(0,o.j4)(_,{key:1,class:"flowitemstep__value",value:t},null,8,["value"])):(0,o.kq)("",!0)])))),128)),0!==Object.keys(a.input).length?((0,o.wg)(),(0,o.iD)("div",qc,[(0,o.Wm)(_,{class:"flowitemstep__caption",value:"Входные данные:"}),(0,o._)("div",{class:(0,l.C_)(["flowitemstep__arrow",{flowitemstep__arrow_selected:r.is_input_shown}]),onClick:s[1]||(s[1]=t=>r.is_input_shown=!r.is_input_shown)},(0,l.zw)(r.is_input_shown?"▼":"◆"),3)])):(0,o.kq)("",!0),r.is_input_shown?((0,o.wg)(),(0,o.iD)("textarea",{key:2,value:r.formatted_input,rows:"10",class:"flowitemstep__textarea"},null,8,Sc)):(0,o.kq)("",!0),0!==Object.keys(a.output).length?((0,o.wg)(),(0,o.iD)("div",Ec,[(0,o.Wm)(_,{class:"flowitemstep__caption",value:"Выходные данные:"}),(0,o._)("div",{class:(0,l.C_)(["flowitemstep__arrow",{flowitemstep__arrow_selected:r.is_output_shown}]),onClick:s[2]||(s[2]=t=>r.is_output_shown=!r.is_output_shown)},(0,l.zw)(r.is_output_shown?"▼":"◆"),3)])):(0,o.kq)("",!0),r.is_output_shown?((0,o.wg)(),(0,o.iD)("textarea",{key:4,value:r.formatted_output,rows:"10",class:"flowitemstep__textarea"},null,8,Ac)):(0,o.kq)("",!0)])}var Cc={components:{FormTextField:ra},name:"FlowItemStep",props:{name:{type:String,required:!0},variable_name:{type:String,required:!1},description:{type:String,required:!0},action:{type:String,required:!0},attributes:{type:Object,required:!1,default:()=>({})},input:{type:Object,required:!1,default:()=>({})},output:{type:[Object,String],required:!1,default:()=>({})},success:{type:Boolean,required:!0},started_at:{type:Date,required:!1,default:null},finished_at:{type:Date,required:!1,default:null}},events:["updated"],setup(t,{emit:s}){const a=(0,o.Fl)((()=>JSON.stringify(t.input,null,3))),r=(0,o.Fl)((()=>JSON.stringify(t.output,null,3))),n=(0,o.Fl)((()=>null===t.started_at?"Не стартовал":convertDateToDateTimeString(t.started_at))),_=(0,o.Fl)((()=>null===t.finished_at?"Не финишировал":convertDateToDateTimeString(t.finished_at))),l=(0,o.Fl)((()=>null===t.started_at?"WAITING":null===t.finished_at?"RUNNING":!0===t.success?"FINISHED_SUCCESS":"FINISHED_FAIL")),d=(0,i.iH)(!1),p=(0,i.iH)(!1),c=(0,i.iH)(!1),emit_updated=()=>s("updated");return(0,o.YP)(d,(()=>emit_updated())),(0,o.YP)(p,(()=>emit_updated())),(0,o.YP)(c,(()=>emit_updated())),{formatted_input:a,formatted_output:r,formatted_started_at:n,formatted_finished_at:_,state:l,is_input_shown:d,is_output_shown:p,is_attributes_shown:c,emit_updated:emit_updated}}};const Uc=(0,qs.Z)(Cc,[["render",FlowItemStepvue_type_template_id_cb691232_render]]);var Pc=Uc,jc={components:{HeadingComponent:Us,FormTextField:ra,TextButton:ya,FlowItemStep:Pc},name:"FlowItemPage",setup(){const t=(0,_.yj)(),s=new VueUnitOfWork,a=useValidateIntOr404(t.params.flowitem_id),r=s.flow_item_repository.get_current(),n=(0,o.Fl)((()=>null===r.value?"-":r.value.name)),l=(0,o.Fl)((()=>null===r.value?"-":r.value.trigger)),d=(0,o.Fl)((()=>null===r.value?null:r.value.started_at)),p=(0,o.Fl)((()=>null===r.value?null:r.value.finished_at)),c=(0,o.Fl)((()=>null===r.value?{}:r.value.raw_input)),u=(0,o.Fl)((()=>null===r.value?"-":r.value.is_active?"RUNNING":"FINISHED_"+(r.value.success?"SUCCESS":"FAIL"))),m=(0,o.Fl)((()=>null===r.value?null:r.value.raw_process)),g=(0,o.Fl)((()=>null===m.value?null:m.value["steps"])),h=(0,o.Fl)((()=>null===g.value?null:g.value.map((t=>{const s=t["name"];let a={},r={},o=null,n=null,i=!1;return Object.prototype.hasOwnProperty.call(f.value,s)&&(a=f.value[s].input,r=f.value[s].output,o=f.value[s].started_at,n=f.value[s].finished_at,i=f.value[s].success),{name:s,description:t["description"],action:t["action"]["name"],attributes:t["action"]["input"],input:a,output:r,started_at:o,finished_at:n,success:i}})))),handle_restart_flowitem=async()=>{const t=new RestartFlowItem(a);await message_bus_MessageBus.handle(t,s)},f=(0,o.Fl)((()=>{let t={};return s.flow_item_step_repository.values().forEach((s=>{Object.prototype.hasOwnProperty.call(t,s.value.name)&&t[s.value.name].started_at>s.value.started_at||(t[s.value.name]=s.value)})),t})),v=(0,i.iH)(null),w=(0,i.iH)([]),make_dom_elem_obj=()=>{let t={trigger:v.value.$el};return w.value.forEach((s=>t[s.name]=s.$el)),t},y=(0,i.iH)([]),draw=()=>{y.value=[];const t=make_dom_elem_obj();g.value.forEach((s=>{const a=s["name"],r=t[a],o=(s["to_be_finished_before"]||[]).map((t=>Object.assign(t,{type:"must"}))),n=(s["at_least_one_to_be_finished_before"]||[]).map((t=>Object.assign(t,{type:"should"}))),i=[].concat(o).concat(n);let _=null;i?i.forEach((s=>{const a=s["name"],o=s["success"],n=s["result_key"],i="should"===s["type"],l=t[a],d=o?"right":"left",p=Object.prototype.hasOwnProperty.call(f.value,a)&&f.value[a].success===o&&f.value[a].result_key===n?s["success"]?"green":"red":"gray";_=yc.Z.setLine(l,r,{startPlug:"disc",startSocket:d,endSocket:d,middleLabel:n,color:p,dash:i})})):_=yc.Z.setLine(t["trigger"],r,{startPlug:"disc",startSocket:"right",endSocket:"right",color:"green"}),y.value.push(_)}))};(0,o.bv)((async()=>{await useBeforeEnterPage(s,["can_view_flowitem"]),await Promise.all([useGetFlowItem(s,a),useGetFlowItemSteps(s,a)]),draw()})),(0,o.Xn)((()=>{w.value=[]})),(0,o.Jd)((()=>{y.value.forEach((t=>t.remove()))}));const handle_updated=()=>{(0,o.Y3)((()=>y.value.forEach((t=>t.position()))))};return{convertDateToDateTimeString:convertDateToDateTimeString,flowitem:r,flowitem_id:a,flowitem_name:n,flowitem_trigger:l,flowitem_started_at:d,flowitem_finished_at:p,flowitem_state:u,flowitem_input:c,handle_restart_flowitem:handle_restart_flowitem,process:m,process_steps:g,steps:h,real_latest_steps:f,trigger_el:v,step_el_arr:w,make_dom_elem_obj:make_dom_elem_obj,draw:draw,lines_arr:y,handle_updated:handle_updated}}};const Mc=(0,qs.Z)(jc,[["render",FlowItemPagevue_type_template_id_0e74ad10_scoped_true_render],["__scopeId","data-v-0e74ad10"]]);var Tc=Mc;const Nc={class:"page"},Ic={class:"page__container"};function FlowItemsPagevue_type_template_id_19efac15_scoped_true_render(t,s,a,r,n,i){const _=(0,o.up)("heading-component"),l=(0,o.up)("search-component");return(0,o.wg)(),(0,o.iD)("div",Nc,[(0,o.Wm)(_,{class:"page__heading",text:"Экземпляры потоков",size:"middle"}),(0,o._)("div",Ic,[(0,o.Wm)(l,{class:"page__searchblock",schema:r.search_schema,model_objects:r.model_objects,convert_obj_to_item:r.convert_model_to_item,current_id:r.current_id,sort_by:"started_at",search_time:r.search_time,is_searching:r.is_searching,should_emit_search_event_on_any_keypress:!1,has_link:!0,onChoose:s[0]||(s[0]=t=>r.current_id=t),onSearch:s[1]||(s[1]=t=>r.search_action(t))},null,8,["schema","model_objects","convert_obj_to_item","current_id","search_time","is_searching"])])])}var Bc={components:{HeadingComponent:Us,SearchComponent:P_},name:"FlowItemsPage",setup(){const t=new VueUnitOfWork,convert_model_to_item=t=>({id:t.id,attributes:{id:t.id.toString(),name:t.name,username:t.username,is_active:!0===t.is_active?"Y":"N",success:!0===t.success?"Y":"N",started_at:convertDateToDateTimeString(t.started_at),finished_at:t.finished_at?convertDateToDateTimeString(t.finished_at):"-"},link_to_single_page:{name:"FlowItemPage",params:{flowitem_id:t.id}},actions:{}}),s=(0,i.iH)({}),a=(0,o.Fl)((()=>filterArrayOfObjectsByQuery(t.flow_item_repository.values().map((t=>t.value)),s.value))),r=(0,i.iH)(0),n=(0,i.iH)(!1),_=(0,i.iH)(0),search_action=async s=>{await useExecutionTimeDecorator(t,new GetManyFlowItems(s),r,n)},l=[{name:"id",size:"w50",fields:[{placeholder:"ID",rule:"exact"}]},{name:"username",size:"w200",grow:!0,fields:[{placeholder:"Пользователь",rule:"icontains"}]},{name:"name",size:"w200",align:"left",grow:!0,fields:[{placeholder:"Наименование",rule:"icontains"}]},{name:"is_active",size:"w30",fields:[{type:"bool",placeholder:"Активен?",rule:"exact"}]},{name:"success",size:"w30",fields:[{type:"bool",placeholder:"Успешно?",rule:"exact"}]},{name:"started_at",size:"w150",fields:[{placeholder:"Старт (от)",rule:"gte",re:"^\\d{2}\\.\\d{2}\\.\\d{4}$",converter:"date_to_iso_string"},{placeholder:"Старт (до)",rule:"lte",re:"^\\d{2}\\.\\d{2}\\.\\d{4}$",converter:"date_to_iso_string"}]},{name:"finished_at",size:"w150",fields:[{placeholder:"Финиш (от)",rule:"gte",re:"^\\d{2}\\.\\d{2}\\.\\d{4}$",converter:"date_to_iso_string"},{placeholder:"Финиш (до)",rule:"lte",re:"^\\d{2}\\.\\d{2}\\.\\d{4}$",converter:"date_to_iso_string"}]}];return(0,o.bv)((async()=>{await useBeforeEnterPage(t,["can_view_flow"])})),{search_action:search_action,current_id:_,search_schema:l,model_objects:a,convert_model_to_item:convert_model_to_item,search_time:r,is_searching:n}}};const Oc=(0,qs.Z)(Bc,[["render",FlowItemsPagevue_type_template_id_19efac15_scoped_true_render],["__scopeId","data-v-19efac15"]]);var zc=Oc;const Wc=[{path:"/folder/:folder_id/usergroup/:usergroup_id/file/:file_id",name:"DownloadFileFromFolderPage",component:Kp},{path:"/share/file/:file_id",name:"DownloadShareFilePage",component:ec},{path:"/mailmessage/:message_id/file/:file_id",name:"DownloadMailMessageFilePage",component:ac},{path:"/folder/:folder_id/usergroup/:usergroup_id",name:"SearchDocumentPage",component:Jr},{path:"/folder/:folder_id/usergroup/:usergroup_id/document/:document_id",name:"DocumentPage",component:li,meta:{transition:"slide-right"}},{path:"/login",name:"LoginPage",component:Os},{path:"/",name:"FoldersPage",component:yi},{path:"/approvals",name:"ApprovalsPage",component:oo},{path:"/profile",name:"ProfilePage",component:t_},{path:"/cart",name:"CartPage",component:Wi},{path:"/settings",name:"SettingsPage",component:y_},{path:"/settings/users",name:"UserSettingsPage",component:T_},{path:"/settings/user-replacements",name:"UserReplacementsPage",component:K_},{path:"/settings/folders",name:"FolderSettingsPage",component:pl},{path:"/settings/roles",name:"UserFolderSettingsPage",component:rl},{path:"/settings/permissions",name:"PermissionSettingsPage",component:bl},{path:"/settings/usergroups",name:"UserGroupSettingsPage",component:Sl},{path:"/settings/users-in-usergroups",name:"UsersInUserGroupsSettingsPage",component:Bl},{path:"/settings/flows",name:"FlowsPage",component:dc},{path:"/settings/flowitems",name:"FlowItemsPage",component:zc},{path:"/settings/flowitems/:flowitem_id",name:"FlowItemPage",component:Tc},{path:"/settings/server-settings",name:"ServerSettingsPage",component:Zl},{path:"/settings/counters",name:"CounterSettingsPage",component:Kl},{path:"/settings/mailboxes",name:"MailBoxSettingsPage",component:rd},{path:"/settings/mailchannels",name:"MailChannelSettingsPage",component:pd},{path:"/settings/mailboxes-in-mailchannels",name:"MailChannelsInMailBoxesSettingsPage",component:kd},{path:"/settings/mailmessages",name:"MailMessagesPage",component:Nd},{path:"/service",name:"ServicePage",component:Zd},{path:"/service/pdfmergetool",name:"PdfMergeToolPage",component:op},{path:"/service/sharefiletool",name:"ShareFilePage",component:cp},{path:"/service/selftesting",name:"SelfTestingPage",component:jp},{path:"/service/document-approvals-search",name:"DocumentApprovalSearchPage",component:Zp},{path:"/:pathMatch(.*)*",name:"PageNotFound",component:Bp,props:{text:"Страница не найдена"}}],Gc=(0,_.p7)({history:(0,_.PO)("/"),routes:Wc});var Zc=Gc;const filterArrayOfObjects=(t,s,a=!0)=>t.filter((t=>{let r=!0;return Object.keys(s).forEach((o=>{let n=t[o];if(void 0===n)return void(r=!1);if(null===n)return void(s[o]&&(r=!1));let i=s[o];a||(n=n.toLowerCase(),i=i.toLowerCase()),String.prototype.includes.call(n,i)||(r=!1)})),r})),filterArrayOfObjectsByQuery=(t,s)=>t.filter((t=>{let a=!0;return Object.keys(s).forEach((r=>{if(!a)return;const o=s[r];if(!o&&0!==o)return;let n=r.split("__");const i=n.length<=1?"exact":n.pop();let _=t;if(n.forEach((t=>_=_[t])),_||0===_)switch(i){case"exact":a=_==o;break;case"iexact":a=_.toLowerCase()==o.toLowerCase();break;case"contains":a=String.prototype.includes.call(_,o);break;case"icontains":a=String.prototype.includes.call(_.toLowerCase(),o.toLowerCase());break;case"gt":a=_>o;break;case"gte":a=_>=o;break;case"lt":a=_<o;break;case"lte":a=_<=o;break;default:console.log("Wrong comparison rule "+i.toString()+"!"),a=!1}else a=!1})),a})),useBeforeEnterPage=async(t,s,a=null,r=null)=>{const o=(0,_.yj)(),auto_login_action=async t=>{!t.user_repository.is_authenticated()&&t.token_repository.get_auth_token()&&await message_bus_MessageBus.handle(new LoginWithToken,t)};await auto_login_action(t),null!==a&&null!==r&&await message_bus_MessageBus.handle(new GetUserPermissionsForFolder(a,r),t),s.forEach((s=>{!0!==t.permission_repository.has(s).value&&!0!==t.permission_repository.has_for_folder(a,s).value&&(Zc.push({name:"LoginPage",query:{url:encodeURIComponent(o.fullPath)}}),message_bus_MessageBus.handle(new AccessPagePermissionCheckFail,t))}))},useGetInfo=async t=>{const s=new GetInfo;await message_bus_MessageBus.handle(s,t)},useGetFolders=async t=>{const s=new GetFolders;await message_bus_MessageBus.handle(s,t)},useGetRoles=async t=>{const s=new GetRoles;await message_bus_MessageBus.handle(s,t)},useGetUserFolderSettings=async t=>{const s=new GetUserFolderSettings;await message_bus_MessageBus.handle(s,t)},useGetUsers=async t=>{const s=new GetUsers;await message_bus_MessageBus.handle(s,t)},useGetUserReplacements=async t=>{const s=new GetUserReplacements;await message_bus_MessageBus.handle(s,t)},useGetOnBehalfUsers=async t=>{const s=new GetOnBehalfUsers;await message_bus_MessageBus.handle(s,t)},useGetUserGroups=async t=>{const s=new GetUserGroups;await message_bus_MessageBus.handle(s,t)},useGetUserSearchSchema=async(t,s,a)=>{const r=new GetUserSearchSchema(s,a);await message_bus_MessageBus.handle(r,t)},useGetSpareFiles=async(t,s,a)=>{const r=new GetSpareFiles(s,a);await message_bus_MessageBus.handle(r,t)},useGetFlowItem=async(t,s)=>{const a=new GetFlowItem(s);await message_bus_MessageBus.handle(a,t)},useGetFlowItemSteps=async(t,s)=>{const a=new GetFlowItemSteps(s);await message_bus_MessageBus.handle(a,t)},useGetDocument=async(t,s,a,r)=>{const o=new GetDocument(s,a,r);await message_bus_MessageBus.handle(o,t)},useValidateDocument=async(t,s,a,r)=>{const o=new ValidateDocument(s,a,r);await message_bus_MessageBus.handle(o,t)},useGetDocumentsWaitingApproval=async t=>{await message_bus_MessageBus.handle(new GetWaitingDocumentApprovals,t)},useGetDocumentApprovalsWithSpareFiles=async(t,s,a,r)=>{await Promise.all([message_bus_MessageBus.handle(new GetDocumentApprovals(s,a,r),t),message_bus_MessageBus.handle(new GetDocumentApprovalSpareFiles(s,a,r),t)])},useGetDocumentApprovalFlow=async(t,s,a,r)=>{await message_bus_MessageBus.handle(new GetDocumentApprovalFlow(s,a,r),t)},useGetCart=async t=>{await message_bus_MessageBus.handle(new GetCart,t)},useGetServerSettings=async t=>{await message_bus_MessageBus.handle(new GetServerSettings,t)},useGetMailBoxes=async t=>{await message_bus_MessageBus.handle(new GetMailBoxes,t)},useGetMailChannels=async t=>{await message_bus_MessageBus.handle(new GetMailChannels,t)},useGetCounters=async t=>{await message_bus_MessageBus.handle(new GetCounters,t)},useGetContext=async(t,s,a,...r)=>{const o={DOCUMENT_ATTRIBUTES:useGetDocumentAttributesContext,PREVIOUS_DOCUMENTS_ATTRIBUTE:useGetDocumentPreviousContext,USERS_EMAILS:useGetUserEmailContext};t.context_repository.reset(s),await Promise.all(a.map((a=>{const n=o[a["type"]];return n(t,s,a["name"],a["parameters"]||{},...r)})))},useGetDocumentAttributesContext=(t,s,a,r,o,n,i)=>{message_bus_MessageBus.handle(new GetDocumentAttributesContext(s,a,o,i,r["is_raw_attribute"]),t)},useGetDocumentPreviousContext=async(t,s,a,r,o,n,i)=>{await message_bus_MessageBus.handle(new GetDocumentPreviousAttributeContext(s,a,o,n,i,r["attribute_name"],r["is_raw_attribute"],r["count"]),t)},useGetUserEmailContext=(t,s,a)=>{message_bus_MessageBus.handle(new GetUserEmailContext(s,a),t)},use404=()=>{Zc.push({name:"PageNotFound"})},useValidateIntOr404=t=>{const s=Number.parseInt(t,10);return isNaN(s)&&use404(),s},convertStringToDate=(t,s)=>{const a=t.split(".");let r=NaN;try{return null!==s&&"lt"!==s&&"lte"!==s||(r=new Date(parseInt(a[2],10),parseInt(a[1],10)-1,parseInt(a[0],10),23,59,59)),"gt"!==s&&"gte"!==s||(r=new Date(parseInt(a[2],10),parseInt(a[1],10)-1,parseInt(a[0],10))),r}catch(o){return NaN}},useDataEncode=(t,s=null,a=null)=>{if(!a)return t;const r={date_to_timestamp:convertDateToTimestamp,date_to_iso_string:convertDateToIsoString,date_to_date_object:convertDateToDateObject},o=Object.prototype.hasOwnProperty.call(r,a)?r[a]:null;return o?o(t,s):""},useCurrentMixin=(t,s,a)=>{const r=(0,i.iH)(null),n=(0,i.iH)(convertObject(t,a)),handle_update_attribute=(t,s)=>n.value[t]=s;return(0,o.YP)(r,(t=>{if(null===t)return;const r=s.get(t).value;n.value=convertObject(r.to_dict,a)})),{current_id:r,current:n,handle_update_attribute:handle_update_attribute}},useSelectionMixin=(t,s)=>{const a=(0,i.iH)({}),r=(0,o.Fl)((()=>Object.values(a.value).filter((t=>!0===t)).length)),handle_select_item=t=>{t in a.value?a.value[t]=!a.value[t]:a.value[t]=!0},reset_selection=()=>{n.value=!1,a.value={}};(0,o.YP)((()=>t.value),(()=>reset_selection()));const n=(0,i.iH)(!1),handle_select_all_items=()=>{!0===n.value?(reset_selection(),n.value=!1):(n.value=!0,s.value.forEach((t=>a.value[t.id]=!0)))},_=(0,o.Fl)((()=>s.value.filter((t=>t.id in a.value&&!0===a.value[t.id]))));return{selected_item_ids:a,selected_items:_,count_of_selected_items:r,is_all_selected:n,handle_select_all_items:handle_select_all_items,handle_select_item:handle_select_item,reset_selection:reset_selection}},usePaginationMixin=(t,s=[20,100,500,1e3],a=100)=>{const r=(0,i.iH)(s),n=(0,i.iH)(a),_=(0,i.iH)(1),l=(0,i.iH)(0),d=(0,i.iH)(100),handle_set_page_range=(t,s)=>{l.value=t,d.value=s},p=(0,o.Fl)((()=>t.value.slice(l.value,d.value+1)));return{pagination_variants:r,pagination_count_per_page:n,pagination_current_page:_,pagination_min_index:l,pagination_max_index:d,paginated_items:p,handle_set_page_range:handle_set_page_range}},usePromiseExecuteMixin=async(t,s,a=null)=>{null!==a&&(a.value=0);let r=0,o=0;while(o<t.length)await Promise.all(t.slice(o,o+s).map((async s=>{await s(),r++,null!==a&&(a.value=Math.round(r/t.length*100))}))),o+=s},usePerformActionMixin=(t,s)=>{const a=(0,i.iH)(100),perform_action_on_items=async r=>{const o=t.value.filter((t=>t.actions[r])).map((t=>t.actions[r]));await usePromiseExecuteMixin(o,s,a)};return{action_progress:a,perform_action_on_items:perform_action_on_items}},useExecutionTimeDecorator=async(t,s,a,r=null)=>{null!==r&&(r.value=!0);const o=performance.now();await message_bus_MessageBus.handle(s,t),a.value=Math.round(performance.now()-o)/1e3,null!==r&&(r.value=!1)},convertObject=(t,s,a=[])=>{let r={};return Object.keys(t).filter((t=>!a.includes(t))).forEach((a=>r[a]=Object.prototype.hasOwnProperty.call(s,a)?s[a](t[a]):t[a])),Object.keys(s).filter((s=>!Object.prototype.hasOwnProperty.call(t,s))).forEach((t=>r[t]=s[t]())),r},convertDateToDateObject=(t,s)=>convertStringToDate(t,s),convertDateToTimestamp=(t,s)=>{const a=convertStringToDate(t,s);return isNaN(a)?"":Math.floor(a.getTime()/1e3)},convertDateToIsoString=(t,s)=>{const a=convertStringToDate(t,s);return isNaN(a)?"":a.toISOString()},convertDateToDateString=t=>[t.getDate().toString().padStart(2,"0"),(t.getMonth()+1).toString().padStart(2,"0"),t.getFullYear().toString()].join("."),convertDateToDateTimeString=t=>t.toLocaleString("ru-RU"),useGetSortFunction=t=>{const sort_default=(t,s)=>t===s?0:t>s?1:-1,sort_numbers=(t,s)=>t-s,sort_strings=(t,s)=>t.localeCompare(s),sort_change_order_number=(t,s)=>{try{const[a,r]=t.split("-",2),[o,n]=s.split("-",2),i=Number.parseInt(r)-Number.parseInt(n);if(0!==i)return i;const _=Number.parseInt(a)-Number.parseInt(o);return _}catch(a){return 0}};null!==t&&void 0!==t||(t="DEFAULT");const s={DEFAULT:sort_default,INTEGER:sort_numbers,STRING:sort_strings,BOOL:sort_default,DATE:sort_default,CHANGE_ORDER_NUMBER:sort_change_order_number};return Object.prototype.hasOwnProperty.call(s,t)||(t="DEFAULT"),s[t]},shuffleArray=t=>{var s,a,r=t.length;while(r)a=Math.floor(Math.random()*r--),s=t[r],t[r]=t[a],t[a]=s;return t},generate_states_obj_from_approvals=t=>{if(0===t.length)return{};let s={};t.forEach((t=>{s[t.id]=t}));let a={};const r=t.map((t=>t));return r.sort(((t,s)=>t.updated_at-s.updated_at)).map((t=>{const r=t.state;a[t.to_username]=r;while(t.delegated_from)t=s[t.delegated_from],a[t.to_username]=r})),a},validate_json=(t,s=null)=>{let a=null;try{a=JSON.parse(t)}catch(n){return!1}if(null===s)return!0;const r=new(D())({allErrors:!0,allowUnionTypes:!0});k()(r);const o=r.compile(s);return o(a),null===o.errors||(o.errors.forEach((t=>console.log(t.message))),!1)};var Hc={name:"NavigationComponent",components:{FormSelectInput:er},props:{version:{type:String,required:!0},links:{type:Array,required:!0},show_usergroup:{type:Boolean,required:!0},can_change_usergroup:{type:Boolean,required:!0}},setup(t){const s=new VueUnitOfWork,a=s.user_repository.get_current(),r=(0,o.Fl)((()=>{if(null===a.value)return[];let t=s.usergroup_repository.values().filter((t=>!t.value.is_private||t.value.has_username(a.value.username))).map((t=>({id:t.value.id,name:t.value.name,value:t.value.id.toString()})));return t.sort(((t,s)=>t.name.localeCompare(s.name))),t})),n=(0,o.Fl)((()=>{const t=s.usergroup_repository.get_current();return null===t.value?0:t.value.id}));(0,o.YP)(r,(t=>{0===n.value&&t.length>0&&handle_change_current(t[0].id)}));const handle_change_current=t=>{const a=s.usergroup_repository.get(t);message_bus_MessageBus.handle(new SetCurrentUserGroup(a.value),s)},_=s.info_repository.get_approval_actions_count(),l=s.info_repository.get_approval_orders_count(),d=(0,o.Fl)((()=>s.cart_repository.doc_values().length)),p=(0,i.iH)(!1),c=(0,i.iH)(!1);(0,o.YP)((()=>d.value),((t,s)=>{t>s&&(p.value=!0),t<s&&(c.value=!0),setTimeout((()=>{c.value=!1,p.value=!1}),1e3)}));const handle_empty_cart=()=>{message_bus_MessageBus.handle(new EmptyCart,s)},handle_delete_on_behalf_user=t=>message_bus_MessageBus.handle(new DeleteOnBehalfUser(t),s);return(0,o.bv)((async()=>{await useBeforeEnterPage(s,[]),!0===t.show_usergroup&&await useGetUserGroups(s),await Promise.all([useGetInfo(s),useGetCart(s)])})),{user:a,groups:r,group_id:n,handle_change_current:handle_change_current,approval_actions_count:_,approval_orders_count:l,cart_obj_count:d,cart_obj_count_increased_flag:p,cart_obj_count_decreased_flag:c,handle_empty_cart:handle_empty_cart,handle_delete_on_behalf_user:handle_delete_on_behalf_user}}};const $c=(0,qs.Z)(Hc,[["render",NavigationComponentvue_type_template_id_24c82cc2_render]]);var Lc=$c,Vc={components:{NavigationComponent:Lc},name:"BasePage",setup(){const t=(0,_.yj)(),s=new VueUnitOfWork,a=s.user_repository.get_current(),r=(0,o.f3)("version"),n=s.permission_repository.has("can_view_settings"),l=(0,o.Fl)((()=>{const t=[{route_name:"LoginPage",title:"Вход"},{route_name:"FoldersPage",title:"Выборки"},{route_name:"ServicePage",title:"Сервис"}];return!0===n.value&&t.push({route_name:"SettingsPage",title:"Настройки"}),t})),d=["FoldersPage","SearchDocumentPage","DocumentPage"],p=(0,i.iH)(!1),c=(0,i.iH)(!1);return(0,o.YP)((()=>t.name),(t=>{c.value="FoldersPage"===t,p.value=d.includes(t)})),{user:a,navigation_links:l,version:r,show_usergroup:p,can_change_usergroup:c}}};const Jc=(0,qs.Z)(Vc,[["render",BasePagevue_type_template_id_ab6bb786_render]]);var Yc=Jc,Kc={components:{BasePage:Yc},name:"App",setup(){(0,o.JJ)("info",{}),(0,o.JJ)("users",{}),(0,o.JJ)("user_replacements",{}),(0,o.JJ)("usergroups",{}),(0,o.JJ)("tokens",{}),(0,o.JJ)("user_folder_settings",{}),(0,o.JJ)("role_permissions",{}),(0,o.JJ)("permissions",{}),(0,o.JJ)("folders",{}),(0,o.JJ)("documents",{}),(0,o.JJ)("document_approvals",{}),(0,o.JJ)("waiting_document_approvals",{}),(0,o.JJ)("search_document_approvals",{}),(0,o.JJ)("document_approval_flows",{}),(0,o.JJ)("cart",{}),(0,o.JJ)("files_in_folders",{}),(0,o.JJ)("files_pdf_merge",{}),(0,o.JJ)("files_share",{}),(0,o.JJ)("files_document_approval",{}),(0,o.JJ)("files_common",{}),(0,o.JJ)("download_progress",{}),(0,o.JJ)("folder_settings",{}),(0,o.JJ)("self_testing_questions",{}),(0,o.JJ)("server_settings",{}),(0,o.JJ)("mailboxes",{}),(0,o.JJ)("mail_channels",{}),(0,o.JJ)("mail_messages",{}),(0,o.JJ)("context",{}),(0,o.JJ)("counters",{}),(0,o.JJ)("flows",{}),(0,o.JJ)("flow_items",{}),(0,o.JJ)("flow_item_steps",{}),(0,o.JJ)("version","1.91.0")}};const Xc=(0,qs.Z)(Kc,[["render",render]]);var Qc=Xc,eu=a(9138),tu=a.n(eu);(0,r.ri)(Qc).use(Zc).use(tu()).mount(".app")},5832:function(){},2361:function(){},4616:function(){},5382:function(){},2095:function(){},1219:function(){}},__webpack_module_cache__={};function __webpack_require__(t){var s=__webpack_module_cache__[t];if(void 0!==s)return s.exports;var a=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t].call(a.exports,a,a.exports,__webpack_require__),a.exports}__webpack_require__.m=__webpack_modules__,function(){var t=[];__webpack_require__.O=function(s,a,r,o){if(!a){var n=1/0;for(d=0;d<t.length;d++){a=t[d][0],r=t[d][1],o=t[d][2];for(var i=!0,_=0;_<a.length;_++)(!1&o||n>=o)&&Object.keys(__webpack_require__.O).every((function(t){return __webpack_require__.O[t](a[_])}))?a.splice(_--,1):(i=!1,o<n&&(n=o));if(i){t.splice(d--,1);var l=r();void 0!==l&&(s=l)}}return s}o=o||0;for(var d=t.length;d>0&&t[d-1][2]>o;d--)t[d]=t[d-1];t[d]=[a,r,o]}}(),function(){__webpack_require__.n=function(t){var s=t&&t.__esModule?function(){return t["default"]}:function(){return t};return __webpack_require__.d(s,{a:s}),s}}(),function(){__webpack_require__.d=function(t,s){for(var a in s)__webpack_require__.o(s,a)&&!__webpack_require__.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:s[a]})}}(),function(){__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){__webpack_require__.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)}}(),function(){var t={143:0};__webpack_require__.O.j=function(s){return 0===t[s]};var webpackJsonpCallback=function(s,a){var r,o,n=a[0],i=a[1],_=a[2],l=0;if(n.some((function(s){return 0!==t[s]}))){for(r in i)__webpack_require__.o(i,r)&&(__webpack_require__.m[r]=i[r]);if(_)var d=_(__webpack_require__)}for(s&&s(a);l<n.length;l++)o=n[l],__webpack_require__.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return __webpack_require__.O(d)},s=self["webpackChunkvue_project"]=self["webpackChunkvue_project"]||[];s.forEach(webpackJsonpCallback.bind(null,0)),s.push=webpackJsonpCallback.bind(null,s.push.bind(s))}();var __webpack_exports__=__webpack_require__.O(void 0,[998],(function(){return __webpack_require__(2985)}));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();
//# sourceMappingURL=app.664a4c4a.js.map